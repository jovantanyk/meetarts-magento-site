!function(){"use strict";function d(e){return/^[(\[{ \u00a0]$/.test(e)}function l(e){return 3===e.nodeType}function i(e){return 1===e.nodeType}function o(e,t){return t<0&&(t=0),t=l(e)&&(e=e.data.length)<t?e:t}function u(e,t,n){!i(t)||t.hasChildNodes()?e.setStart(t,o(t,n)):e.setStartBefore(t)}function c(e,t,n){!i(t)||t.hasChildNodes()?e.setEnd(t,o(t,n)):e.setEndAfter(t)}function r(e,t){var n,i,o=e.getParam("autolink_pattern",g),r=e.getParam("default_link_target",!1);if(null===e.dom.getParent(e.selection.getNode(),"a[href]")){var a=e.selection.getRng().cloneRange();if(a.startOffset<5){if(!(s=a.endContainer.previousSibling)){if(!a.endContainer.firstChild||!a.endContainer.firstChild.nextSibling)return;s=a.endContainer.firstChild.nextSibling}if(u(a,s,f=s.length),c(a,s,f),a.endOffset<5)return;n=a.endOffset,i=s}else{if(!l(i=a.endContainer)&&i.firstChild){for(;!l(i)&&i.firstChild;)i=i.firstChild;l(i)&&(u(a,i,0),c(a,i,i.nodeValue.length))}n=1===a.endOffset?2:a.endOffset-1-t}for(var f=n;u(a,i,2<=n?n-2:0),c(a,i,1<=n?n-1:0),--n,!d(a.toString())&&0<=n-2;);d(a.toString())?(u(a,i,n),c(a,i,f),n+=1):(0===a.startOffset?u(a,i,0):u(a,i,n),c(a,i,f)),s=a.toString(),/[?!,.;:]/.test(s.charAt(s.length-1))&&c(a,i,f-1);var s,t=(s=a.toString().trim()).match(o),f=e.getParam("link_default_protocol","http","string");t&&((o=s=t[0]).length>=(t="www.").length&&o.substr(0,0+t.length)===t?s=f+"://"+s:-1===s.indexOf("@")||/^([A-Za-z][A-Za-z\d.+-]*:\/\/)|mailto:/.test(s)||(s="mailto:"+s),o=e.selection.getBookmark(),e.selection.setRng(a),e.execCommand("createlink",!1,s),!1!==r&&e.dom.setAttrib(e.selection.getNode(),"target",r),e.selection.moveToBookmark(o),e.nodeChanged())}}var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=tinymce.util.Tools.resolve("tinymce.Env"),g=new RegExp("^"+/(?:[A-Za-z][A-Za-z\d.+-]{0,14}:\/\/(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?|www\.|[-;:&=+$,.\w]+@)[A-Za-z\d-]+(?:\.[A-Za-z\d-]+)*(?::\d+)?(?:\/(?:[-+~=.,%()\/\w]*[-+~=%()\/\w])?)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?/g.source+"$","i");e.add("autolink",function(e){var t,n;(t=e).on("keydown",function(e){if(13===e.keyCode)return r(t,-1)}),a.browser.isIE()?t.on("focus",function(){if(!n){n=!0;try{t.execCommand("AutoUrlDetect",!1,!0)}catch(e){}}}):(t.on("keypress",function(e){if(41===e.keyCode||93===e.keyCode||125===e.keyCode)return r(t,-1)}),t.on("keyup",function(e){if(32===e.keyCode)return r(t,0)}))})}();
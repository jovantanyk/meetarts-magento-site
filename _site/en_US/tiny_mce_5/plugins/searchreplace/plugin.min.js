!function(){"use strict";function h(e){var t=e;return{get:function(){return t},set:function(e){t=e}}}function e(n){return function(e){return t=typeof(e=e),(null===e?"null":"object"==t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t)===n;var t}}function t(t){return function(e){return typeof e===t}}function g(){}function i(e){return function(){return e}}function n(e){return e}function r(){return u}var R=tinymce.util.Tools.resolve("tinymce.PluginManager"),p=function(){return(p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},W=e("string"),j=e("array"),V=t("boolean"),H=t("number"),a=i(!1),c=i(!0),L=i("[!-#%-*,-\\/:;?@\\[-\\]_{}¡«·»¿;·՚-՟։֊־׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰෴๏๚๛༄-༒༺-༽྅࿐-࿔࿙࿚၊-၏჻፡-፨᐀᙭᙮᚛᚜᛫-᛭᜵᜶។-៖៘-៚᠀-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳓‐-‧‰-⁃⁅-⁑⁓-⁞⁽⁾₍₎〈〉❨-❵⟅⟆⟦-⟯⦃-⦘⧘-⧛⧼⧽⳹-⳼⳾⳿⵰⸀-⸮⸰⸱、-〃〈-】〔-〟〰〽゠・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꯫﴾﴿︐-︙︰-﹒﹔-﹡﹣﹨﹪﹫！-＃％-＊，-／：；？＠［-］＿｛｝｟-･]"),u={fold:function(e,t){return e()},isSome:a,isNone:c,getOr:n,getOrThunk:o,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:n,orThunk:o,map:r,each:g,bind:r,exists:a,forall:c,filter:function(){return u},toArray:function(){return[]},toString:i("none()")};function o(e){return e()}function v(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r}function y(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function l(e,t){for(var n=e.length-1;0<=n;n--)t(e[n],n)}function x(e,t){for(var n=v(e,t),r=[],o=0,i=n.length;o<i;++o){if(!j(n[o]))throw new Error("Arr.flatten item "+o+" was not an array, input: "+n);$.apply(r,n[o])}return r}function s(e,t){return _.call(e,t)}function f(n){function e(){return o}function t(e){return e(n)}var r=i(n),o={fold:function(e,t){return t(n)},isSome:c,isNone:a,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:e,orThunk:e,map:function(e){return f(e(n))},each:function(e){e(n)},bind:t,exists:t,forall:t,filter:function(e){return e(n)?o:u},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o}var b={some:f,none:r,from:function(e){return null==e?u:f(e)}},w=L,O=tinymce.util.Tools.resolve("tinymce.Env"),C=tinymce.util.Tools.resolve("tinymce.util.Tools"),U=Array.prototype.slice,$=Array.prototype.push,_=Object.hasOwnProperty;function d(e,t){return{element:e,offset:t}}function m(e,t){var n=e,r=t;b.from(n.dom.parentNode).map(P.fromDom).each(function(e){e.dom.insertBefore(r.dom,n.dom)}),t.dom.appendChild(e.dom)}function T(e){return le.get(e)}function z(e,t){return e.isBlock(t)||s(e.schema.getShortEndedElements(),t.nodeName)}function q(e,t){return"false"===e.getContentEditable(t)}function G(e,t){return!e.isBlock(t)&&s(e.schema.getWhiteSpaceElements(),t.nodeName)}function K(){return{sOffset:0,fOffset:0,elements:[]}}function J(e,t){return t=t,0<(n=v((e=P.fromDom(e)).dom.childNodes,P.fromDom)).length&&t<n.length?d(n[t],0):d(e,t);var n}function Q(e,t,n,r,o,i){for(var a=(i=void 0===i||i)?t(!1):n;a;){var c=q(e,a);if(c||G(e,a)){if(c?r.cef(a):r.boundary(a))break;a=t(!0)}else{if(z(e,a)){if(r.boundary(a))break}else 3===a.nodeType&&r.text(a);if(a===o)break;a=t(!1)}}}function X(e,t,n,r,o){var i,a;z(i=e,a=n)||q(i,a)||G(i,a)||"true"===(i=i).getContentEditable(a=a)&&"false"===i.getContentEditableParent(a.parentNode)||(i=e.getParent(r,e.isBlock),a=new se(n,i),Q(e,(o?a.next:a.prev).bind(a),n,{boundary:c,cef:c,text:function(e){o?t.fOffset+=e.length:t.sOffset+=e.length,t.elements.push(P.fromDom(e))}}))}function Y(e,t,n,r,o,i){void 0===i&&(i=!0);var a=new se(n,t),c=[],u=K();function l(){return 0<u.elements.length&&(c.push(u),u=K()),!1}return X(e,u,n,t,!1),Q(e,a.next.bind(a),n,{boundary:l,cef:function(e){return l(),o&&c.push.apply(c,o.cef(e)),!1},text:function(e){u.elements.push(P.fromDom(e)),o&&o.text(e,u)}},r,i),r&&X(e,u,r,t,!0),l(),c}function Z(e,t){return t.collapsed?[]:(n=e,r=J((e=t).startContainer,e.startOffset),o=r.element.dom,i=J(e.endContainer,e.endOffset),a=i.element.dom,Y(n,e.commonAncestorContainer,o,a,{text:function(e,t){e===a?t.fOffset+=e.length-i.offset:e===o&&(t.sOffset+=r.offset)},cef:function(e){var t=x(1!==(t=e=void 0===(e=P.fromDom(e))?document:e.dom).nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount?[]:v(e.querySelectorAll("*[contenteditable=true]"),P.fromDom),function(e){e=e.dom;return Y(n,e,e)});return(e=U.call(t,0)).sort(function(e,t){return e=e.elements[0].dom,t=t.elements[0].dom,n=Node.DOCUMENT_POSITION_PRECEDING,0!=(e.compareDocumentPosition(t)&n)?1:-1;var n}),e}},!1));var n,r,o,i,a}function ee(e,t){var n=e.createRng();return n.selectNode(t),Z(e,n)}function te(g,e){return x(e,function(e){function t(e){return e.matchId}var n,r,o=e.elements,i=v(o,T).join(""),a=function(e,t,n,r){void 0===r&&(r=e.length);var o=t.regex;o.lastIndex=void 0===n?0:n;for(var i=[];c=o.exec(e);){var a=c[t.matchIndex],c=c.index+c[0].indexOf(a),a=c+a.length;if(r<a)break;i.push({start:c,finish:a}),o.lastIndex=a}return i}(i,g,e.sOffset,i.length-e.fOffset),c=(n=function(e,n){var t=T(n),r=e.last,o=r+t.length,t=x(a,function(e,t){return e.start<o&&e.finish>r?[{element:n,start:Math.max(r,e.start)-r,finish:Math.min(o,e.finish)-r,matchId:t}]:[]});return{results:e.results.concat(t),last:o}},r={results:[],last:0},y(o,function(e,t){r=n(r,e)}),r.results);if(0===c.length)return[];for(var u=t(c[0]),l=[],s=[],f=0,d=c.length;f<d;f++){var m=c[f],h=t(m);h!==u&&(l.push(s),s=[]),u=h,s.push(m)}return 0!==s.length&&l.push(s),l})}function ne(e,a){l(e,function(e,i){l(e,function(e){var t=P.fromDom(a.cloneNode(!1)),n=t,r="data-mce-index",o=i;if(n=n.dom,!(W(o)||V(o)||H(o)))throw console.error("Invalid call to Attribute.set. Key ",r,":: Value ",o,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(r,o+"");n=e.element.dom;n.length===e.finish&&0===e.start?m(e.element,t):(n.length!==e.finish&&n.splitText(e.finish),r=n.splitText(e.start),m(P.fromDom(r),t))})})}function E(e){e=e.getAttribute("data-mce-index");return"number"==typeof e?""+e:e}function re(e){var t=e.parentNode;e.firstChild&&t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)}function N(e,t){var n=[],r=C.toArray(e.getBody().getElementsByTagName("span"));if(r.length)for(var o=0;o<r.length;o++){var i=E(r[o]);null!==i&&i.length&&i===t.toString()&&n.push(r[o])}return n}function k(e,t,n){var t=t.get(),r=t.index,o=e.dom,n=((n=!1!==n)?r+1===t.count?r=0:r++:r-1==-1?r=t.count-1:r--,o.removeClass(N(e,t.index),"mce-match-marker-selected"),N(e,r));return n.length?(o.addClass(N(e,r),"mce-match-marker-selected"),e.selection.scrollIntoView(n[0]),r):-1}function oe(e,t){var n=t.parentNode;e.remove(t),e.isEmpty(n)&&e.remove(n)}function ie(e,t,n,r,o,i){var a,c,u,l,s,f,d,m,h=e.selection,g=(g=o,p="("+n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/\s/g,"[^\\S\\r\\n\\uFEFF]")+")",g?"(?:^|\\s|"+w()+")"+p+"(?=$|\\s|"+w()+")":p),p=h.isForward(),v=(a=e,c=t,g={regex:new RegExp(g,r?"g":"gi"),matchIndex:1},u=i,(l=a.dom.create("span",{"data-mce-bogus":1})).className="mce-match-marker",m=a.getBody(),F(a,c,!1),(u?(c=a.dom,u=g,s=l,d=(v=a.selection).getBookmark(),ne(u=te(u,0<(u=c.select("td[data-mce-selected],th[data-mce-selected]")).length?(f=c,x(u,function(e){return ee(f,e)})):Z(c,v.getRng())),s),v.moveToBookmark(d),u):(c=l,ne(s=te(g,ee(a.dom,m)),c),s)).length);return O.browser.isSafari()&&h.setRng(h.getRng(),p),v&&(d=k(e,t,!0),t.set({index:d,count:v,text:n,matchCase:r,wholeWord:o,inSelection:i})),v}function S(e,t){e=k(e,t,!0);t.set(p(p({},t.get()),{index:e}))}function A(e,t){e=k(e,t,!1);t.set(p(p({},t.get()),{index:e}))}function ae(e){e=E(e);return null!==e&&0<e.length}function D(e,t,n,r,o){var i,a=t.get(),c=a.index,u=c;r=!1!==r;for(var l=e.getBody(),s=C.grep(C.toArray(l.getElementsByTagName("span")),ae),f=0;f<s.length;f++){var d=E(s[f]),m=i=parseInt(d,10);if(o||m===a.index){for(n.length?(s[f].firstChild.nodeValue=n,re(s[f])):oe(e.dom,s[f]);s[++f];){if((m=parseInt(E(s[f]),10))!==i){f--;break}oe(e.dom,s[f])}r&&u--}else c<i&&s[f].setAttribute("data-mce-index",String(i-1))}return t.set(p(p({},a),{count:o?0:a.count-1,index:u})),(r?S:A)(e,t),!o&&0<t.get().count}function ce(i,a){e=g,t=h(b.none());var e,t,n,r=p(p({},n={clear:function(){o(),t.set(b.none())},isSet:function(){return t.get().isSome()},get:function(){return t.get()},set:function(e){o(),t.set(b.some(e))}}),{on:function(e){return n.get().each(e)}});function o(){t.get().each(e)}function c(e){(1<a.get().count?e.enable:e.disable)("next"),(1<a.get().count?e.enable:e.disable)("prev")}function u(e,t){y(["replace","replaceall","prev","next"],t?e.disable:e.enable)}function l(e,t){O.browser.isSafari()&&O.deviceType.isTouch()&&("find"===t||"replace"===t||"replaceall"===t)&&e.focus(t)}function s(e){F(i,a,!1),u(e,!0),c(e)}function f(e){var t,n=e.getData(),r=a.get();(n.findtext.length?(r.text===n.findtext&&r.matchCase===n.matchcase&&r.wholeWord===n.wholewords?S(i,a):((r=ie(i,a,n.findtext,n.matchcase,n.wholewords,n.inselection))<=0&&(t=e,i.windowManager.alert("Could not find the specified string.",function(){t.focus("findtext")})),u(e,0===r)),c):s)(e)}i.undoManager.add();var d=C.trim(i.selection.getContent({format:"text"})),m=a.get(),d={title:"Find and Replace",size:"normal",body:{type:"panel",items:[{type:"bar",items:[{type:"input",name:"findtext",placeholder:"Find",maximized:!0,inputMode:"search"},{type:"button",name:"prev",text:"Previous",icon:"action-prev",disabled:!0,borderless:!0},{type:"button",name:"next",text:"Next",icon:"action-next",disabled:!0,borderless:!0}]},{type:"input",name:"replacetext",placeholder:"Replace with",inputMode:"search"}]},buttons:[{type:"menu",name:"options",icon:"preferences",tooltip:"Preferences",align:"start",items:[{type:"togglemenuitem",name:"matchcase",text:"Match case"},{type:"togglemenuitem",name:"wholewords",text:"Find whole words only"},{type:"togglemenuitem",name:"inselection",text:"Find in selection"}]},{type:"custom",name:"find",text:"Find",primary:!0},{type:"custom",name:"replace",text:"Replace",disabled:!0},{type:"custom",name:"replaceall",text:"Replace all",disabled:!0}],initialData:{findtext:d,replacetext:"",wholewords:m.wholeWord,matchcase:m.matchCase,inselection:m.inSelection},onChange:function(e,t){"findtext"===t.name&&0<a.get().count&&s(e)},onAction:function(e,t){var n,r,o=e.getData();switch(t.name){case"find":f(e);break;case"replace":(D(i,a,o.replacetext)?c:s)(e);break;case"replaceall":D(i,a,o.replacetext,!0,!0),s(e);break;case"prev":A(i,a),c(e);break;case"next":S(i,a),c(e);break;case"matchcase":case"wholewords":case"inselection":n=e.getData(),r=a.get(),a.set(p(p({},r),{matchCase:n.matchcase,wholeWord:n.wholewords,inSelection:n.inselection})),s(e)}l(e,t.name)},onSubmit:function(e){f(e),l(e,"find")},onClose:function(){i.focus(),F(i,a),i.undoManager.add()}};r.set(i.windowManager.open(d,{inline:"toolbar"}))}function M(e,t){return function(){ce(e,t)}}function B(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}}"undefined"==typeof window&&Function("return this;")();function F(e,t,n){for(var r,o,i=t.get(),a=C.toArray(e.getBody().getElementsByTagName("span")),c=0;c<a.length;c++){var u=E(a[c]);null!==u&&u.length&&(u===i.index.toString()&&(r=r||a[c].firstChild,o=a[c].firstChild),re(a[c]))}if(t.set(p(p({},i),{index:-1,count:0,text:""})),r&&o)return(t=e.dom.createRng()).setStart(r,0),t.setEnd(o,o.data.length),!1!==n&&e.selection.setRng(t),t}var I,ue,P={fromHtml:function(e,t){t=(t||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return B(t.childNodes[0])},fromTag:function(e,t){return B((t||document).createElement(e))},fromText:function(e,t){return B((t||document).createTextNode(e))},fromDom:B,fromPoint:function(e,t,n){return b.from(e.dom.elementFromPoint(t,n)).map(B)}},le=(I=function(e){return 3===e.dom.nodeType},{get:function(e){if(I(e))return ue(e).getOr("");throw new Error("Can only get text value of a text node")},getOption:ue=function(e){return I(e)?b.from(e.dom.nodeValue):b.none()},set:function(e,t){if(!I(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=t}}),se=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker");R.add("searchreplace",function(e){var t,n,r,o,i,a=h({index:-1,count:0,text:"",matchCase:!1,wholeWord:!1,inSelection:!1}),c=a;return(t=e).addCommand("SearchReplace",function(){ce(t,c)}),(n=e).ui.registry.addMenuItem("searchreplace",{text:"Find and replace...",shortcut:"Meta+F",onAction:M(n,r=a),icon:"search"}),n.ui.registry.addButton("searchreplace",{tooltip:"Find and replace",onAction:M(n,r),icon:"search"}),n.shortcuts.add("Meta+F","",M(n,r)),o=e,i=a,{done:function(e){return F(o,i,e)},find:function(e,t,n,r){return ie(o,i,e,t,n,r=void 0!==r&&r)},next:function(){return S(o,i)},prev:function(){return A(o,i)},replace:function(e,t,n){return D(o,i,e,t,n)}}})}();
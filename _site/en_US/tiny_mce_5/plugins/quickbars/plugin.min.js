!function(){"use strict";function e(n){return function(e){return t=typeof(e=e),(null===e?"null":"object"==t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t)===n;var t}}function t(t){return function(e){return typeof e===t}}function i(e){return function(){return e}}function n(e){return e}function o(){return b}var r=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=0,a=tinymce.util.Tools.resolve("tinymce.util.Promise"),l=tinymce.util.Tools.resolve("tinymce.Env"),s=tinymce.util.Tools.resolve("tinymce.util.Delay"),u=e("string"),d=e("object"),f=e("array"),m=t("boolean"),g=t("function"),h=i(!1),p=i(!void 0),b={fold:function(e,t){return e()},isSome:h,isNone:p,getOr:n,getOrThunk:y,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:n,orThunk:y,map:o,each:function(){},bind:o,exists:h,forall:p,filter:function(){return b},toArray:function(){return[]},toString:i("none()")};function y(e){return e()}function v(n){function e(){return r}function t(e){return e(n)}var o=i(n),r={fold:function(e,t){return t(n)},isSome:p,isNone:h,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:e,orThunk:e,map:function(e){return v(e(n))},each:function(e){e(n)},bind:t,exists:t,forall:t,filter:function(e){return e(n)?r:b},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return r}var k={some:v,none:o,from:function(e){return null==e?b:v(e)}};function w(e,t,n,o,r){return e(n,o)?k.some(n):g(r)&&r(n)?k.none():t(n,o,r)}function T(e,t){e=e.dom;if(1!==e.nodeType)return!1;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}function E(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}}var N={fromHtml:function(e,t){t=(t||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return E(t.childNodes[0])},fromTag:function(e,t){return E((t||document).createElement(e))},fromText:function(e,t){return E((t||document).createTextNode(e))},fromDom:E,fromPoint:function(e,t,n){return k.from(e.dom.elementFromPoint(t,n)).map(E)}};function M(e,t,n){for(var o=e.dom,r=g(n)?n:h;o.parentNode;){var o=o.parentNode,i=N.fromDom(o);if(t(i))return k.some(i);if(r(i))break}return k.none()}function S(e,t,n){return M(e,function(e){return T(e,t)},n)}"undefined"==typeof window&&Function("return this;")();function C(e,t,n){if(!O(n))throw new Error("Default value doesn't match requested type.");if(e=e.getParam(t,n),t=n,f(e)||d(e))throw new Error("expected a string but found: "+e);return void 0===e?t:m(e)?!1===e?"":t:e}var O;O=u;r.add("quickbars",function(e){var r,t,n,u;function o(e){return"IMG"===e.nodeName||"FIGURE"===e.nodeName&&/image/i.test(e.className)}(u=e).ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:function(){var i=u;new a(function(n){var o=document.createElement("input"),r=(o.type="file",o.accept="image/*",o.style.position="fixed",o.style.left="0",o.style.top="0",o.style.opacity="0.001",document.body.appendChild(o),o.addEventListener("change",function(e){n(Array.prototype.slice.call(e.target.files))}),function(e){function t(){n([]),o.parentNode.removeChild(o)}l.os.isAndroid()&&"remove"!==e.type?s.setEditorTimeout(i,t,0):t(),i.off("focusin remove",r)});i.on("focusin remove",r),o.click()}).then(function(e){var i,n;0<e.length&&(i=e[0],n=i,new a(function(e){var t=new FileReader;t.onloadend=function(){e(t.result.split(",")[1])},t.readAsDataURL(n)}).then(function(e){var t,n=i,o=(t=u).editorUpload.blobCache,r=o.create((r=(new Date).getTime(),"mceu_"+Math.floor(1e9*Math.random())+ ++c+String(r)),n,e);o.add(r),t.insertContent(t.dom.createHTML("img",{src:r.blobUri()}))}))})}}),u.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:function(){var e,t;(e=u).plugins.table?e.plugins.table.insertTable(2,2):(t=e).undoManager.transact(function(){t.insertContent(function(){var e='<table data-mce-id="mce" style="width: 100%">';e+="<tbody>";for(var t=0;t<2;t++){e+="<tr>";for(var n=0;n<2;n++)e+="<td><br></td>";e+="</tr>"}return e+"</tbody></table>"}());var e=t.dom.select("*[data-mce-id]")[0],e=(e.removeAttribute("data-mce-id"),t.dom.select("td,th",e));t.selection.setCursorLocation(e[0],0)})}}),0<(n=C(r=e,"quickbars_insert_toolbar","quickimage quicktable")).trim().length&&r.ui.registry.addContextToolbar("quickblock",{predicate:function(e){function t(e){return e.dom===r.getBody()}var n=N.fromDom(e),o=r.schema.getTextBlockElements();return w(T,S,n,"table",t).fold(function(){return w(function(e,t){return t(e)},M,n,function(e){return e.dom.nodeName.toLowerCase()in o&&r.dom.isEmpty(e.dom)},t).isSome()},h)},items:n,position:"line",scope:"editor"}),0<(n=C(t=e,"quickbars_image_toolbar","alignleft aligncenter alignright")).trim().length&&t.ui.registry.addContextToolbar("imageselection",{predicate:o,items:n,position:"node"}),0<(n=C(t,"quickbars_selection_toolbar","bold italic | quicklink h2 h3 blockquote")).trim().length&&t.ui.registry.addContextToolbar("textselection",{predicate:function(e){return!o(e)&&!t.selection.isCollapsed()&&"false"!==t.dom.getContentEditableParent(e)},items:n,position:"selection",scope:"editor"})})}();
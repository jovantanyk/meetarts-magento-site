!function(){"use strict";function n(n){return function(t){return e=typeof(t=t),(null===t?"null":"object"==e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e)===n;var e}}function o(e){return function(t){return typeof t===e}}function r(e){return function(t){return e===t}}function E(t){return null==t}function a(t,e){if(c(t)){for(var n=0,o=t.length;n<o;++n)if(!e(t[n]))return;return 1}}function Et(){}function i(n,o){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n(o.apply(null,t))}}function Dt(t){return function(){return t}}function x(t){return t}function D(t,e){return t===e}var P=n("string"),H=n("object"),c=n("array"),l=r(null),z=o("boolean"),k=r(void 0),_=function(t){return!E(t)},T=o("function"),Q=o("number");function g(o){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=r.concat(t);return o.apply(null,n)}}function h(e){return function(t){return!e(t)}}function R(t){return function(){throw new Error(t)}}var N=Dt(!1),L=Dt(!0),f=tinymce.util.Tools.resolve("tinymce.ThemeManager"),Bt=function(){return(Bt=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function B(t,e){var n={};for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n}function M(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||((o=o||Array.prototype.slice.call(e,0,r))[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}function d(){return v}var v={fold:function(t,e){return t()},isSome:N,isNone:L,getOr:x,getOrThunk:b,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:Dt(null),getOrUndefined:Dt(void 0),or:x,orThunk:b,map:d,each:Et,bind:d,exists:N,forall:L,filter:function(){return v},toArray:function(){return[]},toString:Dt("none()")};function b(t){return t()}function A(t,e){return Kt.call(t,e)}function V(t,e){for(var n=0,o=t.length;n<o;n++)if(e(t[n],n))return!0;return!1}function W(t,e){for(var n=[],o=0;o<t;o++)n.push(e(o));return n}function U(t,e){for(var n=[],o=0;o<t.length;o+=e){var r=qt.call(t,o,o+e);n.push(r)}return n}function F(t,e){for(var n=t.length,o=new Array(n),r=0;r<n;r++){var i=t[r];o[r]=e(i,r)}return o}function j(t,e){for(var n=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(e(u,r)?n:o).push(u)}return{pass:n,fail:o}}function G(t,e){for(var n=[],o=0,r=t.length;o<r;o++){var i=t[o];e(i,o)&&n.push(i)}return n}function X(t,e,n){for(var o,r=t,i=r.length-1;0<=i;i--)o=r[i],n=e(n,o,i);return n}function Z(t,n,o){return Y(t,function(t,e){o=n(o,t,e)}),o}function tt(t,e){for(var n=t,o=e,r=N,i=0,u=n.length;i<u;i++){var a=n[i];if(o(a,i))return Mt.some(a);if(r(a,i))break}return Mt.none()}function et(t,e){for(var n=0,o=t.length;n<o;n++)if(e(t[n],n))return Mt.some(n);return Mt.none()}function nt(t){for(var e=[],n=0,o=t.length;n<o;++n){if(!c(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);Jt.apply(e,t[n])}return e}function ot(t,e){return nt(F(t,e))}function rt(t,e){for(var n=0,o=t.length;n<o;++n)if(!0!==e(t[n],n))return!1;return!0}function it(t){t=qt.call(t,0);return t.reverse(),t}function ut(t,e){return G(t,function(t){return!$t(e,t)})}function at(t,e){for(var n={},o=0,r=t.length;o<r;o++){var i=t[o];n[String(i)]=e(i,o)}return n}function ct(t){return[t]}function st(t,e){t=qt.call(t,0);return t.sort(e),t}function lt(t,e){return 0<=e&&e<t.length?Mt.some(t[e]):Mt.none()}function ft(t){return lt(t,0)}function dt(t){return lt(t,t.length-1)}function mt(t,e){for(var n=0;n<t.length;n++){var o=e(t[n],n);if(o.isSome())return o}return Mt.none()}function gt(t,e){for(var n=Zt(t),o=0,r=n.length;o<r;o++){var i=n[o];e(t[i],i)}}function pt(t,n){return ee(t,function(t,e){return{k:e,v:n(t,e)}})}function ht(t,n){var o=[];return gt(t,function(t,e){o.push(n(t,e))}),o}function vt(t,e){for(var n=Zt(t),o=0,r=n.length;o<r;o++){var i=n[o],u=t[i];if(e(u,i,t))return Mt.some(u)}return Mt.none()}function bt(t){return ht(t,x)}function I(t,e){return ne(t,e)?Mt.from(t[e]):Mt.none()}function yt(t,e){return ne(t,e)&&void 0!==t[e]&&null!==t[e]}function xt(t,e,n){return void 0===n&&(n=D),t.exists(function(t){return n(t,e)})}function wt(t){for(var e=[],n=function(t){e.push(t)},o=0;o<t.length;o++)t[o].each(n);return e}function St(t,e){return t?Mt.some(e):Mt.none()}function Ct(t,e,n){return""===e||t.length>=e.length&&t.substr(n,n+e.length)===e}function kt(t,e){return-1!==t.indexOf(e)}function Ot(t){return 0<t.length}function _t(t){return void 0!==t.style&&T(t.style.getPropertyValue)}function Tt(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}}function Gt(n){function t(){return r}function e(t){return t(n)}var o=Dt(n),r={fold:function(t,e){return e(n)},isSome:L,isNone:N,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:t,orThunk:t,map:function(t){return Gt(t(n))},each:function(t){t(n)},bind:e,exists:e,forall:e,filter:function(t){return t(n)?r:v},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return r}function Xt(t,e){return Ct(t,e,t.length-e.length)}var Yt,Mt={some:Gt,none:d,from:function(t){return null==t?v:Gt(t)}},qt=Array.prototype.slice,Kt=Array.prototype.indexOf,Jt=Array.prototype.push,$t=function(t,e){return-1<A(t,e)},Y=function(t,e){for(var n=0,o=t.length;n<o;n++)e(t[n],n)},Qt=T(Array.from)?Array.from:function(t){return qt.call(t)},Zt=Object.keys,te=Object.hasOwnProperty,ee=function(t,n){var o={};return gt(t,function(t,e){t=n(t,e);o[t.k]=t.v}),o},ne=function(t,e){return te.call(t,e)},oe=function(t,e,n){return t.isSome()&&e.isSome()?Mt.some(n(t.getOrDie(),e.getOrDie())):Mt.none()},re=(Yt=/^\s+|\s+$/g,function(t){return t.replace(Yt,"")}),At={fromHtml:function(t,e){e=(e||document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return Tt(e.childNodes[0])},fromTag:function(t,e){return Tt((e||document).createElement(t))},fromText:function(t,e){return Tt((e||document).createTextNode(t))},fromDom:Tt,fromPoint:function(t,e,n){return Mt.from(t.dom.elementFromPoint(e,n)).map(Tt)}};function ie(t){return t.dom.nodeName.toLowerCase()}function ue(e){return function(t){return t.dom.nodeType===e}}function ae(n){var o,r=!1;return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r||(r=!0,o=n.apply(null,t)),o}}function ce(t,e){var n=String(e).toLowerCase();return tt(t,function(t){return t.search(n)})}function se(e){return function(t){return kt(t,e)}}function le(t){return window.matchMedia(t).matches}function fe(t,e){t=t.dom;if(1!==t.nodeType)return!1;if(void 0!==t.matches)return t.matches(e);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(e);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(e);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function de(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount}function me(t,e){return t.dom===e.dom}function ge(t,e){return Hn().browser.isIE()?(o=t.dom,r=e.dom,n=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(o.compareDocumentPosition(r)&n)):(o=t.dom)!==(r=e.dom)&&o.contains(r);var n,o,r}function pe(t){return At.fromDom(t.dom.ownerDocument)}function he(t){return On(t)?t:pe(t)}function ve(t){return At.fromDom(he(t).dom.documentElement)}function be(t){return At.fromDom(he(t).dom.defaultView)}function ye(t){return Mt.from(t.dom.parentNode).map(At.fromDom)}function xe(t){return Mt.from(t.dom.offsetParent).map(At.fromDom)}function we(t){return F(t.dom.childNodes,At.fromDom)}function Se(t,e){t=t.dom.childNodes;return Mt.from(t[e]).map(At.fromDom)}function Ce(t,e){return{element:t,offset:e}}function ke(t,e){var n=we(t);return 0<n.length&&e<n.length?Ce(n[e],0):Ce(t,e)}function Oe(t){return _n(t)&&_(t.dom.host)}function _e(t){return Oe(t)?t:At.fromDom(he(t).dom.body)}function Te(t){return At.fromDom(t.dom.host)}function Ee(t,e,n){if(!(P(n)||z(n)||Q(n)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",n,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,n+"")}function Ft(t,e,n){Ee(t.dom,e,n)}function De(t,e){var n=t.dom;gt(e,function(t,e){Ee(n,e,t)})}function Be(t,e){t=t.dom.getAttribute(e);return null===t?void 0:t}function Me(t,e){return Mt.from(Be(t,e))}function Ae(t,e){t=t.dom;return!(!t||!t.hasAttribute)&&t.hasAttribute(e)}function Fe(t,e){t.dom.removeAttribute(e)}function Ie(t,e,n){if(!P(n))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",n,":: Element ",t),new Error("CSS value must be a string: "+n);_t(t)&&t.style.setProperty(e,n)}function Re(t,e){_t(t)&&t.style.removeProperty(e)}function q(t,e,n){Ie(t.dom,e,n)}function Ve(t,e){var n=t.dom;gt(e,function(t,e){Ie(n,e,t)})}function Pe(t,e){var n=t.dom;gt(e,function(t,e){t.fold(function(){Re(n,e)},function(t){Ie(n,e,t)})})}function He(t,e){var n=t.dom,o=window.getComputedStyle(n).getPropertyValue(e);return""!==o||Wn(t)?o:Gn(n,e)}function ze(t,e){t=t.dom,t=Gn(t,e);return Mt.from(t).filter(function(t){return 0<t.length})}function Ne(t,e,n){t=At.fromTag(t);return q(t,e,n),ze(t,e).isSome()}function Le(t,e){Re(t.dom,e),xt(Me(t,"style").map(re),"")&&Fe(t,"style")}function We(t){t.dom.offsetWidth}function Ue(n,o){function t(t){var e=o(t);return e<=0||null===e?(t=He(t,n),parseFloat(t)||0):e}function r(n,t){return Z(t,function(t,e){e=He(n,e),e=void 0===e?0:parseInt(e,10);return isNaN(e)?t:t+e},0)}return{set:function(t,e){if(!Q(e)&&!e.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+e);t=t.dom;_t(t)&&(t.style[n]=e+"px")},get:t,getOuter:t,aggregate:r,max:function(t,e,n){t=r(t,n);return t<e?e-t:0}}}function je(t){return Xn.get(t)}function Ge(t){return Xn.getOuter(t)}function Xe(t,e){return void 0!==t?t:void 0!==e?e:0}function Ye(t){var e,n,o=t.dom.ownerDocument,r=o.body,i=o.defaultView,o=o.documentElement;return r===t.dom?Yn(r.offsetLeft,r.offsetTop):(e=Xe(null==i?void 0:i.pageYOffset,o.scrollTop),i=Xe(null==i?void 0:i.pageXOffset,o.scrollLeft),n=Xe(o.clientTop,r.clientTop),o=Xe(o.clientLeft,r.clientLeft),qn(t).translate(i-o,e-n))}function qe(t){return Kn.get(t)}function Ke(t){return Kn.getOuter(t)}function Je(t){function e(){return t.stopPropagation()}function n(){return t.preventDefault()}var o=i(n,e);return{target:At.fromDom(function(t){if(Nn()&&_(t.target)){var e=At.fromDom(t.target);if(Cn(e)&&bn(e)&&t.composed&&t.composedPath){e=t.composedPath();if(e)return ft(e)}}return Mt.from(t.target)}(t).getOr(t.target)),x:t.clientX,y:t.clientY,stop:e,prevent:n,kill:o,raw:t}}function $e(t,e,n,o,r){function i(t){u(t)&&a(Je(t))}var u,a;u=n,a=o;return t.dom.addEventListener(e,i,r),{unbind:g(Jn,t,e,i,r)}}function Qe(e,n){ye(e).each(function(t){t.dom.insertBefore(n.dom,e.dom)})}function Ze(t,e){Mt.from(t.dom.nextSibling).map(At.fromDom).fold(function(){ye(t).each(function(t){$n(t,e)})},function(t){Qe(t,e)})}function tn(e,n){Se(e,0).fold(function(){$n(e,n)},function(t){e.dom.insertBefore(n.dom,t.dom)})}function en(e,t){Y(t,function(t){$n(e,t)})}function nn(t){t.dom.textContent="",Y(we(t),function(t){Qn(t)})}function on(t){var e,n=we(t);0<n.length&&(e=t,Y(n,function(t){Qe(e,t)})),Qn(t)}function rn(t){var t=void 0!==t?t.dom:document,e=t.body.scrollLeft||t.documentElement.scrollLeft,t=t.body.scrollTop||t.documentElement.scrollTop;return Yn(e,t)}function un(t,e,n){n=(void 0!==n?n.dom:document).defaultView;n&&n.scrollTo(t,e)}function an(t,e,n,o){return{x:t,y:e,width:n,height:o,right:t+n,bottom:e+o}}function cn(t){var n=void 0===t?window:t,t=n.document,o=rn(At.fromDom(t)),t=void 0===n?window:n;return(Hn().browser.isFirefox()?Mt.none():Mt.from(t.visualViewport)).fold(function(){var t=n.document.documentElement,e=t.clientWidth,t=t.clientHeight;return an(o.left,o.top,e,t)},function(t){return an(Math.max(t.pageLeft,o.left),Math.max(t.pageTop,o.top),t.width,t.height)})}function sn(n){var o=rn(At.fromDom(document)),t=(e=to).owner(n),e=Zn(e,t);return Mt.some(e).fold(g(Ye,n),function(t){var e=qn(n),t=X(t,function(t,e){e=qn(e);return{left:t.left+e.left,top:t.top+e.top}},{left:0,top:0});return Yn(t.left+e.left+o.left,t.top+e.top+o.top)})}function ln(t){var e=sn(t),n=Ke(t),t=Ge(t);return eo(e.left,e.top,n,t)}function fn(){return gn(0,0)}function dn(t){function e(t){return function(){return n===t}}var n=t.current,t=t.version;return{current:n,version:t,isEdge:e("Edge"),isChrome:e("Chrome"),isIE:e("IE"),isOpera:e("Opera"),isFirefox:e(Bn),isSafari:e("Safari")}}function mn(t){function e(t){return function(){return n===t}}var n=t.current,t=t.version;return{current:n,version:t,isWindows:e(An),isiOS:e("iOS"),isAndroid:e(Fn),isOSX:e("OSX"),isLinux:e("Linux"),isSolaris:e(In),isFreeBSD:e(Rn),isChromeOS:e(Vn)}}"undefined"==typeof window&&Function("return this;")();function gn(t,e){return{major:t,minor:e}}function pn(){return dn({current:void 0,version:Tn.unknown()})}function hn(){return mn({current:void 0,version:Tn.unknown()})}function vn(t){return Oe(t=Ln(t))?Mt.some(t):Mt.none()}function bn(t){return _(t.dom.shadowRoot)}function yn(n,o){return{left:n,top:o,translate:function(t,e){return yn(n+t,o+e)}}}function xn(n){return{isValue:L,isError:N,getOr:Dt(n),getOrThunk:Dt(n),getOrDie:Dt(n),or:function(t){return xn(n)},orThunk:function(t){return xn(n)},fold:function(t,e){return e(n)},map:function(t){return xn(t(n))},mapError:function(t){return xn(n)},each:function(t){t(n)},bind:function(t){return t(n)},exists:function(t){return t(n)},forall:function(t){return t(n)},toOptional:function(){return Mt.some(n)}}}function wn(n){return{isValue:N,isError:L,getOr:x,getOrThunk:function(t){return t()},getOrDie:function(){return R(String(n))()},or:x,orThunk:function(t){return t()},fold:function(t,e){return t(n)},map:function(t){return wn(n)},mapError:function(t){return wn(t(n))},each:Et,bind:function(t){return wn(n)},exists:N,forall:L,toOptional:Mt.none}}var Sn,Cn=ue(1),kn=ue(3),On=ue(9),_n=ue(11),Tn={nu:gn,detect:function(t,e){var n,o,e=String(e).toLowerCase();return 0===t.length?fn():(o=function(t,e){for(var n=0;n<t.length;n++){var o=t[n];if(o.test(e))return o}}(t,n=e))?gn(r(1),r(2)):{major:0,minor:0};function r(t){return Number(n.replace(o,"$"+t))}},unknown:fn},En=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Dn={browsers:Dt([{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return kt(t,"edge/")&&kt(t,"chrome")&&kt(t,"safari")&&kt(t,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,En],search:function(t){return kt(t,"chrome")&&!kt(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return kt(t,"msie")||kt(t,"trident")}},{name:"Opera",versionRegexes:[En,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:se("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:se("firefox")},{name:"Safari",versionRegexes:[En,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(kt(t,"safari")||kt(t,"mobile/"))&&kt(t,"applewebkit")}}]),oses:Dt([{name:"Windows",search:se("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return kt(t,"iphone")||kt(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:se("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:se("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:se("linux"),versionRegexes:[]},{name:"Solaris",search:se("sunos"),versionRegexes:[]},{name:"FreeBSD",search:se("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:se("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}])},Bn="Firefox",Mn=dn,An=(Dt("Edge"),Dt("Chrome"),Dt("IE"),Dt("Opera"),Dt(Bn),Dt("Safari"),"Windows"),Fn="Android",In="Solaris",Rn="FreeBSD",Vn="ChromeOS",Pn=mn,Hn=(Dt(An),Dt("iOS"),Dt(Fn),Dt("Linux"),Dt("OSX"),Dt(In),Dt(Rn),Dt(Vn),ae(function(){return t=navigator.userAgent,s=Mt.from(navigator.userAgentData),u=le,c=Dn.browsers(),l=Dn.oses(),{browser:s=s.bind(function(t){return o=c,mt(t.brands,function(e){var n=e.brand.toLowerCase();return tt(o,function(t){return n===(null==(t=t.brand)?void 0:t.toLowerCase())}).map(function(t){return{current:t.name,version:Tn.nu(parseInt(e.version,10),0)}})});var o}).orThunk(function(){return ce(c,n=t).map(function(t){var e=Tn.detect(t.versionRegexes,n);return{current:t.name,version:e}});var n}).fold(pn,Mn),os:l=ce(l,n=t).map(function(t){var e=Tn.detect(t.versionRegexes,n);return{current:t.name,version:e}}).fold(hn,Pn),deviceType:(s=s,e=t,u=u,o=(l=l).isiOS()&&!0===/ipad/i.test(e),r=l.isiOS()&&!o,i=(a=l.isiOS()||l.isAndroid())||u("(pointer:coarse)"),u=o||!r&&a&&u("(min-device-width:768px)"),a=r||a&&!u,s=s.isSafari()&&l.isiOS()&&!1===/safari/i.test(e),{isiPad:Dt(o),isiPhone:Dt(r),isTablet:Dt(u),isPhone:Dt(a),isTouch:Dt(i),isAndroid:l.isAndroid,isiOS:l.isiOS,isWebView:Dt(s),isDesktop:Dt(!a&&!u&&!s)})};var t,n,e,o,r,i,u,a,c,s,l})),zn=ye,En=T(Element.prototype.attachShadow)&&T(Node.prototype.getRootNode),Nn=Dt(En),Ln=En?function(t){return At.fromDom(t.dom.getRootNode())}:he,Wn=function(t){var e,n,o,r=kn(t)?t.dom.parentNode:t.dom;return null!=r&&null!==r.ownerDocument&&(o=r.ownerDocument,vn(At.fromDom(r)).fold(function(){return o.body.contains(r)},(e=Wn,n=Te,function(t){return e(n(t))})))},Un=function(){return jn(At.fromDom(document))},jn=function(t){t=t.dom.body;if(null==t)throw new Error("Body is not available yet");return At.fromDom(t)},Gn=function(t,e){return _t(t)?t.style.getPropertyValue(e):""},Xn=Ue("height",function(t){var e=t.dom;return Wn(t)?e.getBoundingClientRect().height:e.offsetHeight}),Yn=yn,qn=function(t){var e=t.dom,n=e.ownerDocument.body;return n===e?Yn(n.offsetLeft,n.offsetTop):Wn(t)?(n=e.getBoundingClientRect(),Yn(n.left,n.top)):Yn(0,0)},Kn=Ue("width",function(t){return t.dom.offsetWidth}),Jn=function(t,e,n,o){t.dom.removeEventListener(e,n,o)},$n=function(t,e){t.dom.appendChild(e.dom)},Qn=function(t){t=t.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Zn=function(n,t){return n.view(t).fold(Dt([]),function(t){var e=n.owner(t),e=Zn(n,e);return[t].concat(e)})},to=Object.freeze({__proto__:null,view:function(t){return(t.dom===document?Mt.none():Mt.from(null==(t=t.dom.defaultView)?void 0:t.frameElement)).map(At.fromDom)},owner:pe}),eo=function(t,e,n,o){return{x:t,y:e,width:n,height:o,right:t+n,bottom:e+o}},no=function(t){var e=Ye(t),n=Ke(t),t=Ge(t);return eo(e.left,e.top,n,t)},oo=function(){return cn(window)},K={value:xn,error:wn,fromOption:function(t,e){return t.fold(function(){return wn(e)},xn)}};function ro(t,e,n){return t.stype===Sn.Error?e(t.serror):n(t.svalue)}function io(t){return{stype:Sn.Value,svalue:t}}function uo(t){return{stype:Sn.Error,serror:t}}function ao(t,e,n,o){return{tag:"field",key:t,newKey:e,presence:n,prop:o}}function co(t,e,n){switch(t.tag){case"field":return e(t.key,t.newKey,t.presence,t.prop);case"custom":return n(t.newKey,t.instantiator)}}function so(u){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0===t.length)throw new Error("Can't merge zero objects");for(var n={},o=0;o<t.length;o++){var r,i=t[o];for(r in i)ne(i,r)&&(n[r]=u(n[r],i[r]))}return n}}function lo(){return{tag:"required",process:{}}}function fo(t){return{tag:"defaultedThunk",process:t}}function mo(t){return fo(Dt(t))}function go(){return{tag:"option",process:{}}}function po(t){return{tag:"mergeWithThunk",process:t}}function ho(t){return H(t)&&100<Zt(t).length?" removed due to size":JSON.stringify(t,null,2)}function vo(t,e){return ir([{path:t,getErrorInfo:e}])}function bo(o){return{extract:function(e,t){return t=o(t),n=function(t){return vo(e,Dt(t))},t.stype===Sn.Error?n(t.serror):t;var n},toString:Dt("val")}}function yo(t,e,n,o){return o(I(t,e).getOrThunk(function(){return n(t)}))}function xo(n){return{extract:function(t,e){return n().extract(t,e)},toString:function(){return n().toString()}}}function wo(t){var c=w(t),s=X(t,function(n,t){return co(t,function(t){var e;return sr(n,((e={})[t]=!0,e))},Dt(n))},{});return{extract:function(t,e){var n,o,r,i,u,a=G(z(e)?[]:Zt((o=_,r=a={},i=function(t,e){r[e]=t},u=Et,gt(e,function(t,e){(o(t,e)?i:u)(t,e)}),a)),function(t){return!yt(s,t)});return 0===a.length?c.extract(t,e):(n=a,vo(t,function(){return"There are unsupported fields: ["+n.join(", ")+"] specified"}))},toString:c.toString}}function So(o){return{extract:function(n,t){t=F(t,function(t,e){return o.extract(n.concat(["["+e+"]"]),t)});return er(t)},toString:function(){return"array("+o.toString()+")"}}}function Co(u){return{extract:function(t,e){for(var n=[],o=0,r=u;o<r.length;o++){var i=r[o].extract(t,e);if(i.stype===Sn.Value)return i;n.push(i)}return er(n)},toString:function(){return"oneOf("+F(u,function(t){return t.toString()}).join(", ")+")"}}}function ko(n,o){return bo(function(t){var e=typeof t;return n(t)?rr(t):ir("Expected type: "+o+" but got: "+e)})}function Oo(e,a){return{extract:function(i,u){return I(u,e).fold(function(){return t=e,vo(i,function(){return'Choice schema did not contain choice key: "'+t+'"'});var t},function(t){return n=i,e=u,I(o=a,r=t).fold(function(){return t=o,e=r,vo(n,function(){return'The chosen schema: "'+e+'" did not exist in branches: '+ho(t)});var t,e},function(t){return t.extract(n.concat(["branch: "+r]),e)});var n,e,o,r})},toString:function(){return"chooseOn("+e+"). Possible values: "+Zt(a)}}}function _o(e){return bo(function(t){return e(t).fold(ir,rr)})}function To(e,t){return r=function(t){return e(t).fold(uo,io)},i=t,{extract:function(e,n){var t,o=Zt(n),o=So(bo(r)).extract(e,o);return t=function(t){t=F(t,function(t){return ao(t,t,lo(),i)});return w(t).extract(e,n)},(o=o).stype===Sn.Value?t(o.svalue):o},toString:function(){return"setOf("+i.toString()+")"}};var r,i}function Eo(t,e,n){return or((e=e.extract([t],o=n),ar(e,function(t){return{input:o,errors:t}})));var o}function Do(t){return t.fold(function(t){throw new Error(br(t))},x)}function Bo(t,e,n){return Do(Eo(t,e,n))}function Mo(t,e){return Oo(t,pt(e,w))}function Ao(e){return _o(function(t){return $t(e,t)?K.value(t):K.error('Unsupported value: "'+t+'", choose one of "'+e.join(", ")+'".')})}function y(t){return yr(t,t,lo(),dr())}function Fo(t,e){return yr(t,t,lo(),e)}function e(t){return Fo(t,gr)}function Io(t,e){return yr(t,t,lo(),Ao(e))}function Ro(t){return Fo(t,hr)}function Vo(t,e){return yr(t,t,lo(),w(e))}function Po(t,e){return yr(t,t,lo(),fr(e))}function Ho(t,e){return yr(t,t,lo(),So(e))}function zo(t){return yr(t,t,go(),dr())}function No(t,e){return yr(t,t,go(),e)}function Lo(t){return No(t,mr)}function Wo(t){return No(t,gr)}function Uo(t){return No(t,hr)}function jo(t,e){return No(t,So(e))}function Go(t,e){return No(t,w(e))}function S(t,e){return yr(t,t,mo(e),dr())}function Xo(t,e,n){return yr(t,t,mo(e),n)}function Yo(t,e){return Xo(t,e,mr)}function qo(t,e){return Xo(t,e,gr)}function Ko(t,e,n){return Xo(t,e,Ao(n))}function Jo(t,e){return Xo(t,e,pr)}function $o(t,e){return Xo(t,e,hr)}function Qo(t,e,n){return Xo(t,e,So(n))}function Zo(t,e,n){return Xo(t,e,w(n))}function It(t){var e=t;return{get:function(){return e},set:function(t){e=t}}}function tr(u){if(!c(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var a=[],n={};return Y(u,function(t,o){var e=Zt(t);if(1!==e.length)throw new Error("one and only one name per case");var r=e[0],i=t[r];if(void 0!==n[r])throw new Error("duplicate key detected:"+r);if("cata"===r)throw new Error("cannot have a case named cata (sorry)");if(!c(i))throw new Error("case arguments must be an array");a.push(r),n[r]=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=n.length;if(e!==i.length)throw new Error("Wrong number of arguments to case "+r+". Expected "+i.length+" ("+i+"), got "+e);return{fold:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+t.length);return t[o].apply(null,n)},match:function(t){var e=Zt(t);if(a.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+a.join(",")+"\nActual: "+e.join(","));if(rt(a,function(t){return $t(e,t)}))return t[r].apply(null,n);throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+a.join(", "))},log:function(t){console.log(t,{constructors:a,constructor:r,params:n})}}}}),n}Sn={Error:0,0:"Error",Value:1,1:"Value"};function er(t){var e,n;return e=[],n=[],Y(t,function(t){ro(t,function(t){return n.push(t)},function(t){return e.push(t)})}),0<(t={values:e,errors:n}).errors.length?i(ir,nt)(t.errors):rr(t.values)}function nr(e){if(Object(e)!==e)return!0;switch({}.toString.call(e).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(e).every(function(t){return nr(e[t])});default:return!1}}var or=function(t){return ro(t,K.error,K.value)},rr=io,ir=uo,ur=function(t,e){return t.stype===Sn.Value?{stype:Sn.Value,svalue:e(t.svalue)}:t},ar=function(t,e){return t.stype===Sn.Error?{stype:Sn.Error,serror:e(t.serror)}:t},cr=ro,sr=so(function(t,e){return H(t)&&H(e)?sr(t,e):e}),lr=so(function(t,e){return e}),En=bo(rr),w=function(n){return{extract:function(r,i){for(var u={},a=[],t=0,e=n;t<e.length;t++)co(e[t],function(t,e,n,o){n=function(e,n,o,r,i){function u(t){return i.extract(n.concat([r]),t)}function t(t){return t.fold(function(){return rr(Mt.none())},function(t){t=i.extract(n.concat([r]),t);return ur(t,Mt.some)})}var a,c,s,l,f,d;switch(e.tag){case"required":return s=n,d=u,I(l=o,f=r).fold(function(){return t=f,e=l,vo(s,function(){return'Could not find valid *required* value for "'+t+'" in '+ho(e)});var t,e},d);case"defaultedThunk":return yo(o,r,e.process,u);case"option":return t(I(o,r));case"defaultedOptionThunk":return c=e.process,t(I(a=o,r).map(function(t){return!0===t?c(a):t}));case"mergeWithThunk":return yo(o,r,Dt({}),function(t){return u(sr(e.process(o),t))})}}(n,r,i,t,o);cr(n,function(t){a.push.apply(a,t)},function(t){u[e]=t})},function(t,e){u[t]=e(i)});return 0<a.length?ir(a):rr(u)},toString:function(){return"obj{\n"+F(n,function(t){return co(t,function(t,e,n,o){return t+" -> "+o.toString()},function(t,e){return"state("+t+")"})}).join("\n")+"}"}}},fr=i(So,w),dr=Dt(En),mr=ko(Q,"number"),gr=ko(P,"string"),pr=ko(z,"boolean"),hr=ko(T,"function"),vr=bo(function(t){return nr(t)?rr(t):ir("Expected value to be acceptable for sending via postMessage")}),br=function(t){return"Errors: \n"+F(10<(e=t.errors).length?e.slice(0,10).concat([{path:[],getErrorInfo:Dt("... (only showing first ten failures)")}]):e,function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}).join("\n")+"\n\nInput object: "+ho(t.input);var e},yr=ao,xr=function(t,e){return{tag:"custom",newKey:t,instantiator:e}};function wr(t,e){return(n={})[t]=e,n;var n}function Sr(t){return e={},Y(t,function(t){e[t.key]=t.value}),e;var e}function Cr(t){return T(t)?t:N}function kr(t,e,n){for(var o=t.dom,r=Cr(n);o.parentNode;){var o=o.parentNode,i=At.fromDom(o),u=e(i);if(u.isSome())return u;if(r(i))break}return Mt.none()}function Or(t,e,n){var o=e(t),r=Cr(n);return o.orThunk(function(){return r(t)?Mt.none():kr(t,e,r)})}function _r(t,e){return me(t.element,e.event.target)}function Tr(t){if(yt(t,"can")||yt(t,"abort")||yt(t,"run"))return Bt(Bt({},di),t);throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!")}function Er(t){return Dt("alloy."+t)}function Rt(t,e){ru(t,t.element,e,{})}function Vt(t,e,n){ru(t,t.element,e,n)}function Dr(t){Rt(t,Hi())}function Br(t,e,n){ru(t,e,n,{})}function Mr(t,e,n,o){t.getSystem().triggerEvent(n,e,o.event)}function Ar(t,e){return{key:t,value:Tr({abort:e})}}function Fr(t){return{key:t,value:Tr({run:function(t,e){e.event.prevent()}})}}function Pt(t,e){return{key:t,value:Tr({run:e})}}function Ir(t,n,o){return{key:t,value:Tr({run:function(t,e){n.apply(void 0,[t,e].concat(o))}})}}function Rr(t){return function(n){return{key:t,value:Tr({run:function(t,e){_r(t,e)&&n(t,e)}})}}}function Vr(t,e,n){var o,r=e.partUids[n];return Pt(o=t,function(t,e){t.getSystem().getByUid(r).each(function(t){Mr(t,t.element,o,e)})})}function Pr(t,r){return Pt(t,function(e,t){var n=t.event,o=e.getSystem().getByDom(n.target).getOrThunk(function(){return Or(n.target,function(t){return e.getSystem().getByDom(t).toOptional()},N).getOr(e)});r(e,o,t)})}function Hr(t){return Pt(t,function(t,e){e.cut()})}function zr(t,e){return Rr(t)(e)}function Nr(t){return t.dom.innerHTML}function Lr(t,e){var n=pe(t).dom,o=At.fromDom(n.createDocumentFragment());en(o,(e=e,(n=(n||document).createElement("div")).innerHTML=e,we(At.fromDom(n)))),nn(t),$n(t,o)}function Wr(t){var e;return Oe(t)?"#shadow-root":(t=At.fromDom(t.dom.cloneNode(!1)),e=At.fromTag("div"),t=At.fromDom(t.dom.cloneNode(!0)),$n(e,t),Nr(e))}function O(t){var e=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++du+String(e)}function Ur(t){t=Cn(t)?t.dom[pu]:null;return Mt.from(t)}function jr(e){function n(t){return"The component must be in a context to execute: "+t+(e?"\n"+Wr(e().element)+" is not in context.":"")}function t(t){return function(){throw new Error(n(t))}}function o(t){return function(){console.warn(n(t))}}return{debugInfo:Dt("fake"),triggerEvent:o("triggerEvent"),triggerFocus:o("triggerFocus"),triggerEscape:o("triggerEscape"),broadcast:o("broadcast"),broadcastOn:o("broadcastOn"),broadcastEvent:o("broadcastEvent"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),isConnected:N}}function Gr(t,e){var n=t.toString(),o=n.indexOf(")")+1,r=n.indexOf("("),i=n.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:e,parameters:xu(i)}},t}function Xr(t){return wr(wu,t)}function Yr(o){return t=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return o.apply(void 0,M([t.getApis(),t],e,!1))},n=(e=o.toString()).indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,n-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:xu(i.slice(1))}},t;var t,e,n,r,i}function qr(t,r){var i={};return gt(t,function(t,o){gt(t,function(t,e){var n=I(i,e).getOr([]);i[e]=n.concat([r(o,t)])})}),i}function Kr(t){return{classes:k(t.classes)?[]:t.classes,attributes:k(t.attributes)?{}:t.attributes,styles:k(t.styles)?{}:t.styles}}function Jr(t){return t.cHandler}function $r(t,e){return{name:t,handler:e}}function Qr(t,e){t=Be(t,e);return void 0===t||""===t?[]:t.split(" ")}function Zr(t){return void 0!==t.dom.classList}function ti(t,e){Zr(t)?t.dom.classList.add(e):(e=e,e=Qr(t=t,"class").concat([e]),Ft(t,"class",e.join(" ")))}function ei(t,e){var n,o;Zr(t)?t.dom.classList.remove(e):(n=e,0<(o=G(Qr(e=t,"class"),function(t){return t!==n})).length?Ft(e,"class",o.join(" ")):Fe(e,"class")),0===(Zr(o=t)?o.dom.classList:Qr(o,"class")).length&&Fe(o,"class")}function ni(t,e){return Zr(t)&&t.dom.classList.contains(e)}function oi(e,t){Y(t,function(t){ti(e,t)})}function ri(e,t){Y(t,function(t){ei(e,t)})}function ii(t){return t.dom.value}function ui(t,e){if(void 0===e)throw new Error("Value.set was undefined");t.dom.value=e}function ai(t){var n,e,o,r,i,u,a,c,s,l,f,d,m,g,p,t=bu(t),h=t.events,t=B(t,["events"]),v=F(I(t,"components").getOr([]),_u),t=Bt(Bt({},t),{events:Bt(Bt({},fu),h),components:v});return K.value((e=It(yu),o=Do(Eo("custom.definition",ku,n=t)),g=I(h=n,"behaviours").getOr({}),v=ot(Zt(g),function(t){t=g[t];return _(t)?[t.me]:[]}),p=h,v=F(h=v,function(t){return Go(t.name(),[y("config"),S("state",Su)])}),t={list:h,data:pt(Eo("component.behaviours",w(v),p.behaviours).fold(function(t){throw new Error(br(t)+"\nComplete spec:\n"+JSON.stringify(p,null,2))},x),function(t){return Dt(t.map(function(t){return{config:t.config,state:t.state.init(t.config)}}))})},v=h=t.list,t=r=t.data,d=Bt(Bt({},(d=f=o).dom),{uid:d.uid,domChildren:F(d.components,function(t){return t.element})}),m=f.domModification.fold(function(){return Kr({})},Kr),f=0<v.length?function(e,t,n){var o=Bt({},{"alloy.base.modification":m});function r(t){return X(t,function(t,e){return Bt(Bt({},e.modification),t)},{})}Y(t,function(t){o[t.name()]=t.exhibit(e,n)});t=qr(o,function(t,e){return{name:t,modification:e}});return Kr({classes:X(t.classes,function(t,e){return e.modification.concat(t)},[]),attributes:r(t.attributes),styles:r(t.styles)})}(t,v,d):m,v=Bt(Bt({},t=d),{attributes:Bt(Bt({},t.attributes),f.attributes),styles:Bt(Bt({},t.styles),f.styles),classes:t.classes.concat(f.classes)}),De(l=At.fromTag(v.tag),v.attributes),oi(l,v.classes),Ve(l,v.styles),v.innerHtml.each(function(t){return Lr(l,t)}),d=v.domChildren,en(l,d),v.value.each(function(t){ui(l,t)}),v.uid,hu(l,v.uid),i=l,t=h,f=r,v={"alloy.base.behaviour":(d=o).events},d=o.eventOrder,v=qr(Bt(Bt({},v),(c=f,s={},Y(t,function(t){s[t.name()]=t.handlers(c)}),s)),$r),h=si(v,d).getOrDie(),u=It(o.components),a={uid:n.uid,getSystem:e.get,config:function(t){var e=r;return(T(e[t.name()])?e[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(n,null,2))})()},hasConfigured:function(t){return T(r[t.name()])},spec:n,readState:function(t){return r[t]().map(function(t){return t.state.readState()}).getOr("not enabled")},getApis:function(){return o.apis},connect:function(t){e.set(t)},disconnect:function(){e.set(jr(b))},element:i,syncComponents:function(){var t=ot(we(i),function(t){return e.get().getByDom(t).fold(function(){return[]},ct)});u.set(t)},components:u.get,events:h}));function b(){return a}}function ci(t){t=At.fromText(t);return li({element:t})}tr([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);function si(t,i){var t=ht(t,function(n,e){return(1===n.length?K.value(n[0].handler):(t=n,(o=(o=i)[r=e])?function(r,t,i){try{var e=st(t,function(t,e){var t=t.name,e=e.name,n=i.indexOf(t),o=i.indexOf(e);if(-1===n)throw new Error("The ordering for "+r+" does not have an entry for "+t+".\nOrder specified: "+JSON.stringify(i,null,2));if(-1===o)throw new Error("The ordering for "+r+" does not have an entry for "+e+".\nOrder specified: "+JSON.stringify(i,null,2));return n<o?-1:o<n?1:0});return K.value(e)}catch(t){return K.error([t])}}("Event: "+r,t,o).map(function(t){var n,e,o,r,t=F(t,function(t){return t.handler});return{can:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return Z(e,function(t,e){return t&&e.can.apply(void 0,n)},!0)},abort:(o=e=n=t,r=function(t){return t.abort},function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return Z(o,function(t,e){return t||r(e).apply(void 0,n)},!1)}),run:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Y(n,function(t){t.run.apply(void 0,e)})}}}):K.error(["The event ("+r+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(F(t,function(t){return t.name}),null,2)]))).map(function(t){r=T(t=t)?{can:L,abort:N,run:t}:t;var r,t=1<n.length?G(i[e],function(e){return V(n,function(t){return t.name===e})}).join(" > "):n[0].name;return wr(e,{handler:function(t,e){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];t=[t,e].concat(n);r.abort.apply(void 0,t)?e.stop():r.can.apply(void 0,t)&&r.run.apply(void 0,t)},purpose:t})});var t,o,r}),e={},n=[],o=[];return Y(t,function(t){t.fold(function(t){n.push(t)},function(t){o.push(t)})}),0<(t={errors:n,values:o}).errors.length?K.error(nt(t.errors)):(e=e,0===(t=t.values).length?K.value(e):K.value(sr(e,lr.apply(void 0,t))))}function li(t){var e=Bo("external.component",wo([y("element"),zo("uid")]),t),n=It(jr()),o=e.uid.getOrThunk(function(){return vu("external")}),r=(hu(e.element,o),{uid:o,getSystem:n.get,config:Mt.none,hasConfigured:N,connect:function(t){n.set(t)},disconnect:function(){n.set(jr(function(){return r}))},getApis:function(){return{}},element:e.element,spec:t,readState:Dt("No state"),syncComponents:Et,components:Dt([]),events:{}});return Xr(r)}var fi,di={can:L,abort:N,run:Et},mi=Dt,gi=mi("touchstart"),pi=mi("touchmove"),hi=mi("touchend"),vi=mi("touchcancel"),bi=mi("mousedown"),yi=mi("mousemove"),xi=mi("mouseout"),wi=mi("mouseup"),Si=mi("mouseover"),Ci=mi("focusin"),ki=mi("focusout"),Oi=mi("keydown"),_i=mi("keyup"),Ti=mi("input"),Ei=mi("change"),Di=mi("click"),Bi=mi("transitioncancel"),Mi=mi("transitionend"),Ai=mi("transitionstart"),Fi=mi("selectstart"),mi={tap:Er("tap")},Ii=Er("focus"),Ri=Er("blur.post"),Vi=Er("paste.post"),Pi=Er("receive"),Hi=Er("execute"),zi=Er("focus.item"),Ni=mi.tap,Li=Er("longpress"),Wi=Er("sandbox.close"),Ui=Er("typeahead.cancel"),ji=Er("system.init"),Gi=Er("system.touchmove"),Xi=Er("system.touchend"),Yi=Er("system.scroll"),qi=Er("system.resize"),Ki=Er("system.attached"),Ji=Er("system.detached"),$i=Er("system.dismissRequested"),mi=Er("system.repositionRequested"),Qi=Er("focusmanager.shifted"),Zi=Er("slotcontainer.visibility"),tu=Er("change.tab"),eu=Er("dismiss.tab"),nu=Er("highlight"),ou=Er("dehighlight"),ru=function(t,e,n,o){o=Bt({target:e},o);t.getSystem().triggerEvent(n,e,o)},iu=Sr,uu=Rr(Ki()),au=Rr(Ji()),cu=Rr(ji()),su=(fi=Hi(),function(t){return Pt(fi,t)}),lu=iu([{key:Ii(),value:Tr({can:function(t,e){var n,e=e.event,o=e.originator,e=e.target;return!(me(n=o,t.element)&&!me(n,e)&&(console.warn(Ii()+" did not get interpreted by the desired target. \nOriginator: "+Wr(o)+"\nTarget: "+Wr(e)+"\nCheck the "+Ii()+" event handlers"),1))}})}]),fu=Object.freeze({__proto__:null,events:lu}),du=0,lu=Dt("alloy-id-"),mu=Dt("data-alloy-id"),gu=lu(),pu=mu(),hu=function(t,e){Object.defineProperty(t.dom,pu,{value:e,writable:!0})},vu=O,bu=x,yu=jr(),xu=function(t){return F(t,function(t){return Xt(t,"/*")?t.substring(0,t.length-"/*".length):t})},wu=O("alloy-premade"),Su={init:function(){return Cu({readState:Dt("No State required")})}},Cu=function(t){return t},lu="alloy.base.behaviour",ku=w([yr("dom","dom",lo(),w([y("tag"),S("styles",{}),S("classes",[]),S("attributes",{}),zo("value"),zo("innerHtml")])),y("components"),y("uid"),S("events",{}),S("apis",{}),yr("eventOrder","eventOrder",((mu={})[Hi()]=["disabling",lu,"toggling","typeaheadevents"],mu[Ii()]=[lu,"focusing","keying"],mu[ji()]=[lu,"disabling","toggling","representing"],mu[Ti()]=[lu,"representing","streaming","invalidating"],mu[Ji()]=[lu,"representing","item-events","tooltipping"],mu[bi()]=["focusing",lu,"item-type-events"],mu[gi()]=["focusing",lu,"item-type-events"],mu[Si()]=["item-type-events","tooltipping"],mu[Pi()]=["receiving","reflecting","tooltipping"],po(Dt(mu))),dr()),zo("domModification")]),Ou=vu,_u=function(t){return I(t,wu).getOrThunk(function(){return ai(ne(t,"uid")?t:Bt({uid:Ou("")},t)).getOrDie()})},Tu=Xr;function Eu(t,e,n,o,r){return t(n,o)?Mt.some(n):T(r)&&r(n)?Mt.none():e(n,o,r)}function Du(t,e,n){for(var o=t.dom,r=T(n)?n:N;o.parentNode;){var o=o.parentNode,i=At.fromDom(o);if(e(i))return Mt.some(i);if(r(i))break}return Mt.none()}function Bu(t,e,n){return Eu(function(t,e){return e(t)},Du,t,e,n)}function Mu(t,e,n){return Bu(t,e,n).isSome()}function Au(t,e,n){return Du(t,function(t){return fe(t,e)},n)}function Fu(t,e){return e=e,de(t=void 0===t?document:t.dom)?Mt.none():Mt.from(t.querySelector(e)).map(At.fromDom)}function Iu(t,e,n){return Eu(fe,Au,t,e,n)}function Ru(){var e=O("aria-owns");return{id:e,link:function(t){Ft(t,"aria-owns",e)},unlink:function(t){Fe(t,"aria-owns")}}}function Vu(e,t){return Mu(t,function(t){return me(t,e.element)},N)||(n=e,Bu(t,function(t){return!!Cn(t)&&void 0!==(t=Be(t,"id"))&&-1<t.indexOf("aria-owns")}).bind(function(t){var e=Be(t,"id");return Fu(Ln(t),'[aria-owns="'+e+'"]')}).exists(function(t){return Vu(n,t)}));var n}var Pu,Hu="unknown";function zu(e,t,n){var o,r,i,u;switch(I(Nu.get(),e).orThunk(function(){return mt(Zt(Nu.get()),function(t){return-1<e.indexOf(t)?Mt.some(Nu.get()[t]):Mt.none()})}).getOr(Pu.NORMAL)){case Pu.NORMAL:return n(Wu());case Pu.LOGGING:o=e,r=t,i=[],u=(new Date).getTime();var a={logEventCut:function(t,e,n){i.push({outcome:"cut",target:e,purpose:n})},logEventStopped:function(t,e,n){i.push({outcome:"stopped",target:e,purpose:n})},logNoParent:function(t,e,n){i.push({outcome:"no-parent",target:e,purpose:n})},logEventNoHandlers:function(t,e){i.push({outcome:"no-handlers-left",target:e})},logEventResponse:function(t,e,n){i.push({outcome:"response",purpose:n,target:e})},write:function(){var t=(new Date).getTime();$t(["mousemove","mouseover","mouseout",ji()],o)||console.log(o,{event:o,time:t-u,target:r.dom,sequence:F(i,function(t){return $t(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+Wr(t.target)+")":t.outcome})})}},c=n(a);return a.write(),c;case Pu.STOP:return!0}}(lu=Pu=Pu||{})[lu.STOP=0]="STOP",lu[lu.NORMAL=1]="NORMAL",lu[lu.LOGGING=2]="LOGGING";var Nu=It({}),Lu=["alloy/data/Fields","alloy/debugging/Debugging"],Wu=Dt({logEventCut:Et,logEventStopped:Et,logNoParent:Et,logEventNoHandlers:Et,logEventResponse:Et,write:Et}),Uu=Dt([y("menu"),y("selectedMenu")]),ju=Dt([y("item"),y("selectedItem")]);function Gu(){return Vo("markers",[y("backgroundMenu")].concat(Uu()).concat(ju()))}function Xu(t){return Vo("markers",F(t,y))}function Yu(t,e,n){return void 0!==(o=new Error).stack&&tt(o.stack.split("\n"),function(e){return 0<e.indexOf("alloy")&&!V(Lu,function(t){return-1<e.indexOf(t)})}).getOr(Hu),yr(e,e,n,_o(function(n){return K.value(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.apply(void 0,t)})}));var o}function t(t){return Yu(0,t,mo(Et))}function qu(t){return Yu(0,t,mo(Mt.none))}function Ku(t){return Yu(0,t,lo())}function Ju(t){return Yu(0,t,lo())}function $u(t,e){return xr(t,Dt(e))}function Qu(t){return xr(t,x)}function Zu(t,e,n,o,r,i,u,a){return{x:t,y:e,bubble:n,direction:o,placement:r,restriction:i,label:u+"-"+r,alwaysFit:a=void 0!==a&&a}}function ta(t,e,n,o){t+=e;return o<t?n:t<n?o:t}function ea(n,e){return at(["left","right","top","bottom"],function(t){return I(e,t).map(function(t){var e=n;switch(t){case 1:return e.x;case 0:return e.x+e.width;case 2:return e.y;case 3:return e.y+e.height}})})}function na(t,e){return t.x+t.width/2-e.width/2}function oa(t,e){return t.x+t.width-e.width}function ra(t,e){return t.y-e.height}function ia(t){return t.y+t.height}function ua(t,e){return t.y+t.height/2-e.height/2}function aa(t,e,n){return Zu(t.x+t.width,ua(t,e),n.east(),za(),"east",ea(t,{left:0}),Wa)}function ca(t,e,n){return Zu(t.x-e.width,ua(t,e),n.west(),Na(),"west",ea(t,{right:1}),Wa)}function sa(){return[Ua,ja,Ga,Xa,qa,Ya,aa,ca]}function la(){return[ja,Ua,Xa,Ga,qa,Ya,aa,ca]}function fa(){return[Ga,Xa,Ua,ja,Ya,qa]}function da(){return[Xa,Ga,ja,Ua,Ya,qa]}function ma(){return[Ua,ja,Ga,Xa,qa,Ya]}function ga(){return[ja,Ua,Xa,Ga,qa,Ya]}function pa(n,o,r){return cu(function(t,e){r(t,n,o)})}function ha(t){return{key:t,value:void 0}}function va(t){var t=Bo("Creating behaviour: "+t.name,Ja,t),e=t.fields,n=t.name,o=t.active,r=t.apis,i=t.extra,t=t.state,u=wo(e),e=Go(n,[No("config",wo(e))]);return Ba(u,e,n,o,r,i,t)}function ba(t){var t=Bo("Creating behaviour: "+t.name,$a,t),e=Mo(t.branchKey,t.branches),n=t.name,o=t.active,r=t.apis,i=t.extra,t=t.state,u=Go(n,[No("config",e=e)]);return Ba(e,u,n,o,r,i,t)}function ya(){return At.fromDom(document)}function xa(t){return t.dom.focus()}function wa(t){var e=Ln(t).dom;return t.dom===e.activeElement}function Sa(t){return void 0===t&&(t=ya()),Mt.from(t.dom.activeElement).map(At.fromDom)}function Ca(e){return Sa(Ln(e)).filter(function(t){return e.dom.contains(t.dom)})}function ka(t,n){var o=Ln(n),e=Sa(o).bind(function(e){function t(t){return me(e,t)}var o,r;return t(n)?Mt.some(n):(o=t,(r=function(t){for(var e=0;e<t.childNodes.length;e++){var n=At.fromDom(t.childNodes[e]);if(o(n))return Mt.some(n);n=r(t.childNodes[e]);if(n.isSome())return n}return Mt.none()})(n.dom))});t(n);e.each(function(e){Sa(o).filter(function(t){return me(t,e)}).fold(function(){xa(e)},Et)})}function Oa(t,e,n,o,r){function i(t){return t+"px"}return{position:t,left:e.map(i),top:n.map(i),right:o.map(i),bottom:r.map(i)}}function _a(t,e){Pe(t,Bt(Bt({},t=e),{position:Mt.some(t.position)}))}function Ta(t,e,n,o,r,i){var u=e.rect,n=u.x-n,o=u.y-o,r=r-(n+u.width),i=i-(o+u.height),a=Mt.some(n),c=Mt.some(o),s=Mt.some(r),l=Mt.some(i),f=Mt.none();return e.direction.fold(function(){return Oa(t,a,c,f,f)},function(){return Oa(t,f,c,s,f)},function(){return Oa(t,a,f,f,l)},function(){return Oa(t,f,f,s,l)},function(){return Oa(t,a,c,f,f)},function(){return Oa(t,a,f,f,l)},function(){return Oa(t,a,c,f,f)},function(){return Oa(t,f,c,s,f)})}function Ea(t,r){return t.fold(function(){var t=r.rect;return Oa("absolute",Mt.some(t.x),Mt.some(t.y),Mt.none(),Mt.none())},function(t,e,n,o){return Ta("absolute",r,t,e,n,o)},function(t,e,n,o){return Ta("fixed",r,t,e,n,o)})}function Da(t,e){var n=g(sn,e),t=t.fold(n,n,function(){var t=rn();return sn(e).translate(-t.left,-t.top)}),n=Ke(e),o=Ge(e);return eo(t.left,t.top,n,o)}Dt(w(ju().concat(Uu())));function Ba(n,t,s,e,o,r,i){function u(t){return yt(t,s)?t[s]():Mt.none()}var o=pt(o,function(t,e){return r=s,n=function(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var o=[n].concat(t);return n.config({name:Dt(r)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+r+". Using API: "+u)},function(t){var e=Array.prototype.slice.call(o,1);return i.apply(void 0,[n,t.config,t.state].concat(e))})},o=u=e,t=(e=(i=t).toString()).indexOf(")")+1,a=e.indexOf("("),c=e.substring(a+1,t-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:o,parameters:xu(c.slice(0,1).concat(c.slice(3)))}},n;var r,i,u,n,o,a,c}),r=pt(r,Gr),a=Bt(Bt(Bt({},r),o),{revoke:g(ha,s),config:function(t){var e=Bo(s+"-config",n,t);return{key:s,value:{config:e,me:a,configAsRaw:ae(function(){return Bo(s+"-config",n,t)}),initialConfig:t,state:i}}},schema:Dt(t),exhibit:function(t,n){return oe(u(t),I(e,"exhibit"),function(t,e){return e(n,t.config,t.state)}).getOrThunk(function(){return Kr({})})},name:Dt(s),handlers:function(t){return u(t).map(function(t){return I(e,"events").getOr(function(){return{}})(t.config,t.state)}).getOr({})}});return a}function Ma(t,e,n){var o=Yn(e,n);return t.fold(Dt(o),Dt(o),function(){var t=rn();return o.translate(-t.left,-t.top)})}var mu=Dt(w(ju())),lu=Dt(Vo("initSize",[y("numColumns"),y("numRows")])),Aa=tr([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Fa=Aa.southeast,Ia=Aa.southwest,Ra=Aa.northeast,Va=Aa.northwest,Pa=Aa.south,Ha=Aa.north,za=Aa.east,Na=Aa.west,La=function(t,e,n){return Math.min(Math.max(t,e),n)},Wa="layout",Ua=function(t,e,n){return Zu(t.x,ia(t),n.southeast(),Fa(),"southeast",ea(t,{left:1,top:3}),Wa)},ja=function(t,e,n){return Zu(oa(t,e),ia(t),n.southwest(),Ia(),"southwest",ea(t,{right:0,top:3}),Wa)},Ga=function(t,e,n){return Zu(t.x,ra(t,e),n.northeast(),Ra(),"northeast",ea(t,{left:1,bottom:2}),Wa)},Xa=function(t,e,n){return Zu(oa(t,e),ra(t,e),n.northwest(),Va(),"northwest",ea(t,{right:0,bottom:2}),Wa)},Ya=function(t,e,n){return Zu(na(t,e),ra(t,e),n.north(),Ha(),"north",ea(t,{bottom:2}),Wa)},qa=function(t,e,n){return Zu(na(t,e),ia(t),n.south(),Pa(),"south",ea(t,{top:3}),Wa)},Aa=Object.freeze({__proto__:null,events:function(u){return iu([Pt(Pi(),function(o,t){var e,r=u.channels,n=Zt(r),i=t,t=(e=i).universal?n:G(n,function(t){return $t(e.channels,t)});Y(t,function(t){var e=r[t],n=e.schema,t=Bo("channel["+t+"] data\nReceiver: "+Wr(o.element),n,i.data);e.onReceive(o,t)})})])}}),Ka=[Fo("channels",To(K.value,wo([Ku("onReceive"),S("schema",dr())])))],Ht=Sr,Ja=wo([y("fields"),y("name"),S("active",{}),S("apis",{}),S("state",Su),S("extra",{})]),$a=wo([y("branchKey"),y("branches"),y("name"),S("active",{}),S("apis",{}),S("state",Su),S("extra",{})]),Qa=Dt(void 0),Za=va({fields:Ka,name:"receiving",active:Aa}),Ka=Object.freeze({__proto__:null,exhibit:function(t,e){return Kr({classes:[],styles:e.useFixed()?{}:{position:"relative"}})}}),Aa=tr([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]);function tc(t){return Me(t,bc)}function ec(t){function e(){n.get().each(t)}var n=It(Mt.none());return{clear:function(){e(),n.set(Mt.none())},isSet:function(){return n.get().isSome()},get:function(){return n.get()},set:function(t){e(),n.set(Mt.some(t))}}}function nc(){return ec(function(t){return t.destroy()})}function oc(){return ec(function(t){return t.unbind()})}function rc(){var e=ec(Et);return Bt(Bt({},e),{on:function(t){return e.get().each(t)}})}function ic(t,e,n){return $e(t,e,xc,n,!1)}function uc(t,e,n){return $e(t,e,xc,n,!0)}function ac(t,e,n,o,r,i){u=o,a=r;var u,a,c,s,l,f,d,m,g,p,h,v,b,y,x,w,i=i.exists(function(t){var e=u.mode;return"all"===e||t[e]!==a[e]});function S(t){return parseFloat(t).toFixed(3)}function C(t){var e=null!=(e=t.raw.pseudoElement)?e:"";return me(t.target,m)&&!Ot(e)&&$t(Sc,t.raw.propertyName)}function k(t){(E(t)||C(t))&&(v.clear(),b.clear(),!E(t=null==t?void 0:t.raw.type)&&t!==Mi()||(clearTimeout(p),Fe(m,Cc),ri(m,g.classes)))}function O(){v.set(ic(m,Mi(),k)),b.set(ic(m,Bi(),k))}function _(t){t=He(y,t);return G(P(t)?t.split(/\s*,\s*/):[],Ot)}function T(t){var e;return P(t)&&/^[\d.]+/.test(t)?(e=parseFloat(t),Xt(t,"ms")?e:1e3*e):0}i||(d=t,rt(o.classes,function(t){return ni(d,t)}))?(q(t,"position",n.position),c=Da(e,t),s=Ea(e,Bt(Bt({},r),{rect:c})),e=at(Sc,function(t){return s[t]}),f=n,vt(e,function(t,e){var e=f[e].map(S),t=t.map(S);return!oe(e=e,t=t,D).getOr(e.isNone()&&t.isNone())}).isSome()&&(Pe(t,e),i&&(oi(l=t,(r=o).classes),Me(l,Cc).each(function(t){clearTimeout(parseInt(t,10)),Fe(l,Cc)}),m=l,g=r,v=oc(),b=oc(),"ontransitionstart"in m.dom?h=ic(m,Ai(),function(t){C(t)&&(h.unbind(),O())}):O(),y=m,x=_("transition-delay"),w=Z(_("transition-duration"),function(t,e,n){n=T(x[n])+T(e);return Math.max(t,n)},0),requestAnimationFrame(function(){p=setTimeout(k,w+17),Ft(m,Cc,p)})),We(t))):ri(t,o.classes)}function cc(t,e,n,o){Le(e,"max-height"),Le(e,"max-width");var r={width:Ke(r=e),height:Ge(r)},_=e,e=o.preference,T=t,E=r,D=n,B=o.bounds,M=E.width,A=E.height;return Z(e,function(t,e){e=g(i,e);return t.fold(Dt(t),e)},yc.nofit({rect:T,maxHeight:E.height,maxWidth:E.width,direction:Fa(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:T.y},-1,-1,!1)).fold(x,x);function i(t,r,i,u,a){t=t(T,E,D,_,B),e=M,n=A,o=B,d=t.bubble,m=d.offset,l=t.restriction,f=m,p=O("left",(s=o).x),v=O("top",s.y),g=O("right",s.right),h=O("bottom",s.bottom),g=eo(p,v,g-p,h-v),p=t.x+m.left,h=t.y+m.top,v=eo(p,h,e,n),m=g.x,p=g.y,e=g.right,n=g.bottom,y=v.x,C=v.y,x=v.right,c=v.bottom,b=v.width,w=v.height,b={originInBounds:m<=y&&y<=e&&p<=C&&C<=n,sizeInBounds:x<=e&&m<=x&&c<=n&&p<=c,visibleW:Math.min(b,m<=y?e-y:x-m),visibleH:Math.min(w,p<=C?n-C:c-p)},e=b.visibleW,y=b.visibleH,S=0<(w=(x=b.originInBounds&&b.sizeInBounds)?v:(m=g.x,w=g.y,n=g.right,C=g.bottom,c=v.x,p=v.y,b=v.width,g=v.height,v=Math.max(m,n-b),S=Math.max(w,C-g),c=La(c,m,v),m=La(p,w,S),v=Math.min(c+b,n)-c,p=Math.min(m+g,C)-m,eo(c,m,v,p))).width&&0<w.height,b=t.direction,C=Dt((n=w).bottom-(g=o).y),c=Dt(g.bottom-n.y),m=b.fold(c,c,C,C,c,C,c,c),v=Dt(n.right-g.x),p=Dt(g.right-n.x),o={maxWidth:b.fold(p,v,p,v,p,p,p,v),maxHeight:m},C={rect:w,maxHeight:o.maxHeight,maxWidth:o.maxWidth,direction:t.direction,placement:t.placement,classes:{on:d.classesOn,off:d.classesOff},layout:t.label,testY:h};var e,n,o,c,s,l,f,d,m,g,p,h,v,b,y,x,w,S,C,k=x||t.alwaysFit?yc.fit(C):yc.nofit(C,e,y,S);function O(o,r){return l[o].map(function(t){var e="top"===o||"bottom"===o,n=e?f.top:f.left,t=("left"===o||"top"===o?Math.max:Math.min)(t,r)+n;return e?La(t,s.y,s.bottom):La(t,s.x,s.right)}).getOr(r)}return k.fold(Dt(k),function(t,e,n,o){return(a===o?u<n||i<e:!a&&o)?k:yc.nofit(r,i,u,a)})}}function sc(t,e){e=Math.floor(e);q(t,"max-height",Xn.max(t,e,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"])+"px")}function lc(t,e,n){return void 0===t[e]?n:t[e]}function fc(t,e,n,o){function r(t){return I(n,t).getOr([])}function i(t,e,n){var o=ut(_c,n);return{offset:Yn(t,e),classesOn:ot(n,r),classesOff:ot(o,r)}}var u=t*(o=void 0===o?1:o),a=e*o;return{southeast:function(){return i(-t,e,["top","alignLeft"])},southwest:function(){return i(t,e,["top","alignRight"])},south:function(){return i(-t/2,e,["top","alignCentre"])},northeast:function(){return i(-t,-e,["bottom","alignLeft"])},northwest:function(){return i(t,-e,["bottom","alignRight"])},north:function(){return i(-t/2,-e,["bottom","alignCentre"])},east:function(){return i(t,-e/2,["valignCentre","left"])},west:function(){return i(-t,-e/2,["valignCentre","right"])},insetNortheast:function(){return i(u,a,["top","alignLeft","inset"])},insetNorthwest:function(){return i(-u,a,["top","alignRight","inset"])},insetNorth:function(){return i(-u/2,a,["top","alignCentre","inset"])},insetSoutheast:function(){return i(u,-a,["bottom","alignLeft","inset"])},insetSouthwest:function(){return i(-u,-a,["bottom","alignRight","inset"])},insetSouth:function(){return i(-u/2,-a,["bottom","alignCentre","inset"])},insetEast:function(){return i(-u,-a/2,["valignCentre","right","inset"])},insetWest:function(){return i(u,-a/2,["valignCentre","left","inset"])}}}function dc(){return fc(0,0,{})}function mc(e,n){return function(t){return"rtl"===Ec(t)?n:e}}Aa.none;function gc(t,e,n,o){var r,i,t=cc(t,e,n,o),u=e,a=t,c=Ea((r=o).origin,a);return r.transition.each(function(t){ac(u,r.origin,c,t,a,r.lastPlacement)}),_a(u,c),n=t.placement,Ft(e,bc,n),ri(n=e,(i=t.classes).off),oi(n,i.on),(0,o.maxHeightFunction)(e,t.maxHeight),(0,o.maxWidthFunction)(e,t.maxWidth),{layout:t.layout,placement:t.placement}}var pc,hc=Aa.relative,vc=Aa.fixed,bc="data-alloy-placement",yc=tr([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),xc=L,wc=Je,Sc=["top","bottom","right","left"],Cc="data-alloy-transition-timer",kc=Dt(function(t,e){sc(t,e),Ve(t,{"overflow-x":"hidden","overflow-y":"auto"})}),Oc=Dt(function(t,e){sc(t,e)}),_c=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],Tc=x,Ec=function(t){return"rtl"===He(t,"direction")?"rtl":"ltr"};function Dc(t){return Mu(t,function(t){return Cn(t)&&Be(t,"data-alloy-vertical-dir")===pc.BottomToTop})}function Bc(){return Go("layouts",[y("onLtr"),y("onRtl"),zo("onBottomLtr"),zo("onBottomRtl")])}function Mc(e,t,n,o,r,i,u){var u=u.map(Dc).getOr(!1),a=t.layouts.map(function(t){return t.onLtr(e)}),c=t.layouts.map(function(t){return t.onRtl(e)});return mc(u?t.layouts.bind(function(t){return t.onBottomLtr.map(function(t){return t(e)})}).or(a).getOr(r):a.getOr(n),u?t.layouts.bind(function(t){return t.onBottomRtl.map(function(t){return t(e)})}).or(c).getOr(i):c.getOr(o))(e)}function Ac(t){return t.fold(x,function(t,e,n){return t.translate(-e,-n)})}function Fc(t){return t.fold(x,x)}function Ic(t){return Z(t,function(t,e){return t.translate(e.left,e.top)},Yn(0,0))}function Rc(t){return Ic(F(t,Fc))}function Vc(t,e,n){var o,r=rn(pe(t.element)),n=(o=t,t=be(n.root).dom,Mt.from(t.frameElement).map(At.fromDom).filter(function(t){return me(pe(t),pe(o.element))}).map(Ye).getOr(r));return qc(n,r.left,r.top)}function Pc(t,e,n,o){t=Yc(Yn(t,e));return Mt.some({point:t,width:n,height:o})}function Hc(t,r,i,u,a){return t.map(function(t){var e=[r,t.point],n=u.fold(function(){return Rc(e)},function(){return Rc(e)},function(){return Ic(F(e,Ac))}),n={x:n.left,y:n.top,width:t.width,height:t.height},t=(i.showAbove?fa:ma)(),o=(i.showAbove?da:ga)(),t=Mc(a,i,t,o,t,o,Mt.none());return Tc({anchorBox:n,bubble:i.bubble.getOr(dc()),overrides:i.overrides,layouts:t,placer:Mt.none()})})}function zc(t,e,n){var o,t=t.document.createRange(),r=t;return e.fold(function(t){r.setStartBefore(t.dom)},function(t,e){r.setStart(t.dom,e)},function(t){r.setStartAfter(t.dom)}),o=t,n.fold(function(t){o.setEndBefore(t.dom)},function(t,e){o.setEnd(t.dom,e)},function(t){o.setEndAfter(t.dom)}),t}function Nc(t,e,n,o,r){t=t.document.createRange();return t.setStart(e.dom,n),t.setEnd(o.dom,r),t}function Lc(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}}function Wc(t,e,n){return e(At.fromDom(n.startContainer),n.startOffset,At.fromDom(n.endContainer),n.endOffset)}function Uc(i,t){return r=i,t=t.match({domRange:function(t){return{ltr:Dt(t),rtl:Mt.none}},relative:function(t,e){return{ltr:ae(function(){return zc(r,t,e)}),rtl:ae(function(){return Mt.some(zc(r,e,t))})}},exact:function(t,e,n,o){return{ltr:ae(function(){return Nc(r,t,e,n,o)}),rtl:ae(function(){return Mt.some(Nc(r,n,o,t,e))})}}}),((e=(t=t).ltr()).collapsed?t.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return Zc.rtl(At.fromDom(t.endContainer),t.endOffset,At.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return Wc(0,Zc.ltr,e)}):Wc(0,Zc.ltr,e)).match({ltr:function(t,e,n,o){var r=i.document.createRange();return r.setStart(t.dom,e),r.setEnd(n.dom,o),r},rtl:function(t,e,n,o){var r=i.document.createRange();return r.setStart(n.dom,o),r.setEnd(t.dom,e),r}});var r,e}(pc=pc||{}).TopToBottom="toptobottom",pc.BottomToTop="bottomtotop";var jc="data-alloy-vertical-dir",Aa=[y("hotspot"),zo("bubble"),S("overrides",{}),Bc(),$u("placement",function(t,e,n){n=Da(n,e.hotspot.element),t=Mc(t.element,e,ma(),ga(),fa(),da(),Mt.some(e.hotspot.element));return Mt.some(Tc({anchorBox:n,bubble:e.bubble.getOr(dc()),overrides:e.overrides,layouts:t,placer:Mt.none()}))})],Gc=[y("x"),y("y"),S("height",0),S("width",0),S("bubble",dc()),S("overrides",{}),Bc(),$u("placement",function(t,e,n){n=Ma(n,e.x,e.y),n=eo(n.left,n.top,e.width,e.height),t=Mc(t.element,e,sa(),la(),sa(),la(),Mt.none());return Mt.some(Tc({anchorBox:n,bubble:e.bubble,overrides:e.overrides,layouts:t,placer:Mt.none()}))})],Xc=tr([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Yc=Xc.screen,qc=Xc.absolute,Xc=[y("node"),y("root"),zo("bubble"),Bc(),S("overrides",{}),S("showAbove",!1),$u("placement",function(n,o,r){var i=Vc(n,0,o);return o.node.filter(Wn).bind(function(t){var t=t.dom.getBoundingClientRect(),t=Pc(t.left,t.top,t.width,t.height),e=o.node.getOr(n.element);return Hc(t,i,o,r,e)})})],Kc=function(t,e,n,o){return{start:t,soffset:e,finish:n,foffset:o}},Jc=tr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),$c=(Jc.before,Jc.on,Jc.after,tr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}])),Qc={domRange:$c.domRange,relative:$c.relative,exact:$c.exact,exactFromRange:function(t){return $c.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){return be(t.match({domRange:function(t){return At.fromDom(t.startContainer)},relative:function(t,e){return t.fold(x,x,x)},exact:function(t,e,n,o){return t}}))},range:Kc},Zc=tr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]);function ts(t){return Nl.getOption(t)}function es(t){return ts(t).filter(function(t){return 0!==t.trim().length||-1<t.indexOf(" ")}).isSome()||$t(Ll,ie(t))}function ns(t,e){return de(t=void 0===t?document:t.dom)?[]:F(t.querySelectorAll(e),At.fromDom)}function os(t){var e;return 0<t.rangeCount?(e=t.getRangeAt(0),t=t.getRangeAt(t.rangeCount-1),Mt.some(Kc(At.fromDom(e.startContainer),e.startOffset,At.fromDom(t.endContainer),t.endOffset))):Mt.none()}function rs(t){var e,n,o,r,i,u,a,c,s,l,f;return null!==t.anchorNode&&null!==t.focusNode&&(o=At.fromDom(t.anchorNode),r=At.fromDom(t.focusNode),s=u=t.anchorOffset,l=a=r,f=c=t.focusOffset,(e=pe(n=i=o).dom.createRange()).setStart(n.dom,s),e.setEnd(l.dom,f),n=e,s=me(i,a)&&u===c,n.collapsed)&&!s?Mt.some(Kc(o,t.anchorOffset,r,t.focusOffset)):os(t)}function is(t,e){var e=(t=Uc(t,e)).getClientRects();return 0<(e=0<e.length?e[0]:t.getBoundingClientRect()).width||0<e.height?Mt.some(e).map(Lc):Mt.none()}function us(t,e){return{element:t,offset:e}}function as(t,e){return(kn(t)?us:function(t,e){var n=we(t);return 0===n.length?us(t,e):e<n.length?us(n[e],0):us(t=n[n.length-1],(kn(t)?Nl.get(t):we(t)).length)})(t,e)}function cs(t,e){return e.getSelection.getOrThunk(function(){return function(){return Mt.from(t.getSelection()).filter(function(t){return 0<t.rangeCount}).bind(rs)}})().map(function(t){var e=as(t.start,t.soffset),t=as(t.finish,t.foffset);return Qc.range(e.element,e.offset,t.element,t.offset)})}function ss(t){return t.x+t.width}function ls(t,e){return t.x-e.width}function fs(t,e){return t.y-e.height+t.height}function ds(t,e,n){return Zu(ss(t),t.y,n.southeast(),Fa(),"southeast",ea(t,{left:0,top:2}),Wl)}function ms(t,e,n){return Zu(ls(t,e),t.y,n.southwest(),Ia(),"southwest",ea(t,{right:1,top:2}),Wl)}function gs(t,e,n){return Zu(ss(t),fs(t,e),n.northeast(),Ra(),"northeast",ea(t,{left:0,bottom:3}),Wl)}function ps(t,e,n){return Zu(ls(t,e),fs(t,e),n.northwest(),Va(),"northwest",ea(t,{right:1,bottom:3}),Wl)}function hs(){return[ds,ms,gs,ps]}function vs(){return[ms,ds,ps,gs]}function bs(t,e,n,o,r,i,u){var a,e={anchorBox:n.anchorBox,origin:e},r=r.element,c=n.bubble,s=n.layouts,n=n.overrides,l=lc(n,"maxHeightFunction",kc()),n=lc(n,"maxWidthFunction",Et),f=e.anchorBox,e=e.origin,o={bounds:(a=e,o.fold(function(){return a.fold(oo,oo,eo)},function(n){return a.fold(n,n,function(){var t=n(),e=Ma(a,t.x,t.y);return eo(e.left,e.top,t.width,t.height)})})),origin:e,preference:s,maxHeightFunction:l,maxWidthFunction:n,lastPlacement:i,transition:u};return gc(f,r,c,o)}function ys(t,e){$n(t.element,e.element)}function xs(e,t){var n=e.components(),o=(Y((o=e).components(),function(t){return Qn(t.element)}),nn(o.element),o.syncComponents(),ut(n,t));Y(o,function(t){Gl(t),e.getSystem().removeFromWorld(t)}),Y(t,function(t){t.getSystem().isConnected()?ys(e,t):(e.getSystem().addToWorld(t),ys(e,t),Wn(e.element)&&Xl(t)),e.syncComponents()})}function ws(t,e){Rl(t,e,$n)}function Ss(t){Gl(t),Qn(t.element),t.getSystem().removeFromWorld(t)}function Cs(e){var t=ye(e.element).bind(function(t){return e.getSystem().getByDom(t).toOptional()});Ss(e),t.each(function(t){t.syncComponents()})}function ks(t){var e=t.components();Y(e,Ss),nn(t.element),t.syncComponents()}function Os(t,e){Vl(t,e,$n)}function _s(e){var t=we(e.element);Y(t,function(t){e.getByDom(t).each(Gl)}),Qn(e.element)}function Ts(e,t,n,o){n.get().each(function(t){ks(e)}),ws(t.getAttachPoint(e),e);t=e.getSystem().build(o);return ws(e,t),n.set(t),t}function Es(t,e,n,o){n=Ts(t,e,n,o);return e.onOpen(t,n),n}function Ds(e,n,o){o.get().each(function(t){ks(e),Cs(e),n.onClose(e,t),o.clear()})}function Bs(t,e,n){return n.isOpen()}function Ms(t){var n=Bo("Dismissal",Jl,t),t={};return t[Yl()]={schema:wo([y("target")]),onReceive:function(e,t){!m.isOpen(e)||m.isPartOf(e,t.target)||n.isExtraPart(e,t.target)||n.fireEventInstead.fold(function(){return m.close(e)},function(t){return Rt(e,t.event)})}},t}function As(t){var n=Bo("Reposition",$l,t),t={};return t[ql()]={onReceive:function(e){m.isOpen(e)&&n.fireEventInstead.fold(function(){return n.doReposition(e)},function(t){return Rt(e,t.event)})}},t}function Fs(t,e,n){e.store.manager.onLoad(t,e,n)}function Is(t,e,n){e.store.manager.onUnload(t,e,n)}function Rs(){var t=It(null);return Cu({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})}function Vs(){var i=It({}),u=It({});return Cu({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(t){return I(i.get(),t).orThunk(function(){return I(u.get(),t)})},update:function(t){var e=i.get(),n=u.get(),o={},r={};Y(t,function(e){I(o[e.value]=e,"meta").each(function(t){I(t,"text").each(function(t){r[t]=e})})}),i.set(Bt(Bt({},e),o)),u.set(Bt(Bt({},n),r))},clear:function(){i.set({}),u.set({})}})}function Ps(t,e,n,o){var r=e.store;n.update([o]),r.setValue(t,o),e.onSetValue(t,o)}function Hs(o,t){return Zo(o,{},F(t,function(t){return e=t.name(),n="Cannot configure "+t.name()+" for "+o,yr(e,e,go(),bo(function(t){return ir("The field: "+e+" is forbidden. "+n)}));var e,n}).concat([xr("dump",x)]))}function zs(t){return t.dump}function Ns(t,e){return Bt(Bt({},Ht(e)),t.dump)}function Ls(t){return ne(t,"uiType")}function Ws(t){return t.fold(Mt.some,Mt.none,Mt.some,Mt.some)}function Us(t){function e(t){return t.name}return t.fold(e,e,e,e)}function js(e,n){return function(t){t=Bo("Converting part type",n,t);return e(t)}}function Gs(t,e,n,o){return sr(e.defaults(t,n,o),n,{uid:t.partUids[e.name]},e.overrides(t,n,o))}function Xs(r,t){var i={};return Y(t,function(t){Ws(t).each(function(n){t=r,e=n.pname;var t,e,o={uiType:uf(),owner:t,name:e};i[n.name]=function(t){var e=Bo("Part: "+n.name+" in "+r,w(n.schema),t);return Bt(Bt({},o),{config:t,validated:e})}})}),i}function Ys(t,e,n){return{uiType:uf(),owner:t,name:e,config:n,validated:{}}}function qs(t){return ot(t,function(t){return t.fold(Mt.none,Mt.some,Mt.none,Mt.none).map(function(t){return Vo(t.name,t.schema.concat([Qu(gf())]))}).toArray()})}function Ks(t){return F(t,Us)}function Js(t,e,n){return o=e,r={},i={},Y(n,function(t){t.fold(function(o){r[o.pname]=of(!0,function(t,e,n){return o.factory.sketch(Gs(t,o,e,n))})},function(t){var e=o.parts[t.name];i[t.name]=Dt(t.factory.sketch(Gs(o,t,e[gf()]),e))},function(o){r[o.pname]=of(!1,function(t,e,n){return o.factory.sketch(Gs(t,o,e,n))})},function(o){r[o.pname]=rf(!0,function(e,t,n){return F(e[o.name],function(t){return o.factory.sketch(sr(o.defaults(e,t,n),t,o.overrides(e,t)))})})})}),{internals:Dt(r),externals:Dt(i)};var o,r,i}function $s(t,e,n){return o=Mt.some(t),t=(r=e).components,e=pt(n,function(t,e){return o=t,r=!1,{name:Dt(n=e),required:function(){return o.fold(function(t,e){return t},function(t,e){return t})},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+n);return r=!0,o}};var n,o,r}),i=o,u=r,a=e,n=ot(t,function(t){return nf(i,u,t,a)}),gt(e,function(t){if(!1===t.used()&&t.required())throw new Error("Placeholder: "+t.name()+" was not found in components list\nNamespace: "+o.getOr("none")+"\nComponents: "+JSON.stringify(r.components,null,2))}),n;var o,r,i,u,a}function Qs(t,e,n){e=e.partUids[n];return t.getSystem().getByUid(e).toOptional()}function Zs(t,e,n){return Qs(t,e,n).getOrDie("Could not find part: "+n)}function tl(t,e,n){var o={},r=e.partUids,i=t.getSystem();return Y(n,function(t){o[t]=Dt(i.getByUid(r[t]))}),o}function el(t,e){var n=t.getSystem();return pt(e.partUids,function(t,e){return Dt(n.getByUid(t))})}function nl(t){return Zt(t.partUids)}function ol(t,e,n){var o={},r=e.partUids,i=t.getSystem();return Y(n,function(t){o[t]=Dt(i.getByUid(r[t]).getOrDie())}),o}function rl(e,t){return Sr(F(Ks(t),function(t){return{key:t,value:e+"-"+t}}))}function il(e){return yr("partUids","partUids",po(function(t){return rl(t.uid,e)}),dr())}function ul(t,e,n,o,r){return Bo(t+" [SpecSchema]",wo((t=r,(0<o.length?[Vo("parts",o)]:[]).concat([y("uid"),S("dom",{}),S("components",[]),Qu("originalSpec"),S("debug.sketcher",{})]).concat(t).concat(e))),n)}function al(t,e,n,o,r){r=pf(r),e=ul(t,e,r,qs(n),[il(n)]),n=Js(0,e,n);return o(e,$s(t,e,n.internals()),r,n.externals())}function cl(t){var o=Bo("Sketcher for "+t.name,hf,t),t=pt(o.apis,Yr),e=pt(o.extraApis,Gr);return Bt(Bt({name:o.name,configFields:o.configFields,sketch:function(t){return n=o.name,e=o.configFields,(0,o.factory)(ul(n,e,n=pf(t),[],[]),n);var e,n}},t),e)}function sl(t){var e=Bo("Sketcher for "+t.name,vf,t),t=Xs(e.name,e.partFields),n=pt(e.apis,Yr),o=pt(e.extraApis,Gr);return Bt(Bt({name:e.name,partFields:e.partFields,configFields:e.configFields,sketch:function(t){return al(e.name,e.configFields,e.partFields,e.factory,t)},parts:t},n),o)}function ll(t){return"input"===ie(t)&&"radio"!==Be(t,"type")||"textarea"===ie(t)}function fl(t,e,n){(e.disabled()?yf:xf)(t,e)}function dl(t,e){return!0===e.useNative&&$t(bf,ie(t.element))}function ml(t,e){return dl(t,e)?Ae(t.element,"disabled"):"true"===Be(t.element,"aria-disabled")}function gl(n,o,t,r){var e=ns(n.element,"."+o.highlightClass);Y(e,function(e){V(r,function(t){return t.element===e})||(ei(e,o.highlightClass),n.getSystem().getByDom(e).each(function(t){o.onDehighlight(n,t),Rt(t,ou())}))})}function pl(t,e,n,o){gl(t,e,0,[o]),Bl(0,e,0,o)||(ti(o.element,e.highlightClass),e.onHighlight(t,o),Rt(o,nu()))}function hl(e,n,t,o){var r=ns(e.element,"."+n.itemClass);return et(r,function(t){return ni(t,n.highlightClass)}).bind(function(t){t=ta(t,o,0,r.length-1);return e.getSystem().getByDom(r[t]).toOptional()})}function vl(t,e,n){var o=it(t.slice(0,e)),t=it(t.slice(e+1));return tt(o.concat(t),n)}function bl(t,e,n){return tt(it(t.slice(0,e)),n)}function yl(t,e,n){var o=t.slice(0,e);return tt(t.slice(e+1).concat(o),n)}function xl(t,e,n){return tt(t.slice(e+1),n)}function s(e){return function(t){t=t.raw;return $t(e,t.which)}}function wl(t){return function(e){return rt(t,function(t){return t(e)})}}function Sl(t){return!0===t.raw.shiftKey}function Cl(t){return!0===t.raw.ctrlKey}function u(t,e){return{matches:t,classification:e}}function kl(t,e,n){e.exists(function(e){return n.exists(function(t){return me(t,e)})})||Vt(t,Qi(),{prevFocus:e,newFocus:n})}function Ol(){function o(t){return Ca(t.element)}return{get:o,set:function(t,e){var n=o(t);t.getSystem().triggerFocus(e,t.element),kl(t,n,o(t))}}}function _l(){function o(t){return wf.getHighlighted(t).map(function(t){return t.element})}return{get:o,set:function(e,t){var n=o(e),t=(e.getSystem().getByDom(t).fold(Et,function(t){wf.highlight(e,t)}),o(e));kl(e,n,t)}}}function Tl(t,e,n,o,r,i){i=i.map(no);return Il(t,e,n,o,r,i)}function El(t,e,n){var o,r,i=e.getAttachPoint(t);q(t.element,"position",jl.getMode(i)),r=e.cloakVisibilityAttr,ze((o=t).element,"visibility").fold(function(){Fe(o.element,r)},function(t){Ft(o.element,r,t)}),q(o.element,"visibility","hidden")}function Dl(t,e,n){var o,r,i=t.element;V(["top","left","right","bottom"],function(t){return ze(i,t).isSome()})||Le(t.element,"position"),r="visibility",e=e.cloakVisibilityAttr,Me((o=t).element,e).fold(function(){return Le(o.element,r)},function(t){return q(o.element,r,t)})}function Bl(t,e,n,o){return ni(o.element,e.highlightClass)}function Ml(e,t,n){return Fu(e.element,"."+t.itemClass).bind(function(t){return e.getSystem().getByDom(t).toOptional()})}function Al(e,t,n){t=ns(e.element,"."+t.itemClass);return(0<t.length?Mt.some(t[t.length-1]):Mt.none()).bind(function(t){return e.getSystem().getByDom(t).toOptional()})}function Fl(e,t,n){return wt(F(ns(e.element,"."+t.itemClass),function(t){return e.getSystem().getByDom(t).toOptional()}))}Zc.ltr,Zc.rtl;function Il(i,u,a,c,t,s){var l=Bo("placement.info",w(Ul),t),f=l.anchor,d=c.element,m=a.get(c.uid);ka(function(){q(d,"position","fixed");var t=ze(d,"visibility");q(d,"visibility","hidden");var e,n=u.useFixed()?(e=document.documentElement,vc(0,0,e.clientWidth,e.clientHeight)):(o=Ye((e=i).element),e=e.element.dom.getBoundingClientRect(),hc(o.left,o.top,e.width,e.height)),o=f.placement,r=s.map(Dt).or(u.getBounds);o(i,f,n).each(function(t){t=t.placer.getOr(bs)(i,n,t,r,c,m,l.transition);a.set(c.uid,t)}),t.fold(function(){Le(d,"visibility")},function(t){q(d,"visibility",t)}),ze(d,"left").isNone()&&ze(d,"top").isNone()&&ze(d,"right").isNone()&&ze(d,"bottom").isNone()&&xt(ze(d,"position"),"fixed")&&Le(d,"position")},d)}function Rl(t,e,n){t.getSystem().addToWorld(e),n(t.element,e.element),Wn(t.element)&&Xl(e),t.syncComponents()}function Vl(t,e,n){n(t,e.element),n=we(e.element),Y(n,function(t){e.getByDom(t).each(Xl)})}Pl=kn;var Pl,Hl,zl,Nl={get:function(t){if(Pl(t))return Hl(t).getOr("");throw new Error("Can only get text value of a text node")},getOption:Hl=function(t){return Pl(t)?Mt.from(t.dom.nodeValue):Mt.none()},set:function(t,e){if(!Pl(t))throw new Error("Can only set raw text value of a text node");t.dom.nodeValue=e}},Ll=["img","br"],Jc=[zo("getSelection"),y("root"),zo("bubble"),Bc(),S("overrides",{}),S("showAbove",!1),$u("placement",function(t,e,n){var o=be(e.root).dom,r=Vc(t,0,e);return Hc(cs(o,e).bind(function(n){return(0<(t=Uc(o,Qc.exactFromRange(n)).getBoundingClientRect()).width||0<t.height?Mt.some(t).map(Lc):Mt.none()).orThunk(function(){var t=At.fromText("\ufeff"),e=(Qe(n.start,t),is(o,Qc.exact(t,0,t,1)));return Qn(t),e}).bind(function(t){return Pc(t.left,t.top,t.width,t.height)});var t}),r,e,n,cs(o,e).bind(function(t){return Cn(t.start)?Mt.some(t.start):zn(t.start)}).getOr(t.element))})],Wl="link-layout",Jc=Mo("type",{selection:Jc,node:Xc,hotspot:Aa,submenu:[y("item"),Bc(),S("overrides",{}),$u("placement",function(t,e,n){n=Da(n,e.item.element),t=Mc(t.element,e,hs(),vs(),hs(),vs(),Mt.none());return Mt.some(Tc({anchorBox:n,bubble:dc(),overrides:e.overrides,layouts:t,placer:Mt.none()}))})],makeshift:Gc}),Xc=[Ho("classes",gr),Ko("mode","all",["all","layout","placement"])],Aa=[S("useFixed",N),zo("getBounds")],Ul=[Fo("anchor",Jc),Go("transition",Xc)],jl=va({fields:Aa,name:"positioning",active:Ka,apis:Object.freeze({__proto__:null,position:function(t,e,n,o,r){Tl(t,e,n,o,r,Mt.none())},positionWithin:Tl,positionWithinBounds:Il,getMode:function(t,e,n){return e.useFixed()?"fixed":"absolute"},reset:function(t,e,n,o){var r=o.element;Y(["position","left","right","top","bottom"],function(t){return Le(r,t)}),Fe(r,bc),n.clear(o.uid)}}),state:Object.freeze({__proto__:null,init:function(){var n={};return Cu({readState:function(){return n},clear:function(t){_(t)?delete n[t]:n={}},set:function(t,e){n[t]=e},get:function(t){return I(n,t)}})}})}),Gl=function(t){Rt(t,Ji());t=t.components();Y(t,Gl)},Xl=function(t){var e=t.components();Y(e,Xl),Rt(t,Ki())},Gc=Object.freeze({__proto__:null,cloak:El,decloak:Dl,open:Es,openWhileCloaked:function(t,e,n,o,r){El(t,e),Es(t,e,n,o),r(),Dl(t,e)},close:Ds,isOpen:Bs,isPartOf:function(e,n,t,o){return Bs(0,0,t)&&t.get().exists(function(t){return n.isPartOf(e,t,o)})},getState:function(t,e,n){return n.get()},setContent:function(t,e,n,o){return n.get().map(function(){return Ts(t,e,n,o)})}}),Jc=Object.freeze({__proto__:null,events:function(n,o){return iu([Pt(Wi(),function(t,e){Ds(t,n,o)})])}}),m=va({fields:[t("onOpen"),t("onClose"),y("isPartOf"),y("getAttachPoint"),S("cloakVisibilityAttr","data-precloak-visibility")],name:"sandboxing",active:Jc,apis:Gc,state:Object.freeze({__proto__:null,init:function(){var t=rc(),e=Dt("not-implemented");return Cu({readState:e,isOpen:t.isSet,clear:t.clear,set:t.set,get:t.get})}})}),Yl=Dt("dismiss.popups"),ql=Dt("reposition.popups"),Kl=Dt("mouse.released"),Jl=wo([S("isExtraPart",N),Go("fireEventInstead",[S("event",$i())])]),$l=wo([Go("fireEventInstead",[S("event",mi())]),Ro("doReposition")]),Xc=Object.freeze({__proto__:null,onLoad:Fs,onUnload:Is,setValue:function(t,e,n,o){e.store.manager.setValue(t,e,n,o)},getValue:function(t,e,n){return e.store.manager.getValue(t,e,n)},getState:function(t,e,n){return n}}),Aa=Object.freeze({__proto__:null,events:function(n,o){var t=n.resetOnDom?[uu(function(t,e){Fs(t,n,o)}),au(function(t,e){Is(t,n,o)})]:[pa(n,o,Fs)];return iu(t)}}),Ka=Object.freeze({__proto__:null,memory:Rs,dataset:Vs,manual:function(){return Cu({readState:Et})},init:function(t){return t.store.manager.state(t)}}),Jc=[zo("initialValue"),y("getFallbackEntry"),y("getDataKey"),y("setValue"),$u("manager",{setValue:Ps,getValue:function(t,e,n){var o=e.store,r=o.getDataKey(t);return n.lookup(r).getOrThunk(function(){return o.getFallbackEntry(r)})},onLoad:function(e,n,o){n.store.initialValue.each(function(t){Ps(e,n,o,t)})},onUnload:function(t,e,n){n.clear()},state:Vs})],Gc=[y("getValue"),S("setValue",Et),zo("initialValue"),$u("manager",{setValue:function(t,e,n,o){e.store.setValue(t,o),e.onSetValue(t,o)},getValue:function(t,e,n){return e.store.getValue(t)},onLoad:function(e,n,t){n.store.initialValue.each(function(t){n.store.setValue(e,t)})},onUnload:Et,state:Su.init})],zt=va({fields:[Xo("store",{mode:"memory"},Mo("mode",{memory:[zo("initialValue"),$u("manager",{setValue:function(t,e,n,o){n.set(o),e.onSetValue(t,o)},getValue:function(t,e,n){return n.get()},onLoad:function(t,e,n){e.store.initialValue.each(function(t){n.isNotSet()&&n.set(t)})},onUnload:function(t,e,n){n.clear()},state:Rs})],manual:Gc,dataset:Jc})),t("onSetValue"),S("resetOnDom",!1)],name:"representing",active:Aa,apis:Xc,extra:{setValueFrom:function(t,e){e=zt.getValue(e);zt.setValue(t,e)}},state:Ka}),Ql=Hs,Zl=Ns,tf="placeholder",ef=tr([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),nf=function(o,r,i,u){return t=o,n=u,(Ls(e=i)&&e.uiType===tf?(c=e,s=n,(a=t).exists(function(t){return t!==c.owner})?ef.single(!0,Dt(c)):I(s,c.name).fold(function(){throw new Error("Unknown placeholder component: "+c.name+"\nKnown: ["+Zt(s)+"]\nNamespace: "+a.getOr("none")+"\nSpec: "+JSON.stringify(c,null,2))},function(t){return t.replace()})):ef.single(!1,Dt(e))).fold(function(t,e){var e=Ls(i)?e(r,i.config,i.validated):e(r),n=ot(I(e,"components").getOr([]),function(t){return nf(o,r,t,u)});return[Bt(Bt({},e),{components:n})]},function(t,e){var n;return Ls(i)?(n=e(r,i.config,i.validated),i.validated.preprocess.getOr(x)(n)):e(r)});var t,e,n,a,c,s},of=ef.single,rf=ef.multiple,uf=Dt(tf),Gc=tr([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Jc=S("factory",{sketch:x}),Aa=S("schema",[]),Xc=y("name"),Ka=yr("pname","pname",fo(function(t){return"<alloy."+O(t.name)+">"}),dr()),af=xr("schema",function(){return[zo("preprocess")]}),cf=S("defaults",Dt({})),sf=S("overrides",Dt({})),lf=w([Jc,Aa,Xc,Ka,cf,sf]),ff=w([Jc,Aa,Xc,cf,sf]),Aa=w([Jc,Aa,Xc,Ka,cf,sf]),Jc=w([Jc,af,Xc,y("unit"),Ka,cf,sf]),df=js(Gc.required,lf),af=js(Gc.external,ff),mf=js(Gc.optional,Aa),Xc=js(Gc.group,Jc),gf=Dt("entirety"),Ka=Object.freeze({__proto__:null,required:df,external:af,optional:mf,group:Xc,asNamedPart:Ws,name:Us,asCommon:function(t){return t.fold(x,x,x,x)},original:gf}),cf=Object.freeze({__proto__:null,generate:Xs,generateOne:Ys,schemas:qs,names:Ks,substitutes:Js,components:$s,defaultUids:rl,defaultUidsSchema:il,getAllParts:el,getAllPartNames:nl,getPart:Qs,getPartOrDie:Zs,getParts:tl,getPartsOrDie:ol}),pf=function(t){return ne(t,"uid")?t:Bt(Bt({},t),{uid:vu("uid")})},hf=wo([y("name"),y("factory"),y("configFields"),S("apis",{}),S("extraApis",{})]),vf=wo([y("name"),y("factory"),y("configFields"),y("partFields"),S("apis",{}),S("extraApis",{})]),sf=Object.freeze({__proto__:null,getCurrent:function(t,e,n){return e.find(t)}}),J=va({fields:[y("find")],name:"composing",apis:sf}),bf=["input","button","textarea","select"],yf=function(e,t,n){t.disableClass.each(function(t){ti(e.element,t)}),(dl(e,t)?function(t){Ft(t.element,"disabled","disabled")}:function(t){Ft(t.element,"aria-disabled","true")})(e),t.onDisabled(e)},xf=function(e,t,n){t.disableClass.each(function(t){ei(e.element,t)}),(dl(e,t)?function(t){Fe(t.element,"disabled")}:function(t){Ft(t.element,"aria-disabled","false")})(e),t.onEnabled(e)},lf=Object.freeze({__proto__:null,enable:xf,disable:yf,isDisabled:ml,onLoad:fl,set:function(t,e,n,o){(o?yf:xf)(t,e)}}),ff=Object.freeze({__proto__:null,exhibit:function(t,e){return Kr({classes:e.disabled()?e.disableClass.toArray():[]})},events:function(n,t){return iu([Ar(Hi(),function(t,e){return ml(t,n)}),pa(n,t,fl)])}}),Nt=va({fields:[$o("disabled",N),S("useNative",!0),zo("disableClass"),t("onDisabled"),t("onEnabled")],name:"disabling",active:ff,apis:lf}),Aa=Object.freeze({__proto__:null,dehighlightAll:function(t,e,n){return gl(t,e,0,[])},dehighlight:function(t,e,n,o){Bl(0,e,0,o)&&(ei(o.element,e.highlightClass),e.onDehighlight(t,o),Rt(o,ou()))},highlight:pl,highlightFirst:function(e,n,t){Ml(e,n).each(function(t){pl(e,n,0,t)})},highlightLast:function(e,n,t){Al(e,n).each(function(t){pl(e,n,0,t)})},highlightAt:function(e,n,t,o){var r=o,i=ns((o=e).element,"."+n.itemClass);Mt.from(i[r]).fold(function(){return K.error(new Error("No element found with index "+r))},o.getSystem().getByDom).fold(function(t){throw t},function(t){pl(e,n,0,t)})},highlightBy:function(e,n,t,o){tt(Fl(e,n),o).each(function(t){pl(e,n,0,t)})},isHighlighted:Bl,getHighlighted:function(e,t,n){return Fu(e.element,"."+t.highlightClass).bind(function(t){return e.getSystem().getByDom(t).toOptional()})},getFirst:Ml,getLast:Al,getPrevious:function(t,e,n){return hl(t,e,0,-1)},getNext:function(t,e,n){return hl(t,e,0,1)},getCandidates:Fl}),wf=va({fields:[y("highlightClass"),y("itemClass"),t("onHighlight"),t("onDehighlight")],name:"highlighting",apis:Aa}),Sf=[8],Cf=[9],kf=[13],Of=[27],_f=[32],Tf=[37],Ef=[38],Df=[39],Bf=[40],Mf=h(Sl);function Af(t,e,n,o,a){function c(e,n,t,o,r){var t=t(e,n,o,r),i=n.event;return tt(t,function(t){return t.matches(i)}).map(function(t){return t.classification}).bind(function(t){return t(e,n,o,r)})}var r={schema:function(){return t.concat([S("focusManager",Ol()),Xo("focusInside","onFocus",_o(function(t){return $t(["onFocus","onEnterOrSpace","onApi"],t)?K.value(t):K.error("Invalid value for focusInside")})),$u("handler",r),$u("state",e),$u("sendFocusIn",a)])},processKey:c,toEvents:function(i,u){var t=i.focusInside!==zl.OnFocusMode?Mt.none():a(i).map(function(n){return Pt(Ii(),function(t,e){n(t,i,u),e.stop()})}),e=[Pt(Oi(),function(o,r){c(o,r,n,i,u).fold(function(){var e=o,n=r,t=s(_f.concat(kf))(n.event);i.focusInside===zl.OnEnterOrSpaceMode&&t&&_r(e,n)&&a(i).each(function(t){t(e,i,u),n.stop()})},function(t){r.stop()})}),Pt(_i(),function(t,e){c(t,e,o,i,u).each(function(t){e.stop()})})];return iu(t.toArray().concat(e))}};return r}function Ff(t){function a(t,e){return 0<je(t.visibilitySelector.bind(function(t){return Iu(e,t)}).getOr(e))}function e(e,n,t){var o=n,r=G(ns(e.element,o.selector),function(t){return a(o,t)});Mt.from(r[o.firstTabstop]).each(function(t){n.focusManager.set(e,t)})}function o(o,t,r,i){var e,u=ns(o.element,r.selector);return(e=r).focusManager.get(o).bind(function(t){return Iu(t,e.selector)}).bind(function(t){return et(u,g(me,t)).bind(function(t){return e=o,n=r,i(u,t,function(t){return a(e=n,t=t)&&e.useTabstopAt(t);var e}).fold(function(){return n.cyclic?Mt.some(!0):Mt.none()},function(t){return n.focusManager.set(e,t),Mt.some(!0)});var e,n})})}var t=[zo("onEscape"),zo("onEnter"),S("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),S("firstTabstop",0),S("useTabstopAt",L),zo("visibilitySelector")].concat([t]),n=Dt([u(wl([Sl,s(Cf)]),function(t,e,n){return o(t,0,n,n.cyclic?vl:bl)}),u(s(Cf),function(t,e,n){return o(t,0,n,n.cyclic?yl:xl)}),u(s(Of),function(e,n,t){return t.onEscape.bind(function(t){return t(e,n)})}),u(wl([Mf,s(kf)]),function(e,n,t){return t.onEnter.bind(function(t){return t(e,n)})})]),r=Dt([]);return Af(t,Su.init,n,r,function(){return Mt.some(e)})}function If(t,e,n){return ll(n)&&s(_f)(e.event)?Mt.none():(Br(t,n,Hi()),Mt.some(!0))}function Rf(t,e){return Mt.some(!0)}function Vf(t,e,n){return n.execute(t,e,t.element)}function Pf(){var n=rc();return Cu({readState:function(){return n.get().map(function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,e){n.set({numRows:t,numColumns:e})},getNumRows:function(){return n.get().map(function(t){return t.numRows})},getNumColumns:function(){return n.get().map(function(t){return t.numColumns})}})}function Hf(i){return function(t,e,n,o){var r=i(t.element);return om(r,t,e,n,o)}}function zf(t,e){return Hf(mc(t,e))}function Nf(t,e){return Hf(mc(e,t))}function Lf(r){return function(t,e,n,o){return om(r,t,e,n,o)}}function Wf(t){return!((t=t.dom).offsetWidth<=0&&t.offsetHeight<=0)}function Uf(t,e,n){var o,t=G(ns(t,n),Wf);return et(o=t,function(t){return me(t,e)}).map(function(t){return{index:t,candidates:o}})}function jf(t,e){return et(t,function(t){return me(e,t)})}function Gf(e,t,n,o){return o(Math.floor(t/n),t%n).bind(function(t){t=t.row*n+t.column;return 0<=t&&t<e.length?Mt.some(e[t]):Mt.none()})}function Xf(o,t,r,i,u){return Gf(o,t,i,function(t,e){var n=t===r-1?o.length-t*i:i,e=ta(e,u,0,n-1);return Mt.some({row:t,column:e})})}function Yf(o,t,r,i,u){return Gf(o,t,i,function(t,e){var t=ta(t,u,0,r-1),n=t===r-1?o.length-t*i:i,e=La(e,0,n-1);return Mt.some({row:t,column:e})})}function qf(e,n,t){Fu(e.element,n.selector).each(function(t){n.focusManager.set(e,t)})}function Kf(r){return function(t,e,n,o){return Uf(t,e,n.selector).bind(function(t){return r(t.candidates,t.index,o.getNumRows().getOr(n.initSize.numRows),o.getNumColumns().getOr(n.initSize.numColumns))})}}function Jf(t,e,n){return n.captureTab?Mt.some(!0):Mt.none()}function $f(t,e,n,r){function i(t,e,n){var o;return(e=ta(e,r,0,n.length-1))===t?Mt.none():"button"===ie(o=n[e])&&"disabled"===Be(o,"disabled")?i(t,e,n):Mt.from(n[e])}return Uf(t,n,e).bind(function(t){var e=t.index,t=t.candidates;return i(e,e,t)})}function Qf(e,n,o){return(r=o).focusManager.get(e).bind(function(t){return Iu(t,r.selector)}).bind(function(t){return o.execute(e,n,t)});var r}function Zf(e,n,t){n.getInitial(e).orThunk(function(){return Fu(e.element,n.selector)}).each(function(t){n.focusManager.set(e,t)})}function td(t,e,n){return $f(t,n.selector,e,-1)}function ed(t,e,n){return $f(t,n.selector,e,1)}function nd(r){return function(t,e,n,o){return r(t,e,n,o).bind(function(){return n.executeOnMove?Qf(t,e,n):Mt.some(!0)})}}function od(t,e,n){return n.onEscape(t,e)}function rd(t,e,n){return Mt.from(t[e]).bind(function(t){return Mt.from(t[n]).map(function(t){return{rowIndex:e,columnIndex:n,cell:t}})})}function id(t,e,n,o){return rd(t,e,ta(n,o,0,t[e].length-1))}function ud(t,e,n,o){n=ta(n,o,0,t.length-1),o=t[n].length;return rd(t,n,La(e,0,o-1))}function ad(t,e,n,o){var r=t[e].length;return rd(t,e,La(n+o,0,r-1))}function cd(t,e,n,o){n=La(n+o,0,t.length-1),o=t[n].length;return rd(t,n,La(e,0,o-1))}function sd(e,n,t){n.previousSelector(e).orThunk(function(){var t=n.selectors;return Fu(e.element,t.cell)}).each(function(t){n.focusManager.set(e,t)})}function ld(t,o){return function(e,n,i){var u=i.cycles?t:o;return Iu(n,i.selectors.row).bind(function(t){return jf(ns(t,i.selectors.cell),n).bind(function(o){var r=ns(e,i.selectors.row);return jf(r,t).bind(function(t){e=i;var e,n=F(r,function(t){return ns(t,e.selectors.cell)});return u(n,t,o).map(function(t){return t.cell})})})})}}function fd(e,n,o){return o.focusManager.get(e).bind(function(t){return o.execute(e,n,t)})}function dd(e,n,t){Fu(e.element,n.selector).each(function(t){n.focusManager.set(e,t)})}function md(t,e,n){return $f(t,n.selector,e,-1)}function gd(t,e,n){return $f(t,n.selector,e,1)}function pd(t,e,n,o){o=t.getSystem().build(o);Rl(t,o,n)}function hd(t,e,n,o){tt(Zd(t),function(t){return me(o.element,t.element)}).each(Cs)}function vd(e,t,n,r,o){var i=Zd(e);return Mt.from(i[r]).map(function(t){return hd(e,0,0,t),o.each(function(t){pd(e,0,function(t,e){var n,o=e;Se(n=t,r).fold(function(){$n(n,o)},function(t){Qe(t,o)})},t)}),t})}function Lt(t,e){return{key:t,value:{config:{},me:(t=t,e=iu(e),va({fields:[y("enabled")],name:t,active:{events:Dt(e)}})),configAsRaw:Dt({}),initialConfig:{},state:Su}}}function bd(t,e){e.ignore||(xa(t.element),e.onFocus(t))}function yd(t,e,n){e=e.aria;e.update(t,e,n.get())}function xd(e,t,n){t.toggleClass.each(function(t){(n.get()?ti:ei)(e.element,t)})}function wd(t,e,n){Jd(t,e,n,!n.get())}function Sd(t,e,n){n.set(!0),xd(t,e,n),yd(t,e,n)}function Cd(t,e,n){n.set(!1),xd(t,e,n),yd(t,e,n)}function kd(t,e,n){Jd(t,e,n,e.selected)}function Od(){function t(t,e){e.stop(),Dr(t)}return[Pt(Di(),t),Pt(Ni(),t),Hr(gi()),Hr(bi())]}function _d(t){return iu(nt([t.map(function(n){return su(function(t,e){n(t),e.stop()})}).toArray(),Od()]))}function Td(t){(Ca(t.element).isNone()||jt.isFocused(t))&&(jt.isFocused(t)||jt.focus(t),Vt(t,dm,{item:t}))}function Ed(t){Vt(t,mm,{item:t})}function Dd(t,e){return t.x+t.width/2-e.width/2}function Bd(t,e){return t.x+t.width-e.width}function Md(t,e){return t.y+t.height-e.height}function Ad(t,e){return t.y+t.height/2-e.height/2}function Fd(t,e,n){return Zu(Bd(t,e),Md(t,e),n.insetSouthwest(),Va(),"southwest",ea(t,{right:0,bottom:3}),_m)}function Id(t,e,n){return Zu(t.x,Md(t,e),n.insetSoutheast(),Ra(),"southeast",ea(t,{left:1,bottom:3}),_m)}function Rd(t,e,n){return Zu(Bd(t,e),t.y,n.insetNorthwest(),Ia(),"northwest",ea(t,{right:0,top:2}),_m)}function Vd(t,e,n){return Zu(t.x,t.y,n.insetNortheast(),Fa(),"northeast",ea(t,{left:1,top:2}),_m)}function Pd(t,e,n){return Zu(Bd(t,e),Ad(t,e),n.insetEast(),Na(),"east",ea(t,{right:0}),_m)}function Hd(t,e,n){return Zu(t.x,Ad(t,e),n.insetWest(),za(),"west",ea(t,{left:1}),_m)}function zd(t){switch(t){case"north":return em;case"northeast":return Vd;case"northwest":return Rd;case"south":return nm;case"southeast":return Id;case"southwest":return Fd;case"east":return Pd;case"west":return Hd}}function Nd(t,e,n,o,r){return tc(o).map(zd).getOr(em)(t,e,n,o,r)}function Ld(t){switch(t){case"north":return nm;case"northeast":return Id;case"northwest":return Fd;case"south":return em;case"southeast":return Vd;case"southwest":return Rd;case"east":return Hd;case"west":return Pd}}function Wd(t,e,n,o,r){return tc(o).map(Ld).getOr(em)(t,e,n,o,r)}function Wt(t){var e=void 0!==t.uid&&yt(t,"uid")?t.uid:vu("memento");return{get:function(t){return t.getSystem().getByUid(e).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(e).toOptional()},asSpec:function(){return Bt(Bt({},t),{uid:e})}}}function Ud(t){return function(){return I(t,Mm).getOr("!not found!")}}function jd(t,e){var n,t=t.toLowerCase();return Dm.isRtl()&&(n=Xt(n=t,"-rtl")?n:n+"-rtl",ne(e,n))?n:t}function Gd(t,e){return I(e,jd(t,e))}function Xd(t,e){e=e();return Gd(t,e).getOrThunk(Ud(e))}function Yd(){return Lt("add-focusable",[uu(function(t){var t=t.element,e="svg",n=function(t){return fe(t,e)};tt(t.dom.childNodes,function(t){return n(At.fromDom(t))}).map(At.fromDom).each(function(t){return Ft(t,"focusable","false")})})])}function qd(t,e,n,o){r=e;var r=Dm.isRtl()&&ne(Bm,r)?["tox-icon--flip"]:[],e=I(n,jd(e,n)).or(o).getOrThunk(Ud(n));return{dom:{tag:t.tag,attributes:null!=(o=t.attributes)?o:{},classes:t.classes.concat(r),innerHtml:e},behaviours:Ht(M(M([],null!=(n=t.behaviours)?n:[],!0),[Yd()],!1))}}function Kd(t,e,n,o){return void 0===o&&(o=Mt.none()),qd(e,t,n(),o)}function Jd(t,e,n,o){(o?Sd:Cd)(t,e,n)}function $d(t,e,n){Ft(t.element,"aria-expanded",n)}function Qd(t){return"prepared"===t.type?Mt.some(t.menu):Mt.none()}(Gc=zl=zl||{}).OnFocusMode="onFocus",Gc.OnEnterOrSpaceMode="onEnterOrSpace",Gc.OnApiMode="onApi";function Zd(t,e){return t.components()}function tm(){function c(t){return n(t).bind(Qd)}function e(t){return I(s.get(),t)}function n(t){return I(l.get(),t)}var s=It({}),l=It({}),f=It({}),d=rc(),m=It({});return{setMenuBuilt:function(t,e){var n;l.set(Bt(Bt({},l.get()),((n={})[t]={type:"prepared",menu:e},n)))},setContents:function(t,e,n,o){d.set(t),s.set(n),l.set(e),m.set(o);t=n,r={},gt(o,function(t,e){Y(t,function(t){r[t]=e})}),u=ee(i=t,function(t,e){return{k:t,v:e}}),a=pt(u,function(t,e){return[e].concat(wm(r,i,u,e))});var r,i,u,a,e=pt(r,function(t){return I(a,t).getOr([t])});f.set(e)},expand:function(n){return I(s.get(),n).map(function(t){var e=I(f.get(),n).getOr([]);return[t].concat(e)})},refresh:function(t){return I(f.get(),t)},collapse:function(t){return I(f.get(),t).bind(function(t){return 1<t.length?Mt.some(t.slice(1)):Mt.none()})},lookupMenu:n,lookupItem:e,otherMenus:function(t){var e=m.get();return ut(Zt(e),t)},getPrimary:function(){return d.get().bind(c)},getMenus:function(){return l.get()},clear:function(){s.set({}),l.set({}),f.set({}),d.clear()},isClear:function(){return d.get().isNone()},getTriggeringPath:function(t,u){var a=G(e(t).toArray(),function(t){return c(t).isSome()});return I(f.get(),t).bind(function(t){for(var n=it(a.concat(t)),e=ot(n,function(t,e){return o=t,r=u,i=n.slice(0,e+1),c(o).bind(function(e){return n=o,vt(s.get(),function(t,e){return t===n}).bind(function(t){return r(t).map(function(t){return{triggeredMenu:e,triggeringItem:t,triggeringPath:i}})});var n}).fold(function(){return xt(d.get(),t)?[]:[Mt.none()]},function(t){return[Mt.some(t)]});var o,r,i}),o=[],r=0;r<e.length;r++){var i=e[r];if(!i.isSome())return Mt.none();o.push(i.getOrDie())}return Mt.some(o)})}}}function em(t,e,n){return Zu(Dd(t,e),t.y,n.insetNorth(),Pa(),"north",ea(t,{top:2}),_m)}function nm(t,e,n){return Zu(Dd(t,e),Md(t,e),n.insetSouth(),Ha(),"south",ea(t,{bottom:3}),_m)}var Jc=Ff(xr("cyclic",N)),sf=Ff(xr("cyclic",L)),ff=Af([S("execute",If),S("useSpace",!1),S("useEnter",!0),S("useControlEnter",!1),S("useDown",!1)],Su.init,function(t,e,n,o){var t=n.useSpace&&!ll(t.element)?_f:[],r=n.useEnter?kf:[],i=n.useDown?Bf:[];return[u(s(t.concat(r).concat(i)),Vf)].concat(n.useControlEnter?[u(wl([Cl,s(kf)]),Vf)]:[])},function(t,e,n,o){return n.useSpace&&!ll(t.element)?[u(s(_f),Rf)]:[]},function(){return Mt.none()}),lf=Object.freeze({__proto__:null,flatgrid:Pf,init:function(t){return t.state(t)}}),om=function(e,n,t,o,r){return o.focusManager.get(n).bind(function(t){return e(n.element,t,o,r)}).map(function(t){return o.focusManager.set(n,t),!0})},Aa=Lf,Gc=Lf,rm=Lf,im=Kf(function(t,e,n,o){return Xf(t,e,n,o,-1)}),um=Kf(function(t,e,n,o){return Xf(t,e,n,o,1)}),am=Kf(function(t,e,n,o){return Yf(t,e,n,o,-1)}),cm=Kf(function(t,e,n,o){return Yf(t,e,n,o,1)}),im=Af([y("selector"),S("execute",If),qu("onEscape"),S("captureTab",!1),lu()],Pf,Dt([u(s(Tf),zf(im,um)),u(s(Df),Nf(im,um)),u(s(Ef),Aa(am)),u(s(Bf),Gc(cm)),u(wl([Sl,s(Cf)]),Jf),u(wl([Mf,s(Cf)]),Jf),u(s(Of),function(t,e,n){return n.onEscape(t,e)}),u(s(_f.concat(kf)),function(e,n,o,t){return(r=o).focusManager.get(e).bind(function(t){return Iu(t,r.selector)}).bind(function(t){return o.execute(e,n,t)});var r})]),Dt([u(s(_f),Rf)]),function(){return Mt.some(qf)}),um=[y("selector"),S("getInitial",Mt.none),S("execute",If),qu("onEscape"),S("executeOnMove",!1),S("allowVertical",!0)],am=Dt([u(s(_f),Rf)]),cm=Af(um,Su.init,function(t,e,n,o){var r=Tf.concat(n.allowVertical?Ef:[]),n=Df.concat(n.allowVertical?Bf:[]);return[u(s(r),nd(zf(td,ed))),u(s(n),nd(Nf(td,ed))),u(s(kf),Qf),u(s(_f),Qf),u(s(Of),od)]},am,function(){return Mt.some(Zf)}),um=[Vo("selectors",[y("row"),y("cell")]),S("cycles",!0),S("previousSelector",Mt.none),S("execute",If)],am=ld(function(t,e,n){return id(t,e,n,-1)},function(t,e,n){return ad(t,e,n,-1)}),sm=ld(function(t,e,n){return id(t,e,n,1)},function(t,e,n){return ad(t,e,n,1)}),lm=ld(function(t,e,n){return ud(t,n,e,-1)},function(t,e,n){return cd(t,n,e,-1)}),fm=ld(function(t,e,n){return ud(t,n,e,1)},function(t,e,n){return cd(t,n,e,1)}),am=Dt([u(s(Tf),zf(am,sm)),u(s(Df),Nf(am,sm)),u(s(Ef),Aa(lm)),u(s(Bf),Gc(fm)),u(s(_f.concat(kf)),function(e,n,o){return Ca(e.element).bind(function(t){return o.execute(e,n,t)})})]),sm=Dt([u(s(_f),Rf)]),Aa=Af(um,Su.init,am,sm,function(){return Mt.some(sd)}),lm=[y("selector"),S("execute",If),S("moveOnTab",!1)],Gc=Dt([u(s(Ef),rm(md)),u(s(Bf),rm(gd)),u(wl([Sl,s(Cf)]),function(t,e,n,o){return n.moveOnTab?rm(md)(t,e,n,o):Mt.none()}),u(wl([Mf,s(Cf)]),function(t,e,n,o){return n.moveOnTab?rm(gd)(t,e,n,o):Mt.none()}),u(s(kf),fd),u(s(_f),fd)]),fm=Dt([u(s(_f),Rf)]),um=Af(lm,Su.init,Gc,fm,function(){return Mt.some(dd)}),am=Af([qu("onSpace"),qu("onEnter"),qu("onShiftEnter"),qu("onLeft"),qu("onRight"),qu("onTab"),qu("onShiftTab"),qu("onUp"),qu("onDown"),qu("onEscape"),S("stopSpaceKeyup",!1),zo("focusIn")],Su.init,function(t,e,n){return[u(s(_f),n.onSpace),u(wl([Mf,s(kf)]),n.onEnter),u(wl([Sl,s(kf)]),n.onShiftEnter),u(wl([Sl,s(Cf)]),n.onShiftTab),u(wl([Mf,s(Cf)]),n.onTab),u(s(Ef),n.onUp),u(s(Bf),n.onDown),u(s(Tf),n.onLeft),u(s(Df),n.onRight),u(s(_f),n.onSpace),u(s(Of),n.onEscape)]},function(t,e,n){return n.stopSpaceKeyup?[u(s(_f),Rf)]:[]},function(t){return t.focusIn}),sm=Jc.schema(),lm=sf.schema(),Gc=cm.schema(),fm=im.schema(),Jc=Aa.schema(),sf=ff.schema(),cm=um.schema(),im=am.schema(),$=ba({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:sm,cyclic:lm,flow:Gc,flatgrid:fm,matrix:Jc,execution:sf,menu:cm,special:im}),name:"keying",active:{events:function(t,e){return t.handler.toEvents(t,e)}},apis:{focusIn:function(e,n,o){n.sendFocusIn(n).fold(function(){e.getSystem().triggerFocus(e.element,e.element)},function(t){t(e,n,o)})},setGridSize:function(t,e,n,o,r){yt(n,"setGridSize")?n.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:lf}),Ut=va({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(t,e,n,o){pd(t,0,$n,o)},prepend:function(t,e,n,o){pd(t,0,tn,o)},remove:hd,replaceAt:vd,replaceBy:function(e,t,n,o,r){return et(Zd(e),o).bind(function(t){return vd(e,0,0,t,r)})},set:function(e,t,n,o){ka(function(){var t=F(o,e.getSystem().build);xs(e,t)},e.element)},contents:Zd})}),Aa=Object.freeze({__proto__:null,focus:bd,blur:function(t,e){e.ignore||t.element.dom.blur()},isFocused:function(t){return wa(t.element)}}),ff=Object.freeze({__proto__:null,exhibit:function(t,e){return Kr(e.ignore?{}:{attributes:{tabindex:"-1"}})},events:function(n){return iu([Pt(Ii(),function(t,e){bd(t,n),e.stop()})].concat(n.stopMousedown?[Pt(bi(),function(t,e){e.event.prevent()})]:[]))}}),jt=va({fields:[t("onFocus"),S("stopMousedown",!1),S("ignore",!1)],name:"focusing",active:ff,apis:Aa}),um=Object.freeze({__proto__:null,onLoad:kd,toggle:wd,isOn:function(t,e,n){return n.get()},on:Sd,off:Cd,set:Jd}),am=Object.freeze({__proto__:null,exhibit:function(){return Kr({})},events:function(t,e){n=t,o=e,r=wd;var n,o,r,i=su(function(t){r(t,n,o)}),e=pa(t,e,kd);return iu(nt([t.toggleOnExecute?[i]:[],[e]]))}}),p=va({fields:[S("selected",!1),zo("toggleClass"),S("toggleOnExecute",!0),Xo("aria",{mode:"none"},Mo("mode",{pressed:[S("syncWithExpanded",!1),$u("update",function(t,e,n){Ft(t.element,"aria-pressed",n),e.syncWithExpanded&&$d(t,0,n)})],checked:[$u("update",function(t,e,n){Ft(t.element,"aria-checked",n)})],expanded:[$u("update",$d)],selected:[$u("update",function(t,e,n){Ft(t.element,"aria-selected",n)})],none:[$u("update",Et)]}))],name:"toggling",active:am,apis:um,state:{init:function(){var e=It(!1);return{get:function(){return e.get()},set:function(t){return e.set(t)},clear:function(){return e.set(!1)},readState:function(){return e.get()}}}}}),dm="alloy.item-hover",mm="alloy.item-focus",gm=Dt(dm),pm=Dt(mm),sm=[y("data"),y("components"),y("dom"),S("hasSubmenu",!1),zo("toggling"),Ql("itemBehaviours",[p,jt,$,zt]),S("ignoreFocus",!1),S("domModification",{}),$u("builder",function(t){return{dom:t.dom,domModification:Bt(Bt({},t.domModification),{attributes:Bt(Bt(Bt({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Zl(t.itemBehaviours,[t.toggling.fold(p.revoke,function(t){return p.config(Bt({aria:{mode:"checked"}},t))}),jt.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Ed(t)}}),$.config({mode:"execution"}),zt.config({store:{mode:"memory",initialValue:t.data}}),Lt("item-type-events",M(M([],Od(),!0),[Pt(Si(),Td),Pt(zi(),jt.focus)],!1))]),components:t.components,eventOrder:t.eventOrder}}),S("eventOrder",{})],lm=[y("dom"),y("components"),$u("builder",function(t){return{dom:t.dom,components:t.components,events:iu([Pt(zi(),function(t,e){e.stop()})])}})],hm=Dt("item-widget"),vm=Dt([df({name:"widget",overrides:function(e){return{behaviours:Ht([zt.config({store:{mode:"manual",getValue:function(t){return e.data},setValue:Et}})])}}})]),bm=Mo("type",{widget:[y("uid"),y("data"),y("components"),y("dom"),S("autofocus",!1),S("ignoreFocus",!1),Ql("widgetBehaviours",[zt,jt,$]),S("domModification",{}),il(vm()),$u("builder",function(n){function o(t){return Qs(t,n,"widget").map(function(t){return $.focusIn(t),t})}function t(t,e){return ll(e.event.target)||n.autofocus&&e.setSource(t.element),Mt.none()}var e=Js(hm(),n,vm()),e=$s(hm(),n,e.internals());return{dom:n.dom,components:e,domModification:n.domModification,events:iu([su(function(t,e){o(t).each(function(t){e.stop()})}),Pt(Si(),Td),Pt(zi(),function(t,e){n.autofocus?o(t):jt.focus(t)})]),behaviours:Zl(n.widgetBehaviours,[zt.config({store:{mode:"memory",initialValue:n.data}}),jt.config({ignore:n.ignoreFocus,onFocus:function(t){Ed(t)}}),$.config({mode:"special",focusIn:n.autofocus?function(t){o(t)}:Qa(),onLeft:t,onRight:t,onEscape:function(t,e){return jt.isFocused(t)||n.autofocus?(n.autofocus&&e.setSource(t.element),Mt.none()):(jt.focus(t),Mt.some(!0))}})])}})],item:sm,separator:lm}),Gc=Dt([Xc({factory:{sketch:function(t){t=Bo("menu.spec item",bm,t);return t.builder(t)}},name:"items",unit:"item",defaults:function(t,e){return ne(e,"uid")?e:Bt(Bt({},e),{uid:vu("item")})},overrides:function(t,e){return{type:e.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),fm=Dt([y("value"),y("items"),y("dom"),y("components"),S("eventOrder",{}),Hs("menuBehaviours",[wf,zt,J,$]),Xo("movement",{mode:"menu",moveOnTab:!0},Mo("mode",{grid:[lu(),$u("config",function(t,e){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:e.initSize.numColumns,numRows:e.initSize.numRows},focusManager:t.focusManager}})],matrix:[$u("config",function(t,e){return{mode:"matrix",selectors:{row:e.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}}),y("rowSelector")],menu:[S("moveOnTab",!0),$u("config",function(t,e){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:e.moveOnTab,focusManager:t.focusManager}})]})),Fo("markers",mu()),S("fakeFocus",!1),S("focusManager",Ol()),t("onHighlight")]),ym=Dt("alloy.menu-focus"),xm=sl({name:"Menu",configFields:fm(),partFields:Gc(),factory:function(t,e,n,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Ns(t.menuBehaviours,[wf.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),zt.config({store:{mode:"memory",initialValue:t.value}}),J.config({find:Mt.some}),$.config(t.movement.config(t,t.movement))]),events:iu([Pt(pm(),function(e,n){var t=n.event;e.getSystem().getByDom(t.target).each(function(t){wf.highlight(e,t),n.stop(),Vt(e,ym(),{menu:e,item:t})})}),Pt(gm(),function(t,e){e=e.event.item;wf.highlight(t,e)})]),components:e,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),wm=function(n,o,r,t){return I(r,t).bind(function(t){return I(n,t).bind(function(t){var e=wm(n,o,r,t);return Mt.some([t].concat(e))})}).getOr([])},Sm=Qd,Cm=Dt("collapse-item"),km=cl({name:"TieredMenu",configFields:[Ju("onExecute"),Ju("onEscape"),Ku("onOpenMenu"),Ku("onOpenSubmenu"),t("onRepositionMenu"),t("onCollapseMenu"),S("highlightImmediately",!0),Vo("data",[y("primary"),y("menus"),y("expansions")]),S("fakeFocus",!1),t("onHighlight"),t("onHover"),Gu(),y("dom"),S("navigateOnHover",!0),S("stayInDom",!1),Hs("tmenuBehaviours",[$,wf,J,Ut]),S("eventOrder",{})],apis:{collapseMenu:function(t,e){t.collapseMenu(e)},highlightPrimary:function(t,e){t.highlightPrimary(e)},repositionMenus:function(t,e){t.repositionMenus(e)}},factory:function(c,t){function r(t){return zt.getValue(t).value}function u(e,t){wf.highlight(e,t),wf.getHighlighted(t).orThunk(function(){return wf.getFirst(t)}).each(function(t){Br(e,t.element,zi())})}function i(e,t){return wt(F(t,function(t){return e.lookupMenu(t).bind(function(t){return"prepared"===t.type?Mt.some(t.menu):Mt.none()})}))}function a(e,t,n){t=i(t,t.otherMenus(n));Y(t,function(t){ri(t.element,[c.markers.backgroundMenu]),c.stayInDom||Ut.remove(e,t)})}function s(t,n){var e;gt((e=t,o.get().getOrThunk(function(){var n={},t=G(ns(e.element,"."+c.markers.item),function(t){return"true"===Be(t,"aria-haspopup")});return Y(t,function(t){e.getSystem().getByDom(t).each(function(t){var e=r(t);n[e]=t})}),o.set(n),n})),function(t,e){e=$t(n,e);Ft(t.element,"aria-expanded",e)})}function l(n,o,r){return Mt.from(r[0]).bind(function(t){return o.lookupMenu(t).bind(function(t){var e;return"notbuilt"===t.type?Mt.none():(t=t.menu,e=i(o,r.slice(1)),Y(e,function(t){ti(t.element,c.markers.backgroundMenu)}),Wn(t.element)||Ut.append(n,Tu(t)),ri(t.element,[c.markers.backgroundMenu]),u(n,t),a(n,o,r),Mt.some(t))})})}var f,o=rc(),d=tm();function m(i,u,a){var t;return void 0===a&&(a=f.HighlightSubmenu),u.hasConfigured(Nt)&&Nt.isDisabled(u)?Mt.some(u):(t=r(u),d.expand(t).bind(function(r){return s(i,r),Mt.from(r[0]).bind(function(o){return d.lookupMenu(o).bind(function(t){e=i,n=o;var e,n,t="notbuilt"!==(t=t).type?t.menu:(e=e.getSystem().build(t.nbMenu()),d.setMenuBuilt(n,e),e);return Wn(t.element)||Ut.append(i,Tu(t)),c.onOpenSubmenu(i,u,t,it(r)),a===f.HighlightSubmenu?(wf.highlightFirst(t),l(i,d,r)):(wf.dehighlightAll(t),Mt.some(u))})})}))}function n(e,n){var t=r(n);return d.collapse(t).bind(function(t){return s(e,t),l(e,d,t).map(function(t){return c.onCollapseMenu(e,n,t),t})})}function e(n){return function(e,t){return Iu(t.getSource(),"."+c.markers.item).bind(function(t){return e.getSystem().getByDom(t).toOptional().bind(function(t){return n(e,t).map(L)})})}}function g(t){return wf.getHighlighted(t).bind(wf.getHighlighted)}f={HighlightSubmenu:0,0:"HighlightSubmenu",HighlightParent:1,1:"HighlightParent"};var p=iu([Pt(ym(),function(e,n){var t=n.event.item;d.lookupItem(r(t)).each(function(){var t=n.event.menu,t=(wf.highlight(e,t),r(n.event.item));d.refresh(t).each(function(t){return a(e,d,t)})})}),su(function(e,t){t=t.event.target;e.getSystem().getByDom(t).each(function(t){0===r(t).indexOf("collapse-item")&&n(e,t),m(e,t,f.HighlightSubmenu).fold(function(){c.onExecute(e,t)},Et)})}),uu(function(e,t){var n,o,r,i;o=n=e,r=c.data.primary,n=pt(c.data.menus,function(t,e){function n(){return xm.sketch(Bt(Bt({},t),{value:e,markers:c.markers,fakeFocus:c.fakeFocus,onHighlight:c.onHighlight,focusManager:(c.fakeFocus?_l:Ol)()}))}return e===r?{type:"prepared",menu:o.getSystem().build(n())}:{type:"notbuilt",nbMenu:n}}),i=pt(c.data.menus,function(t,e){return ot(t.items,function(t){return"separator"===t.type?[]:[t.data.value]})}),d.setContents(c.data.primary,n,c.data.expansions,i),d.getPrimary().each(function(t){Ut.append(e,Tu(t)),c.onOpenMenu(e,t),c.highlightImmediately&&u(e,t)})})].concat(c.navigateOnHover?[Pt(gm(),function(t,e){var e=e.event.item,n=t,o=r(e);d.refresh(o).bind(function(t){return s(n,t),l(n,d,t)}),m(t,e,f.HighlightParent),c.onHover(t,e)})]:[])),h={collapseMenu:function(e){g(e).each(function(t){n(e,t)})},highlightPrimary:function(e){d.getPrimary().each(function(t){u(e,t)})},repositionMenus:function(n){d.getPrimary().bind(function(e){return g(n).bind(function(t){var t=r(t),n=wt(F(bt(d.getMenus()),Sm));return d.getTriggeringPath(t,function(t){return e=t,mt(n,function(t){return t.getSystem().isConnected()?tt(wf.getCandidates(t),function(t){return r(t)===e}):Mt.none()});var e})}).map(function(t){return{primary:e,triggeringPath:t}})}).fold(function(){Mt.from(n.components()[0]).filter(function(t){return"menu"===Be(t.element,"role")}).each(function(t){c.onRepositionMenu(n,t,[])})},function(t){var e=t.primary,t=t.triggeringPath;c.onRepositionMenu(n,e,t)})}};return{uid:c.uid,dom:c.dom,markers:c.markers,behaviours:Ns(c.tmenuBehaviours,[$.config({mode:"special",onRight:e(function(t,e){return ll(e.element)?Mt.none():m(t,e,f.HighlightSubmenu)}),onLeft:e(function(t,e){return ll(e.element)?Mt.none():n(t,e)}),onEscape:e(function(t,e){return n(t,e).orThunk(function(){return c.onEscape(t,e).map(function(){return t})})}),focusIn:function(e,t){d.getPrimary().each(function(t){Br(e,t.element,zi())})}}),wf.config({highlightClass:c.markers.selectedMenu,itemClass:c.markers.menu}),J.config({find:function(t){return wf.getHighlighted(t)}}),Ut.config({})]),eventOrder:c.eventOrder,apis:h,events:p}},extraApis:{tieredData:function(t,e,n){return{primary:t,menus:e,expansions:n}},singleData:function(t,e){return{primary:t,menus:wr(t,e),expansions:{}}},collapseItem:function(t){return{value:O(Cm()),meta:{text:t}}}}}),Om=cl({name:"InlineView",configFields:[y("lazySink"),t("onShow"),t("onHide"),Uo("onEscape"),Hs("inlineBehaviours",[m,zt,Za]),Go("fireDismissalEventInstead",[S("event",$i())]),Go("fireRepositionEventInstead",[S("event",mi())]),S("getRelated",Mt.none),S("isExtraPart",N),S("eventOrder",Mt.none)],factory:function(f,t){function e(n){m.isOpen(n)&&zt.getValue(n).each(function(t){switch(t.mode){case"menu":m.getState(n).each(km.repositionMenus);break;case"position":var e=f.lazySink(n).getOrDie();jl.positionWithinBounds(e,n,t.config,t.getBounds())}})}function o(t,e,n,o){i(t,e,n,function(){return o.map(function(t){return no(t)})})}function r(t,e,n,o){r=f,i=t,u=e,a=o,c="horizontal"===n.type?{layouts:{onLtr:ma,onRtl:ga}}:{};var r,i,u,a,c,e=km.sketch({dom:{tag:"div"},data:n.data,markers:n.menu.markers,highlightImmediately:n.menu.highlightImmediately,onEscape:function(){return m.close(i),r.onEscape.map(function(t){return t(i)}),Mt.some(!0)},onExecute:function(){return Mt.some(!0)},onOpenMenu:function(t,e){jl.positionWithinBounds(s().getOrDie(),e,u,a())},onOpenSubmenu:function(t,e,n,o){var r=s().getOrDie();jl.position(r,n,{anchor:Bt({type:"submenu",item:e},l(o))})},onRepositionMenu:function(t,e,n){var o=s().getOrDie();jl.positionWithinBounds(o,e,u,a()),Y(n,function(t){var e=l(t.triggeringPath);jl.position(o,t.triggeredMenu,{anchor:Bt({type:"submenu",item:t.triggeringItem},e)})})}});function s(){return r.lazySink(i)}function l(t){return 2===t.length?c:{}}m.open(t,e),zt.setValue(t,Mt.some({mode:"menu",menu:e}))}function i(t,e,n,o){var r=f.lazySink(t).getOrDie();m.openWhileCloaked(t,e,function(){return jl.positionWithinBounds(r,t,n,o())}),zt.setValue(t,Mt.some({mode:"position",config:n,getBounds:o}))}var n={setContent:function(t,e){m.setContent(t,e)},showAt:function(t,e,n){o(t,e,n,Mt.none())},showWithin:o,showWithinBounds:i,showMenuAt:function(t,e,n){r(t,e,n,Mt.none)},showMenuWithinBounds:r,hide:function(t){m.isOpen(t)&&(zt.setValue(t,Mt.none()),m.close(t))},getContent:function(t){return m.getState(t)},reposition:e,isOpen:m.isOpen};return{uid:f.uid,dom:f.dom,behaviours:Ns(f.inlineBehaviours,[m.config({isPartOf:function(t,e,n){return Vu(e,n)||(o=n,f.getRelated(t).exists(function(t){return Vu(t,o)}));var o},getAttachPoint:function(t){return f.lazySink(t).getOrDie()},onOpen:function(t){f.onShow(t)},onClose:function(t){f.onHide(t)}}),zt.config({store:{mode:"memory",initialValue:Mt.none()}}),Za.config({channels:Bt(Bt({},Ms(Bt({isExtraPart:t.isExtraPart},f.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),As(Bt(Bt({},f.fireRepositionEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})),{doReposition:e})))})]),eventOrder:f.eventOrder,apis:n}},apis:{showAt:function(t,e,n,o){t.showAt(e,n,o)},showWithin:function(t,e,n,o,r){t.showWithin(e,n,o,r)},showWithinBounds:function(t,e,n,o,r){t.showWithinBounds(e,n,o,r)},showMenuAt:function(t,e,n,o){t.showMenuAt(e,n,o)},showMenuWithinBounds:function(t,e,n,o,r){t.showMenuWithinBounds(e,n,o,r)},hide:function(t,e){t.hide(e)},isOpen:function(t,e){return t.isOpen(e)},getContent:function(t,e){return t.getContent(e)},setContent:function(t,e,n){t.setContent(e,n)},reposition:function(t,e){t.reposition(e)}}}),_m="layout-inset",Tm=tinymce.util.Tools.resolve("tinymce.util.Delay"),Em=cl({name:"Button",factory:function(t){function e(e){return I(t.dom,"attributes").bind(function(t){return I(t,e)})}var n=_d(t.action),o=t.dom.tag;return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:Zl(t.buttonBehaviours,[jt.config({}),$.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:"button"!==o?{role:e("role").getOr("button")}:(n=e("type").getOr("button"),o=e("role").map(function(t){return{role:t}}).getOr({}),Bt({type:n},o))},eventOrder:t.eventOrder}},configFields:[S("uid",void 0),y("dom"),S("components",[]),Ql("buttonBehaviours",[jt,$]),zo("action"),zo("role"),S("eventOrder",{})]}),Dm=tinymce.util.Tools.resolve("tinymce.util.I18n"),Bm={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},Mm="temporary-placeholder",Am={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Fm=cl({name:"Notification",factory:function(e){function n(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}}function o(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}}var t,r,i=Wt({dom:{tag:"p",innerHtml:e.translationProvider(e.text)},behaviours:Ht([Ut.config({})])}),u=Wt({dom:{tag:"div",classes:e.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[n(0)]},o(0)],behaviours:Ht([Ut.config({})])}),a={updateProgress:function(t,e){t.getSystem().isConnected()&&u.getOpt(t).each(function(t){Ut.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[n(e)]},o(e)])})},updateText:function(t,e){t.getSystem().isConnected()&&(t=i.get(t),Ut.set(t,[ci(e)]))}},c=nt([e.icon.toArray(),e.level.toArray(),e.level.bind(function(t){return Mt.from(Am[t])}).toArray()]),s=Wt(Em.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[Kd("close",{tag:"div",classes:["tox-icon"],attributes:{"aria-label":e.translationProvider("Close")}},e.iconProvider)],action:function(t){e.onAction(t)}})),l=[(c=c,t={tag:"div",classes:["tox-notification__icon"]},l=e.iconProvider,r=l(),qd(t,tt(c,function(t){return ne(r,jd(t,r))}).getOr(Mm),r,Mt.none())),{dom:{tag:"div",classes:["tox-notification__body"]},components:[i.asSpec()],behaviours:Ht([Ut.config({})])}];return{uid:e.uid,dom:{tag:"div",attributes:{role:"alert"},classes:e.level.map(function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]}).getOr(["tox-notification","tox-notification--in"])},behaviours:Ht([jt.config({}),Lt("notification-events",[Pt(Ci(),function(t){s.getOpt(t).each(jt.focus)})])]),components:l.concat(e.progress?[u.asSpec()]:[]).concat(e.closeButton?[s.asSpec()]:[]),apis:a}},configFields:[zo("level"),y("progress"),y("icon"),y("onAction"),y("text"),y("iconProvider"),y("translationProvider"),Jo("closeButton",!0)],apis:{updateProgress:function(t,e,n){t.updateProgress(e,n)},updateText:function(t,e,n){t.updateText(e,n)}}});function Im(n,o){function r(){l(i)||(clearTimeout(i),i=null)}var i=null;return{cancel:r,throttle:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];r(),i=setTimeout(function(){i=null,n.apply(null,t)},o)}}}function Rm(n,t,e,o,r){var i=Gm(n,function(t){return(e=n).isBlock(t=t)||$t(["BR","IMG","HR","INPUT"],t.nodeName)||"false"===e.getContentEditable(t);var e});return Mt.from(i.backwards(t,e,o,r))}function Vm(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")}function Pm(t){return""!==t&&-1!=="  \f\n\r\t\v".indexOf(t)}function Hm(t,e){return t.substring(e.length)}function zm(i,u,a,c){return void 0===c&&(c=0),Xm(At.fromDom(u.startContainer)).fold(function(){return t=i,o=a,r=void 0===c?0:c,(n=u).collapsed&&3===n.startContainer.nodeType?(e=t.getParent(n.startContainer,t.isBlock)||t.getRoot(),Rm(t,n.startContainer,n.startOffset,function(t,r,e){return function(t,e){for(var n=r-1;0<=n;n--){var o=t.charAt(n);if(Pm(o))return Mt.none();if(o===e)break}return Mt.some(n)}(e,o).getOr(r)},e).bind(function(t){var e=n.cloneRange();return e.setStart(t.container,t.offset),e.setEnd(n.endContainer,n.endOffset),e.collapsed||0!==(t=Vm(e)).lastIndexOf(o)||Hm(t,o).length<r?Mt.none():Mt.some({text:Hm(t,o),range:e,triggerChar:o})})):Mt.none();var t,n,o,r,e},function(t){var e=i.createRng(),t=(e.selectNode(t.dom),Vm(e));return Mt.some({range:e,text:Hm(t,a),triggerChar:a})})}function Nm(t,e){return{container:t,offset:e}}function Lm(t){return Eo("toolbarbutton",Qm,t)}function Wm(t){return Eo("ToggleButton",Zm,t)}function Um(n,t,o,r){void 0===r&&(r={});var t=t(),e=n.selection.getRng().startContainer.nodeValue,t=G(t.lookupByChar(o.triggerChar),function(t){return o.text.length>=t.minChars&&t.matches.getOrThunk(function(){return e=n.dom,function(t){t=qm(t.startContainer,t.startOffset);return!Rm(e,t.container,t.offset,function(t,e){return 0===e?-1:e},e.getRoot()).filter(function(t){return!Pm(t.container.data.charAt(t.offset-1))}).isSome()};var e})(o.range,e,o.text)});return 0===t.length?Mt.none():(t=Ym.all(F(t,function(e){return e.fetch(o.text,e.maxResults,r).then(function(t){return{matchText:o.text,items:t,columns:e.columns,onAction:e.onAction,highlightOn:e.highlightOn}})})),Mt.some({lookupData:t,context:o}))}function jm(t){var e;return 3===t.nodeType?Nm(t,t.data.length):0<(e=t.childNodes).length?jm(e[e.length-1]):Nm(t,e.length)}var Gm=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),Xm=function(t){return Iu(t,"[data-mce-autocompleter]")},Ym=tinymce.util.Tools.resolve("tinymce.util.Promise"),qm=function(t,e){var n=t.childNodes;return 0<n.length&&e<n.length?qm(n[e],0):0<n.length&&1===t.nodeType&&n.length===e?jm(n[n.length-1]):Nm(t,e)},Km=w([e("type"),Wo("text")]),Jm=w([S("type","autocompleteitem"),S("active",!1),S("disabled",!1),S("meta",{}),e("value"),Wo("text"),Wo("icon")]),$m=w([e("type"),e("ch"),Yo("minChars",1),S("columns",1),Yo("maxResults",10),Uo("matches"),Ro("fetch"),Ro("onAction"),Qo("highlightOn",[],gr)]),Jc=[Jo("disabled",!1),Wo("tooltip"),Wo("icon"),Wo("text"),$o("onSetup",function(){return Et})],Qm=w([e("type"),Ro("onAction")].concat(Jc)),sf=[Jo("active",!1)].concat(Jc),Zm=w(sf.concat([e("type"),Ro("onAction")])),cm=[$o("predicate",N),Ko("scope","node",["node","editor"]),Ko("position","selection",["node","selection","line"])],im=Jc.concat([S("type","contextformbutton"),S("primary",!1),Ro("onAction"),xr("original",x)]),lf=sf.concat([S("type","contextformbutton"),S("primary",!1),Ro("onAction"),xr("original",x)]),ff=Jc.concat([S("type","contextformbutton")]),Aa=sf.concat([S("type","contextformtogglebutton")]),am=Mo("type",{contextformbutton:im,contextformtogglebutton:lf}),tg=w([S("type","contextform"),$o("initValue",Dt("")),Wo("label"),Ho("commands",am),No("launch",Mo("type",{contextformbutton:ff,contextformtogglebutton:Aa}))].concat(cm)),eg=w([S("type","contexttoolbar"),e("items")].concat(cm));function ng(t){return I(Dg,t).getOr(Tg)}function og(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===t?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}}function rg(t){var e=og(t);return{backgroundMenu:e.backgroundMenu,selectedMenu:e.selectedMenu,menu:e.menu,selectedItem:e.selectedItem,item:ng(t)}}function ig(t,e,n){return{dom:{tag:"div",classes:nt([[og(n).tieredMenu]])},markers:rg(n)}}function ug(e,n){return function(t){return F(U(t,n),function(t){return{dom:e,components:t}})}}function ag(t,n){var o=[],r=[];return Y(t,function(t,e){n(t,e)&&(0<r.length&&o.push(r),r=[],!ne(t.dom,"innerHtml"))||r.push(t)}),0<r.length&&o.push(r),F(o,function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}})}function cg(e,n){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===e?["tox-collection--list"]:["tox-collection--grid"])},components:[xm.parts.items({preprocess:function(t){return"auto"!==e&&1<e?ug({tag:"div",classes:["tox-collection__group"]},e)(t):ag(t,function(t,e){return"separator"===n[e].type})}})]}}function sg(t){return V(t,function(t){return"icon"in t&&void 0!==t.icon})}function lg(t){return console.error(br(t)),console.log(t),Mt.none()}function fg(t,e,n,o,r){var i;return"color"===r?{value:t,dom:(i={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[xm.parts.items({preprocess:"auto"!==o?ug({tag:"div",classes:["tox-swatches__row"]},o):x})]}]}).dom,components:i.components,items:n}:"normal"===r&&"auto"===o?{value:t,dom:(i=cg(o,n)).dom,components:i.components,items:n}:"normal"===r&&1===o?{value:t,dom:(i=cg(1,n)).dom,components:i.components,items:n}:"normal"===r?{value:t,dom:(i=cg(o,n)).dom,components:i.components,items:n}:"listpreview"!==r||"auto"===o?{value:t,dom:{tag:"div",classes:nt([[(r=og(r)).menu,"tox-menu-"+o+"-column"],e?[r.hasIcons]:[]])},components:Pg,items:n}:{value:t,dom:(i={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[xm.parts.items({preprocess:ug({tag:"div",classes:["tox-collection__group"]},o)})]}).dom,components:i.components,items:n}}function dg(t,n,e){var o=ns(t.element,"."+e);return 0<o.length?(t=et(o,function(t){var t=t.dom.getBoundingClientRect().top,e=o[0].dom.getBoundingClientRect().top;return Math.abs(t-e)>n}).getOr(o.length),Mt.some({numColumns:t,numRows:Math.ceil(o.length/t)})):Mt.none()}function mg(t,e,n){t.getSystem().broadcastOn([Yg],{})}function gg(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))}function pg(t){return t.getParam("width",$g.DOM.getStyle(t.getElement(),"width"))}function hg(t){return Mt.from(t.getParam("min_width")).filter(Q)}function vg(t){return Mt.from(t.getParam("min_height")).filter(Q)}function bg(t){return Mt.from(t.getParam("max_width")).filter(Q)}function yg(t){return Mt.from(t.getParam("max_height")).filter(Q)}function xg(t){return!1!==t.getParam("menubar",!0,"boolean")}function wg(t){var e=t.getParam("toolbar",!0),n=!0===e,o=P(e),e=c(e)&&0<e.length;return!Zg(t)&&(e||o||n)}function Sg(e){var t=G(W(9,function(t){return e.getParam("toolbar"+(t+1),!1,"string")}),function(t){return"string"==typeof t});return 0<t.length?Mt.some(t):Mt.none()}um={CLOSE_ON_EXECUTE:0,0:"CLOSE_ON_EXECUTE",BUBBLE_TO_SANDBOX:1,1:"BUBBLE_TO_SANDBOX"};function Cg(t){return e=O("unnamed-events"),Ht([Lt(e,t)]);var e}var kg,Og,_g=um,Tg="tox-menu-nav__js",Eg="tox-collection__item",Dg={normal:Tg,color:"tox-swatch"},Bg="tox-collection__item--enabled",Mg="tox-collection__item-icon",Ag="tox-collection__item-label",Fg="tox-collection__item-caret",Ig="tox-collection__item--active",Rg="tox-collection__item-container",Vg="tox-collection__item-container--row",Pg=[xm.parts.items({})],sm=[e("type"),e("src"),Wo("alt"),Qo("classes",[],gr)],Hg=w(sm),lm=[e("type"),e("text"),Wo("name"),Qo("classes",["tox-collection__item-label"],gr)],zg=w(lm),lu=xo(function(){return Oo("type",{cardimage:Hg,cardtext:zg,cardcontainer:Ng})}),Ng=w([e("type"),qo("direction","horizontal"),qo("align","left"),qo("valign","middle"),Ho("items",lu)]),mu=[Jo("disabled",!1),Wo("text"),Wo("shortcut"),yr("value","value",fo(function(){return O("menuitem-value")}),dr()),S("meta",{})],Lg=w([e("type"),Wo("label"),Ho("items",lu),$o("onSetup",function(){return Et}),$o("onAction",Et)].concat(mu)),Wg=w([e("type"),Jo("active",!1),Wo("icon")].concat(mu)),fm=[e("type"),e("fancytype"),$o("onAction",Et)],Ug=Mo("fancytype",{inserttable:[S("initData",{})].concat(fm),colorswatch:[Zo("initData",{},[Jo("allowCustomColors",!0),jo("colors",dr())])].concat(fm)}),jg=w([e("type"),$o("onSetup",function(){return Et}),$o("onAction",Et),Wo("icon")].concat(mu)),Gg=w([e("type"),Ro("getSubmenuItems"),$o("onSetup",function(){return Et}),Wo("icon")].concat(mu)),Xg=w([e("type"),Wo("icon"),Jo("active",!1),$o("onSetup",function(){return Et}),Ro("onAction")].concat(mu)),Yg=O("tooltip.exclusive"),qg=O("tooltip.show"),Kg=O("tooltip.hide"),Gc=Object.freeze({__proto__:null,hideAllExclusive:mg,setComponents:function(t,e,n,o){n.getTooltip().each(function(t){t.getSystem().isConnected()&&Ut.set(t,o)})}}),mi=Object.freeze({__proto__:null,events:function(r,i){function n(e){i.getTooltip().each(function(t){Cs(t),r.onHide(e,t),i.clearTooltip()}),i.clearTimer()}return iu(nt([[Pt(qg,function(o){i.resetTimer(function(){var t,e,n=o;i.isShowing()||(mg(n),t=r.lazySink(n).getOrDie(),e=n.getSystem().build({dom:r.tooltipDom,components:r.tooltipComponents,events:iu("normal"===r.mode?[Pt(Si(),function(t){Rt(n,qg)}),Pt(xi(),function(t){Rt(n,Kg)})]:[]),behaviours:Ht([Ut.config({})])}),i.setTooltip(e),ws(t,e),r.onShow(n,e),jl.position(t,e,{anchor:r.anchor(n)}))},r.delay)}),Pt(Kg,function(t){i.resetTimer(function(){n(t)},r.delay)}),Pt(Pi(),function(t,e){e.universal||$t(e.channels,Yg)&&n(t)}),au(function(t){n(t)})],"normal"===r.mode?[Pt(Ci(),function(t){Rt(t,qg)}),Pt(Ri(),function(t){Rt(t,Kg)}),Pt(Si(),function(t){Rt(t,qg)}),Pt(xi(),function(t){Rt(t,Kg)})]:[Pt(nu(),function(t,e){Rt(t,qg)}),Pt(ou(),function(t){Rt(t,Kg)})]]))}}),Jg=va({fields:[y("lazySink"),y("tooltipDom"),S("exclusive",!0),S("tooltipComponents",[]),S("delay",300),Ko("mode","normal",["normal","follow-highlight"]),S("anchor",function(t){return{type:"hotspot",hotspot:t,layouts:{onLtr:Dt([qa,Ya,Ua,Ga,ja,Xa]),onRtl:Dt([qa,Ya,Ua,Ga,ja,Xa])}}}),t("onHide"),t("onShow")],name:"tooltipping",active:mi,state:Object.freeze({__proto__:null,init:function(){function n(){o.on(clearTimeout)}var o=rc(),t=rc(),e=Dt("not-implemented");return Cu({getTooltip:t.get,isShowing:t.isSet,setTooltip:t.set,clearTooltip:t.clear,clearTimer:n,resetTimer:function(t,e){n(),o.set(setTimeout(t,e))},readState:e})}}),apis:Gc}),$g=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Qg=tinymce.util.Tools.resolve("tinymce.EditorManager"),Zg=function(t){return Sg(t).fold(function(){return 0<t.getParam("toolbar",[],"string[]").length},L)};function tp(t){return t.getParam("toolbar_mode","","string")}function ep(t){return t.getParam("toolbar_location",Og.auto,"string")}function np(t){return ep(t)===Og.bottom}function op(t){var e;return t.inline?0<(e=t.getParam("fixed_toolbar_container","","string")).length?Fu(Un(),e):(e=t.getParam("fixed_toolbar_container_target"),_(e)?Mt.some(At.fromDom(e)):Mt.none()):Mt.none()}function rp(t){return t.inline&&op(t).isSome()}function ip(t){return op(t).getOrThunk(function(){return _e(Ln(At.fromDom(t.getElement())))})}function up(t){return t.inline&&!xg(t)&&!wg(t)&&!Zg(t)}function ap(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!rp(t)&&!up(t)}function cp(t,e){var n=t.outerContainer.element;e&&(t.mothership.broadcastOn([Yl()],{target:n}),t.uiMothership.broadcastOn([Yl()],{target:n})),t.mothership.broadcastOn([Up],{readonly:e}),t.uiMothership.broadcastOn([Up],{readonly:e})}function sp(t,e){t.on("init",function(){t.mode.isReadOnly()&&cp(e,!0)}),t.on("SwitchMode",function(){return cp(e,t.mode.isReadOnly())}),t.getParam("readonly",!1,"boolean")&&t.setMode("readonly")}function lp(){var t;return Za.config({channels:((t={})[Up]={schema:jp,onReceive:function(t,e){Nt.set(t,e.readonly)}},t)})}function fp(t,e){var n=t.getApi(e);return function(t){t(n)}}function dp(e,n){return uu(function(t){fp(e,t)(function(t){t=e.onSetup(t);T(t)&&n.set(t)})})}function mp(e,n){return au(function(t){return fp(e,t)(n.get())})}function gp(t,e,n,o){var r,i,u=It(Et);return{type:"item",dom:e.dom,components:qp(e.optComponents),data:t.data,eventOrder:Yp,hasSubmenu:t.triggersSubmenu,itemBehaviours:Ht([Lt("item-events",[(r=t,i=n,su(function(t,e){fp(r,t)(r.onAction),r.triggersSubmenu||i!==_g.CLOSE_ON_EXECUTE||(Rt(t,Wi()),e.stop())})),dp(t,u),mp(t,u)]),Nt.config({disabled:function(){return t.disabled||o.isDisabled()},disableClass:"tox-collection__item--state-disabled"}),lp(),Ut.config({})].concat(t.itemBehaviours))}}function pp(t){return{value:t.value,meta:Bt({text:t.text.getOr("")},t.meta)}}function hp(t,e,n){return Kd(t,{tag:"div",classes:n=void 0===n?[Mg]:n},e)}function vp(t){return{dom:{tag:"div",classes:[Ag]},components:[ci(Dm.translate(t))]}}function bp(t,e){return{dom:{tag:"div",classes:e,innerHtml:t}}}function yp(t,e){return{dom:{tag:"div",classes:[Ag]},components:[{dom:{tag:t.tag,styles:t.styles},components:[ci(Dm.translate(e))]}]}}function xp(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:(n=Kp.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},t=F(t.split("+"),function(t){var e=t.toLowerCase().trim();return ne(n,e)?n[e]:t}),Kp.mac?t.join(""):t.join("+"))}};var n}function wp(t){return hp("checkmark",t,["tox-collection__item-checkmark"])}function Sp(t){t=t.map(function(t){return{attributes:{title:Dm.translate(t)}}}).getOr({});return Bt({tag:"div",classes:[Tg,Eg]},t)}function Cp(t,e,n,o){return void 0===o&&(o=Mt.none()),"color"===t.presets?(r=e,i=o,f=t.ariaLabel,m=t.value,{dom:(l=t.iconContent.map(function(t){return e=r.icons,n=i,Gd(t,t=e()).or(n).getOrThunk(Ud(t));var e,n}).getOr(""),f={tag:"div",attributes:f.map(function(t){return{title:r.translate(t)}}).getOr({}),classes:["tox-swatch"]},Bt(Bt({},f),"custom"===m?{tag:"button",classes:M(M([],f.classes,!0),["tox-swatches__picker-btn"],!1),innerHtml:l}:"remove"===m?{classes:M(M([],f.classes,!0),["tox-swatch--remove"],!1),innerHtml:l}:{attributes:Bt(Bt({},f.attributes),{"data-mce-color":m}),styles:{"background-color":m}})),optComponents:[]}):(u=t,a=e,c=o,s={tag:"div",classes:[Mg]},l=n?u.iconContent.map(function(t){return Kd(t,s,a.icons,c)}).orThunk(function(){return Mt.some({dom:s})}):Mt.none(),f=u.checkMark,d=Mt.from(u.meta).fold(function(){return vp},function(t){return ne(t,"style")?g(yp,t.style):vp}),m=u.htmlContent.fold(function(){return u.textContent.map(d)},function(t){return Mt.some(bp(t,[Ag]))}),{dom:Sp(u.ariaLabel),optComponents:[l,m,u.shortcutContent.map(xp),f,u.caret]});var r,i,u,a,c,s,l,f,d,m}function kp(t,e){return I(t,"tooltipWorker").map(function(n){return[Jg.config({lazySink:e.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{type:"submenu",item:t,overrides:{maxHeightFunction:Oc}}},mode:"follow-highlight",onShow:function(e,t){n(function(t){Jg.setComponents(e,[li({element:At.fromDom(t)})])})}})]}).getOr([])}function Op(t,e){t=Dm.translate(t),t=$g.DOM.encode(t);return 0<e.length?(e=new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"),t.replace(e,function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"})):t}function _p(t){return{value:t}}function Tp(t){return Qp.test(t)||Zp.test(t)}function Ep(t){t=t.toString(16);return(1===t.length?"0"+t:t).toUpperCase()}function Dp(t){return _p(Ep(t.red)+Ep(t.green)+Ep(t.blue))}function Bp(t,e,n,o){return{red:t,green:e,blue:n,alpha:o}}function Mp(t){var e=parseInt(t,10);return e.toString()===t&&0<=e&&e<=255}function Ap(t){var e,n,o,r=(t.hue||0)%360,i=t.saturation/100,t=t.value/100,i=eh(0,th(i,1)),t=eh(0,th(t,1));if(0===i)return Bp(e=n=o=nh(255*t),n,o,1);var r=r/60,u=t*i,a=u*(1-Math.abs(r%2-1)),i=t-u;switch(Math.floor(r)){case 0:e=u,n=a,o=0;break;case 1:e=a,n=u,o=0;break;case 2:e=0,n=u,o=a;break;case 3:e=0,n=a,o=u;break;case 4:e=a,n=0,o=u;break;case 5:e=u,n=0,o=a;break;default:e=n=o=0}return Bp(e=nh(255*(e+i)),n=nh(255*(n+i)),o=nh(255*(o+i)),1)}function Fp(t){t={value:t.value.replace(Qp,function(t,e,n,o){return e+e+n+n+o+o})};t=null===(t=Zp.exec(t.value))?["FFFFFF","FF","FF","FF"]:t;return Bp(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),1)}function Ip(t,e,n,o){return Bp(parseInt(t,10),parseInt(e,10),parseInt(n,10),parseFloat(o))}function Rp(t){var e;return"transparent"===t?Mt.some(Bp(0,0,0,0)):null!==(e=oh.exec(t))?Mt.some(Ip(e[1],e[2],e[3],"1")):null!==(e=rh.exec(t))?Mt.some(Ip(e[1],e[2],e[3],e[4])):Mt.none()}function Vp(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"}function Pp(t,e){t.fire("ResizeContent",e)}function Hp(t,e,n){return{hue:t,saturation:e,value:n}}function zp(t){var e,n=0,o=t.red/255,r=t.green/255,t=t.blue/255,i=Math.min(o,Math.min(r,t)),u=Math.max(o,Math.max(r,t));return i===u?Hp(0,0,100*(n=i)):(e=(u-i)/u,n=u,Hp(Math.round(60*((o===i?3:t===i?1:5)-(o===i?r-t:t===i?o-r:t-o)/(u-i))),Math.round(100*e),Math.round(100*n)))}function Np(t){return Dp(Ap(t))}function Lp(n){return(Tp(t=n)?Mt.some({value:(t=t,(Ct(t,"#",0)?t.substring("#".length):t).toUpperCase())}):Mt.none()).orThunk(function(){return Rp(n).map(Dp)}).getOrThunk(function(){var t=document.createElement("canvas"),e=(t.height=1,t.width=1,t.getContext("2d")),t=(e.clearRect(0,0,t.width,t.height),e.fillStyle="#FFFFFF",e.fillStyle=n,e.fillRect(0,0,1,1),e.getImageData(0,0,1,1).data);return Dp(Bp(t[0],t[1],t[2],t[3]))});var t}function Wp(t){return Nt.config({disabled:t,disableClass:"tox-tbtn--disabled"})}(sf=kg=kg||{}).default="wrap",sf.floating="floating",sf.sliding="sliding",sf.scrolling="scrolling",(im=Og=Og||{}).auto="auto",im.top="top",im.bottom="bottom";var Up="silver.readonly",jp=w([Fo("readonly",pr)]),Gp=function(t){return Nt.config({disabled:t})},Xp=function(t){return Nt.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},Yp=((lf={})[Hi()]=["disabling","alloy.base.behaviour","toggling","item-events"],lf),qp=wt,Kp=tinymce.util.Tools.resolve("tinymce.Env"),Jp=function(t,i){return F(t,function(t){switch(t.type){case"cardcontainer":return n=Jp((e=t).items,i),o="vertical"===e.direction?"tox-collection__item-container--column":Vg,r="left"===e.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right",{dom:{tag:"div",classes:[Rg,o,r,function(){switch(e.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:n};case"cardimage":return o=t.src,{dom:{tag:"img",classes:t.classes,attributes:{src:o,alt:t.alt.getOr("")}}};case"cardtext":r=t.name.exists(function(t){return $t(i.cardText.highlightOn,t)})?Mt.from(i.cardText.matchText).getOr(""):"";return bp(Op(t.text,r),t.classes)}var e,n,o,r})},$p=Xs(hm(),vm()),Qp=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Zp=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,th=Math.min,eh=Math.max,nh=Math.round,oh=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,rh=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,ih=Bp(255,0,0,1),uh=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),ah="tinymce-custom-colors";function ch(t){return!1!==t.getParam("custom_colors")}function sh(t){t=t.getParam("color_map");if(void 0===t)return _h;for(var e=t,n=[],o=0;o<e.length;o+=2)n.push({text:e[o+1],value:"#"+Lp(e[o]).value,type:"choiceitem"});return n}function lh(t){Th.add(t)}function fh(t){e=sh(t).length;var e=Math.max(5,Math.ceil(Math.sqrt(e)));return t.getParam("color_cols",e,"number")}function dh(t){var e="choiceitem",n={type:e,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return t?[n,{type:e,text:"Custom color",icon:"color-picker",value:"custom"}]:[n]}function mh(e,n,t,o){"custom"===t?Dh(e)(function(t){t.each(function(t){lh(t),e.execCommand("mceApplyTextcolor",n,t),o(t)})},Eh):"remove"===t?(o(""),e.execCommand("mceRemoveTextcolor",n)):(o(t),e.execCommand("mceApplyTextcolor",n,t))}function gh(t,e){return t.concat(F(Th.state(),function(t){return{type:Oh,text:t,value:t}}).concat(dh(e)))}function ph(e,n){return function(t){t(gh(e,n))}}function hh(t,e,n){t.setIconFill("forecolor"===e?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",n)}function vh(r,n,i,t,o){r.ui.registry.addSplitButton(n,{tooltip:t,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(e){var n,o=i;return r.dom.getParents(r.selection.getStart(),function(t){(t=t.style["forecolor"===o?"color":"background-color"])&&(n=n||t)}),Mt.from(n).bind(function(t){return Rp(t).map(function(t){t=Dp(t).value;return kt(e.toLowerCase(),t)})}).getOr(!1)},columns:fh(r),fetch:ph(sh(r),ch(r)),onAction:function(t){mh(r,i,o.get(),Et)},onItemAction:function(t,e){mh(r,i,e,function(t){o.set(t),r.fire("TextColorChange",{name:n,color:t})})},onSetup:function(e){function t(t){t.name===n&&hh(e,t.name,t.color)}return hh(e,n,o.get()),r.on("TextColorChange",t),function(){r.off("TextColorChange",t)}}})}function bh(e,t,n,o){e.ui.registry.addNestedMenuItem(t,{text:o,icon:"forecolor"===t?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(t){mh(e,n,t.value,Et)}}]}})}function yh(t,e,n,o,r,i,u,a){return fg(t,sg(e),(s=n,l=o,f="color"!==r?"normal":"color",d=i,m=u,g=a,wt(F(c=e,function(e){return"choiceitem"===e.type?Eo("choicemenuitem",Wg,e).fold(lg,function(t){return Mt.some(function(e,t,n,o,r,i,u,a){void 0===a&&(a=!0);n=Cp({presets:n,textContent:t?e.text:Mt.none(),htmlContent:Mt.none(),ariaLabel:e.text,iconContent:e.icon,shortcutContent:t?e.shortcut:Mt.none(),checkMark:t?Mt.some(wp(u.icons)):Mt.none(),caret:Mt.none(),value:e.value},u,a);return sr(gp({data:pp(e),disabled:e.disabled,getApi:function(e){return{setActive:function(t){p.set(e,t)},isActive:function(){return p.isOn(e)},isDisabled:function(){return Nt.isDisabled(e)},setDisabled:function(t){return Nt.set(e,t)}}},onAction:function(t){return o(e.value)},onSetup:function(t){return t.setActive(r),Et},triggersSubmenu:!1,itemBehaviours:[]},n,i,u),{toggling:{toggleClass:Bg,toggleOnExecute:!1,selected:e.active}})}(t,1===l,f,s,m(e.value),d,g,sg(c)))}):Mt.none()}))),o,r);var c,s,l,f,d,m,g}function xh(t,e){var n=rg(e);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+n.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===e?"tox-swatches__row":"tox-collection__group")}}function wh(t,e){return ci(e+"x"+t)}var Sh,Ch,kh,Oh="choiceitem",_h=[{type:Oh,text:"Light Green",value:"#BFEDD2"},{type:Oh,text:"Light Yellow",value:"#FBEEB8"},{type:Oh,text:"Light Red",value:"#F8CAC6"},{type:Oh,text:"Light Purple",value:"#ECCAFA"},{type:Oh,text:"Light Blue",value:"#C2E0F4"},{type:Oh,text:"Green",value:"#2DC26B"},{type:Oh,text:"Yellow",value:"#F1C40F"},{type:Oh,text:"Red",value:"#E03E2D"},{type:Oh,text:"Purple",value:"#B96AD9"},{type:Oh,text:"Blue",value:"#3598DB"},{type:Oh,text:"Dark Turquoise",value:"#169179"},{type:Oh,text:"Orange",value:"#E67E23"},{type:Oh,text:"Dark Red",value:"#BA372A"},{type:Oh,text:"Dark Purple",value:"#843FA1"},{type:Oh,text:"Dark Blue",value:"#236FA1"},{type:Oh,text:"Light Gray",value:"#ECF0F1"},{type:Oh,text:"Medium Gray",value:"#CED4D9"},{type:Oh,text:"Gray",value:"#95A5A6"},{type:Oh,text:"Dark Gray",value:"#7E8C8D"},{type:Oh,text:"Navy Blue",value:"#34495E"},{type:Oh,text:"Black",value:"#000000"},{type:Oh,text:"White",value:"#ffffff"}],Th=(void 0===(Ch=10)&&(Ch=10),am=uh.getItem(ah),am=P(am)?JSON.parse(am):[],kh=Ch-(am=am).length<0?am.slice(0,Ch):am,{add:function(t){var e;(-1===(e=A(kh,t))?Mt.none():Mt.some(e)).each(Hh),kh.unshift(t),kh.length>Ch&&kh.pop(),uh.setItem(ah,JSON.stringify(kh))},state:function(){return kh.slice(0)}}),Eh="#000000",Dh=function(r){return function(n,t){var o=!1;r.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{colorpicker:t},onAction:function(t,e){"hex-valid"===e.name&&(o=e.value)},onSubmit:function(t){var e=t.getData().colorpicker;o?(n(Mt.from(e)),t.close()):r.windowManager.alert(r.translate(["Invalid hex color code: {0}",e]))},onClose:Et,onCancel:function(){n(Mt.none())}})}},Bh=O("cell-over"),Mh=O("cell-execute"),Ah={inserttable:function(r){var t=O("size-label"),s=function(i){for(var t=[],e=0;e<10;e++){for(var n=[],o=0;o<10;o++)n.push(function(e,n){function o(t){return Vt(t,Mh,{row:e,col:n})}function t(t,e){e.stop(),o(t)}var r;return _u({dom:{tag:"div",attributes:((r={role:"button"})["aria-labelledby"]=i,r)},behaviours:Ht([Lt("insert-table-picker-cell",[Pt(Si(),jt.focus),Pt(Hi(),o),Pt(Di(),t),Pt(Ni(),t)]),p.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),jt.config({onFocus:function(t){return Vt(t,Bh,{row:e,col:n})}})])})}(e,o));t.push(n)}return t}(t),e=wh(0,0),l=Wt({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:t}},components:[e],behaviours:Ht([Ut.config({})])});return{type:"widget",data:{value:O("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[$p.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:ot(s,function(t){return F(t,Tu)}).concat(l.asSpec()),behaviours:Ht([Lt("insert-table-picker",[uu(function(t){Ut.set(l.get(t),[e])}),Pr(Bh,function(t,e,n){for(var n=n.event,o=n.row,n=n.col,r=s,i=o,u=n,a=0;a<10;a++)for(var c=0;c<10;c++)p.set(r[a][c],a<=i&&c<=u);Ut.set(l.get(t),[wh(o+1,n+1)])}),Pr(Mh,function(t,e,n){var n=n.event,o=n.row,n=n.col;r.onAction({numRows:o+1,numColumns:n+1}),Rt(t,Wi())})]),$.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(e,t){n=t,o=(r=e).initData.allowCustomColors&&n.colorinput.hasCustomColors();var n,o,r=r.initData.colors.fold(function(){return gh(n.colorinput.getColors(),o)},function(t){return t.concat(dh(o))}),i=t.colorinput.getColorCols(),r=yh(O("menu-value"),r,function(t){e.onAction({value:t})},i,"color",_g.CLOSE_ON_EXECUTE,N,t.shared.providers),t=Bt(Bt({},r),{markers:rg("color"),movement:xh(i,"color")});return{type:"widget",data:{value:O("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[$p.widget(xm.sketch(t))]}}},Fh=function(t){t=t.text.fold(function(){return{}},function(t){return{innerHtml:t}});return{type:"separator",dom:Bt({tag:"div",classes:[Eg,"tox-collection__group-heading"]},t),components:[]}},Ih=function(t,e,n,o){void 0===o&&(o=!0);o=Cp({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:Mt.none(),ariaLabel:t.text,caret:Mt.none(),checkMark:Mt.none(),shortcutContent:t.shortcut},n,o);return gp({data:pp(t),getApi:function(e){return{isDisabled:function(){return Nt.isDisabled(e)},setDisabled:function(t){return Nt.set(e,t)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,e,n)},Rh=function(t,e,n,o,r){void 0===o&&(o=!0);r=(r=void 0!==r&&r)?hp("chevron-down",n.icons,[Fg]):hp("chevron-right",n.icons,[Fg]),r=Cp({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:Mt.none(),ariaLabel:t.text,caret:Mt.some(r),checkMark:Mt.none(),shortcutContent:t.shortcut},n,o);return gp({data:pp(t),getApi:function(e){return{isDisabled:function(){return Nt.isDisabled(e)},setDisabled:function(t){return Nt.set(e,t)}}},disabled:t.disabled,onAction:Et,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},r,e,n)},Vh=function(t,e,n,o){void 0===o&&(o=!0);o=Cp({iconContent:t.icon,textContent:t.text,htmlContent:Mt.none(),ariaLabel:t.text,checkMark:Mt.some(wp(n.icons)),caret:Mt.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},n,o);return sr(gp({data:pp(t),disabled:t.disabled,getApi:function(e){return{setActive:function(t){p.set(e,t)},isActive:function(){return p.isOn(e)},isDisabled:function(){return Nt.isDisabled(e)},setDisabled:function(t){return Nt.set(e,t)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,e,n),{toggling:{toggleClass:Bg,toggleOnExecute:!1,selected:t.active}})},Ph=function(e,n){return I(Ah,e.fancytype).map(function(t){return t(e,n)})};function Hh(t){kh.splice(t,1)}function zh(t,e,c,s,l){var f=sg(e),e=wt(F(e,function(t){function e(t){var e=t,n=c,o=s,r=l?!ne(t,"text"):f,i=l;function u(t){return i?Bt(Bt({},t),{shortcut:Mt.none(),icon:t.text.isSome()?Mt.none():t.icon}):t}var a=o.shared.providers;switch(e.type){case"menuitem":return Eo("menuitem",jg,e).fold(lg,function(t){return Mt.some(Ih(u(t),n,a,r))});case"nestedmenuitem":return Eo("nestedmenuitem",Gg,e).fold(lg,function(t){return Mt.some(Rh(u(t),n,a,r,i))});case"togglemenuitem":return Eo("togglemenuitem",Xg,e).fold(lg,function(t){return Mt.some(Vh(u(t),n,a,r))});case"separator":return Eo("separatormenuitem",Km,e).fold(lg,function(t){return Mt.some(Fh(t))});case"fancymenuitem":return Eo("fancymenuitem",Ug,e).fold(lg,function(t){return Ph(u(t),o)});default:return console.error("Unknown item in general menu",e),Mt.none()}}return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?e(Bt(Bt({},t),{disabled:!0})):e(t)}));return(l?function(t,e,n,o,r){i=n;var i,u={tag:"div",classes:["tox-collection","tox-collection--horizontal"]},a=[xm.parts.items({preprocess:function(t){return ag(t,function(t,e){return"separator"===i[e].type})}})];return{value:t,dom:u,components:a,items:n}}:fg)(t,f,e,1,"normal")}function Nh(t){return km.singleData(t.value,t)}function Lh(t,e,n){return Iu(t,e,n).isSome()}function Wh(n,o){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},schedule:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];r=setTimeout(function(){n.apply(null,t),r=null},o)}}}function Uh(t){t=t.raw;return void 0===t.touches||1!==t.touches.length?Mt.none():Mt.some(t.touches[0])}function jh(){return Hn().browser.isFirefox()}function Gh(t,e){return It(I(t,"target").getOr(e))}function Xh(t,o,e,n,r,i){var u,a,t=t(o,n),c=(u=It(!1),a=It(!1),{stop:function(){u.set(!0)},cut:function(){a.set(!0)},isStopped:u.get,isCut:a.get,event:e,setSource:r.set,getSource:r.get});return t.fold(function(){return i.logEventNoHandlers(o,n),ev.complete()},function(e){var n=e.descHandler;return Jr(n)(c),c.isStopped()?(i.logEventStopped(o,e.element,n.purpose),ev.stopped()):c.isCut()?(i.logEventCut(o,e.element,n.purpose),ev.complete()):ye(e.element).fold(function(){return i.logNoParent(o,e.element,n.purpose),ev.complete()},function(t){return i.logEventResponse(o,e.element,n.purpose),ev.resume(t)})})}function Yh(){function i(t){Ur(t.element).each(function(t){delete c[t],a.unregisterId(t)})}u={};var u,a={registerId:function(o,r,t){gt(t,function(t,e){var n=void 0!==u[e]?u[e]:{};n[r]={cHandler:g.apply(void 0,[(t=t).handler].concat(o)),purpose:t.purpose},u[e]=n})},unregisterId:function(n){gt(u,function(t,e){ne(t,n)&&delete t[n]})},filterByType:function(t){return I(u,t).map(function(t){return ht(t,function(t,e){return{id:e,descHandler:t}})}).getOr([])},find:function(t,e,n){return I(u,e).bind(function(o){return Or(n,function(t){return e=o,Ur(n=t).bind(function(t){return I(e,t)}).map(function(t){return{element:n,descHandler:t}});var e,n},t)})}},c={};return{find:function(t,e,n){return a.find(t,e,n)},filter:function(t){return a.filterByType(t)},register:function(t){var n,e=Ur((n=t).element).getOrThunk(function(){return t=n.element,e=O(gu+"uid-"),hu(t,e),e;var t,e});if(yt(c,e)){var o=t,r=c[e];if(r!==o)throw new Error('The tagId "'+e+'" is already used by: '+Wr(r.element)+"\nCannot use it for: "+Wr(o.element)+"\nThe conflicting element is"+(Wn(r.element)?" ":" not ")+"already in the DOM");i(o)}a.registerId([t],e,t.events),c[e]=t},unregister:i,getById:function(t){return I(c,t)}}}function qh(n){function o(e){return ye(n.element).fold(L,function(t){return me(e,t)})}function c(t,e){return w.find(o,t,e)}function r(e){var t=w.filter(Pi());Y(t,function(t){Jr(t.descHandler)(e)})}var e,t,i,u,a,s,l,f,d,m,g,p,h,v,b,y,x,w=Yh(),S=(e=n.element,d=Bt({stopBackspace:!0},t={triggerEvent:function(e,n){return zu(e,n.target,function(t){return nv(c,e,n,n.target,t)})}}),u=d,a=rc(),s=It(!1),l=Wh(function(t){u.triggerEvent(Li(),t),s.set(!0)},400),f=Sr([{key:gi(),value:function(e){return Uh(e).each(function(t){l.cancel();t={x:t.clientX,y:t.clientY,target:e.target};l.schedule(e),s.set(!1),a.set(t)}),Mt.none()}},{key:pi(),value:function(t){return l.cancel(),Uh(t).each(function(o){a.on(function(t){var e=o,n=Math.abs(e.clientX-t.x),e=Math.abs(e.clientY-t.y);(5<n||5<e)&&a.clear()})}),Mt.none()}},{key:hi(),value:function(e){return l.cancel(),a.get().filter(function(t){return me(t.target,e.target)}).map(function(t){return s.get()?(e.prevent(),!1):u.triggerEvent(Ni(),e)})}}]),m={fireIfReady:function(e,t){return I(f,t).bind(function(t){return t(e)})}},g=F(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(t){return ic(e,t,function(e){m.fireIfReady(e,t).each(function(t){t&&e.kill()}),d.triggerEvent(t,e)&&e.kill()})}),p=rc(),h=ic(e,"paste",function(e){m.fireIfReady(e,"paste").each(function(t){t&&e.kill()}),d.triggerEvent("paste",e)&&e.kill(),p.set(setTimeout(function(){d.triggerEvent(Vi(),e)},0))}),v=ic(e,"keydown",function(t){var e;d.triggerEvent("keydown",t)?t.kill():!d.stopBackspace||(e=t).raw.which!==Sf[0]||$t(["input","textarea"],ie(e.target))||Lh(e.target,'[contenteditable="true"]')||t.prevent()}),t=e,i=function(t){d.triggerEvent("focusin",t)&&t.kill()},b=jh()?uc(t,"focus",i):ic(t,"focusin",i),y=rc(),t=e,i=function(t){d.triggerEvent("focusout",t)&&t.kill(),y.set(setTimeout(function(){d.triggerEvent(Ri(),t)},0))},x=jh()?uc(t,"blur",i):ic(t,"focusout",i),{unbind:function(){Y(g,function(t){t.unbind()}),v.unbind(),b.unbind(),x.unbind(),h.unbind(),p.on(clearTimeout),y.on(clearTimeout)}}),C={debugInfo:Dt("real"),triggerEvent:function(e,n,o){zu(e,n,function(t){return nv(c,e,o,n,t)})},triggerFocus:function(u,a){Ur(u).fold(function(){xa(u)},function(t){zu(Ii(),u,function(t){var e,n,o=c,r=Ii(),i=Gh(e={originator:a,kill:Et,prevent:Et,target:u},n=u);return Xh(o,r,e,n,i,t),!1})})},triggerEscape:function(t,e){C.triggerEvent("keydown",t.element,e.event)},getByUid:function(t){return M(t)},getByDom:function(t){return A(t)},build:_u,addToGui:function(t){_(t)},removeFromGui:function(t){T(t)},addToWorld:function(t){k(t)},removeFromWorld:function(t){O(t)},broadcast:function(t){E(t)},broadcastOn:function(t,e){D(t,e)},broadcastEvent:function(t,e){B(t,e)},isConnected:L},k=function(t){t.connect(C),kn(t.element)||(w.register(t),Y(t.components(),k),C.triggerEvent(ji(),t.element,{target:t.element}))},O=function(t){kn(t.element)||(Y(t.components(),O),w.unregister(t)),t.disconnect()},_=function(t){ws(n,t)},T=function(t){Cs(t)},E=function(t){r({universal:!0,data:t})},D=function(t,e){r({universal:!1,channels:t,data:e})},B=function(t,e){var n,t=w.filter(t),o={stop:function(){n.set(!0)},cut:Et,isStopped:(n=It(!1)).get,isCut:N,event:e,setSource:R("Cannot set source of a broadcasted event"),getSource:R("Cannot get source of a broadcasted event")};return Y(t,function(t){Jr(t.descHandler)(o)}),o.isStopped()},M=function(t){return w.getById(t).fold(function(){return K.error(new Error('Could not find component with uid: "'+t+'" in system.'))},K.value)},A=function(t){t=Ur(t).getOr("not found");return M(t)};return k(n),{root:n,element:n.element,destroy:function(){S.unbind(),Qn(n.element)},add:_,remove:T,getByUid:M,getByDom:A,addToWorld:k,removeFromWorld:O,broadcast:E,broadcastOn:D,broadcastEvent:B}}function Kh(t,e,n,o){t=t,e=e,o=o;n={dom:uv(n),components:t.toArray().concat([e]),fieldBehaviours:Ht(o)};return C.sketch(n)}function Jh(t,e){return C.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:e.translate(t)}})}function $h(t){return Ht([jt.config({onFocus:t.selectOnFocus?function(t){var t=t.element,e=ii(t);t.dom.setSelectionRange(0,e.length)}:Et})])}function Qh(t){return{tag:t.tag,attributes:Bt({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}}function Zh(m,g){function r(){return i.get().isSome()}function p(){r()&&Om.hide(b)}function h(t){var e=t;i.get().map(function(t){return zm(m.dom,m.selection.getRng(),t.triggerChar).bind(function(t){return Um(m,u,t,e)})}).getOrThunk(function(){return e=m,t=(n=u)(),o=e.selection.getRng(),r=e.dom,i=o,mt(t.triggerChars,function(t){return zm(r,i,t)}).bind(function(t){return Um(e,n,t)});var e,n,t,o,r,i}).fold(y,function(d){var t,n,e,o=d.context;r()||(n=m,e=o.range,t=Xm(At.fromDom(n.selection.getNode())).getOrThunk(function(){var r,i,t=At.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',n.getDoc());return $n(t,At.fromDom(e.extractContents())),e.insertNode(t.dom),ye(t).each(function(t){return t.dom.normalize()}),r=es,(i=function(t){for(var e=we(t),n=e.length-1;0<=n;n--){var o=e[n];if(r(o))return Mt.some(o);o=i(o);if(o.isSome())return o}return Mt.none()})(t).map(function(t){var e;n.selection.setCursorLocation(t.dom,"img"===ie(e=t)?1:ts(e).fold(function(){return we(e).length},function(t){return t.length}))}),t}),i.set({triggerChar:o.triggerChar,element:t,matchLength:o.text.length}),v.set(!1)),d.lookupData.then(function(f){i.get().map(function(t){var i,n,e,o,r,u,a,c,s,l=d.context;t.triggerChar===l.triggerChar&&(i=l.triggerChar,n=mt(r=f,function(t){return Mt.from(t.columns)}).getOr(1),0<(r=ot(r,function(r){return t=r.items,u=r.matchText,a=function(n,o){var t=m.selection.getRng();zm(m.dom,t,i).fold(function(){return console.error("Lost context. Cursor probably moved")},function(t){var t=t.range,e={hide:function(){y()},reload:function(t){p(),h(t)}};v.set(!0),r.onAction(e,t,n,o),v.set(!1)})},c=_g.BUBBLE_TO_SANDBOX,s=g,l=r.highlightOn,f=!(e=1===n)||sg(t),wt(F(t,function(t){switch(t.type){case"separator":return Eo("Autocompleter.Separator",Km,t).fold(lg,function(t){return Mt.some(Fh(t))});case"cardmenuitem":return Eo("cardmenuitem",Lg,t).fold(lg,function(e){return Mt.some((t=Bt(Bt({},e),{onAction:function(t){e.onAction(t),a(e.value,e.meta)}}),n=c,r={itemBehaviours:kp(e.meta,o=s),cardText:{matchText:u,highlightOn:l}},i={dom:Sp(t.label),optComponents:[Mt.some({dom:{tag:"div",classes:[Rg,Vg]},components:Jp(t.items,r)})]},gp({data:pp(Bt({text:Mt.none()},t)),disabled:t.disabled,getApi:function(n){return{isDisabled:function(){return Nt.isDisabled(n)},setDisabled:function(e){Nt.set(n,e),Y(ns(n.element,"*"),function(t){n.getSystem().getByDom(t).each(function(t){t.hasConfigured(Nt)&&Nt.set(t,e)})})}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:Mt.from(r.itemBehaviours).getOr([])},i,n,o.providers)));var t,n,o,r,i});default:return Eo("Autocompleter.Item",Jm,t).fold(lg,function(t){return Mt.some(function(e,n,t,o,r,i,u){void 0===f&&(u=!0);t=Cp({presets:"normal",textContent:Mt.none(),htmlContent:t?e.text.map(function(t){return Op(t,n)}):Mt.none(),ariaLabel:e.text,iconContent:e.icon,shortcutContent:Mt.none(),checkMark:Mt.none(),caret:Mt.none(),value:e.value},i.providers,u,e.icon);return gp({data:pp(e),disabled:e.disabled,getApi:Dt({}),onAction:function(t){return o(e.value,e.meta)},onSetup:Dt(Et),triggersSubmenu:!1,itemBehaviours:kp(e.meta,i)},t,r,i.providers)}(t,u,e,a,c,s,f))})}}));var t,u,a,c,s,l,e,f})).length?(o=f,r=r,(e=t).matchLength=l.text.length,o=mt(o,function(t){return Mt.from(t.columns)}).getOr(1),Om.showAt(b,xm.sketch((r=fg("autocompleter-value",!0,r,o,"normal"),o=o,a=((u=Sh.ContentFocus)===Sh.ContentFocus?_l:Ol)(),c=xh(o,"normal"),s=rg("normal"),{dom:r.dom,components:r.components,items:r.items,value:r.value,markers:{selectedItem:s.selectedItem,item:s.item},movement:c,fakeFocus:u===Sh.ContentFocus,focusManager:a,menuBehaviours:Cg("auto"!==o?[]:[uu(function(n,t){dg(n,4,s.item).each(function(t){var e=t.numColumns,t=t.numRows;$.setGridSize(n,t,e)})})])})),{anchor:{type:"node",root:At.fromDom(m.getBody()),node:Mt.from(e.element)}}),Om.getContent(b).each(wf.highlightFirst)):(10<=l.text.length-t.matchLength?y:p)())})})})}var n,i=rc(),v=It(!1),b=_u(Om.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:Ht([Lt("dismissAutocompleter",[Pt($i(),function(){return y()})])]),lazySink:g.getSink})),y=function(){var t;r()&&(t=i.get().map(function(t){return t.element}),Xm(t.getOr(At.fromDom(m.selection.getNode()))).each(on),p(),i.clear(),v.set(!1))},u=ae(function(){return n=ht(t=pt(m.ui.registry.getAll().popups,function(t){return Eo("Autocompleter",$m,t).fold(function(t){throw new Error(br(t))},x)}),function(t){return t.ch}),e={},Y(n,function(t){e[t]={}}),n=Zt(e),o=bt(t),{dataset:t,triggerChars:n,lookupByChar:function(e){return G(o,function(t){return t.ch===e})}};var e,t,n,o}),t={onKeypress:Im(function(t){27!==t.which&&h()},50),cancelIfNecessary:y,isMenuOpen:function(){return Om.isOpen(b)},isActive:r,isProcessingAction:v.get,getView:function(){return Om.getContent(b)}};function o(t,e){Vt(t,Oi(),{raw:e})}!1===m.hasPlugin("rtc")&&(n=t,(t=m).on("keypress compositionend",n.onKeypress.throttle),t.on("remove",n.onKeypress.cancel),t.on("keydown",function(e){function t(){return n.getView().bind(wf.getHighlighted)}8===e.which&&n.onKeypress.throttle(e),n.isActive()&&(27===e.which&&n.cancelIfNecessary(),n.isMenuOpen()?13===e.which?(t().each(Dr),e.preventDefault()):40===e.which?(t().fold(function(){n.getView().each(wf.highlightFirst)},function(t){o(t,e)}),e.preventDefault(),e.stopImmediatePropagation()):37!==e.which&&38!==e.which&&39!==e.which||t().each(function(t){o(t,e),e.preventDefault(),e.stopImmediatePropagation()}):13!==e.which&&38!==e.which&&40!==e.which||n.cancelIfNecessary())}),t.on("NodeChange",function(t){n.isActive()&&!n.isProcessingAction()&&Xm(At.fromDom(t.element)).isNone()&&n.cancelIfNecessary()}))}Sh={ContentFocus:0,0:"ContentFocus",UiFocus:1,1:"UiFocus"};function tv(e,n,o,t,r,i){return Xh(e,n,o,t,r,i).fold(L,function(t){return tv(e,n,o,t,r,i)},N)}var ev=tr([{stopped:[]},{resume:["element"]},{complete:[]}]),nv=function(t,e,n,o,r){var i=Gh(n,o);return tv(t,e,n,o,i,r)},ov=cl({name:"Container",factory:function(t){var e=t.dom,n=e.attributes,e=B(e,["attributes"]);return{uid:t.uid,dom:Bt({tag:"div",attributes:Bt({role:"presentation"},n)},e),components:t.components,behaviours:zs(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[S("components",[]),Hs("containerBehaviours",[]),S("events",{}),S("domModification",{}),S("eventOrder",{})]}),ff=Dt([S("prefix","form-field"),Hs("fieldBehaviours",[J,zt])]),Aa=Dt([mf({schema:[y("dom")],name:"label"}),mf({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[y("text")],name:"aria-descriptor"}),df({factory:{sketch:function(t){n=["factory"],o={},gt(t,function(t,e){$t(n,e)||(o[e]=t)});var n,o,e=o;return t.factory.sketch(e)}},schema:[y("factory")],name:"field"})]),C=sl({name:"FormField",configFields:ff(),partFields:Aa(),factory:function(r,t,e,n){var o=Ns(r.fieldBehaviours,[J.config({find:function(t){return Qs(t,r,"field")}}),zt.config({store:{mode:"manual",getValue:function(t){return J.getCurrent(t).bind(zt.getValue)},setValue:function(t,e){J.getCurrent(t).each(function(t){zt.setValue(t,e)})}}})]),i=iu([uu(function(t,e){var o=tl(t,r,["label","field","aria-descriptor"]);o.field().each(function(n){var e=O(r.prefix);o.label().each(function(t){Ft(t.element,"for",e),Ft(n.element,"id",e)}),o["aria-descriptor"]().each(function(t){var e=O(r.prefix);Ft(t.element,"id",e),Ft(n.element,"aria-describedby",e)})})})]);return{uid:r.uid,dom:r.dom,components:t,behaviours:o,events:i,apis:{getField:function(t){return Qs(t,r,"field")},getLabel:function(t){return Qs(t,r,"label")}}}},apis:{getField:function(t,e){return t.getField(e)},getLabel:function(t,e){return t.getLabel(e)}}}),cm=Object.freeze({__proto__:null,exhibit:function(t,e){return Kr({attributes:Sr([{key:e.tabAttr,value:"true"}])})}}),rv=va({fields:[S("tabAttr","data-alloy-tabstop")],name:"tabstopping",active:cm}),iv=tinymce.util.Tools.resolve("tinymce.html.Entities"),uv=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},av=O("form-component-change"),cv=O("form-close"),sv=O("form-cancel"),lv=O("form-action"),fv=O("form-submit"),dv=O("form-block"),mv=O("form-unblock"),gv=O("form-tabchange"),pv=O("form-resize"),um=Dt([zo("data"),S("inputAttributes",{}),S("inputStyles",{}),S("tag","input"),S("inputClasses",[]),t("onSetValue"),S("styles",{}),S("eventOrder",{}),Hs("inputBehaviours",[zt,jt]),S("selectOnFocus",!0)]),hv=cl({name:"Input",configFields:um(),factory:function(t,e){return{uid:t.uid,dom:Qh(t),components:[],behaviours:Bt(Bt({},$h(n=t)),Ns(n.inputBehaviours,[zt.config({store:Bt(Bt({mode:"manual"},n.data.map(function(t){return{initialValue:t}}).getOr({})),{getValue:function(t){return ii(t.element)},setValue:function(t,e){ii(t.element)!==e&&ui(t.element,e)}}),onSetValue:n.onSetValue})])),eventOrder:t.eventOrder};var n}}),vv={},bv={exports:vv};function yv(t){setTimeout(function(){throw t},0)}function xv(t){t=ie(t);return $t(Av,t)}function wv(t,e){ei(e.getRoot(t).getOr(t.element),e.invalidClass),e.notify.each(function(e){xv(t.element)&&Ft(t.element,"aria-invalid",!1),e.getContainer(t).each(function(t){Lr(t,e.validHtml)}),e.onValid(t)})}function Sv(e,t,n,o){ti(t.getRoot(e).getOr(e.element),t.invalidClass),t.notify.each(function(t){xv(e.element)&&Ft(e.element,"aria-invalid",!0),t.getContainer(e).each(function(t){Lr(t,o)}),t.onInvalid(e,o)})}function Cv(e,t,n){return t.validator.fold(function(){return Mv(K.value(!0))},function(t){return t.validate(e)})}function kv(e,n,t){return n.notify.each(function(t){t.onValidate(e)}),Cv(e,n).map(function(t){return e.getSystem().isConnected()?t.fold(function(t){return Sv(e,n,0,t),K.error(t)},function(t){return wv(e,n),K.value(t)}):K.error("No longer in system")})}!function(){function t(){var t,e,n={exports:{}};function o(){}function i(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function r(n,o){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,i._immediateFn(function(){var t,e=1===n._state?o.onFulfilled:o.onRejected;if(null!==e){try{t=e(n._value)}catch(t){return void a(o.promise,t)}u(o.promise,t)}else(1===n._state?u:a)(o.promise,n._value)})):n._deferreds.push(o)}function u(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,c(t);if("function"==typeof n)return l((o=n,r=e,function(){o.apply(r,arguments)}),t)}t._state=1,t._value=e,c(t)}catch(e){a(t,e)}var o,r}function a(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&i._immediateFn(function(){t._handled||i._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)r(t,t._deferreds[e]);t._deferreds=null}function s(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function l(t,e){var n=!1;try{t(function(t){n||(n=!0,u(e,t))},function(t){n||(n=!0,a(e,t))})}catch(t){n||(n=!0,a(e,t))}}f=n,t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=setTimeout,i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,e){var n=new this.constructor(o);return r(this,new s(t,e,n)),n},i.all=function(t){var a=Array.prototype.slice.call(t);return new i(function(r,i){if(0===a.length)return r([]);for(var u=a.length,t=0;t<a.length;t++)!function e(n,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var o=t.then;if("function"==typeof o)return o.call(t,function(t){e(n,t)},i),0}a[n]=t,0==--u&&r(a)}catch(t){i(t)}}(t,a[t])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(n){return new i(function(t,e){e(n)})},i.race=function(r){return new i(function(t,e){for(var n=0,o=r.length;n<o;n++)r[n].then(t,e)})},i._immediateFn="function"==typeof setImmediate?function(t){setImmediate(t)}:function(t){e(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},i._setImmediateFn=function(t){i._immediateFn=t},i._setUnhandledRejectionFn=function(t){i._unhandledRejectionFn=t},f.exports?f.exports=i:t.Promise||(t.Promise=i);var f=n.exports;return{boltExport:("undefined"!=typeof window?window:Function("return this;")()).Promise||f}}var e=this;"object"==typeof vv&&void 0!==bv?bv.exports=t():(e="undefined"!=typeof globalThis?globalThis:e||self).EphoxContactWrapper=t()}();function Ov(t){function o(t){e()?n(t):i.push(t)}function e(){return r.isSome()}function n(e){r.each(function(t){setTimeout(function(){e(t)},0)})}var r=Mt.none(),i=[];return t(function(t){e()||(r=Mt.some(t),Y(i,n),i=[])}),{get:o,map:function(n){return Ov(function(e){o(function(t){e(n(t))})})},isReady:e}}var _v,Tv=bv.exports.boltExport,Ev={nu:Ov,pure:function(e){return Ov(function(t){t(e)})}},Dv=function(n){function t(t){n().then(t,yv)}return{map:function(t){return Dv(function(){return n().then(t)})},bind:function(e){return Dv(function(){return n().then(function(t){return e(t).toPromise()})})},anonBind:function(t){return Dv(function(){return n().then(function(){return t.toPromise()})})},toLazy:function(){return Ev.nu(t)},toCached:function(){var t=null;return Dv(function(){return t=null===t?n():t})},toPromise:n,get:t}},Bv=function(t){return Dv(function(){return new Tv(t)})},Mv=function(t){return Dv(function(){return Tv.resolve(t)})},Av=["input","textarea"],sm=Object.freeze({__proto__:null,markValid:wv,markInvalid:Sv,query:Cv,run:kv,isInvalid:function(t,e){return ni(e.getRoot(t).getOr(t.element),e.invalidClass)}}),lm=Object.freeze({__proto__:null,events:function(e,t){return e.validator.map(function(t){return iu([Pt(t.onEvent,function(t){kv(t,e).get(x)})].concat(t.validateOnLoad?[uu(function(t){kv(t,e).get(Et)})]:[]))}).getOr({})}}),Fv=va({fields:[y("invalidClass"),S("getRoot",Mt.none),Go("notify",[S("aria","alert"),S("getContainer",Mt.none),S("validHtml",""),t("onValid"),t("onInvalid"),t("onValidate")]),Go("validator",[y("validate"),S("onEvent","input"),S("validateOnLoad",!0)])],name:"invalidating",active:lm,apis:sm,extra:{validation:function(e){return function(t){t=zt.getValue(t);return Mv(e(t))}}}}),lu=Object.freeze({__proto__:null,getCoupled:function(t,e,n,o){return n.getOrCreate(t,e,o)}}),Iv=va({fields:[Fo("others",To(K.value,dr()))],name:"coupling",apis:lu,state:Object.freeze({__proto__:null,init:function(){var r={},t=Dt({});return Cu({readState:t,getOrCreate:function(e,n,o){var t=Zt(n.others);if(t)return I(r,o).getOrThunk(function(){var t=I(n.others,o).getOrDie("No information found for coupled component: "+o)(e),t=e.getSystem().build(t);return r[o]=t});throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(t,null,2))}})}})}),Rv=Dt("sink"),fm=Dt(mf({name:Rv(),overrides:Dt({dom:{tag:"div"},behaviours:Ht([jl.config({useFixed:L})]),events:iu([Hr(Oi()),Hr(bi()),Hr(Di())])})}));function Vv(t,e){var n=t.getHotspot(e).getOr(e),o=t.getAnchorOverrides();return t.layouts.fold(function(){return{type:"hotspot",hotspot:n,overrides:o}},function(t){return{type:"hotspot",hotspot:n,overrides:o,layouts:t}})}function Pv(t,e,n,o,r,i,u){var a=Vv(t,n),c=n,s=o,l=r,f=u,n=e,u=(0,(r=t).fetch)(c).map(n),d=Yy(c,r);return u.map(function(t){return t.bind(function(t){return Mt.from(km.sketch(Bt(Bt({},l.menu()),{uid:vu(""),data:t,highlightImmediately:f===_v.HighlightFirst,onOpenMenu:function(t,e){var n=d().getOrDie();jl.position(n,e,{anchor:a}),m.decloak(s)},onOpenSubmenu:function(t,e,n){var o=d().getOrDie();jl.position(o,n,{anchor:{type:"submenu",item:e}}),m.decloak(s)},onRepositionMenu:function(t,e,n){var o=d().getOrDie();jl.position(o,e,{anchor:a}),Y(n,function(t){jl.position(o,t.triggeredMenu,{anchor:{type:"submenu",item:t.triggeringItem}})})},onEscape:function(){return jt.focus(c),m.close(s),Mt.some(!0)}})))})}).map(function(t){return t.fold(function(){m.isOpen(o)&&m.close(o)},function(t){m.cloak(o),m.open(o,t),i(o)}),o})}function Hv(t,e,n,o,r,i){var u=Iv.getCoupled(n,"sandbox");return(m.isOpen(u)?function(t,e,n,o,r,i,u){return m.close(o),Mv(o)}:Pv)(t,e,n,u,o,r,i)}function zv(t){m.getState(t).each(function(t){km.repositionMenus(t)})}function Nv(u,a,c){var s=Ru(),t=Yy(a,u);return{dom:{tag:"div",classes:u.sandboxClasses,attributes:{id:s.id,role:"listbox"}},behaviours:Zl(u.sandboxBehaviours,[zt.config({store:{mode:"memory",initialValue:a}}),m.config({onOpen:function(t,e){var n,o,r,i=Vv(u,a);s.link(a.element),u.matchWidth&&(r=i.hotspot,n=u.useMinWidth,o=J.getCurrent(o=e).getOr(o),r=qe(r.element),n?q(o.element,"min-width",r+"px"):(n=o.element,Kn.set(n,r))),u.onOpen(i,t,e),void 0!==c&&void 0!==c.onOpen&&c.onOpen(t,e)},onClose:function(t,e){s.unlink(a.element),void 0!==c&&void 0!==c.onClose&&c.onClose(t,e)},isPartOf:function(t,e,n){return Vu(e,n)||Vu(a,n)},getAttachPoint:function(){return t().getOrDie()}}),J.config({find:function(t){return m.getState(t).bind(function(t){return J.getCurrent(t)})}}),Za.config({channels:Bt(Bt({},Ms({isExtraPart:N})),As({doReposition:zv}))})])}}function Lv(t){zv(Iv.getCoupled(t,"sandbox"))}function Wv(){return[S("sandboxClasses",[]),Ql("sandboxBehaviours",[J,Za,m,zt])]}function Uv(e){return mf({name:e+"-edge",overrides:function(t){return t.model.manager.edgeActions[e].fold(function(){return{}},function(o){return{events:iu([Ir(gi(),function(t,e,n){return o(t,n)},[t]),Ir(bi(),function(t,e,n){return o(t,n)},[t]),Ir(yi(),function(t,e,n){n.mouseIsDown.get()&&o(t,n)},[t])])}})}})}function jv(t){t=t.event.raw;return-1===t.type.indexOf("touch")?void 0!==t.clientX?Mt.some(t).map(function(t){return Yn(t.clientX,t.clientY)}):Mt.none():void 0!==t.touches&&1===t.touches.length?Mt.some(t.touches[0]).map(function(t){return Yn(t.clientX,t.clientY)}):Mt.none()}function Gv(t){return t.model.minX}function Xv(t){return t.model.minY}function Yv(t){return t.model.minX-1}function qv(t){return t.model.minY-1}function Kv(t){return t.model.maxX}function Jv(t){return t.model.maxY}function $v(t){return t.model.maxX+1}function Qv(t){return t.model.maxY+1}function Zv(t,e,n){return e(t)-n(t)}function tb(t){return Zv(t,Kv,Gv)}function eb(t){return Zv(t,Jv,Xv)}function nb(t){return tb(t)/2}function ob(t){return eb(t)/2}function rb(t){return t.stepSize}function ib(t){return t.snapToGrid}function ub(t){return t.snapStart}function ab(t){return t.rounded}function cb(t,e){return void 0!==t[e+"-edge"]}function sb(t){return cb(t,"left")}function lb(t){return cb(t,"right")}function fb(t){return cb(t,"top")}function db(t){return cb(t,"bottom")}function mb(t){return t.model.value.get()}function gb(t,e){return{x:t,y:e}}function pb(t,e){Vt(t,Zy(),{value:e})}function hb(t,e,n,o){return t<e?t:n<t?n:t===e?e-1:Math.max(e,t-o)}function vb(t,e,n,o){return n<t?t:t<e?e:t===n?n+1:Math.min(n,t+o)}function bb(t,e,n){return Math.max(e,Math.min(n,t))}function yb(t){var r,e,i,u,n=t.min,o=t.max,a=t.range,c=t.value,s=t.step,l=t.snap,f=t.snapStart,d=t.rounded,m=t.hasMinEdge,g=t.hasMaxEdge,p=t.minBound,h=t.maxBound,t=t.screenRange,m=m?n-1:n,g=g?o+1:o;return c<p?m:h<c?g:(h=bb((p=p,(Math.min(h,Math.max(c,p))-p)/t*a+n),m,g),l&&n<=h&&h<=o?(r=h,e=n,i=o,u=s,f.fold(function(){var t=Math.round((r-e)/u)*u;return bb(e+t,e-1,i+1)},function(t){var e=Math.round((r-t)%u/u),n=Math.floor((r-t)/u),o=Math.floor((i-t)/u),o=Math.min(o,n+e);return Math.max(t,t+o*u)})):d?Math.round(h):h)}function xb(t){var e=t.min,n=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,t=t.centerMaxEdge;return r<e?i?0:s:n<r?u?a:t:(r-e)/o*c}function wb(t){return t.element.dom.getBoundingClientRect()}function Sb(t){return wb(t)[tx]}function Cb(t){return wb(t).right}function kb(t){return wb(t).top}function Ob(t){return wb(t).bottom}function _b(t){return wb(t).width}function Tb(t){return wb(t).height}function Eb(t,e){t=wb(t),e=wb(e);return(t[tx]+t.right)/2-e[tx]}function Db(t,e){t=wb(t),e=wb(e);return(t.top+t.bottom)/2-e.top}function Bb(t,e){Vt(t,Zy(),{value:e})}function Mb(t,e,n){return yb({min:Gv(e),max:Kv(e),range:tb(e),value:n,step:rb(e),snap:ib(e),snapStart:ub(e),rounded:ab(e),hasMinEdge:sb(e),hasMaxEdge:lb(e),minBound:Sb(t),maxBound:Cb(t),screenRange:_b(t)})}function Ab(n){return function(t,e){return Bb(t,{x:e=(0<n?vb:hb)(mb(t=e).x,Gv(t),Kv(t),rb(t))}),Mt.some(e).map(L)}}function Fb(t,e,n,o,r,i){i=i,n=n,o=o,r=r,a=_b(u=e),o=o.bind(function(t){return Mt.some(Eb(t,u))}).getOr(0),r=r.bind(function(t){return Mt.some(Eb(t,u))}).getOr(a);var u,a,n=xb({min:Gv(i),max:Kv(i),range:tb(i),value:n,hasMinEdge:sb(i),hasMaxEdge:lb(i),minBound:Sb(u),minOffset:0,maxBound:Cb(u),maxOffset:a,centerMinEdge:o,centerMaxEdge:r});return Sb(e)-Sb(t)+n}function Ib(t,e){Vt(t,Zy(),{value:e})}function Rb(t,e,n){return yb({min:Xv(e),max:Jv(e),range:eb(e),value:n,step:rb(e),snap:ib(e),snapStart:ub(e),rounded:ab(e),hasMinEdge:fb(e),hasMaxEdge:db(e),minBound:kb(t),maxBound:Ob(t),screenRange:Tb(t)})}function Vb(n){return function(t,e){return Ib(t,{y:e=(0<n?vb:hb)(mb(t=e).y,Xv(t),Jv(t),rb(t))}),Mt.some(e).map(L)}}function Pb(t,e,n,o,r,i){i=i,n=n,o=o,r=r,a=Tb(u=e),o=o.bind(function(t){return Mt.some(Db(t,u))}).getOr(0),r=r.bind(function(t){return Mt.some(Db(t,u))}).getOr(a);var u,a,n=xb({min:Xv(i),max:Jv(i),range:eb(i),value:n,hasMinEdge:fb(i),hasMaxEdge:db(i),minBound:kb(u),minOffset:0,maxBound:Ob(u),maxOffset:a,centerMinEdge:o,centerMaxEdge:r});return kb(e)-kb(t)+n}function Hb(t,e){Vt(t,Zy(),{value:e})}function zb(t,e){return{x:t,y:e}}function Nb(r,i){return function(t,e){return e=e,n=0<r?vb:hb,Hb(t,zb(o=(t=i)?mb(e).x:n(mb(e).x,Gv(e),Kv(e),rb(e)),t?n(mb(e).y,Xv(e),Jv(e),rb(e)):mb(e).y)),Mt.some(o).map(L);var n,o}}function Lb(t){return"<alloy.field."+t+">"}function Wb(f,d,m,g){function p(t,e,n,o,r){var i,u,a=f(lx+"range"),n=[C.parts.label({dom:{tag:"label",innerHtml:n,attributes:{"aria-label":o}}}),C.parts.field({data:r,factory:hv,inputAttributes:Bt({type:"text"},"hex"===e?{"aria-live":"polite"}:{}),inputClasses:[d("textfield")],inputBehaviours:Ht([(i=e,u=t,Fv.config({invalidClass:d("invalid"),notify:{onValidate:function(t){Vt(t,sx,{type:i})},onValid:function(t){Vt(t,ax,{type:i,value:zt.getValue(t)})},onInvalid:function(t){Vt(t,cx,{type:i,value:zt.getValue(t)})}},validator:{validate:function(t){t=zt.getValue(t),t=u(t)?K.value(!0):K.error(f("aria.input.invalid"));return Mv(t)},validateOnLoad:!1}})),rv.config({})]),onSetValue:function(t){Fv.isInvalid(t)&&Fv.run(t).get(Et)}})],o="hex"!==e?[C.parts["aria-descriptor"]({text:a})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:n.concat(o)}}function h(t,e){var n=e.red,o=e.green,e=e.blue;zt.setValue(t,{red:n,green:o,blue:e})}function v(t,e){b.getOpt(t).each(function(t){q(t.element,"background-color","#"+e.value)})}var b=Wt({dom:{tag:"div",classes:[d("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}});return cl({factory:function(){function u(t){return o[t].get()}function a(t,e){o[t].set(e)}function e(t,e){e=e.event;"hex"!==e.type?a(e.type,Mt.none()):g(t)}function n(t,e){var o,n,r,i,e=e.event;"hex"===e.type?(n=t,r=e.value,m(n),i=_p(r),a("hex",Mt.some(r)),r=Fp(i),h(n,r),c(r),Vt(n,nx,{hex:i}),v(n,i)):(o=t,r=e.type,n=e.value,i=parseInt(n,10),a(r,Mt.some(i)),u("red").bind(function(n){return u("green").bind(function(e){return u("blue").map(function(t){return Bp(n,e,t,1)})})}).each(function(t){e=o,n=Dp(t),ux.getField(e,"hex").each(function(t){jt.isFocused(t)||zt.setValue(e,{hex:n.value})});var e,n,t=n;Vt(o,nx,{hex:t}),v(o,t)}))}function t(t){return{label:f(lx+t+".label"),description:f(lx+t+".description")}}function c(t){var e=t.red,n=t.green,t=t.blue;a("red",Mt.some(e)),a("green",Mt.some(n)),a("blue",Mt.some(t))}var o={red:It(Mt.some(255)),green:It(Mt.some(255)),blue:It(Mt.some(255)),hex:It(Mt.some("ffffff"))},r=t("red"),i=t("green"),s=t("blue"),l=t("hex");return sr(ux.sketch(function(t){return{dom:{tag:"form",classes:[d("rgb-form")],attributes:{"aria-label":f("aria.color.picker")}},components:[t.field("red",C.sketch(p(Mp,"red",r.label,r.description,255))),t.field("green",C.sketch(p(Mp,"green",i.label,i.description,255))),t.field("blue",C.sketch(p(Mp,"blue",s.label,s.description,255))),t.field("hex",C.sketch(p(Tp,"hex",l.label,l.description,"ffffff"))),b.asSpec()],formBehaviours:Ht([Fv.config({invalidClass:d("form-invalid")}),Lt("rgb-form-events",[Pt(ax,n),Pt(cx,e),Pt(sx,e)])])}}),{apis:{updateHex:function(t,e){var n;zt.setValue(t,{hex:e.value}),h(t,n=Fp(e)),c(n),v(t,e)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,e,n){t.updateHex(e,n)}},extraApis:{}})}function Ub(t){return mx[t]}function jb(t,e,n){return zt.config(sr({store:{mode:"manual",getValue:e,setValue:n}},t.map(function(t){return{store:{initialValue:t}}}).getOr({})))}function Gb(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:Ht([jt.config({ignore:!0}),rv.config({})])}}function Xb(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[Gb([xx]),t,Gb([wx])],behaviours:Ht([dx(1)])}}function Yb(t,e){Vt(t,Oi(),{raw:{which:9,shiftKey:e}})}function qb(t,e){e=e.element;ni(e,xx)?Yb(t,!0):ni(e,wx)&&Yb(t,!1)}function Kb(t){return Lh(t,["."+xx,"."+wx].join(","),N)}function Jb(t,e){return Ny(document.createElement("canvas"),t,e)}function $b(t){var e=Jb(t.width,t.height);return Cx(e).drawImage(t,0,0),e}function Qb(t){return t.naturalWidth||t.width}function Zb(t){return t.naturalHeight||t.height}function ty(t,o,r){return o=o||"image/png",T(HTMLCanvasElement.prototype.toBlob)?new Tv(function(e,n){t.toBlob(function(t){t?e(t):n()},o,r)}):(d=t.toDataURL(o,r),new Tv(function(t,e){!function(){var t=d.split(","),e=/data:([^;]+)/.exec(t[0]);if(!e)return Mt.none();for(var e=e[1],t=t[1],n=atob(t),o=n.length,r=Math.ceil(o/1024),i=new Array(r),u=0;u<r;++u){for(var a=1024*u,c=Math.min(1024+a,o),s=new Array(c-a),l=a,f=0;l<c;++f,++l)s[f]=n[l].charCodeAt(0);i[u]=new Uint8Array(s)}return Mt.some(new Blob(i,{type:e}))}().fold(function(){e("uri is not base64: "+d)},t)}));var d}function ey(t,e,n){function o(e,n){return t.then(function(t){return t.toDataURL(e||"image/png",n)})}return{getType:Dt(e.type),toBlob:function(){return Tv.resolve(e)},toDataURL:Dt(n),toBase64:function(){return n.split(",")[1]},toAdjustedBlob:function(e,n){return t.then(function(t){return ty(t,e,n)})},toAdjustedDataURL:o,toAdjustedBase64:function(t,e){return o(t,e).then(function(t){return t.split(",")[1]})},toCanvas:function(){return t.then($b)}}}function ny(e,t){return ty(e,t).then(function(t){return ey(Tv.resolve(e),t,e.toDataURL())})}function oy(t,e,n){t="string"==typeof t?parseFloat(t):t;return n<t?t=n:t<e&&(t=e),t}function ry(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}function iy(t,e){for(var n=[],o=new Array(25),r=0;r<5;r++){for(var i=0;i<5;i++)n[i]=e[i+5*r];for(i=0;i<5;i++){for(var u=0,a=0;a<5;a++)u+=t[i+5*a]*n[a];o[i+5*r]=u}}return o}function uy(e,n){return e.toCanvas().then(function(t){return Ly(t,e.getType(),n)})}function ay(n){return function(t,e){return uy(t,n(ry(),e))}}function cy(t,e){void 0===e&&(e=2);e=Math.pow(10,e),t=Math.round(t*e);return Math.ceil(t/e)}function sy(t){return _x(t)}function ly(t){return Dx(t)}function fy(t,e){return Bx(t,e)}function dy(t,e){return Tx(t,e)}function my(t,e){return Ex(t,e)}function gy(t,e){return o=e,(n=t).toCanvas().then(function(t){return Uy(t,n.getType(),o)});var n,o}function py(t,e){return o=e,(n=t).toCanvas().then(function(t){return Wy(t,n.getType(),o)});var n,o}function hy(t,e,n){return Kd(t,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:n},e)}function vy(t,e){return hy(t,e,[])}function by(t,e){return hy(t,e,[Ut.config({})])}function yy(t,e,n){return{dom:{tag:"span",innerHtml:n.translate(t),classes:[e+"__select-label"]},behaviours:Ht([Ut.config({})])}}function xy(e,n,o){function t(t,e){t=zt.getValue(t);return jt.focus(t),Vt(t,"keydown",{raw:e.event.raw}),qy.close(t),Mt.some(!0)}var r=It(Et),i=e.text.map(function(t){return Wt(yy(t,n,o.providers))}),u=e.icon.map(function(t){return Wt(by(t,o.providers.icons))}),a=e.role.fold(function(){return{}},function(t){return{role:t}}),c=e.tooltip.fold(function(){return{}},function(t){t=o.providers.translate(t);return{title:t,"aria-label":t}}),s=Kd("chevron-down",{tag:"div",classes:[n+"__select-chevron"]},o.providers.icons);return Wt(qy.sketch(Bt(Bt(Bt({},e.uid?{uid:e.uid}:{}),a),{dom:{tag:"button",classes:[n,n+"--select"].concat(F(e.classes,function(t){return n+"--"+t})),attributes:Bt({},c)},components:qp([u.map(function(t){return t.asSpec()}),i.map(function(t){return t.asSpec()}),Mt.some(s)]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:Ht(M(M([],e.dropdownBehaviours,!0),[Gp(function(){return e.disabled||o.providers.isDisabled()}),lp(),Ky.config({}),Ut.config({}),Lt("dropdown-events",[dp(e,r),mp(e,r)]),Lt("menubutton-update-display-text",[Pt(Rx,function(e,n){i.bind(function(t){return t.getOpt(e)}).each(function(t){Ut.set(t,[ci(o.providers.translate(n.event.text))])})}),Pt(Vx,function(e,n){u.bind(function(t){return t.getOpt(e)}).each(function(t){Ut.set(t,[by(n.event.icon,o.providers.icons)])})})])],!1)),eventOrder:sr(Ix,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:Ht([$.config({mode:"special",onLeft:t,onRight:t})]),lazySink:o.getSink,toggleClass:n+"--active",parts:{menu:ig(0,e.columns,e.presets)},fetch:function(t){return Bv(g(e.fetch,t))}}))).asSpec()}function wy(t){return"separator"===t.type}function Sy(t,n,o,e){var r,i=O("primary-menu"),t=Hx(t,o.shared.providers.menuItems());return 0===t.items.length?Mt.none():(e=zh(i,t.items,n,o,e),r=pt(t.menus,function(t,e){return zh(e,t,n,o,!1)}),r=sr(r,wr(i,e)),Mt.from(km.tieredData(i,r,t.expansions)))}function Cy(n){return{isDisabled:function(){return Nt.isDisabled(n)},setDisabled:function(t){return Nt.set(n,t)},setActive:function(t){var e=n.element;t?(ti(e,"tox-tbtn--enabled"),Ft(e,"aria-pressed",!0)):(ei(e,"tox-tbtn--enabled"),Fe(e,"aria-pressed"))},isActive:function(){return ni(n.element,"tox-tbtn--enabled")}}}function ky(n,t,o,e){return xy({text:n.text,icon:n.icon,tooltip:n.tooltip,role:e,fetch:function(t,e){n.fetch(function(t){e(Sy(t,_g.CLOSE_ON_EXECUTE,o,!1))})},onSetup:n.onSetup,getApi:Cy,columns:1,presets:"normal",classes:[],dropdownBehaviours:[rv.config({})]},t,o.shared)}function Oy(t,e,n,o,r,i){void 0===n&&(n=[]);e=e.fold(function(){return{}},function(t){return{action:t}}),n=Bt({buttonBehaviours:Ht([Gp(function(){return t.disabled||i.isDisabled()}),lp(),rv.config({}),Lt("button press",[Fr("click"),Fr("mousedown")])].concat(n)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},e),e=sr(n,{dom:o});return sr(e,{components:r})}function _y(t,e,n,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map(function(t){return{"aria-label":n.translate(t),title:n.translate(t)}}).getOr({})},i=t.icon.map(function(t){return vy(t,n.icons)});return Oy(t,e,o,r,qp([i]),n)}function Ty(t,e,n,o){void 0===o&&(o=[]);t=_y(t,Mt.some(e),n,o);return Em.sketch(t)}function Ey(t,e,n,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=n.translate(t.text),u=t.icon?t.icon.map(function(t){return vy(t,n.icons)}):Mt.none(),a=u.isSome()?qp([u]):[],c=u.isSome()?{}:{innerHtml:i},u=M(M(M(M([],t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],!0),u.isSome()?["tox-button--icon"]:[],!0),t.borderless?["tox-button--naked"]:[],!0),r,!0);return Oy(t,e,o,Bt(Bt({tag:"button",classes:u},c),{attributes:{title:i}}),a,n)}function Dy(t,e,n,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);t=Ey(t,Mt.some(e),n,o,r);return Em.sketch(t)}function By(e,n){return function(t){"custom"===n?Vt(t,lv,{name:e,value:{}}):"submit"===n?Rt(t,fv):"cancel"===n?Rt(t,sv):console.error("Unknown button type: ",n)}}function My(e,t,n){var r,o,i,u;return"menu"===t?(r=Wt(ky(Bt(Bt({},u=e),{onSetup:function(t){return t.setDisabled(e.disabled),Et},fetch:(o=u.items,i=n,function(t){t(F(o,function(t){var e,n,o=t.text.fold(function(){return{}},function(t){return{text:t}});return Bt(Bt({type:t.type,active:!1},o),{onAction:function(t){var e=!t.isActive();t.setActive(e),n.storage.set(e),i.shared.getSink().each(function(t){r.getOpt(t).each(function(t){xa(t.element),Vt(t,lv,{name:n.name,value:n.storage.get()})})})},onSetup:(e=n=t,function(t){t.setActive(e.storage.get())})})}))})}),"tox-tbtn",n,Mt.none()))).asSpec():"custom"===t||"cancel"===t||"submit"===t?(u=By(e.name,t),Dy(Bt(Bt({},e),{borderless:!1}),u,n.shared.providers,[])):void console.error("Unknown footer button type: ",t)}function Ay(t,e){return df({factory:C,name:t,overrides:function(o){return{fieldBehaviours:Ht([Lt("coupled-input-behaviour",[Pt(Ti(),function(n){Qs(n,o,e).bind(J.getCurrent).each(function(e){Qs(n,o,"lock").each(function(t){p.isOn(t)&&o.onLockedChange(n,e,t)})})})])])}}})}function Fy(t){var e=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);return null===e?K.error(t):(t=parseFloat(e[1]),e=e[2],K.value({value:t,unit:e}))}function Iy(t,e){function n(t){return ne(o,t)}var o={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1};return t.unit===e?Mt.some(t.value):n(t.unit)&&n(e)?o[t.unit]===o[e]?Mt.some(t.value):Mt.some(t.value/o[t.unit]*o[e]):Mt.none()}function Ry(t){return Mt.none()}function Vy(o,e){function t(t){return Kd(t,{tag:"span",classes:["tox-icon","tox-lock-icon__"+t]},e.icons)}function n(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}}function r(n){return C.parts.field({factory:hv,inputClasses:["tox-textfield"],inputBehaviours:Ht([Nt.config({disabled:function(){return o.disabled||e.isDisabled()}}),lp(),rv.config({}),Lt("size-input-events",[Pt(Ci(),function(t,e){Vt(t,a,{isField1:n})}),Pt(Ei(),function(t,e){Vt(t,av,{name:o.name})})])]),selectOnFocus:!1})}function i(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:e.translate(t)}}}var u=Ry,a=O("ratio-event"),c=zx.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:e.translate(o.label.getOr("Constrain proportions"))}},components:[t("lock"),t("unlock")],buttonBehaviours:Ht([Nt.config({disabled:function(){return o.disabled||e.isDisabled()}}),lp(),rv.config({})])}),s=zx.parts.field1(n([C.parts.label(i("Width")),r(!0)])),l=zx.parts.field2(n([C.parts.label(i("Height")),r(!1)]));return zx.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[s,l,n([i("&nbsp;"),c])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,o,e){Fy(zt.getValue(t)).each(function(t){u(t).each(function(t){var e,n;zt.setValue(o,(n=-1!==(n=(t=t).value.toFixed((e=t.unit)in(n={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4})?n[e]:1)).indexOf(".")?n.replace(/\.?0*$/,""):n)+t.unit)})})},coupledFieldBehaviours:Ht([Nt.config({disabled:function(){return o.disabled||e.isDisabled()},onDisabled:function(t){zx.getField1(t).bind(C.getField).each(Nt.disable),zx.getField2(t).bind(C.getField).each(Nt.disable),zx.getLock(t).each(Nt.disable)},onEnabled:function(t){zx.getField1(t).bind(C.getField).each(Nt.enable),zx.getField2(t).bind(C.getField).each(Nt.enable),zx.getLock(t).each(Nt.enable)}}),lp(),Lt("size-input-events2",[Pt(a,function(t,e){var e=e.event.isField1,n=e?zx.getField1(t):zx.getField2(t),e=e?zx.getField2(t):zx.getField1(t),t=n.map(zt.getValue).getOr(""),n=e.map(zt.getValue).getOr(""),e=Fy(t).toOptional(),t=Fy(n).toOptional();u=oe(e,t,function(t,o){return Iy(t,o.unit).map(function(t){return o.value/t}).map(function(t){return e=t,n=o.unit,function(t){return Iy(t,n).map(function(t){return{value:t*e,unit:n}})};var e,n}).getOr(Ry)}).getOr(Ry)})])])})}function Py(t){if(_(t.changedTouches))for(var e="screenX screenY pageX pageY clientX clientY".split(" "),n=0;n<e.length;n++)t[e[n]]=t.changedTouches[0][e[n]]}function Hy(o,t){return{uid:o.uid,dom:o.dom,components:t,behaviours:Ns(o.formBehaviours,[zt.config({store:{mode:"manual",getValue:function(t){return pt(el(t,o),function(t,o){return t().bind(function(t){var e=J.getCurrent(t),n=new Error("Cannot find a current component to extract the value from for form part '"+o+"': "+Wr(t.element));return e.fold(function(){return K.error(n)},K.value)}).map(zt.getValue)})},setValue:function(n,t){gt(t,function(e,t){Qs(n,o,t).each(function(t){J.getCurrent(t).each(function(t){zt.setValue(t,e)})})})}}})]),apis:{getField:function(t,e){return Qs(t,o,e).bind(J.getCurrent)}}}}function zy(){return J.config({find:Mt.some})}(mi=_v=_v||{})[mi.HighlightFirst=0]="HighlightFirst",mi[mi.HighlightNone=1]="HighlightNone";function Ny(t,e,n){return t.width=e,t.height=n,t}function Ly(t,e,T){var n=Cx(t),o=function(t){for(var e,n,o,r,i=t.data,u=T[0],a=T[1],c=T[2],s=T[3],l=T[4],f=T[5],d=T[6],m=T[7],g=T[8],p=T[9],h=T[10],v=T[11],b=T[12],y=T[13],x=T[14],w=T[15],S=T[16],C=T[17],k=T[18],O=T[19],_=0;_<i.length;_+=4)e=i[_],n=i[_+1],o=i[_+2],r=i[_+3],i[_]=e*u+n*a+o*c+r*s+l,i[_+1]=e*f+n*d+o*m+r*g+p,i[_+2]=e*h+n*v+o*b+r*y+x,i[_+3]=e*w+n*S+o*C+r*k+O;return t}(n.getImageData(0,0,t.width,t.height));return n.putImageData(o,0,0),ny(t,e)}function Wy(t,e,n){var n=(n<0?360+n:n)*Math.PI/180,o=t.width,r=t.height,i=Math.sin(n),u=Math.cos(n),a=cy(Math.abs(o*u)+Math.abs(r*i)),i=cy(Math.abs(o*i)+Math.abs(r*u)),u=Jb(a,i),c=Cx(u);return c.translate(a/2,i/2),c.rotate(n),c.drawImage(t,-o/2,-r/2),ny(u,e)}function Uy(t,e,n){var o=Jb(t.width,t.height),r=Cx(o);return"v"===n?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),ny(o,e)}var jy,Gy,Xy,Yy=function(e,t){return e.getSystem().getByUid(t.uid+"-"+Rv()).map(function(t){return function(){return K.value(t)}}).getOrThunk(function(){return t.lazySink.fold(function(){return function(){return K.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(t){return function(){return t(e)}})})},Gc=Dt([y("dom"),y("fetch"),t("onOpen"),qu("onExecute"),S("getHotspot",Mt.some),S("getAnchorOverrides",Dt({})),Bc(),Hs("dropdownBehaviours",[p,Iv,$,jt]),y("toggleClass"),S("eventOrder",{}),zo("lazySink"),S("matchWidth",!1),S("useMinWidth",!1),zo("role")].concat(Wv())),sf=Dt([af({schema:[Gu()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),fm()]),qy=sl({name:"Dropdown",configFields:Gc(),partFields:sf(),factory:function(e,t,n,o){function r(t){m.getState(t).each(function(t){km.highlightPrimary(t)})}function i(t,e){return Dr(t),Mt.some(!0)}var u={expand:function(t){p.isOn(t)||Hv(e,x,t,o,Et,_v.HighlightNone).get(Et)},open:function(t){p.isOn(t)||Hv(e,x,t,o,Et,_v.HighlightFirst).get(Et)},isOpen:p.isOn,close:function(t){p.isOn(t)&&Hv(e,x,t,o,Et,_v.HighlightFirst).get(Et)},repositionMenus:function(t){p.isOn(t)&&Lv(t)}};return{uid:e.uid,dom:e.dom,components:t,behaviours:Ns(e.dropdownBehaviours,[p.config({toggleClass:e.toggleClass,aria:{mode:"expanded"}}),Iv.config({others:{sandbox:function(t){return Nv(e,t,{onOpen:function(){return p.on(t)},onClose:function(){return p.off(t)}})}}}),$.config({mode:"special",onSpace:i,onEnter:i,onDown:function(t,e){return qy.isOpen(t)?r(Iv.getCoupled(t,"sandbox")):qy.open(t),Mt.some(!0)},onEscape:function(t,e){return qy.isOpen(t)?(qy.close(t),Mt.some(!0)):Mt.none()}}),jt.config({})]),events:_d(Mt.some(function(t){Hv(e,x,t,o,r,_v.HighlightFirst).get(Et)})),eventOrder:Bt(Bt({},e.eventOrder),((t={})[Hi()]=["disabling","toggling","alloy.base.behaviour"],t)),apis:u,domModification:{attributes:Bt(Bt({"aria-haspopup":"true"},e.role.fold(function(){return{}},function(t){return{role:t}})),"button"===e.dom.tag?{type:I(e.dom,"attributes").bind(function(t){return I(t,"type")}).getOr("button")}:{})}}},apis:{open:function(t,e){return t.open(e)},expand:function(t,e){return t.expand(e)},close:function(t,e){return t.close(e)},isOpen:function(t,e){return t.isOpen(e)},repositionMenus:function(t,e){return t.repositionMenus(e)}}}),Ky=va({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return iu([Ar(Fi(),L)])},exhibit:function(){return Kr({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),Jy=O("color-input-change"),$y=O("color-swatch-change"),Qy=O("color-picker-cancel"),im=mf({schema:[y("dom")],name:"label"}),lf=Uv("top-left"),am=Uv("top"),ff=Uv("top-right"),Aa=Uv("right"),cm=Uv("bottom-right"),lm=Uv("bottom"),sm=Uv("bottom-left"),lu=[im,Uv("left"),Aa,am,lm,lf,ff,sm,cm,df({name:"thumb",defaults:Dt({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:iu([Vr(gi(),t,"spectrum"),Vr(pi(),t,"spectrum"),Vr(hi(),t,"spectrum"),Vr(bi(),t,"spectrum"),Vr(yi(),t,"spectrum"),Vr(wi(),t,"spectrum")])}}}),df({schema:[xr("mouseIsDown",function(){return It(!1)})],name:"spectrum",overrides:function(n){function o(e,t){return r.getValueFromEvent(t).map(function(t){return r.setValueFrom(e,n,t)})}var r=n.model.manager;return{behaviours:Ht([$.config({mode:"special",onLeft:function(t){return r.onLeft(t,n)},onRight:function(t){return r.onRight(t,n)},onUp:function(t){return r.onUp(t,n)},onDown:function(t){return r.onDown(t,n)}}),jt.config({})]),events:iu([Pt(gi(),o),Pt(pi(),o),Pt(bi(),o),Pt(yi(),function(t,e){n.mouseIsDown.get()&&o(t,e)})])}}})],Zy=Dt("slider.change.value"),tx="left",mi=Ab(-1),Gc=Ab(1),sf=Mt.none,im=Mt.none,Aa={"top-left":Mt.none(),top:Mt.none(),"top-right":Mt.none(),right:Mt.some(function(t,e){pb(t,{x:$v(e)})}),"bottom-right":Mt.none(),bottom:Mt.none(),"bottom-left":Mt.none(),left:Mt.some(function(t,e){pb(t,{x:Yv(e)})})},am=Object.freeze({__proto__:null,setValueFrom:function(t,e,n){e=Mb(t,e,n);return Bb(t,{x:e}),e},setToMin:function(t,e){Bb(t,{x:Gv(e)})},setToMax:function(t,e){Bb(t,{x:Kv(e)})},findValueOfOffset:Mb,getValueFromEvent:function(t){return jv(t).map(function(t){return t.left})},findPositionOfValue:Fb,setPositionFromValue:function(t,e,n,o){var r=mb(n),r=Fb(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),n),o=qe(e.element)/2;q(e.element,"left",r-o+"px")},onLeft:mi,onRight:Gc,onUp:sf,onDown:im,edgeActions:Aa}),lm=Mt.none,lf=Mt.none,ff=Vb(-1),sm=Vb(1),cm={"top-left":Mt.none(),top:Mt.some(function(t,e){pb(t,{y:qv(e)})}),"top-right":Mt.none(),right:Mt.none(),"bottom-right":Mt.none(),bottom:Mt.some(function(t,e){pb(t,{y:Qv(e)})}),"bottom-left":Mt.none(),left:Mt.none()},mi=Object.freeze({__proto__:null,setValueFrom:function(t,e,n){e=Rb(t,e,n);return Ib(t,{y:e}),e},setToMin:function(t,e){Ib(t,{y:Xv(e)})},setToMax:function(t,e){Ib(t,{y:Jv(e)})},findValueOfOffset:Rb,getValueFromEvent:function(t){return jv(t).map(function(t){return t.top})},findPositionOfValue:Pb,setPositionFromValue:function(t,e,n,o){var r=mb(n),r=Pb(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),n),o=je(e.element)/2;q(e.element,"top",r-o+"px")},onLeft:lm,onRight:lf,onUp:ff,onDown:sm,edgeActions:cm}),Gc=jv,sf=Nb(-1,!1),im=Nb(1,!1),Aa=Nb(-1,!0),lm=Nb(1,!0),lf={"top-left":Mt.some(function(t,e){pb(t,gb(Yv(e),qv(e)))}),top:Mt.some(function(t,e){pb(t,gb(nb(e),qv(e)))}),"top-right":Mt.some(function(t,e){pb(t,gb($v(e),qv(e)))}),right:Mt.some(function(t,e){pb(t,gb($v(e),ob(e)))}),"bottom-right":Mt.some(function(t,e){pb(t,gb($v(e),Qv(e)))}),bottom:Mt.some(function(t,e){pb(t,gb(nb(e),Qv(e)))}),"bottom-left":Mt.some(function(t,e){pb(t,gb(Yv(e),Qv(e)))}),left:Mt.some(function(t,e){pb(t,gb(Yv(e),ob(e)))})},ff=Object.freeze({__proto__:null,setValueFrom:function(t,e,n){e=zb(Mb(t,e,n.left),Rb(t,e,n.top));return Hb(t,e),e},setToMin:function(t,e){Hb(t,zb(Gv(e),Xv(e)))},setToMax:function(t,e){Hb(t,zb(Kv(e),Jv(e)))},getValueFromEvent:Gc,setPositionFromValue:function(t,e,n,o){var r=mb(n),i=Fb(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),n),r=Pb(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),n),o=qe(e.element)/2,t=je(e.element)/2;q(e.element,"left",i-o+"px"),q(e.element,"top",r-t+"px")},onLeft:sf,onRight:im,onUp:Aa,onDown:lm,edgeActions:lf}),ex=sl({name:"Slider",configFields:[S("stepSize",1),S("onChange",Et),S("onChoose",Et),S("onInit",Et),S("onDragStart",Et),S("onDragEnd",Et),S("snapToGrid",!1),S("rounded",!0),zo("snapStart"),Fo("model",Mo("mode",{x:[S("minX",0),S("maxX",100),xr("value",function(t){return It(t.mode.minX)}),y("getInitialValue"),$u("manager",am)],y:[S("minY",0),S("maxY",100),xr("value",function(t){return It(t.mode.minY)}),y("getInitialValue"),$u("manager",mi)],xy:[S("minX",0),S("maxX",100),S("minY",0),S("maxY",100),xr("value",function(t){return It({x:t.mode.minX,y:t.mode.minY})}),y("getInitialValue"),$u("manager",ff)]})),Hs("sliderBehaviours",[$,zt]),xr("mouseIsDown",function(){return It(!1)})],partFields:lu,factory:function(r,t,e,n){function i(t){return Zs(t,r,"thumb")}function u(t){return Zs(t,r,"spectrum")}function o(t){return Qs(t,r,"left-edge")}function a(t){return Qs(t,r,"right-edge")}function c(t){return Qs(t,r,"top-edge")}function s(t){return Qs(t,r,"bottom-edge")}function l(t,e){h.setPositionFromValue(t,e,r,{getLeftEdge:o,getRightEdge:a,getTopEdge:c,getBottomEdge:s,getSpectrum:u})}function f(t,e){p.value.set(e),l(t,i(t))}function d(n){var t=r.mouseIsDown.get();r.mouseIsDown.set(!1),t&&Qs(n,r,"thumb").each(function(t){var e=p.value.get();r.onChoose(n,t,e)})}function m(t,e){e.stop(),r.mouseIsDown.set(!0),r.onDragStart(t,i(t))}function g(t,e){e.stop(),r.onDragEnd(t,i(t)),d(t)}var p=r.model,h=p.manager;return{uid:r.uid,dom:r.dom,components:t,behaviours:Ns(r.sliderBehaviours,[$.config({mode:"special",focusIn:function(t){return Qs(t,r,"spectrum").map($.focusIn).map(L)}}),zt.config({store:{mode:"manual",getValue:function(t){return p.value.get()}}}),Za.config({channels:((t={})[Kl()]={onReceive:d},t)})]),events:iu([Pt(Zy(),function(t,e){var n;t=t,e=e.event.value,f(t,e),n=i(t),r.onChange(t,n,e),Mt.some(!0)}),uu(function(t,e){var n=p.getInitialValue(),n=(p.value.set(n),i(t)),o=(l(t,n),u(t));r.onInit(t,n,o,p.value.get())}),Pt(gi(),m),Pt(hi(),g),Pt(bi(),m),Pt(wi(),g)]),apis:{resetToMin:function(t){h.setToMin(t,r)},resetToMax:function(t){h.setToMax(t,r)},setValue:f,refresh:l},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(t,e,n){t.setValue(e,n)},resetToMin:function(t,e){t.resetToMin(e)},resetToMax:function(t,e){t.resetToMax(e)},refresh:function(t,e){t.refresh(e)}}}),nx=O("rgb-hex-update"),ox=O("slider-update"),rx=O("palette-update"),ix=[Hs("formBehaviours",[zt])],ux={getField:Yr(function(t,e,n){return t.getField(e,n)}),sketch:function(t){var n,e={field:function(t,e){return n.push(t),Ys("form",Lb(t),e)},record:Dt(n=[])},t=t(e),e=F(e.record(),function(t){return df({name:t,pname:Lb(t)})});return al("form",ix,e,Hy,t)}},ax=O("valid-input"),cx=O("invalid-input"),sx=O("validating-input"),lx="colorcustom.rgb.",fx=function(t){return J.config({find:t.getOpt})},dx=function(t){return J.config({find:function(e){return Se(e.element,t).bind(function(t){return e.getSystem().getByDom(t).toOptional()})}})},mx={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},gx=tinymce.util.Tools.resolve("tinymce.Resource"),px=tinymce.util.Tools.resolve("tinymce.util.Tools"),hx=w([S("preprocess",x),S("postprocess",x)]),vx=function(n,t){var o=Bo("RepresentingConfigs.memento processors",hx,t);return zt.config({store:{mode:"manual",getValue:function(t){t=n.get(t),t=zt.getValue(t);return o.postprocess(t)},setValue:function(t,e){e=o.preprocess(e),t=n.get(t);zt.setValue(t,e)}}})},bx=jb,yx=function(t){return zt.config({store:{mode:"memory",initialValue:t}})},xx=O("alloy-fake-before-tabstop"),wx=O("alloy-fake-after-tabstop"),Sx=!(Hn().browser.isIE()||Hn().browser.isEdge()),Cx=function(t){return t.getContext("2d")},kx=function(t){URL.revokeObjectURL(t.src)},Ox=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],_x=(jy=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1],function(t){return uy(t,jy)}),Tx=ay(function(t,e){return iy(t,[1,0,0,0,e=oy(255*e,-255,255),0,1,0,0,e,0,0,1,0,e,0,0,0,1,0,0,0,0,0,1])}),Ex=ay(function(t,e){var n;return e=oy(e,-1,1),iy(t,[(n=(e*=100)<0?127+e/100*127:127*(0==(n=e%1)?Ox[e]:Ox[Math.floor(e)]*(1-n)+Ox[Math.floor(e)+1]*n)+127)/127,0,0,0,.5*(127-n),0,n/127,0,0,.5*(127-n),0,0,n/127,0,.5*(127-n),0,0,0,1,0,0,0,0,0,1])}),Dx=(Gy=[0,-1,0,-1,5,-1,0,-1,0],function(t){return i=Gy,(r=t).toCanvas().then(function(t){return t=t,e=r.getType(),o=i,o=function(t,e,n){for(var o=function(t,e,n){return n<t?t=n:t<e&&(t=e),t},r=Math.round(Math.sqrt(n.length)),i=Math.floor(r/2),u=t.data,a=e.data,c=t.width,s=t.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(f+h-i,0,c-1),v=4*(o(l+p-i,0,s-1)*c+v),b=n[p*r+h];d+=u[v]*b,m+=u[1+v]*b,g+=u[2+v]*b}var y=4*(l*c+f);a[y]=o(d,0,255),a[1+y]=o(m,0,255),a[2+y]=o(g,0,255)}return e}((n=Cx(t)).getImageData(0,0,t.width,t.height),n.getImageData(0,0,t.width,t.height),o),n.putImageData(o,0,0),ny(t,e);var e,n,o});var r,i}),Bx=(Xy=function(t,e){return 255*Math.pow(t/255,1-e)},function(a,c){return a.toCanvas().then(function(t){for(var e=a.getType(),n=c,o=Cx(t),r=new Array(256),i=0;i<r.length;i++)r[i]=Xy(i,n);var u=function(t,e){for(var n=t.data,o=0;o<n.length;o+=4)n[o]=e[n[o]],n[o+1]=e[n[o+1]],n[o+2]=e[n[o+2]];return t}(o.getImageData(0,0,t.width,t.height),r);return o.putImageData(u,0,0),ny(t,e)})}),Mx=function(t,e,n){var u,a,c,o=Qb(t),r=Zb(t),o=e/o,r=n/r,i=!1,t=((o<.5||2<o)&&(o=o<.5?.5:2,i=!0),(r<.5||2<r)&&(r=r<.5?.5:2,i=!0),u=t,a=o,c=r,new Tv(function(t){var e=Qb(u),n=Zb(u),o=Math.floor(e*a),r=Math.floor(n*c),i=Jb(o,r);Cx(i).drawImage(u,0,0,e,n,0,0,o,r),t(i)}));return i?t.then(function(t){return Mx(t,e,n)}):t},Ax=function(t,e,n,o,r,i){r=Jb(r,i);return Cx(r).drawImage(t,-n,-o),ny(r,e)},Fx=O("toolbar.button.execute"),Ix=((sm={})[Hi()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],sm),Rx=O("update-menu-text"),Vx=O("update-menu-icon"),Px={type:"separator"},Hx=function(t,u){var n;return X((t=P(t)?t.split(" "):t,n=u,0<(t=Z(t,function(t,e){return P(e)?""===e?t:"|"===e?0<t.length&&!wy(t[t.length-1])?t.concat([Px]):t:ne(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])},[])).length&&wy(t[t.length-1])&&t.pop(),t),function(t,e){var n,o,r,i=wy(e=e)?e:(i=I(e,"value").getOrThunk(function(){return O("generated-menu-item")}),sr({value:i},e)),e=(e=u,ne(n=i,"getSubmenuItems")?(e=e,r=(o=n).getSubmenuItems(),r=Hx(r,e),{item:o,menus:sr(r.menus,wr(o.value,r.items)),expansions:sr(r.expansions,wr(o.value,o.value))}):{item:n,menus:{},expansions:{}});return{menus:sr(t.menus,e.menus),items:[e.item].concat(t.items),expansions:sr(t.expansions,e.expansions)}},{menus:{},expansions:{},items:[]})},cm=Dt([S("field1Name","field1"),S("field2Name","field2"),Ku("onLockedChange"),Xu(["lockClass"]),S("locked",!1),Ql("coupledFieldBehaviours",[J,zt])]),Gc=Dt([Ay("field1","field2"),Ay("field2","field1"),df({factory:Em,schema:[y("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:Ht([p.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),zx=sl({name:"FormCoupledInputs",configFields:cm(),partFields:Gc(),factory:function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,behaviours:Zl(n.coupledFieldBehaviours,[J.config({find:Mt.some}),zt.config({store:{mode:"manual",getValue:function(t){var t=ol(t,n,["field1","field2"]),e={};return e[n.field1Name]=zt.getValue(t.field1()),e[n.field2Name]=zt.getValue(t.field2()),e},setValue:function(t,e){t=ol(t,n,["field1","field2"]);yt(e,n.field1Name)&&zt.setValue(t.field1(),e[n.field1Name]),yt(e,n.field2Name)&&zt.setValue(t.field2(),e[n.field2Name])}}})]),apis:{getField1:function(t){return Qs(t,n,"field1")},getField2:function(t){return Qs(t,n,"field2")},getLock:function(t){return Qs(t,n,"lock")}}}},apis:{getField1:function(t,e){return t.getField1(e)},getField2:function(t,e){return t.getField2(e)},getLock:function(t,e){return t.getLock(e)}}}),Nx={undo:Dt(O("undo")),redo:Dt(O("redo")),zoom:Dt(O("zoom")),back:Dt(O("back")),apply:Dt(O("apply")),swap:Dt(O("swap")),transform:Dt(O("transform")),tempTransform:Dt(O("temp-transform")),transformApply:Dt(O("transform-apply"))},sf=Dt("save-state"),im=Dt("disable"),Aa=Dt("enable"),Lx={formActionEvent:lv,saveState:sf,disable:im,enable:Aa},Wx=tinymce.util.Tools.resolve("tinymce.geom.Rect"),Ux=tinymce.util.Tools.resolve("tinymce.util.Observable"),jx=tinymce.util.Tools.resolve("tinymce.util.VK");function Gx(t,e,n,o,r){return Ty({name:t,icon:Mt.some(e),disabled:n,tooltip:Mt.some(t),primary:!1,borderless:!1},o,r)}function Xx(t,e){e?Nt.enable(t):Nt.disable(t)}function Yx(u,e,a,c,n){function s(t,e){return{x:e.x-t.x,y:e.y-t.y,w:e.w,h:e.h}}function w(t,e,n,o){var r=e.x+n*t.deltaX,i=e.y+o*t.deltaY,n=Math.max(20,e.w+n*t.deltaW),e=Math.max(20,e.h+o*t.deltaH),o=(u=Wx.clamp({x:r,y:i,w:n,h:e},a,"move"===t.name),s(a,u));p.fire("updateRect",{rect:o}),l(o)}function o(t){r(u=t)}function r(n){function t(t,e){Fu(C,"#"+S+"-"+t).each(function(t){Ve(t,{left:e.x+"px",top:e.y+"px",width:Math.max(0,e.w)+"px",height:Math.max(0,e.h)+"px"})})}Y(d,function(e){Fu(C,"#"+S+"-"+e.name).each(function(t){Ve(t,{left:n.w*e.xMul+n.x+"px",top:n.h*e.yMul+n.y+"px"})})}),t("top",{x:e.x,y:e.y,w:e.w,h:n.y-e.y}),t("right",{x:n.x+n.w,y:n.y,w:e.w-n.x-n.w+e.x,h:n.h}),t("bottom",{x:e.x,y:n.y+n.h,w:e.w,h:e.h-n.y-n.h+e.y}),t("left",{x:e.x,y:n.y,w:n.x-e.x,h:n.h}),t("move",n)}function l(t){var e;o((e=a,{x:t.x+e.x,y:t.y+e.y,w:t.w,h:t.h}))}var t,i,f=[],S="tox-crid-"+qx++,C=At.fromDom(c),d=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],m=["top","right","bottom","left"];function g(t){Ft(t.target,"aria-grabbed","focus"===t.raw.type?"true":"false")}De(i=At.fromTag("div"),{id:S,class:"tox-croprect-container",role:"grid","aria-dropeffect":"execute"}),$n(C,i),Y(m,function(n){Fu(C,"#"+S).each(function(t){var e=At.fromTag("div");De(e,{id:S+"-"+n,class:"tox-croprect-block","data-mce-bogus":"all"}),q(e,"display","none"),$n(t,e)})}),Y(d,function(n){Fu(C,"#"+S).each(function(t){var e=At.fromTag("div");De(e,{id:S+"-"+n.name,"aria-label":n.label,"aria-grabbed":"false","data-mce-bogus":"all",role:"gridcell",tabindex:"-1",title:n.label}),oi(e,["tox-croprect-handle","tox-croprect-handle-"+n.name]),q(e,"display","none"),$n(t,e)})}),t=F(d,function(e){var n,t,l,f,d,m,g,o,p,h,r,v,b,y;return t=S,l={document:c.ownerDocument,root:Ln(C).dom,handle:S+"-"+e.name,start:function(){n=u},drag:function(t){w(e,n,t.deltaX,t.deltaY)}},o=[],p=[],h=null!=(r=l.document)?r:document,r=null!=(r=l.root)?r:h,v=At.fromDom(h),b=At.fromDom(r.getElementById(null!=(r=l.handle)?r:t)),y=function(t){Py(t.raw),Y(p,function(t){return t.unbind()}),p=[],Qn(f),l.stop&&l.stop(t.raw)},o.push(ic(b,"mousedown",i),ic(b,"touchstart",i)),{destroy:function(){Y(p.concat(o),function(t){return t.unbind()}),p=[],o=[],_(f)&&Qn(f)}};function i(t){var e,n,o,r,i,u,a=t.raw,c=(e=Math.max,n=h.documentElement,o=h.body,r=e(n.scrollWidth,o.scrollWidth),s=e(n.clientWidth,o.clientWidth),c=e(n.offsetWidth,o.offsetWidth),i=e(n.scrollHeight,o.scrollHeight),u=e(n.clientHeight,o.clientHeight),{width:r<c?s:r,height:i<e(n.offsetHeight,o.offsetHeight)?u:i}),s=(Py(a),t.prevent(),d=a.button,m=a.screenX,g=a.screenY,He(b,"cursor"));Ve(f=At.fromTag("div",h),{position:"absolute",top:"0",left:"0",width:c.width+"px",height:c.height+"px","z-index":"2147483647",opacity:"0.0001",cursor:s}),$n(jn(v),f),p.push(ic(v,"mousemove",x),ic(v,"touchmove",x),ic(v,"mouseup",y),ic(v,"touchend",y)),l.start(a)}function x(t){var e=t.raw;if(Py(e),e.button!==d)return y(t);e.deltaX=e.screenX-m,e.deltaY=e.screenY-g,t.prevent(),l.drag(e)}}),r(u),f.push(ic(C,"focusin",g),ic(C,"focusout",g),ic(C,"keydown",function(e){var i;function t(t,e,n,o,r){t.stopPropagation(),t.preventDefault(),w(i,n,o,r)}switch(Y(d,function(t){if(Be(e.target,"id")===S+"-"+t.name)return i=t,!1}),e.raw.keyCode){case jx.LEFT:t(e,0,u,-10,0);break;case jx.RIGHT:t(e,0,u,10,0);break;case jx.UP:t(e,0,u,0,-10);break;case jx.DOWN:t(e,0,u,0,10);break;case jx.ENTER:case jx.SPACEBAR:e.prevent(),n()}}));var p=Bt(Bt({},Ux),{toggleVisibility:function(t){var e=M(M([],F(d,function(t){return"#"+S+"-"+t.name}),!0),F(m,function(t){return"#"+S+"-"+t}),!0).join(","),e=ns(C,e);Y(e,t?function(t){return Le(t,"display")}:function(t){return q(t,"display","none")})},setClampRect:function(t){a=t,r(u)},setRect:o,getInnerRect:function(){return s(a,u)},setInnerRect:l,setViewPortRect:function(t){e=t,r(u)},destroy:function(){Y(t,function(t){return t.destroy()}),t=[],Y(f,function(t){return t.unbind()}),f=[]}});return p}var qx=0;function Kx(t,e){function a(t){var e=k.getHistoryStates();ct.updateButtonUndoStates(t,e.undoEnabled,e.redoEnabled),Vt(t,Lx.formActionEvent,{name:Lx.saveState(),value:e.undoEnabled})}function V(t){return t.toBlob()}function P(t){Vt(t,Lx.formActionEvent,{name:Lx.disable(),value:{}})}function H(e,t,n,o,r){var i,u;P(e),u=i=t,new Tv(function(t){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(u)}).then(function(t){return ey((a=i,new Tv(function(t,e){function n(){u.removeEventListener("load",o),u.removeEventListener("error",r)}function o(){n(),t(u)}function r(){n(),e("Unable to load data of type "+a.type+": "+i)}var i=URL.createObjectURL(a),u=new Image;u.addEventListener("load",o),u.addEventListener("error",r),u.src=i,u.complete&&setTimeout(o,0)}).then(function(t){kx(t);var e=Jb(Qb(t),Zb(t));return Cx(e).drawImage(t,0,0),e})),i,t);var a}).then(n).then(V).then(o).then(function(t){return _(e,t)}).then(function(){a(e),r(),O(e)}).catch(function(t){console.log(t),e.getSystem().isConnected()&&O(e)})}function z(t,e,n){H(t,k.getBlobState().blob,e,function(t){return k.updateTempState(t)},n)}function N(t){var e=k.getBlobState().url;return k.destroyTempState(),a(t),e}b=t.currentState,w=It(b),S=rc(),x=-1,(C={data:y=[],add:function(t){var e=y.splice(++x);return y.push(t),{state:t,removed:e}},undo:function(){if(ut())return y[--x]},redo:function(){if(at())return y[++x]},canUndo:ut=function(){return 0<x},canRedo:at=function(){return-1!==x&&x<y.length-1}}).add(b);var L,W,U,j,G,l,f,d,u,c,m,s,g,n,o,r,X,Y,q,K,i,J,p,$,Q,Z,tt,et,nt,h,ot,rt,it,v,b,y,x,ut,at,w,S,C,k={getBlobState:function(){return w.get()},setBlobState:wt,addBlobState:Ct,getTempState:function(){return S.get().getOrThunk(w.get)},updateTempState:function(t){t=kt(t);return Ot(),S.set(t),t.url},addTempState:function(t){t=kt(t);return S.set(t),t.url},applyTempState:function(e){return S.get().fold(Et,function(t){Ct(t.blob),e()})},destroyTempState:Ot,undo:function(){var t=C.undo();return wt(t),t.url},redo:function(){var t=C.redo();return wt(t),t.url},getHistoryStates:function(){return{undoEnabled:C.canUndo(),redoEnabled:C.canRedo()}}},O=function(t){st.getApplyButton(t).each(function(t){Nt.enable(t)}),Vt(t,Lx.formActionEvent,{name:Lx.enable(),value:{}})},_=function(t,e){return P(t),T.updateSrc(t,e)},T=(U=t.currentState.url,G=Wt({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),l=It(1),j=nc(),f=Bt(Bt({},j),{run:function(t){return j.get().each(t)}}),d=It({x:0,y:0,w:1,h:1}),u=It({x:0,y:0,w:1,h:1}),{memContainer:c=Wt(ov.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[G.asSpec(),{dom:{tag:"img",attributes:{src:U}}},{dom:{tag:"div"},behaviours:Ht([Lt("image-panel-crop-events",[uu(function(t){c.getOpt(t).each(function(t){t=t.element.dom,t=Yx({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t,Et);t.toggleVisibility(!1),t.on("updateRect",function(t){var t=t.rect,e=l.get(),t={x:Math.round(t.x/e),y:Math.round(t.y/e),w:Math.round(t.w/e),h:Math.round(t.h/e)};d.set(t)}),f.set(t)})}),au(function(){f.clear()})])])}],containerBehaviours:Ht([Ut.config({}),Lt("image-panel-events",[uu(function(t){Tt(t,U)})])])})),updateSrc:Tt,zoom:function(t,e){var n=l.get(),e=0<e?Math.min(2,n+.1):Math.max(.1,n-.1);l.set(e),c.getOpt(t).each(function(t){var e=t.components()[1].element;_t(t,e)})},showCrop:function(){f.run(function(t){t.toggleVisibility(!0)})},hideCrop:function(){f.run(function(t){t.toggleVisibility(!1)})},getRect:function(){return d.get()},getMeasurements:function(){var t=u.get();return{width:t.w,height:t.h}}}),ct=(L=Wt(Gx("Undo","undo",!0,function(t){Vt(t,Nx.undo(),{direction:1})},b=e)),W=Wt(Gx("Redo","redo",!0,function(t){Vt(t,Nx.redo(),{direction:1})},b)),{container:ov.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[L.asSpec(),W.asSpec(),Gx("Zoom in","zoom-in",!1,function(t){Vt(t,Nx.zoom(),{direction:1})},b),Gx("Zoom out","zoom-out",!1,function(t){Vt(t,Nx.zoom(),{direction:-1})},b)]}),updateButtonUndoStates:function(t,e,n){L.getOpt(t).each(function(t){Xx(t,e)}),W.getOpt(t).each(function(t){Xx(t,n)})}}),st=(m=T,s=e,g={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},t=Et,n=[A(),F(),E("Apply",function(t){pt(t,function(t){var e,n=m.getRect(),o=n.x,r=n.y,i=n.w,n=n.h,u=o,a=r,c=i,s=n;return(e=t).toCanvas().then(function(t){return Ax(t,e.getType(),u,a,c,s)})}),m.hideCrop()},!1,!0)],b=ov.sketch({dom:g,components:n.map(function(t){return t.asSpec()}),containerBehaviours:Ht([Lt("image-tools-crop-buttons-events",[Pt(Lx.disable(),function(t,e){B(n,t)}),Pt(Lx.enable(),function(t,e){lt(n,t)})])])}),o=Wt(Vy({name:"size",label:Mt.none(),constrain:!0,disabled:!1},s)),r=[A(),F(),o,F(),E("Apply",function(n){o.getOpt(n).each(function(t){var r,i,t=zt.getValue(t),e=parseInt(t.width,10),t=parseInt(t.height,10);r=e,i=t;pt(n,function(t){return n=r,o=i,(e=t).toCanvas().then(function(t){return Mx(t,n,o).then(function(t){return ny(t,e.getType())})});var e,n,o})})},!1,!0)],e=ov.sketch({dom:g,components:r.map(function(t){return t.asSpec()}),containerBehaviours:Ht([Lt("image-tools-resize-buttons-events",[Pt(Lx.disable(),function(t,e){B(r,t)}),Pt(Lx.enable(),function(t,e){lt(r,t)})])])}),X=I(gy,"h"),Y=I(gy,"v"),q=I(py,-90),K=I(py,90),i=[A(),F(),D("flip-horizontally","Flip horizontally",function(t){vt(t,X)},!1),D("flip-vertically","Flip vertically",function(t){vt(t,Y)},!1),D("rotate-left","Rotate counterclockwise",function(t){vt(t,q)},!1),D("rotate-right","Rotate clockwise",function(t){vt(t,K)},!1),F(),ht()],J=ov.sketch({dom:g,components:i.map(function(t){return t.asSpec()}),containerBehaviours:Ht([Lt("image-tools-fliprotate-buttons-events",[Pt(Lx.disable(),function(t,e){B(i,t)}),Pt(Lx.enable(),function(t,e){lt(i,t)})])])}),p=[A(),F(),ht()],p=ov.sketch({dom:g,components:p.map(function(t){return t.asSpec()})}),$=yt("Brightness",dy,-100,0,100),Q=yt("Contrast",my,-100,0,100),Z=yt("Gamma",fy,-100,0,100),tt=xt("R"),et=xt("G"),nt=xt("B"),h=[A(),tt,et,nt,ht()],h=ov.sketch({dom:g,components:h.map(function(t){return t.asSpec()})}),ot=Mt.some(ly),rt=Mt.some(sy),b=[D("crop","Crop",R(b,Mt.none(),function(t){m.showCrop()}),!1),D("resize","Resize",R(e,Mt.none(),function(t){o.getOpt(t).each(function(t){var e=m.getMeasurements(),n=e.width,e=e.height;zt.setValue(t,{width:n,height:e})})}),!1),D("orientation","Orientation",R(J,Mt.none(),t),!1),D("brightness","Brightness",R($,Mt.none(),t),!1),D("sharpen","Sharpen",R(p,ot,t),!1),D("contrast","Contrast",R(Q,Mt.none(),t),!1),D("color-levels","Color levels",R(h,Mt.none(),t),!1),D("gamma","Gamma",R(Z,Mt.none(),t),!1),D("invert","Invert",R(p,rt,t),!1)],it=ov.sketch({dom:g,components:b.map(function(t){return t.asSpec()})}),{memContainer:v=Wt(ov.sketch({dom:{tag:"div"},components:[it],containerBehaviours:Ht([Ut.config({})])})),getApplyButton:function(t){return v.getOpt(t).map(function(t){t=t.components()[0];return t.components()[t.components().length-1]})}});function E(t,e,n,o){return Wt(Dy({name:t,text:t,disabled:n,primary:o,icon:Mt.none(),borderless:!1},e,s))}function D(t,e,n,o){return Wt(Ty({name:t,icon:Mt.some(t),tooltip:Mt.some(e),disabled:o,primary:!1,borderless:!1},n,s))}function B(t,e){t.map(function(t){t=t.get(e);t.hasConfigured(Nt)&&Nt.disable(t)})}function lt(t,e){t.map(function(t){t=t.get(e);t.hasConfigured(Nt)&&Nt.enable(t)})}function M(t,e,n){Vt(t,e,n)}function ft(t){Rt(t,Lx.disable())}function dt(t){Rt(t,Lx.enable())}function mt(t,e){ft(t),M(t,Nx.transform(),{transform:e}),dt(t)}function gt(t){return function(){v.getOpt(t).each(function(t){Ut.set(t,[it])})}}function pt(t,e){ft(t),M(t,Nx.transformApply(),{transform:e,swap:gt(t)}),dt(t)}function A(){return E("Back",function(t){return M(t,Nx.back(),{swap:gt(t)})},!1,!1)}function F(){return Wt({dom:{tag:"div",classes:["tox-spacer"]},behaviours:Ht([Nt.config({})])})}function ht(){return E("Apply",function(t){return M(t,Nx.apply(),{swap:gt(t)})},!0,!0)}function I(e,n){return function(t){return e(t,n)}}function vt(t,e){ft(t=t),M(t,Nx.tempTransform(),{transform:e}),dt(t)}function bt(t,e,n,o,r){var t=ex.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:s.translate(t)}}),i=ex.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),u=ex.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Wt(ex.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:n,maxX:r,getInitialValue:Dt({x:o})},components:[t,i,u],sliderBehaviours:Ht([jt.config({})]),onChoose:e}))}function yt(t,e,n,o,r){t=t,e=e,n=n,o=o,r=r;var i,u=[A(),(i=e,bt(t,function(t,e,n){mt(t,I(i,n.x/100))},n,o,r)),ht()];return ov.sketch({dom:g,components:u.map(function(t){return t.asSpec()}),containerBehaviours:Ht([Lt("image-tools-filter-panel-buttons-events",[Pt(Lx.disable(),function(t,e){B(u,t)}),Pt(Lx.enable(),function(t,e){lt(u,t)})])])})}function xt(t){return bt(t,function(c,t,e){var n=tt.getOpt(c),o=nt.getOpt(c),r=et.getOpt(c);n.each(function(a){o.each(function(u){r.each(function(t){var n,o,r,e=zt.getValue(a).x/100,t=zt.getValue(t).x/100,i=zt.getValue(u).x/100;n=e,o=t,r=i;mt(c,function(t){return uy(t,(t=o,e=r,iy(ry(),[oy(n,0,2),0,0,0,0,0,oy(t,0,2),0,0,0,0,0,oy(e,0,2),0,0,0,0,0,1,0,0,0,0,0,1])));var e})})})})},0,100,200)}function R(e,n,o){return function(t){M(t,Nx.swap(),{transform:n,swap:function(){v.getOpt(t).each(function(t){Ut.set(t,[e]),o(t)})}})}}function wt(t){w.set(t)}function St(t){URL.revokeObjectURL(t.url)}function Ct(t){var t=kt(t),e=(wt(t),C.add(t).removed);return px.each(e,St),t.url}function kt(t){return{blob:t,url:URL.createObjectURL(t)}}function Ot(){S.on(St),S.clear()}function _t(t,s){c.getOpt(t).each(function(t){var n=l.get(),o=qe(t.element),r=je(t.element),i=s.dom.naturalWidth*n,u=s.dom.naturalHeight*n,a=Math.max(0,o/2-i/2),c=Math.max(0,r/2-u/2),e={left:a.toString()+"px",top:c.toString()+"px",width:i.toString()+"px",height:u.toString()+"px",position:"absolute"};Ve(s,e),G.getOpt(t).each(function(t){Ve(t.element,e)}),f.run(function(t){var e=d.get();t.setRect({x:e.x*n+a,y:e.y*n+c,w:e.w*n,h:e.h*n}),t.setClampRect({x:a,y:c,w:i,h:u}),t.setViewPortRect({x:0,y:0,w:o,h:r})})})}function Tt(t,e){var n,i=At.fromTag("img");return Ft(i,"src",e),n=i.dom,new Ym(function(t){var e=function(){n.removeEventListener("load",e),t(n)};n.complete?t(n):n.addEventListener("load",e)}).then(function(){t.getSystem().isConnected()&&c.getOpt(t).map(function(t){var e=li({element:i}),e=(Ut.replaceAt(t,1,Mt.some(e)),u.get()),n={x:0,y:0,w:i.dom.naturalWidth,h:i.dom.naturalHeight};u.set(n);var r,o=Wx.inflate(n,-20,-20);d.set(o),e.w===n.w&&e.h===n.h||(r=i,c.getOpt(t).each(function(t){var e=qe(t.element),t=je(t.element),n=r.dom.naturalWidth,o=r.dom.naturalHeight,e=Math.min(e/n,t/o);1<=e?l.set(1):l.set(e)})),_t(t,i)})})}return{dom:{tag:"div",attributes:{role:"presentation"}},components:[st.memContainer.asSpec(),T.memContainer.asSpec(),ct.container],behaviours:Ht([zt.config({store:{mode:"manual",getValue:function(){return k.getBlobState()}}}),Lt("image-tools-events",[Pt(Nx.undo(),function(e,t){var n=k.undo();_(e,n).then(function(t){O(e),a(e)})}),Pt(Nx.redo(),function(e,t){var n=k.redo();_(e,n).then(function(t){O(e),a(e)})}),Pt(Nx.zoom(),function(t,e){e=e.event.direction;T.zoom(t,e)}),Pt(Nx.back(),function(t,e){var n,t=N(n=t);_(n,t).then(function(t){O(n)}),(0,e.event.swap)(),T.hideCrop()}),Pt(Nx.apply(),function(t,e){k.applyTempState(function(){N(t),(0,e.event.swap)()})}),Pt(Nx.transform(),function(t,e){return z(t,e.event.transform,Et)}),Pt(Nx.tempTransform(),function(t,e){e=e.event.transform;H(t,k.getTempState().blob,e,function(t){return k.addTempState(t)},Et)}),Pt(Nx.transformApply(),function(t,e){var n=t,t=e.event.transform,e=e.event.swap,o=k.getBlobState().blob;H(n,o,t,function(t){t=k.addBlobState(t);return N(n),t},e)}),Pt(Nx.swap(),function(e,t){ct.updateButtonUndoStates(e,!1,!1);var n=t.event.transform,o=t.event.swap;n.fold(function(){o()},function(t){z(e,t,o)})})]),zy()])}}function Jx(t){return!ne(t,"items")}function $x(n,e){var t=n.label.map(function(t){return Jh(t,e)}),o=[Nt.config({disabled:function(){return n.disabled||e.isDisabled()}}),lp(),$.config({mode:"execution",useEnter:!0!==n.multiline,useControlEnter:!0===n.multiline,execute:function(t){return Rt(t,fv),Mt.some(!0)}}),Lt("textfield-change",[Pt(Ti(),function(t,e){Vt(t,av,{name:n.name})}),Pt(Vi(),function(t,e){Vt(t,av,{name:n.name})})]),rv.config({})],r=n.validation.map(function(n){return Fv.config({getRoot:function(t){return ye(t.element)},invalidClass:"tox-invalid",validator:{validate:function(t){var t=zt.getValue(t),e=n.validator(t);return Mv(!0===e?K.value(t):K.error(e))},validateOnLoad:n.validateOnLoad}})}).toArray(),i=n.placeholder.fold(Dt({}),function(t){return{placeholder:e.translate(t)}}),u=n.inputMode.fold(Dt({}),function(t){return{inputmode:t}}),i=Bt(Bt({},i),u);return Kh(t,C.parts.field({tag:!0===n.multiline?"textarea":"input",inputAttributes:i,inputClasses:[n.classname],inputBehaviours:Ht(nt([o,r])),selectOnFocus:!1,factory:hv}),(n.flex?["tox-form__group--stretched"]:[]).concat(n.maximized?["tox-form-group--maximize"]:[]),[Nt.config({disabled:function(){return n.disabled||e.isDisabled()},onDisabled:function(t){C.getField(t).each(Nt.disable)},onEnabled:function(t){C.getField(t).each(Nt.enable)}}),lp()])}function Qx(t){var e=It(null);return Cu({readState:function(){return{timer:null!==e.get()?"set":"unset"}},setTimer:function(t){e.set(t)},cancel:function(){var t=e.get();null!==t&&t.cancel()}})}function Zx(t,e,n){n=zt.getValue(n);zt.setValue(e,n),zw(e)}function t0(t,e){var t=t.element,n=ii(t),o=t.dom;"number"!==Be(t,"type")&&e(o,n)}function e0(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:Et}}function n0(t,e){return{type:"menuitem",value:e,text:t,meta:{attach:void 0},onAction:Et}}function o0(t,e){return n=t,F(G(e,function(t){return t.type===n}),e0);var n}function r0(t,e){var n=t.toLowerCase();return G(e,function(t){return kt((void 0!==t.meta&&void 0!==t.meta.text?t.meta:t).text.toLowerCase(),n)||kt(t.value.toLowerCase(),n)})}function i0(i,e,u){function r(t){t=zt.getValue(t);u.addToHistory(t.value,i.filetype)}var n=e.shared.providers,t=C.parts.field({factory:qw,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":$w,type:"url"},minChars:0,responseTime:0,fetch:function(t){var n,o,r,t=Sy((n=i.filetype,o=u,t=zt.getValue(t),r=void 0!==t.meta.text?t.meta.text:t.value,o.getLinkInformation().fold(function(){return[]},function(t){var e=r0(r,F(o.getHistory(n),function(t){return n0(t,t)}));return"file"===n?Z([e,r0(r,o0("header",t.targets)),r0(r,nt([Mt.from(t.anchorTop).map(function(t){return n0("<top>",t)}).toArray(),o0("anchor",t.targets),Mt.from(t.anchorBottom).map(function(t){return n0("<bottom>",t)}).toArray()]))],function(t,e){return 0===t.length||0===e.length?t.concat(e):t.concat(Jw,e)},[]):e})),_g.BUBBLE_TO_SANDBOX,e,!1);return Mv(t)},getHotspot:function(t){return f.getOpt(t)},onSetValue:function(t,e){t.hasConfigured(Fv)&&Fv.run(t).get(Et)},typeaheadBehaviours:Ht(nt([u.getValidationHandler().map(function(o){return Fv.config({getRoot:function(t){return ye(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,e){a.getOpt(t).each(function(t){Ft(t.element,"title",n.translate(e))})}},validator:{validate:function(t){var e=zt.getValue(t);return Kw(Bv(function(n){o({type:i.filetype,url:e.value},function(t){var e;"invalid"===t.status?(e=K.error(t.message),n(e)):(e=K.value(t.message),n(e))})}))},validateOnLoad:!1}})}).toArray(),[Nt.config({disabled:function(){return i.disabled||n.isDisabled()}}),rv.config({}),Lt("urlinput-events",nt(["file"===i.filetype?[Pt(Ti(),function(t){Vt(t,av,{name:i.name})})]:[],[Pt(Ei(),function(t){Vt(t,av,{name:i.name}),r(t)}),Pt(Vi(),function(t){Vt(t,av,{name:i.name}),r(t)})]]))]])),eventOrder:((t={})[Ti()]=["streaming","urlinput-events","invalidating"],t),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:e.shared.getSink,parts:{menu:ig(0,0,"normal")},onExecute:function(t,e,n){Vt(e,fv,{})},onItemExecute:function(t,e,n,o){r(t),Vt(t,av,{name:i.name})}}),o=i.label.map(function(t){return Jh(t,n)}),a=Wt((c=Mt.some($w),Kd("warning",{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-invalid"],attributes:Bt({title:n.translate("invalid"),"aria-live":"polite"},c.fold(function(){return{}},function(t){return{id:t}}))},n.icons))),c=Wt({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[a.asSpec()]}),s=u.getUrlPicker(i.filetype),l=O("browser.url.event"),f=Wt({dom:{tag:"div",classes:["tox-control-wrap"]},components:[t,c.asSpec()],behaviours:Ht([Nt.config({disabled:function(){return i.disabled||n.isDisabled()}})])}),d=Wt(Dy({name:i.name,icon:Mt.some("browse"),text:i.label.getOr(""),disabled:i.disabled,primary:!1,borderless:!0},function(t){return Rt(t,l)},n,[],["tox-browse-url"]));return C.sketch({dom:uv([]),components:o.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:nt([[f.asSpec()],s.map(function(){return d.asSpec()}).toArray()])}]),fieldBehaviours:Ht([Nt.config({disabled:function(){return i.disabled||n.isDisabled()},onDisabled:function(t){C.getField(t).each(Nt.disable),d.getOpt(t).each(Nt.disable)},onEnabled:function(t){C.getField(t).each(Nt.enable),d.getOpt(t).each(Nt.enable)}}),lp(),Lt("url-input-events",[Pt(l,function(o){J.getCurrent(o).each(function(e){var t=zt.getValue(e),n=Bt({fieldname:i.name},t);s.each(function(t){t(n).get(function(t){zt.setValue(e,t),Vt(o,av,{name:i.name})})})})})])])})}function u0(r){return function(e,n,o){return I(n,"name").fold(function(){return r(n,o)},function(t){return e.field(t,r(n,o))})}}function a0(e,t,n){var o=sr(n,{shared:{interpreter:function(t){return tS(e,t,o)}}});return tS(e,t,o)}function c0(r){return Mt.from(r.getParam("style_formats")).filter(c).map(function(t){e=r,n=oS(t),e.formatter?o(n.customFormats):e.on("init",function(){o(n.customFormats)});var e,n,t=n.formats;function o(t){Y(t,function(t){e.formatter.has(t.name)||e.formatter.register(t.name,t.format)})}return r.getParam("style_formats_merge",!1,"boolean")?nS.concat(t):t}).getOr(nS)}function s0(t,e,n){e={type:"formatter",isSelected:e(t.format),getStylePreview:n(t.format)};return sr(t,e)}function l0(o,t,r,i){function u(t){return F(t,function(t){var e,n=Zt(t);return yt(t,"items")?(e=u(t.items),sr(sr(t,{type:"submenu"}),{getStyleItems:Dt(e)})):yt(t,"format")?s0(t,r,i):1===n.length&&$t(n,"title")?sr(t,{type:"separator"}):(t={type:"formatter",format:t="custom-"+(n=P((e=t).name)?e.name:O(e.title)),isSelected:r(t),getStylePreview:i(t)},e=sr(e,t),o.formatter.register(n,e),e)})}return u(t)}function f0(n){return function(t){if(_(e=t)&&1===e.nodeType){if(t.contentEditable===n)return!0;if(t.getAttribute("data-mce-contenteditable")===n)return!0}var e;return!1}}function d0(t,e,n,o,r){return{type:t,title:e,url:n,level:o,attach:r}}function m0(t){return t.innerText||t.textContent}function g0(t){return t&&"A"===t.nodeName&&void 0!==(t.id||t.name)&&Iw(t)}function p0(t){return t&&/^(H[1-6])$/.test(t.nodeName)}function h0(t){return p0(t)&&Iw(t)}function v0(t){var e,n=t.id||O("h");return d0("header",m0(t),"#"+n,p0(e=t)?parseInt(e.nodeName.substr(1),10):0,function(){t.id=n})}function b0(t){var e=t.id||t.name;return d0("anchor",m0(t)||"#"+e,"#"+e,0,Et)}function y0(t){return 0<rS(t.title).length}function x0(t){return P(t)&&/^https?/.test(t)}function w0(t){return H(t)&&vt(t,function(t){return!(c(t=t)&&t.length<=5&&rt(t,x0))}).isNone()}function S0(){var t,e=uh.getItem(aS);if(null===e)return{};try{t=JSON.parse(e)}catch(t){if(t instanceof SyntaxError)return console.log("Local storage "+aS+" was not valid JSON",t),{};throw t}return w0(t)?t:(console.log("Local storage "+aS+" was not valid format",t),{})}function C0(t){return I(S0(),t).getOr([])}function k0(e,t){var n,o;if(x0(e)){o=G(I(n=S0(),t).getOr([]),function(t){return t!==e}),n[t]=[e].concat(o).slice(0,5);t=n;if(!w0(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));uh.setItem(aS,JSON.stringify(t))}}function O0(t){return!!t}function _0(t){return pt(px.makeMap(t,/[, ]/),O0)}function T0(t){return Mt.from(t.getParam("file_picker_callback")).filter(T)}function E0(t){return Mt.from(t).filter(P).getOrUndefined()}function D0(V,t,e){var n,o,r,i,u,a,c,s,l,f,d,m,g,p,h,v,b,y,x,w,S,C,k,O,_,T,E,D=It(!1),B={isPositionedAtTop:function(){return"top"===n.get()},getDockingMode:(n=It(np(t)?"bottom":"top")).get,setDockingMode:n.set},M={shared:{providers:{icons:function(){return t.ui.registry.getAll().icons},menuItems:function(){return t.ui.registry.getAll().menuItems},translate:Dm.translate,isDisabled:function(){return t.mode.isReadOnly()||t.ui.isDisabled()},getSetting:t.getParam.bind(t)},interpreter:function(t){return tS(Zw,t,M)},anchors:(h=t,e=e,v=B.isPositionedAtTop,E=rp(h),{inlineDialog:(k=A,O=e,_=F,T={maxHeightFunction:Oc()},function(){return _()?{type:"node",root:_e(k()),node:Mt.from(k()),bubble:fc(12,12,eS),layouts:{onRtl:function(){return[Vd]},onLtr:function(){return[Rd]}},overrides:T}:{type:"hotspot",hotspot:O(),bubble:fc(-12,12,eS),layouts:{onRtl:function(){return[Ua]},onLtr:function(){return[ja]}},overrides:T}}),banner:(w=A,S=e,C=F,function(){return C()?{type:"node",root:_e(w()),node:Mt.from(w()),layouts:{onRtl:function(){return[em]},onLtr:function(){return[em]}}}:{type:"hotspot",hotspot:S(),layouts:{onRtl:function(){return[qa]},onLtr:function(){return[qa]}}}}),cursor:(y=h,function(){return{type:"selection",root:x(),getSelection:function(){var t=y.selection.getRng();return Mt.some(Qc.range(At.fromDom(t.startContainer),t.startOffset,At.fromDom(t.endContainer),t.endOffset))}}}),node:(b=x=function(){return At.fromDom(h.getBody())},function(t){return{type:"node",root:b(),node:t}})}),header:B,getSink:function(){return K.value(V)}},urlinput:{getHistory:C0,addToHistory:k0,getLinkInformation:function(){return!1===(t=p).getParam("typeahead_urls")?Mt.none():Mt.some({targets:Nw(t.getBody()),anchorTop:E0(t.getParam("anchor_top","#top")),anchorBottom:E0(t.getParam("anchor_bottom","#bottom"))});var t},getValidationHandler:function(){return Mt.from(void 0===(e=(t=p).getParam("file_picker_validator_handler",void 0,"function"))?t.getParam("filepicker_validator_handler",void 0,"function"):e);var t,e},getUrlPicker:function(t){return e=u=p,t=a=t,i=Mt.some((n=e).getParam("file_picker_types")).filter(O0),o=Mt.some(n.getParam("file_browser_callback_types")).filter(O0),r=i.or(o).map(_0),i=T0(n).fold(N,function(t){return r.fold(L,function(t){return 0<Zt(t).length&&t})}),(z(i)?i?T0(e):Mt.none():i[t]?T0(e):Mt.none()).map(function(o){return function(e){return Bv(function(n){var t=Bt({filetype:a,fieldname:e.fieldname},Mt.from(e.meta).getOr({}));o.call(u,function(t,e){if(!P(t))throw new Error("Expected value to be string");if(void 0!==e&&!H(e))throw new Error("Expected meta to be a object");n({value:t,meta:e})},e.value,t)})}});var e,n,o,r,i,u,a}},styleselect:(l=It([]),f=It([]),d=It([]),m=It([]),g=It(!(s=function(t){var e=t.items;return void 0!==e&&0<e.length?ot(e,s):[t.format]})),(c=p=t).on("PreInit",function(t){var e=c0(c),e=l0(c,e,I,R);l.set(e),f.set(ot(e,s))}),c.on("addStyleModifications",function(t){var e=l0(c,t.items,I,R);d.set(e),g.set(t.replace),m.set(ot(e,s))}),{getData:function(){var t=g.get()?[]:l.get(),e=d.get();return t.concat(e)},getFlattenedKeys:function(){var t=g.get()?[]:f.get(),e=m.get();return t.concat(e)}}),colorinput:{colorPicker:function(t,e){Dh(a)(t,e)},hasCustomColors:function(){return ch(u)},getColors:function(){return sh(i)},getColorCols:(r=i=u=a=t,function(){return fh(r)})},dialog:{isDraggableModal:(o=t,function(){return o.getParam("draggable_modal",!1,"boolean")})},isContextMenuOpen:function(){return D.get()},setContextMenuState:function(t){return D.set(t)}};function A(){return At.fromDom(h.getContentAreaContainer())}function F(){return E||!v()}function I(t){return function(){return c.formatter.match(t)}}function R(e){return function(){var t=c.formatter.get(e);return void 0!==t?Mt.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styles:c.dom.parseStyle(c.formatter.getCssText(e))}):Mt.none()}}return M}function B0(t){return(xt(ze(t,"position"),"fixed")?Mt.none():xe(t)).orThunk(function(){var e=At.fromTag("span");return ye(t).bind(function(t){$n(t,e);t=xe(e);return Qn(e),t})})}function M0(t){return B0(t).map(Ye).getOrThunk(function(){return Yn(0,0)})}function A0(t,e,n){return rt(t,function(t){switch(t){case"bottom":return e.bottom<=n.bottom;case"top":return e.y>=n.y}})}function F0(e,t){return t.getInitialPos().map(function(t){return eo(t.bounds.x,t.bounds.y,qe(e),je(e))})}function I0(n,o,r){return r.getInitialPos().bind(function(t){switch(r.clearInitialPos(),t.position){case"static":return Mt.some(mS.static());case"absolute":var e=B0(n).map(no).getOrThunk(function(){return no(Un())});return Mt.some(mS.absolute(Oa("absolute",I(t.style,"left").map(function(t){return o.x-e.x}),I(t.style,"top").map(function(t){return o.y-e.y}),I(t.style,"right").map(function(t){return e.right-o.right}),I(t.style,"bottom").map(function(t){return e.bottom-o.bottom}))));default:return Mt.none()}})}function R0(e,t,n){n.setDocked(!1),Y(["left","right","top","bottom","position"],function(t){return Le(e.element,t)}),t.onUndocked(e)}function V0(t,e,n,o){var r="fixed"===o.position;n.setDocked(r),_a(t.element,o),(r?e.onDocked:e.onUndocked)(t)}function P0(n,t,o,r,i){void 0===i&&(i=!1),t.contextual.each(function(e){e.lazyContext(n).each(function(t){t=t.y<r.bottom&&t.bottom>r.y;t!==o.isVisible()&&(o.setVisible(t),i&&!t?(oi(n.element,[e.fadeOutClass]),e.onHide(n)):(t?function(t,e){var n=t.element;ti(n,e.transitionClass),ei(n,e.fadeOutClass),ti(n,e.fadeInClass),e.onShow(t)}:function(t,e){var n=t.element;ti(n,e.transitionClass),ei(n,e.fadeInClass),ti(n,e.fadeOutClass),e.onHide(t)})(n,e))})})}function H0(t,e,n){var o,r,i,u,a,c;n.isDocked()&&(r=e,i=n,c=(o=t).element,i.setDocked(!1),F0(a=o.element,u=i).bind(function(t){return I0(a,t,u)}).each(function(t){t.fold(function(){return R0(o,r,i)},function(t){return V0(o,r,i,t)},Et)}),i.setVisible(!0),r.contextual.each(function(t){ri(c,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(o)}),Lw(o,r,i))}function z0(t,e){return $t(gS.getModes(t),e)}function N0(o){var r=o.element;ye(r).each(function(t){var e,n="padding-"+gS.getModes(o)[0];gS.isDocked(o)?(e=qe(t),q(r,"width",e+"px"),q(t,n,Ge(e=r)+(parseInt(He(e,"margin-top"),10)||0)+(parseInt(He(e,"margin-bottom"),10)||0)+"px")):(Le(r,"width"),Le(t,n))})}function L0(t,e){e?(ei(t,hS.fadeOutClass),oi(t,[hS.transitionClass,hS.fadeInClass])):(ei(t,hS.fadeInClass),oi(t,[hS.fadeOutClass,hS.transitionClass]))}function W0(t,e){t=At.fromDom(t.getContainer());e?(ti(t,vS),ei(t,bS)):(ti(t,bS),ei(t,vS))}function U0(r,t){function n(e){o().each(function(t){return e(t.element)})}function e(t){r.inline||N0(t),W0(r,gS.isDocked(t)),t.getSystem().broadcastOn([ql()],{}),o().each(function(t){return t.getSystem().broadcastOn([ql()],{})})}var i=rc(),o=t.getSink,u=r.inline?[]:[Za.config({channels:((u={})[pS()]={onReceive:N0},u)})];return M([jt.config({}),gS.config({contextual:Bt({lazyContext:function(t){var e=Ge(t.element),n=r.inline?r.getContentAreaContainer():r.getContainer(),n=no(At.fromDom(n)),o=n.height-e,t=n.y+(z0(t,"top")?0:e);return Mt.some(eo(n.x,t,n.width,o))},onShow:function(){n(function(t){return L0(t,!0)})},onShown:function(r){n(function(t){return ri(t,[hS.transitionClass,hS.fadeInClass])}),i.get().each(function(t){var e,n=r.element,o=pe(e=t);Sa(o).filter(function(t){return!me(e,t)}).filter(function(t){return me(t,At.fromDom(o.dom.body))||ge(n,t)}).each(function(){return xa(e)}),i.clear()})},onHide:function(t){var t=t.element,e=o;Ca(t).orThunk(function(){return e().toOptional().bind(function(t){return Ca(t.element)})}).fold(i.clear,i.set),n(function(t){return L0(t,!1)})},onHidden:function(){n(function(t){return ri(t,[hS.transitionClass])})}},hS),lazyViewport:function(t){var e=oo(),n=r.getParam("toolbar_sticky_offset",0,"number"),o=e.y+(z0(t,"top")?n:0),t=e.height-(z0(t,"bottom")?n:0);return eo(e.x,o,e.width,t)},modes:[t.header.getDockingMode()],onDocked:e,onUndocked:e})],u,!0)}function j0(t){return Eo("menubutton",wS,t)}function G0(e,t){return t.getAnimationRoot.fold(function(){return e.element},function(t){return t(e)})}function X0(t){return t.dimension.property}function Y0(t,e){return t.dimension.getDimension(e)}function q0(t,e){ri(G0(t,e),[e.shrinkingClass,e.growingClass])}function K0(t,e){ei(t.element,e.openClass),ti(t.element,e.closedClass),q(t.element,X0(e),"0px"),We(t.element)}function J0(t,e){ei(t.element,e.closedClass),ti(t.element,e.openClass),Le(t.element,X0(e))}function $0(t,e,n,o){n.setCollapsed(),q(t.element,X0(e),Y0(e,t.element)),We(t.element),q0(t,e),K0(t,e),e.onStartShrink(t),e.onShrunk(t)}function Q0(t,e,n){var o=Y0(e,t.element);("0px"===o?$0:function(t,e,n,o){o=o.getOrThunk(function(){return Y0(e,t.element)}),n.setCollapsed(),q(t.element,X0(e),o),We(t.element),n=G0(t,e);ei(n,e.growingClass),ti(n,e.shrinkingClass),K0(t,e),e.onStartShrink(t)})(t,e,n,Mt.some(o))}function Z0(t,e,n){var o=G0(t,e),r=ni(o,e.shrinkingClass),i=Y0(e,t.element),u=(J0(t,e),Y0(e,t.element));(r?function(){q(t.element,X0(e),i),We(t.element)}:function(){K0(t,e)})(),ei(o,e.shrinkingClass),ti(o,e.growingClass),J0(t,e),q(t.element,X0(e),u),n.setExpanded(),e.onStartGrow(t)}function tw(t,e,n){return!0===ni(G0(t,e),e.growingClass)}function ew(t,e,n){return!0===ni(G0(t,e),e.shrinkingClass)}function nw(t){return"<alloy.field."+t+">"}function ow(t){return{element:function(){return t.element.dom}}}function rw(t){return J.getCurrent(t).bind(function(t){return kS.isGrowing(t)||kS.hasGrown(t)?J.getCurrent(t).bind(function(e){return tt(TS.getSlotNames(e),function(t){return TS.isShowing(e,t)})}):Mt.none()})}function iw(t){var t=At.fromHtml(t),e=we(t),n=Z(void 0!==t.dom.attributes?t.dom.attributes:[],function(t,e){return"class"===e.name?t:Bt(Bt({},t),((t={})[e.name]=e.value,t))},{}),o=Array.prototype.slice.call(t.dom.classList,0),e=0===e.length?{}:{innerHtml:Nr(t)};return Bt({tag:ie(t),classes:o,attributes:n},e)}function uw(t){J.getCurrent(t).each(function(t){return xa(t.element)})}function aw(t,e,n){return{within:t,extra:e,withinWidth:n}}function cw(t,e,o){n=function(t,e){var n=o(t);return Mt.some({element:t,start:e,finish:e+n,width:n})};var n,t=Z(t,function(e,t){return n(t,e.len).fold(Dt(e),function(t){return{len:t.finish,list:e.list.concat([t])}})},{len:0,list:[]}).list,r=G(t,function(t){return t.finish<=e}),i=X(r,function(t,e){return t+e.width},0);return{within:r,extra:t.slice(r.length),withinWidth:i}}function sw(t){return F(t,function(t){return t.element})}function lw(t,e){e=F(e,function(t){return Tu(t)});lS.setGroups(t,e)}function fw(t,e,n){var o,r,i,u,a,c,s,l,f,d=e.builtGroups.get();0!==d.length&&(o=Zs(t,e,"primary"),t=Iv.getCoupled(t,"overflowGroup"),q(o.element,"visibility","hidden"),r=mt(d=d.concat([t]),function(e){return Ca(e.element).bind(function(t){return e.getSystem().getByDom(t).toOptional()})}),n([]),lw(o,d),d=qe(o.element),0===(i=d,u=e.builtGroups.get(),c=t,d=(e=(0===(d=cw(u,i,a=function(t){return qe(t.element)})).extra.length?Mt.some(d):Mt.none()).getOrThunk(function(){return cw(u,i-a(c),a)})).within,f=e.extra,e=e.withinWidth,(l=1===f.length&&f[0].width<=a(c)?(l=e,aw(sw(d.concat(f)),[],l)):1<=f.length?(l=f,f=c,s=e,aw(sw(d).concat([f]),sw(l),s)):(f=e,aw(sw(d),[],f))).extra.length)?(Ut.remove(o,t),n([])):(lw(o,l.within),n(l.extra)),Le(o.element,"visibility"),We(o.element),r.each(jt.focus))}function dw(t,e){t=Iv.getCoupled(t,"toolbarSandbox");m.isOpen(t)?m.close(t):m.open(t,e.toolbar())}function mw(t,e,n,o){var r=n.getBounds.map(function(t){return t()}),n=n.lazySink(t).getOrDie();jl.positionWithinBounds(n,e,{anchor:{type:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:AS()}}},r)}function gw(t,e,n,o,r){lS.setGroups(e,r),mw(t,e,n,o),p.on(t)}function pw(t){return F(t,function(t){return Tu(t)})}function hw(t,n,o){fw(t,o,function(e){o.overflowGroups.set(e),n.getOpt(t).each(function(t){FS.setGroups(t,pw(e))})})}function vw(e,n){Qs(e,n,"overflow-button").bind(function(){return Qs(e,n,"overflow")}).each(function(t){Vw(e,n),kS.toggleGrow(t)})}function bw(t){var e=t.title.fold(function(){return{}},function(t){return{attributes:{title:t}}});return{dom:Bt({tag:"div",classes:["tox-toolbar__group"]},e),components:[IS.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:Ht([rv.config({}),jt.config({})])}}function yw(t){return IS.sketch(bw(t))}function xw(n,t){var e=uu(function(t){var e=F(n.initGroups,yw);lS.setGroups(t,e)});return Ht([Xp(n.providers.isDisabled),lp(),$.config({mode:t,onEscape:n.onEscape,selector:".tox-toolbar__group"}),Lt("toolbar-events",[e])])}function ww(t){var e=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":bw({title:Mt.none(),items:[]}),"overflow-button":_y({name:"more",icon:Mt.some("more-drawer"),disabled:!1,tooltip:Mt.some("More..."),primary:!1,borderless:!1},Mt.none(),t.providers)},splitToolbarBehaviours:xw(t,e)}}function Sw(t){var e=t.cyclicKeying?"cyclic":"acyclic";return lS.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===kg.scrolling?["tox-toolbar--scrolling"]:[])},components:[lS.parts.groups({})],toolbarBehaviours:xw(t,e)})}function Cw(t){return"string"==typeof t?t.split(" "):t}function kw(r,i){var u=Bt(Bt({},HS),i.menus),n=0<Zt(i.menus).length,t=G(void 0===i.menubar||!0===i.menubar?Cw("file edit view insert format tools table help"):Cw(!1===i.menubar?"":i.menubar),function(t){var e=ne(HS,t);return n?e||I(i.menus,t).exists(function(t){return ne(t,"items")}):e});return G(F(t,function(t){var t=u[t],e={title:t.title,items:Cw(t.items)},n=i,o=r.getParam("removed_menuitems","").split(/[ ,]/);return{text:e.title,getItems:function(){return ot(e.items,function(t){var e=t.toLowerCase();return 0===e.trim().length||V(o,function(t){return t===e})?[]:"separator"===e||"|"===e?[{type:"separator"}]:n.menuItems[e]?[n.menuItems[e]]:[]})}}}),function(t){return 0<t.getItems().length&&V(t.getItems(),function(t){return"separator"!==t.type})})}function Ow(t){function e(){t._skinLoaded=!0,t.fire("SkinLoaded")}return function(){t.initialized?e():t.on("init",e)}}function _w(n,o,r){return new Ym(function(t,e){r.load(o,t,e),n.on("remove",function(){return r.unload(o)})})}function Tw(t,e){r=(i=e).getParam("skin"),o=i.getParam("skin_url"),!1!==r&&(r=r||"oxide",o=o?i.documentBaseURI.toAbsolute(o):Qg.baseURL+"/skins/ui/"+r);var n,o,r,i=o;i&&e.contentCSS.push(i+(t?"/content.inline":"/content")+".min.css"),!1===e.getParam("skin")==0&&P(i)?Ym.all([_w(e,i+"/skin.min.css",e.ui.styleSheetLoader),(r=i,t=At.fromDom((o=e).getElement()),vn(t).isSome()?_w(o,r+"/skin.shadowdom.min.css",$g.DOM.styleSheetLoader):Ym.resolve())]).then(Ow(e),(n=e,function(){return n.fire("SkinLoadError",{message:"Skin could not be loaded"})})):Ow(e)()}function Ew(o,r){return function(e){function t(){e.setActive(o.formatter.match(r));var t=o.formatter.formatChanged(r,e.setActive);n.set(t)}var n=oc();return o.initialized?t():o.once("init",t),function(){o.off("init",t),n.clear()}}}function Dw(o,r,i){return function(t){function e(){return i(t)}function n(){i(t),o.on(r,e)}return o.initialized?n():o.once("init",n),function(){o.off("init",n),o.off(r,e)}}}function Bw(e){return function(t){return function(){e.undoManager.transact(function(){e.focus(),e.execCommand("mceToggleFormat",!1,t.format)})}}}function Mw(t,e){return function(){return t.execCommand(e)}}function Aw(t,e,n){var i,u,a,o=n.dataset,r="basic"===o.type?function(){return F(o.data,function(t){return s0(t,n.isSelectedFor,n.getPreviewFor)})}:o.getData;return{items:(i=e,u=n,a=function(t,e,n){var o="formatter"===t.type&&u.isInvalid(t);return 0===e?o?[]:c(t,e,!1,n).toArray():c(t,e,o,n).toArray()},{validateItems:s,getFetch:function(n,o){return function(t,e){e(Sy(s(o()),_g.CLOSE_ON_EXECUTE,n,!1))}}}),getStyleItems:r};function c(t,e,n,o){var r=i.shared.providers.translate(t.title);return"separator"===t.type?Mt.some({type:"separator",text:r}):"submenu"!==t.type?Mt.some(Bt({type:"togglemenuitem",text:r,icon:t.icon,active:t.isSelected(o),disabled:n,onAction:u.onAction(t)},t.getStylePreview().fold(function(){return{}},function(t){return{meta:{style:t}}}))):(n=ot(t.getStyleItems(),function(t){return a(t,e,o)}),0===e&&n.length<=0?Mt.none():Mt.some({type:"nestedmenuitem",text:r,disabled:n.length<=0,getSubmenuItems:function(){return ot(t.getStyleItems(),function(t){return a(t,e,o)})}}))}function s(t){var e=u.getCurrentValue(),n=u.shouldHide?0:1;return ot(t,function(t){return a(t,n,e)})}}function Fw(t,e,n){var o=Aw(0,e,n),r=o.items,o=o.getStyleItems,t=Dw(t,"NodeChange",function(t){t=t.getComponent();n.updateText(t)});return xy({text:n.icon.isSome()?Mt.none():n.text,icon:n.icon,tooltip:Mt.from(n.tooltip),role:Mt.none(),fetch:r.getFetch(e,o),onSetup:t,getApi:function(t){return{getComponent:Dt(t)}},columns:1,presets:"normal",classes:n.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",e.shared)}function Iw(t){return function(t){for(;t=t.parentNode;){var e=t.contentEditable;if(e&&"inherit"!==e)return iS(t)}return!1}(t)&&!uS(t)}function Rw(r,t){function n(t){return nl(r)}function e(n,o){return function(t,e){return Qs(t,r,e).map(function(t){return n(t,e)}).getOr(o)}}function o(t,e){return"true"!==Be(t.element,"aria-hidden")}var i,u=e(o,!1),a=e(function(t,e){var n;o(t)&&(q(n=t.element,"display","none"),Ft(n,"aria-hidden","true"),Vt(t,Zi(),{name:e,visible:!1}))}),c=(i=a,e(function(t,e){var n;o(t)||(Le(n=t.element,"display"),Fe(n,"aria-hidden"),Vt(t,Zi(),{name:e,visible:!0}))}));return{uid:r.uid,dom:r.dom,components:t,behaviours:zs(r.slotBehaviours),apis:{getSlotNames:n,getSlot:function(t,e){return Qs(t,r,e)},isShowing:u,hideSlot:a,hideAllSlots:function(t){var e;e=t,t=n(),Y(t,function(t){return i(e,t)})},showSlot:c}}}function Vw(t,n){Qs(t,n,"overflow").each(function(e){fw(t,n,function(t){t=F(t,function(t){return Tu(t)});lS.setGroups(e,t)}),Qs(t,n,"overflow-button").each(function(t){kS.hasGrown(e)&&p.on(t)}),kS.refresh(e)})}function Pw(e,n,t,o){return F(t,function(t){return Jx(t)?{type:"togglemenuitem",text:t.text,value:t.value,active:t.value===o,onAction:function(){zt.setValue(e,t.value),Vt(e,av,{name:n}),jt.focus(e)}}:{type:"nestedmenuitem",text:t.text,getSubmenuItems:function(){return Pw(e,n,t.items,o)}}})}function Hw(t,e){return mt(t,function(t){return Jx(t)?St(t.value===e,t):Hw(t.items,e)})}function zw(t){t0(t,function(t,e){t.setSelectionRange(e.length,e.length)})}function Nw(t){return t=F(ns(At.fromDom(t),"h1,h2,h3,h4,h5,h6,a:not([href])"),function(t){return t.dom}),G(F(G(t,h0),v0).concat(F(G(t,g0),b0)),y0)}function Lw(t,e,n){var o,r,i,u;t.getSystem().isConnected()&&(i=n,u=(r=e).lazyViewport(o=t),i.isDocked()&&P0(o,r,i,u),function(t,e,n){var o,r,i,t=t.element;if(xt(ze(t,"position"),"fixed"))return r=e,F0(o=t,i=n).filter(function(t){return A0(i.getModes(),t,r)}).bind(function(t){return I0(o,t,i)});var u,a=no(t=t);if(A0(n.getModes(),a,e))return Mt.none();u=t,t=a,n.setInitialPos({style:function(){var t={},e=u.dom;if(_t(e))for(var n=0;n<e.style.length;n++){var o=e.style.item(n);t[o]=e.style[o]}return t}(),position:He(u,"position")||"static",bounds:t});var n=oo(),t=a.x-n.x,c=e.y-n.y,n=n.bottom-e.bottom,a=a.y<=e.y;return Mt.some(mS.fixed(Oa("fixed",Mt.some(t),a?Mt.some(c):Mt.none(),Mt.none(),a?Mt.none():Mt.some(n))))}(o,u,i).each(function(t){t.fold(function(){return R0(o,r,i)},function(t){return V0(o,r,i,t)},function(t){P0(o,r,i,u,!0),V0(o,r,i,t)})}))}var Ww,Uw,jw="data-value",Gw=cl({name:"HtmlSelect",configFields:[y("options"),Hs("selectBehaviours",[jt,zt]),S("selectClasses",[]),S("selectAttributes",{}),zo("data")],factory:function(n,t){var e=F(n.options,function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}}),o=n.data.map(function(t){return wr("initialValue",t)}).getOr({});return{uid:n.uid,dom:{tag:"select",classes:n.selectClasses,attributes:n.selectAttributes},components:e,behaviours:Ns(n.selectBehaviours,[jt.config({}),zt.config({store:Bt({mode:"manual",getValue:function(t){return ii(t.element)},setValue:function(t,e){tt(n.options,function(t){return t.value===e}).isSome()&&ui(t.element,e)}},o)})])}}}),lm=Object.freeze({__proto__:null,events:function(t,e){var n=t.stream.streams.setup(t,e);return iu([Pt(t.event,n),au(function(){return e.cancel()})].concat(t.cancelEvent.map(function(t){return[Pt(t,function(){return e.cancel()})]}).getOr([])))}}),lf=Object.freeze({__proto__:null,throttle:Qx,init:function(t){return t.stream.streams.state(t)}}),Xw=va({fields:[Fo("stream",Mo("mode",{throttle:[y("delay"),S("stopEvent",!0),$u("streams",{setup:function(t,e){var n=t.stream,o=Im(t.onStream,n.delay);return e.setTimer(o),function(t,e){o.throttle(t,e),n.stopEvent&&e.stop()}},state:Qx})]})),S("event","input"),zo("cancelEvent"),Ku("onStream")],name:"streaming",active:lm,state:lf}),Yw=Dt("alloy.typeahead.itemexecute"),am=Dt([zo("lazySink"),y("fetch"),S("minChars",5),S("responseTime",1e3),t("onOpen"),S("getHotspot",Mt.some),S("getAnchorOverrides",Dt({})),S("layouts",Mt.none()),S("eventOrder",{}),Zo("model",{},[S("getDisplayText",function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value}),S("selectsOver",!0),S("populateFromBrowse",!0)]),t("onSetValue"),qu("onExecute"),t("onItemExecute"),S("inputClasses",[]),S("inputAttributes",{}),S("inputStyles",{}),S("matchWidth",!0),S("useMinWidth",!1),S("dismissOnBlur",!0),Xu(["openClass"]),zo("initialData"),Hs("typeaheadBehaviours",[jt,zt,Xw,$,p,Iv]),xr("previewing",function(){return It(!0)})].concat(um()).concat(Wv())),mi=Dt([af({schema:[Gu()],name:"menu",overrides:function(a){return{fakeFocus:!0,onHighlight:function(n,u){a.previewing.get()?n.getSystem().getByUid(a.uid).each(function(t){var e,o,r,i;e=a.model,o=t,r=u,(e.selectsOver&&(t=zt.getValue(o),i=e.getDisplayText(t),t=zt.getValue(r),0===e.getDisplayText(t).indexOf(i))?Mt.some(function(){var n;Zx(0,o,r),n=i.length,t0(o,function(t,e){t.setSelectionRange(n,e.length)})}):Mt.none()).fold(function(){return wf.dehighlight(n,u)},function(t){return t()})}):n.getSystem().getByUid(a.uid).each(function(t){a.model.populateFromBrowse&&Zx(a.model,t,u)}),a.previewing.set(!1)},onExecute:function(t,e){return t.getSystem().getByUid(a.uid).toOptional().map(function(t){return Vt(t,Yw(),{item:e}),!0})},onHover:function(t,e){a.previewing.set(!1),t.getSystem().getByUid(a.uid).each(function(t){a.model.populateFromBrowse&&Zx(a.model,t,e)})}}}})]),qw=sl({name:"Typeahead",configFields:am(),partFields:mi(),factory:function(r,t,e,i){function n(t,e,n){r.previewing.set(!1);var o=Iv.getCoupled(t,"sandbox");m.isOpen(o)?J.getCurrent(o).each(function(t){wf.getHighlighted(t).fold(function(){n(t)},function(){Mr(o,t.element,"keydown",e)})}):Pv(r,u(t),t,o,i,function(t){J.getCurrent(t).each(n)},_v.HighlightFirst).get(Et)}function u(n){return function(t){return t.map(function(t){var e=ot(bt(t.menus),function(t){return G(t.items,function(t){return"item"===t.type})});return zt.getState(n).update(F(e,function(t){return t.data})),t})}}var o=$h(r),a=[jt.config({}),zt.config({onSetValue:r.onSetValue,store:Bt({mode:"dataset",getDataKey:function(t){return ii(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(t,e){ui(t.element,r.model.getDisplayText(e))}},r.initialData.map(function(t){return wr("initialValue",t)}).getOr({}))}),Xw.config({stream:{mode:"throttle",delay:r.responseTime,stopEvent:!1},onStream:function(t,e){var n,o=Iv.getCoupled(t,"sandbox");jt.isFocused(t)&&ii(t.element).length>=r.minChars&&(n=J.getCurrent(o).bind(function(t){return wf.getHighlighted(t).map(zt.getValue)}),r.previewing.set(!0),Pv(r,u(t),t,o,i,function(t){J.getCurrent(o).each(function(t){n.fold(function(){r.model.selectsOver&&wf.highlightFirst(t)},function(e){wf.highlightBy(t,function(t){return zt.getValue(t).value===e.value}),wf.getHighlighted(t).orThunk(function(){return wf.highlightFirst(t),Mt.none()})})})},_v.HighlightFirst).get(Et))},cancelEvent:Ui()}),$.config({mode:"special",onDown:function(t,e){return n(t,e,wf.highlightFirst),Mt.some(!0)},onEscape:function(t){t=Iv.getCoupled(t,"sandbox");return m.isOpen(t)?(m.close(t),Mt.some(!0)):Mt.none()},onUp:function(t,e){return n(t,e,wf.highlightLast),Mt.some(!0)},onEnter:function(e){var t,n=Iv.getCoupled(e,"sandbox"),o=m.isOpen(n);return o&&!r.previewing.get()?J.getCurrent(n).bind(function(t){return wf.getHighlighted(t)}).map(function(t){return Vt(e,Yw(),{item:t}),!0}):(t=zt.getValue(e),Rt(e,Ui()),r.onExecute(n,e,t),o&&m.close(n),Mt.some(!0))}}),p.config({toggleClass:r.markers.openClass,aria:{mode:"expanded"}}),Iv.config({others:{sandbox:function(t){return Nv(r,t,{onOpen:function(){return p.on(t)},onClose:function(){return p.off(t)}})}}}),Lt("typeaheadevents",[su(function(t){Hv(r,u(t),t,i,Et,_v.HighlightFirst).get(Et)}),Pt(Yw(),function(t,e){var n=Iv.getCoupled(t,"sandbox");Zx(r.model,t,e.event.item),Rt(t,Ui()),r.onItemExecute(t,n,e.event.item,zt.getValue(t)),m.close(n),zw(t)})].concat(r.dismissOnBlur?[Pt(Ri(),function(t){t=Iv.getCoupled(t,"sandbox");Ca(t.element).isNone()&&m.close(t)})]:[]))];return{uid:r.uid,dom:Qh(sr(r,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:Bt(Bt({},o),Ns(r.typeaheadBehaviours,a)),eventOrder:r.eventOrder}}}),Kw=function(i){return Bt(Bt({},i),{toCached:function(){return Kw(i.toCached())},bindFuture:function(e){return Kw(i.bind(function(t){return t.fold(function(t){return Mv(K.error(t))},function(t){return e(t)})}))},bindResult:function(e){return Kw(i.map(function(t){return t.bind(e)}))},mapResult:function(e){return Kw(i.map(function(t){return t.map(e)}))},mapError:function(e){return Kw(i.map(function(t){return t.mapError(e)}))},foldResult:function(e,n){return i.map(function(t){return t.fold(e,n)})},withTimeout:function(t,r){return Kw(Bv(function(e){var n=!1,o=setTimeout(function(){n=!0,e(K.error(r()))},t);i.get(function(t){n||(clearTimeout(o),e(t))})}))}})},Jw={type:"separator"},$w=O("aria-invalid"),Qw={bar:u0(function(t,e){return e=e.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:F(t.items,e.interpreter)}}),collection:u0(function(t,e){return i=t,u=e.shared.providers,t=i.label.map(function(t){return Jh(t,u)}),e=n(function(t,e,n,o){e.stop(),u.isDisabled()||Vt(t,lv,{name:i.name,value:o})}),e=[Pt(Si(),n(function(t,e,n){xa(n)})),Pt(Di(),e),Pt(Ni(),e),Pt(Ci(),n(function(t,e,n){Fu(t.element,"."+Ig).each(function(t){ei(t,Ig)}),ti(n,Ig)})),Pt(ki(),n(function(t){Fu(t.element,"."+Ig).each(function(t){ei(t,Ig)})})),su(n(function(t,e,n,o){Vt(t,lv,{name:i.name,value:o})}))],Kh(t,C.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==i.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:x},behaviours:Ht([Nt.config({disabled:u.isDisabled,onDisabled:function(t){o(t,function(t){ti(t,"tox-collection__item--state-disabled"),Ft(t,"aria-disabled",!0)})},onEnabled:function(t){o(t,function(t){ei(t,"tox-collection__item--state-disabled"),Fe(t,"aria-disabled")})}}),lp(),Ut.config({}),zt.config({store:{mode:"memory",initialValue:[]},onSetValue:function(n,t){var e=n,t=F(t,function(t){var e=Dm.translate(t.text),n=1===i.columns?'<div class="tox-collection__item-label">'+e+"</div>":"",o='<div class="tox-collection__item-icon">'+t.icon+"</div>",r={_:" "," - ":" ","-":" "},e=e.replace(/\_| \- |\-/g,function(t){return r[t]});return'<div class="tox-collection__item'+(u.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+iv.encodeAllRaw(t.value)+'" title="'+e+'" aria-label="'+e+'">'+o+n+"</div>"}),t=F("auto"!==i.columns&&1<i.columns?U(t,i.columns):[t],function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"});Lr(e.element,t.join("")),"auto"===i.columns&&dg(n,5,"tox-collection__item").each(function(t){var e=t.numRows,t=t.numColumns;$.setGridSize(n,e,t)}),Rt(n,pv)}}),rv.config({}),$.config(1===(t=i.columns)?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===t?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:"."+Eg}}),Lt("collection-events",e)]),eventOrder:((t={})[Hi()]=["disabling","alloy.base.behaviour","collection-events"],t)}),["tox-form__group--collection"],[]);function n(o){return function(e,n){Iu(n.event.target,"[data-collection-item-value]").each(function(t){o(e,n,t,Be(t,"data-collection-item-value"))})}}function o(t,e){F(ns(t.element,".tox-collection__item"),e)}var i,u}),alertbanner:u0(function(t,e){return e=e.shared.providers,ov.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+(n=t).level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[Em.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:Xd(n.icon,e.icons),attributes:{title:e.translate(n.iconTooltip)}},action:function(t){Vt(t,lv,{name:"alert-banner",value:n.url})},buttonBehaviours:Ht([Yd()])})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:e.translate(n.text)}}]});var n}),input:u0(function(t,e){return e=e.shared.providers,$x({name:(t=t).name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:t.disabled,classname:"tox-textfield",validation:Mt.none(),maximized:t.maximized},e)}),textarea:u0(function(t,e){return e=e.shared.providers,$x({name:(t=t).name,multiline:!0,label:t.label,inputMode:Mt.none(),placeholder:t.placeholder,flex:!0,disabled:t.disabled,classname:"tox-textarea",validation:Mt.none(),maximized:t.maximized},e)}),label:u0(function(t,e){return r={dom:{tag:"label",innerHtml:(e=e.shared).providers.translate((t=t).label),classes:["tox-label"]}},t=F(t.items,e.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[r].concat(t),behaviours:Ht([zy(),Ut.config({}),(e=Mt.none(),n=Nr,o=Lr,jb(e,function(t){return n(t.element)},function(t,e){return o(t.element,e)})),$.config({mode:"acyclic"})])};var n,o,r}),iframe:function(t,e,n){e=sr(e,{source:"dynamic"});return u0(Ww)(t,e,n)},button:u0(function(t,e){return e=e.shared.providers,n=By((t=t).name,"custom"),Kh(Mt.none(),C.parts.field(Bt({factory:Em},Ey(t,Mt.some(n),e,[yx(""),zy()]))),[],[]);var n}),checkbox:u0(function(t,e){return r=t,i=e.shared.providers,t=zt.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,e){t.element.dom.checked=e}}}),e=C.parts.field({factory:{sketch:x},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:Ht([zy(),Nt.config({disabled:function(){return r.disabled||i.isDisabled()}}),rv.config({}),jt.config({}),t,$.config({mode:"special",onEnter:n,onSpace:n,stopSpaceKeyup:!0}),Lt("checkbox-events",[Pt(Ei(),function(t,e){Vt(t,av,{name:r.name})})])])}),t=C.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:i.translate(r.label)},behaviours:Ht([Ky.config({})])}),u=Wt({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[o("checked"),o("unchecked")]}),C.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[e,u.asSpec(),t],fieldBehaviours:Ht([Nt.config({disabled:function(){return r.disabled||i.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){C.getField(t).each(Nt.disable)},onEnabled:function(t){C.getField(t).each(Nt.enable)}}),lp()])});function n(t){return t.element.dom.click(),Mt.some(!0)}function o(t){return Kd("checked"===t?"selected":"unselected",{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t]},i.icons)}var r,i,u}),colorinput:u0(function(t,e){return n=t,r=e.shared,i=e.colorinput,t=C.parts.field({factory:hv,inputClasses:["tox-textfield"],onSetValue:function(t){return Fv.run(t).get(Et)},inputBehaviours:Ht([Nt.config({disabled:r.providers.isDisabled}),lp(),rv.config({}),Fv.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return ye(t.element)},notify:{onValid:function(t){var e=zt.getValue(t);Vt(t,Jy,{color:e})}},validator:{validateOnLoad:!1,validate:function(t){var e=zt.getValue(t);return 0===e.length?Mv(K.value(!0)):(q(t=At.fromTag("span"),"background-color",e),t=ze(t,"background-color").fold(function(){return K.error("blah")},function(t){return K.value(e)}),Mv(t))}}})]),selectOnFocus:!1}),e=n.label.map(function(t){return Jh(t,r.providers)}),c=Wt((u={dom:{tag:"span",attributes:{"aria-label":r.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[ja,Ua,qa]},onLtr:function(){return[Ua,ja,qa]}},components:[],fetch:ph(i.getColors(),i.hasCustomColors()),columns:i.getColorCols(),presets:"color",onItemAction:function(t,n){c.getOpt(t).each(function(e){"custom"===n?i.colorPicker(function(t){t.fold(function(){return Rt(e,Qy)},function(t){o(e,t),lh(t)})},"#ffffff"):o(e,"remove"===n?"":n)})}},qy.sketch({dom:u.dom,components:u.components,toggleClass:"mce-active",dropdownBehaviours:Ht([Gp((a=r).providers.isDisabled),lp(),Ky.config({}),rv.config({})]),layouts:u.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:a.getSink,fetch:function(e){return Bv(function(t){return u.fetch(t)}).map(function(t){return Mt.from(Nh(sr(yh(O("menu-value"),t,function(t){u.onItemAction(e,t)},u.columns,u.presets,_g.CLOSE_ON_EXECUTE,N,a.providers),{movement:xh(u.columns,u.presets)})))})},parts:{menu:ig(0,0,u.presets)}}))),C.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:e.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[t,c.asSpec()]}]),fieldBehaviours:Ht([Lt("form-field-events",[Pt(Jy,function(t,e){c.getOpt(t).each(function(t){q(t.element,"background-color",e.event.color)}),Vt(t,av,{name:n.name})}),Pt($y,function(e,n){C.getField(e).each(function(t){zt.setValue(t,n.event.value),J.getCurrent(e).each(jt.focus)})}),Pt(Qy,function(e,t){C.getField(e).each(function(t){J.getCurrent(e).each(jt.focus)})})])])});function o(t,e){Vt(t,$y,{value:e})}var n,r,i,u,a,c}),colorpicker:u0(function(t){var x,w,o=Wt((x=Ub,w=function(t){return"tox-"+t},cl({name:"ColourPicker",configFields:[y("dom"),S("onValidHex",Et),S("onInvalidHex",Et)],factory:function(t){function e(t,e,n){v.getOpt(t).each(function(t){g.setHue(t,n)})}function n(t,e){b.getOpt(t).each(function(t){m.updateHex(t,e)})}function o(e,n,o,t){var r=o,i=Fp(n);p.paletteRgba.set(i),p.paletteHue.set(r),Y(t,function(t){t(e,n,o)})}var r,i,u,a,c,s,l,f,d,m=Wb(x,w,t.onValidHex,t.onInvalidHex),g=(l=w,f=ex.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[l("sv-palette-spectrum")]}}),d=ex.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[l("sv-palette-thumb")],innerHtml:"<div class="+l("sv-palette-inner-thumb")+' role="presentation"></div>'}}),cl({factory:function(t){var e=Dt({x:0,y:0}),n=Ht([J.config({find:Mt.some}),jt.config({})]);return ex.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[l("sv-palette")]},model:{mode:"xy",getInitialValue:e},rounded:!1,components:[f,d],onChange:function(t,e,n){Vt(t,rx,{value:n})},onInit:function(t,e,n,o){y(n.element.dom,Vp(ih))},sliderBehaviours:n})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:function(t,e,n){y(e.components()[0].element.dom,Vp(Ap(Hp(n,100,100))))},setThumb:function(t,e,n){n=zp(Fp(n));ex.setValue(e,{x:n.saturation,y:100-n.value})}},extraApis:{}})),p={paletteRgba:It(ih),paletteHue:It(0)},h=Wt((i=ex.parts.spectrum({dom:{tag:"div",classes:[(r=w)("hue-slider-spectrum")],attributes:{role:"presentation"}}}),u=ex.parts.thumb({dom:{tag:"div",classes:[r("hue-slider-thumb")],attributes:{role:"presentation"}}}),ex.sketch({dom:{tag:"div",classes:[r("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:Dt({y:0})},components:[i,u],sliderBehaviours:Ht([jt.config({})]),onChange:function(t,e,n){Vt(t,ox,{value:n})}}))),v=Wt(g.sketch({})),b=Wt(m.sketch({}));function y(t,e){var n=t.width,o=t.height,t=t.getContext("2d");null!==t&&(t.fillStyle=e,t.fillRect(0,0,n,o),(e=t.createLinearGradient(0,0,n,0)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(1,"rgba(255,255,255,0)"),t.fillStyle=e,t.fillRect(0,0,n,o),(e=t.createLinearGradient(0,0,0,o)).addColorStop(0,"rgba(0,0,0,0)"),e.addColorStop(1,"rgba(0,0,0,1)"),t.fillStyle=e,t.fillRect(0,0,n,o))}return{uid:t.uid,dom:t.dom,components:[v.asSpec(),h.asSpec(),b.asSpec()],behaviours:Ht([Lt("colour-picker-events",[Pt(nx,(s=[e,function(t,e,n){h.getOpt(t).each(function(t){ex.setValue(t,{y:100-n/360*100})})},function(t,e){v.getOpt(t).each(function(t){g.setThumb(t,e)})}],function(t,e){e=e.event.hex;o(t,e,zp(Fp(e)).hue,s)})),Pt(rx,(c=[n],function(t,e){var e=e.event.value,n=p.paletteHue.get();o(t,Np(Hp(n,e.x,100-e.y)),n,c)})),Pt(ox,(a=[e,n],function(t,e){var e=(100-e.event.value.y)/100*360,n=zp(p.paletteRgba.get());o(t,Np(Hp(e,n.saturation,n.value)),e,a)}))]),J.config({find:function(t){return b.getOpt(t)}}),$.config({mode:"acyclic"})])}}}).sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(t){Vt(t,lv,{name:"hex-valid",value:!0})},onInvalidHex:function(t){Vt(t,lv,{name:"hex-valid",value:!1})}})));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:Ht([zt.config({store:{mode:"manual",getValue:function(t){t=o.get(t);return J.getCurrent(t).bind(function(t){return zt.getValue(t).hex}).map(function(t){return"#"+t}).getOr("")},setValue:function(t,e){var n=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(e),e=o.get(t);J.getCurrent(e).fold(function(){console.log("Can not find form")},function(t){zt.setValue(t,{hex:Mt.from(n[1]).getOr("")}),ux.getField(t,"hex").each(function(t){Rt(t,Ti())})})}}}),zy()])}}),dropzone:u0(function(t,e){return a=t,c=e.shared.providers,s=Wt({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:Ht([Lt("input-file-events",[Hr(Di()),Hr(Ni())])])}),Kh(a.label.map(function(t){return Jh(t,c)}),C.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:Ht([yx([]),zy(),Nt.config({}),p.config({toggleClass:"dragenter",toggleOnExecute:!1}),Lt("dropzone-events",[Pt("dragenter",o([n,p.toggle])),Pt("dragleave",o([n,p.toggle])),Pt("dragover",n),Pt("drop",o([n,r])),Pt(Ei(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:c.translate("Drop an image here")}},Em.sketch({dom:{tag:"button",innerHtml:c.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[s.asSpec()],action:function(t){s.get(t).element.dom.click()},buttonBehaviours:Ht([rv.config({}),Gp(c.isDisabled),lp()])})]}]}}}}),["tox-form__group--stretched"],[]);function n(t,e){e.stop()}function o(t){return function(e,n){Y(t,function(t){t(e,n)})}}function r(t,e){Nt.isDisabled(t)||u(t,e.event.raw.dataTransfer.files)}function i(t,e){u(t,e.event.raw.target.files)}function u(t,e){var n;zt.setValue(t,(e=e,n=px.explode(c.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string")),G(Qt(e),function(e){return V(n,function(t){return Xt(e.name.toLowerCase(),"."+t.toLowerCase())})}))),Vt(t,av,{name:a.name})}var a,c,s}),grid:u0(function(t,e){return e=e.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:F(t.items,e.interpreter)}}),listbox:u0(function(t,e){return n=t,r=(o=e).shared.providers,i=ft(n.items).filter(Jx),t=n.label.map(function(t){return Jh(t,r)}),e={dom:{tag:"div",classes:["tox-listboxfield"]},components:[C.parts.field({dom:{},factory:{sketch:function(t){return xy({uid:t.uid,text:i.map(function(t){return t.text}),icon:Mt.none(),tooltip:n.label,role:Mt.none(),fetch:function(t,e){e(Sy(Pw(t,n.name,n.items,zt.getValue(t)),_g.CLOSE_ON_EXECUTE,o,!1))},onSetup:Dt(Et),getApi:Dt({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[rv.config({}),zt.config({store:{mode:"manual",initialValue:i.map(function(t){return t.value}).getOr(""),getValue:function(t){return Be(t.element,jw)},setValue:function(e,t){Hw(n.items,t).each(function(t){Ft(e.element,jw,t.value),Vt(e,Rx,{text:t.text})})}}})]},"tox-listbox",o.shared)}}})]},C.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:nt([t.toArray(),[e]]),fieldBehaviours:Ht([Nt.config({disabled:Dt(n.disabled),onDisabled:function(t){C.getField(t).each(Nt.disable)},onEnabled:function(t){C.getField(t).each(Nt.enable)}})])});var n,o,r,i}),selectbox:u0(function(t,e){return n=t,o=e.shared.providers,t=F(n.items,function(t){return{text:o.translate(t.text),value:t.value}}),e=n.label.map(function(t){return Jh(t,o)}),t={dom:{tag:"div",classes:["tox-selectfield"]},components:nt([[C.parts.field({dom:{},selectAttributes:{size:n.size},options:t,factory:Gw,selectBehaviours:Ht([Nt.config({disabled:function(){return n.disabled||o.isDisabled()}}),rv.config({}),Lt("selectbox-change",[Pt(Ei(),function(t,e){Vt(t,av,{name:n.name})})])])})],(1<n.size?Mt.none():Mt.some(Kd("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},o.icons))).toArray()])},C.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:nt([e.toArray(),[t]]),fieldBehaviours:Ht([Nt.config({disabled:function(){return n.disabled||o.isDisabled()},onDisabled:function(t){C.getField(t).each(Nt.disable)},onEnabled:function(t){C.getField(t).each(Nt.enable)}}),lp()])});var n,o}),sizeinput:u0(function(t,e){return Vy(t,e.shared.providers)}),urlinput:u0(function(t,e){return i0(t,e,e.urlinput)}),customeditor:u0(function(n){var o=rc(),e=Wt({dom:{tag:n.tag}}),r=rc();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:Ht([Lt("custom-editor-events",[uu(function(t){e.getOpt(t).each(function(e){(ne(n,"init")?n.init(e.element.dom):gx.load(n.scriptId,n.scriptUrl).then(function(t){return t(e.element.dom,n.settings)})).then(function(e){r.on(function(t){e.setValue(t)}),r.clear(),o.set(e)})})})]),zt.config({store:{mode:"manual",getValue:function(){return o.get().fold(function(){return r.get().getOr("")},function(t){return t.getValue()})},setValue:function(t,e){o.get().fold(function(){r.set(e)},function(t){return t.setValue(e)})}}}),zy()]),components:[e.asSpec()]}}),htmlpanel:u0(function(t){return"presentation"===t.presets?ov.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):ov.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:Ht([rv.config({}),jt.config({})])})}),imagetools:u0(function(t,e){return Kx(t,e.shared.providers)}),table:u0(function(t,e){return t=t,o=e.shared.providers,{dom:{tag:"table",classes:["tox-dialog__table"]},components:[{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:F(t.header,function(t){return{dom:{tag:"th",innerHtml:o.translate(t)}}})}]},{dom:{tag:"tbody"},components:F(t.cells,function(t){return{dom:{tag:"tr"},components:F(t,n)}})}],behaviours:Ht([rv.config({}),jt.config({})])};function n(t){return{dom:{tag:"td",innerHtml:o.translate(t)}}}var o}),panel:u0(function(t,e){return{dom:{tag:"div",classes:t.classes},components:F(t.items,e.shared.interpreter)}})},Zw={field:function(t,e){return e}},tS=function(e,n,o){return I(Qw,n.type).fold(function(){return console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n},function(t){return t(e,n,o)})},eS={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},nS=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],oS=function(t){return Z(t,function(t,e){var n;return ne(e,"items")?(n=oS(e.items),{customFormats:t.customFormats.concat(n.customFormats),formats:t.formats.concat([{title:e.title,items:n.formats}])}):ne(e,"inline")||ne(e,"block")||ne(e,"selector")?(n="custom-"+(P(e.name)?e.name:e.title.toLowerCase()),{customFormats:t.customFormats.concat([{name:n,format:e}]),formats:t.formats.concat([{title:e.title,format:n,icon:e.icon}])}):Bt(Bt({},t),{formats:t.formats.concat(e)})},{customFormats:[],formats:[]})},rS=px.trim,iS=f0("true"),uS=f0("false"),aS="tinymce-url-history",cS=cf,ff=Ka,lu=Dt([S("shell",!(Ww=function(t,e){return t=t,n=e.shared.providers,e=Sx&&t.sandboxed,i=Bt(Bt({},t.label.map(function(t){return{title:t}}).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),o=e,r=It(""),u={getValue:function(t){return r.get()},setValue:function(t,e){o?Ft(t.element,"srcdoc",e):(Ft(t.element,"src","javascript:''"),(t=t.element.dom.contentWindow.document).open(),t.write(e),t.close()),r.set(e)}},Kh(t.label.map(function(t){return Jh(t,n)}),C.parts.field({factory:{sketch:function(t){return Xb({uid:t.uid,dom:{tag:"iframe",attributes:i},behaviours:Ht([rv.config({}),jt.config({}),bx(Mt.none(),u.getValue,u.setValue)])})}}}),["tox-form__group--stretched"],[]);var n,o,r,i,u})),y("makeItem"),S("setupItem",Et),Ql("listBehaviours",[Ut])]),sm=Dt([mf({name:"items",overrides:function(){return{behaviours:Ht([Ut.config({})])}}})]),sS=sl({name:Dt("CustomList")(),configFields:lu(),partFields:sm(),factory:function(u,t,e,n){t=u.shell?{behaviours:[Ut.config({})],components:[]}:{behaviours:[],components:t};return{uid:u.uid,dom:u.dom,components:t.components,behaviours:Ns(u.listBehaviours,t.behaviours),apis:{setItems:function(r,i){var t=r;(u.shell?Mt.some(t):Qs(t,u,"items")).fold(function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},function(e){var t=Ut.contents(e),n=i.length,o=n-t.length,o=0<o?W(o,function(){return u.makeItem()}):[],t=t.slice(n),n=(Y(t,function(t){return Ut.remove(e,t)}),Y(o,function(t){return Ut.append(e,t)}),Ut.contents(e));Y(n,function(t,e){u.setupItem(r,t,i[e],e)})})}}}},apis:{setItems:function(t,e,n){t.setItems(e,n)}}}),cm=Dt([y("dom"),S("shell",!0),Hs("toolbarBehaviours",[Ut])]),Gc=Dt([mf({name:"groups",overrides:function(){return{behaviours:Ht([Ut.config({})])}}})]),lS=sl({name:"Toolbar",configFields:cm(),partFields:Gc(),factory:function(n,t,e,o){t=n.shell?{behaviours:[Ut.config({})],components:[]}:{behaviours:[],components:t};return{uid:n.uid,dom:n.dom,components:t.components,behaviours:Ns(n.toolbarBehaviours,t.behaviours),apis:{setGroups:function(t,e){(n.shell?Mt.some(t):Qs(t,n,"groups")).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(t){Ut.set(t,e)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,e,n){t.setGroups(e,n)}}}),fS=Dt([]),dS=Object.freeze({__proto__:null,setup:Et,isDocked:N,getBehaviours:fS}),mS=tr([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),sf=Object.freeze({__proto__:null,refresh:Lw,reset:H0,isDocked:function(t,e,n){return n.isDocked()},getModes:function(t,e,n){return n.getModes()},setModes:function(t,e,n,o){return n.setModes(o)}}),im=Object.freeze({__proto__:null,events:function(o,r){return iu([zr(Mi(),function(e,n){o.contextual.each(function(t){ni(e.element,t.transitionClass)&&(ri(e.element,[t.transitionClass,t.fadeInClass]),(r.isVisible()?t.onShown:t.onHidden)(e)),n.stop()})}),Pt(Yi(),function(t,e){Lw(t,o,r)}),Pt(qi(),function(t,e){H0(t,o,r)})])}}),gS=va({fields:[Go("contextual",[e("fadeInClass"),e("fadeOutClass"),e("transitionClass"),Ro("lazyContext"),t("onShow"),t("onShown"),t("onHide"),t("onHidden")]),$o("lazyViewport",oo),Qo("modes",["top","bottom"],gr),t("onDocked"),t("onUndocked")],name:"docking",active:im,apis:sf,state:Object.freeze({__proto__:null,init:function(t){var e=It(!1),n=It(!0),o=rc(),r=It(t.modes);return Cu({isDocked:e.get,setDocked:e.set,getInitialPos:o.get,setInitialPos:o.set,clearInitialPos:o.clear,isVisible:n.get,setVisible:n.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+e.get()+", visible: "+n.get()+", modes: "+r.get().join(",")}})}})}),pS=Dt(O("toolbar-height-change")),hS={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},vS="tox-tinymce--toolbar-sticky-on",bS="tox-tinymce--toolbar-sticky-off",yS=Object.freeze({__proto__:null,setup:function(t,e,n){t.inline||(e.header.isPositionedAtTop()||t.on("ResizeEditor",function(){n().each(gS.reset)}),t.on("ResizeWindow ResizeEditor",function(){n().each(N0)}),t.on("SkinLoaded",function(){n().each(function(t){gS.isDocked(t)?gS.reset(t):gS.refresh(t)})}),t.on("FullscreenStateChanged",function(){n().each(gS.reset)})),t.on("AfterScrollIntoView",function(f){n().each(function(t){gS.refresh(t);var e,n,o,r,i,u,a,c,s,l,t=t.element;Wf(t)&&(r=f,n=(e=pe(t=t)).dom.defaultView.innerHeight,o=rn(e),i=ln(r=At.fromDom(r.elm)),r=je(r),u=(i=i.y)+r,a=Ye(t),t=je(t),c=(a=a.top)+t,s=Math.abs(a-o.top)<2,l=Math.abs(c-(o.top+n))<2,s&&i<c?un(o.left,i-t,e):l&&a<u&&un(o.left,i-n+r+t,e))})}),t.on("PostRender",function(){W0(t,!1)})},isDocked:function(t){return t().map(gS.isDocked).getOr(!1)},getBehaviours:U0}),xS=w([e("type"),Fo("items",Co([fr([e("name"),Ho("items",gr)]),gr]))].concat(Jc)),Aa=[Wo("text"),Wo("tooltip"),Wo("icon"),Ro("fetch"),$o("onSetup",function(){return Et})],wS=w(M([e("type")],Aa,!0)),SS=w([e("type"),Wo("tooltip"),Wo("icon"),Wo("text"),Uo("select"),Ro("fetch"),$o("onSetup",function(){return Et}),Ko("presets","normal",["normal","color","listpreview"]),S("columns",1),Ro("onAction"),Ro("onItemAction")]),CS=cl({factory:function(e,n){var t={focus:$.focusIn,setMenus:function(t,e){e=F(e,function(e){return ky(j0({type:"menubutton",text:e.text,fetch:function(t){t(e.getItems())}}).mapError(function(t){return br(t)}).getOrDie(),"tox-mbtn",n.backstage,Mt.some("menuitem"))});Ut.set(t,e)}};return{uid:e.uid,dom:e.dom,components:[],behaviours:Ht([Ut.config({}),Lt("menubar-events",[uu(function(t){e.onSetup(t)}),Pt(Si(),function(n,t){Fu(n.element,".tox-mbtn--active").each(function(e){Iu(t.event.target,".tox-mbtn").each(function(t){me(e,t)||n.getSystem().getByDom(e).each(function(e){n.getSystem().getByDom(t).each(function(t){qy.expand(t),qy.close(e),jt.focus(t)})})})})}),Pt(Qi(),function(n,t){t.event.prevFocus.bind(function(t){return n.getSystem().getByDom(t).toOptional()}).each(function(e){t.event.newFocus.bind(function(t){return n.getSystem().getByDom(t).toOptional()}).each(function(t){qy.isOpen(e)&&(qy.expand(t),qy.close(e))})})})]),$.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return e.onEscape(t),Mt.some(!0)}}),rv.config({})]),apis:t,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[y("dom"),y("uid"),y("onEscape"),y("backstage"),S("onSetup",Et)],apis:{focus:function(t,e){t.focus(e)},setMenus:function(t,e,n){t.setMenus(e,n)}}}),lm=Object.freeze({__proto__:null,refresh:function(t,e,n){n.isExpanded()&&(Le(t.element,X0(e)),n=Y0(e,t.element),q(t.element,X0(e),n))},grow:function(t,e,n){n.isExpanded()||Z0(t,e,n)},shrink:function(t,e,n){n.isExpanded()&&Q0(t,e,n)},immediateShrink:function(t,e,n){n.isExpanded()&&$0(t,e,n)},hasGrown:function(t,e,n){return n.isExpanded()},hasShrunk:function(t,e,n){return n.isCollapsed()},isGrowing:tw,isShrinking:ew,isTransitioning:function(t,e,n){return tw(t,e)||ew(t,e)},toggleGrow:function(t,e,n){(n.isExpanded()?Q0:Z0)(t,e,n)},disableTransitions:q0}),lf=Object.freeze({__proto__:null,exhibit:function(t,e,n){return Kr(e.expanded?{classes:[e.openClass],styles:{}}:{classes:[e.closedClass],styles:wr(e.dimension.property,"0px")})},events:function(n,o){return iu([zr(Mi(),function(t,e){e.event.raw.propertyName===n.dimension.property&&(q0(t,n),o.isExpanded()&&Le(t.element,n.dimension.property),(o.isExpanded()?n.onGrown:n.onShrunk)(t))})])}}),kS=va({fields:[y("closedClass"),y("openClass"),y("shrinkingClass"),y("growingClass"),zo("getAnimationRoot"),t("onShrunk"),t("onStartShrink"),t("onGrown"),t("onStartGrow"),S("expanded",!1),Fo("dimension",Mo("property",{width:[$u("property","width"),$u("getDimension",function(t){return qe(t)+"px"})],height:[$u("property","height"),$u("getDimension",function(t){return je(t)+"px"})]}))],name:"sliding",active:lf,apis:lm,state:Object.freeze({__proto__:null,init:function(t){var e=It(t.expanded);return Cu({isExpanded:function(){return!0===e.get()},isCollapsed:function(){return!1===e.get()},setCollapsed:g(e.set,!1),setExpanded:g(e.set,!0),readState:function(){return"expanded: "+e.get()}})}})}),OS="container",_S=[Hs("slotBehaviours",[])],um=pt({getSlotNames:function(t,e){return t.getSlotNames(e)},getSlot:function(t,e,n){return t.getSlot(e,n)},isShowing:function(t,e,n){return t.isShowing(e,n)},hideSlot:function(t,e,n){return t.hideSlot(e,n)},hideAllSlots:function(t,e){return t.hideAllSlots(e)},showSlot:function(t,e,n){return t.showSlot(e,n)}},Yr),TS=Bt(Bt({},um),{sketch:function(t){var n,e={slot:function(t,e){return n.push(t),Ys(OS,nw(t),e)},record:Dt(n=[])},t=t(e),e=F(e.record(),function(t){return df({name:t,pname:nw(t)})});return al(OS,_S,e,Rw,t)}}),ES=w([Wo("icon"),Wo("tooltip"),$o("onShow",Et),$o("onHide",Et),$o("onSetup",function(){return Et})]),DS=O("FixSizeEvent"),BS=O("AutoSizeEvent"),am=Object.freeze({__proto__:null,block:function(t,e,n,o){Ft(t.element,"aria-busy",!0);var r=e.getRoot(t).getOr(t),i=Ht([$.config({mode:"special",onTab:function(){return Mt.some(!0)},onShiftTab:function(){return Mt.some(!0)}}),jt.config({})]),o=o(r,i),u=r.getSystem().build(o);Ut.append(r,Tu(u)),u.hasConfigured($)&&e.focus&&$.focusIn(u),n.isBlocked()||e.onBlock(t),n.blockWith(function(){return Ut.remove(r,u)})},unblock:function(t,e,n){Fe(t.element,"aria-busy"),n.isBlocked()&&e.onUnblock(t),n.clear()}}),MS=va({fields:[$o("getRoot",Mt.none),Jo("focus",!0),t("onBlock"),t("onUnblock")],name:"blocking",apis:am,state:Object.freeze({__proto__:null,init:function(){var e=nc();return Cu({readState:e.isSet,blockWith:function(t){e.set({destroy:t})},clear:e.clear,isBlocked:e.isSet})}})}),mi=Dt([Hs("splitToolbarBehaviours",[Iv]),xr("builtGroups",function(){return It([])})]),cf=Dt([Xu(["overflowToggledClass"]),Uo("getOverflowBounds"),y("lazySink"),xr("overflowGroups",function(){return It([])})].concat(mi())),Ka=Dt([df({factory:lS,schema:cm(),name:"primary"}),af({schema:cm(),name:"overflow"}),af({name:"overflow-button"}),af({name:"overflow-group"})]),AS=Dt(function(t,e){e=Math.floor(e);q(t,"max-width",Kn.max(t,e,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"])+"px")}),lu=Dt([Xu(["toggledClass"]),y("lazySink"),Ro("fetch"),Uo("getBounds"),Go("fireDismissalEventInstead",[S("event",$i())]),Bc()]),sm=Dt([af({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:Ht([p.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),af({factory:lS,schema:cm(),name:"toolbar",overrides:function(e){return{toolbarBehaviours:Ht([$.config({mode:"cyclic",onEscape:function(t){return Qs(t,e,"button").each(jt.focus),Mt.none()}})])}}})]),FS=sl({name:"FloatingToolbarButton",factory:function(u,t,a,e){return Bt(Bt({},Em.sketch(Bt(Bt({},e.button()),{action:function(t){dw(t,e)},buttonBehaviours:Zl({dump:e.button().buttonBehaviours},[Iv.config({others:{toolbarSandbox:function(t){return o=t,n=a,r=u,{dom:{tag:"div",attributes:{id:(i=Ru()).id}},behaviours:Ht([$.config({mode:"special",onEscape:function(t){return m.close(t),Mt.some(!0)}}),m.config({onOpen:function(t,e){r.fetch().get(function(t){gw(o,e,r,n.layouts,t),i.link(o.element),$.focusIn(e)})},onClose:function(){p.off(o),jt.focus(o),i.unlink(o.element)},isPartOf:function(t,e,n){return Vu(e,n)||Vu(o,n)},getAttachPoint:function(){return r.lazySink(o).getOrDie()}}),Za.config({channels:Bt(Bt({},Ms(Bt({isExtraPart:N},r.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),As({doReposition:function(){m.getState(Iv.getCoupled(o,"toolbarSandbox")).each(function(t){mw(o,t,r,n.layouts)})}}))})])};var o,n,r,i}}})])}))),{apis:{setGroups:function(e,n){m.getState(Iv.getCoupled(e,"toolbarSandbox")).each(function(t){gw(e,t,u,a.layouts,n)})},reposition:function(e){m.getState(Iv.getCoupled(e,"toolbarSandbox")).each(function(t){mw(e,t,u,a.layouts)})},toggle:function(t){dw(t,e)},getToolbar:function(t){return m.getState(Iv.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return m.isOpen(Iv.getCoupled(t,"toolbarSandbox"))}}})},configFields:lu(),partFields:sm(),apis:{setGroups:function(t,e,n){t.setGroups(e,n)},reposition:function(t,e){t.reposition(e)},toggle:function(t,e){t.toggle(e)},getToolbar:function(t,e){return t.getToolbar(e)},isOpen:function(t,e){return t.isOpen(e)}}}),Gc=Dt([y("items"),Xu(["itemSelector"]),Hs("tgroupBehaviours",[$])]),im=Dt([Xc({name:"items",unit:"item"})]),IS=sl({name:"ToolbarGroup",configFields:Gc(),partFields:im(),factory:function(t,e,n,o){return{uid:t.uid,dom:t.dom,components:e,behaviours:Ns(t.tgroupBehaviours,[$.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),RS=sl({name:"SplitFloatingToolbar",configFields:cf(),partFields:Ka(),factory:function(n,t,e,o){var r=Wt(FS.sketch({fetch:function(){return Bv(function(t){t(pw(n.overflowGroups.get()))})},layouts:{onLtr:function(){return[ja,Ua]},onRtl:function(){return[Ua,ja]},onBottomLtr:function(){return[Xa,Ga]},onBottomRtl:function(){return[Ga,Xa]}},getBounds:e.getOverflowBounds,lazySink:n.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:n.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:n.uid,dom:n.dom,components:t,behaviours:Ns(n.splitToolbarBehaviours,[Iv.config({others:{overflowGroup:function(){return IS.sketch(Bt(Bt({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(t,e){n.builtGroups.set(F(e,t.getSystem().build)),hw(t,r,n)},refresh:function(t){return hw(t,r,n)},toggle:function(t){r.getOpt(t).each(function(t){FS.toggle(t)})},isOpen:function(t){return r.getOpt(t).map(FS.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each(function(t){FS.reposition(t)})},getOverflow:function(t){return r.getOpt(t).bind(FS.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,e,n){t.setGroups(e,n)},refresh:function(t,e){t.refresh(e)},reposition:function(t,e){t.reposition(e)},toggle:function(t,e){t.toggle(e)},isOpen:function(t,e){return t.isOpen(e)},getOverflow:function(t,e){return t.getOverflow(e)}}}),sf=Dt([Xu(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),t("onOpened"),t("onClosed")].concat(mi())),Jc=Dt([df({factory:lS,schema:cm(),name:"primary"}),df({factory:lS,schema:cm(),name:"overflow",overrides:function(e){return{toolbarBehaviours:Ht([kS.config({dimension:{property:"height"},closedClass:e.markers.closedClass,openClass:e.markers.openClass,shrinkingClass:e.markers.shrinkingClass,growingClass:e.markers.growingClass,onShrunk:function(t){Qs(t,e,"overflow-button").each(function(t){p.off(t),jt.focus(t)}),e.onClosed(t)},onGrown:function(t){$.focusIn(t),e.onOpened(t)},onStartGrow:function(t){Qs(t,e,"overflow-button").each(p.on)}}),$.config({mode:"acyclic",onEscape:function(t){return Qs(t,e,"overflow-button").each(jt.focus),Mt.some(!0)}})])}}}),af({name:"overflow-button",overrides:function(t){return{buttonBehaviours:Ht([p.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),af({name:"overflow-group"})]),VS=sl({name:"SplitSlidingToolbar",configFields:sf(),partFields:Jc(),factory:function(n,t,e,o){var r="alloy.toolbar.toggle";return{uid:n.uid,dom:n.dom,components:t,behaviours:Ns(n.splitToolbarBehaviours,[Iv.config({others:{overflowGroup:function(e){return IS.sketch(Bt(Bt({},o["overflow-group"]()),{items:[Em.sketch(Bt(Bt({},o["overflow-button"]()),{action:function(t){Rt(e,r)}}))]}))}}}),Lt("toolbar-toggle-events",[Pt(r,function(t){vw(t,n)})])]),apis:{setGroups:function(t,e){e=F(e,t.getSystem().build);n.builtGroups.set(e),Vw(t,n)},refresh:function(t){return Vw(t,n)},toggle:function(t){return vw(t,n)},isOpen:function(t){return Qs(t,n,"overflow").map(kS.hasGrown).getOr(!1)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,e,n){t.setGroups(e,n)},refresh:function(t,e){t.refresh(e)},toggle:function(t,e){t.toggle(e)},isOpen:function(t,e){return t.isOpen(e)}}}),Aa=ff.optional({factory:CS,name:"menubar",schema:[y("backstage")]}),lf=ff.optional({factory:{sketch:function(t){return sS.sketch({uid:t.uid,dom:t.dom,listBehaviours:Ht([$.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return Sw({type:t.type,uid:O("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),Mt.some(!0)}})},setupItem:function(t,e,n,o){lS.setGroups(e,n)},shell:!0})}},name:"multiple-toolbar",schema:[y("dom"),y("onEscape")]}),lm=ff.optional({factory:{sketch:function(t){return(t.type===kg.sliding?function(t){var e=VS.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),n=VS.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),t=ww(t);return VS.sketch(Bt(Bt({},t),{components:[e,n],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([pS()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([pS()],{type:"closed"})}}))}:t.type===kg.floating?function(o){var t=ww(o),e=RS.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return RS.sketch(Bt(Bt({},t),{lazySink:o.getSink,getOverflowBounds:function(){var t=o.moreDrawerData.lazyHeader().element,e=ln(t),t=ve(t),n=ln(t),t=Math.max(t.dom.scrollHeight,n.height);return eo(e.x+4,n.y,e.width-8,t)},parts:Bt(Bt({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o.attributes}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))}:Sw)({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),Mt.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[y("dom"),y("onEscape"),y("getSink")]}),um=ff.optional({factory:{sketch:function(t){var e=t.editor,n=t.sticky?U0:fS;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:Ht(n(e,t.sharedBackstage))}}},name:"header",schema:[y("dom")]}),am=ff.optional({name:"socket",schema:[y("dom")]}),lu=ff.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:Ht([rv.config({}),jt.config({}),kS.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){J.getCurrent(t).each(TS.hideAllSlots),Rt(t,BS)},onGrown:function(t){Rt(t,BS)},onStartGrow:function(t){Vt(t,DS,{width:ze(t.element,"width").getOr("")})},onStartShrink:function(t){Vt(t,DS,{width:qe(t.element)+"px"})}}),Ut.config({}),J.config({find:function(t){return ft(Ut.contents(t))}})])}],behaviours:Ht([dx(0),Lt("sidebar-sliding-events",[Pt(DS,function(t,e){q(t.element,"width",e.event.width)}),Pt(BS,function(t,e){Le(t.element,"width")})])])}}},name:"sidebar",schema:[y("dom")]}),sm=ff.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:Ht([Ut.config({}),MS.config({focus:!1}),J.config({find:function(t){return ft(t.components())}})]),components:[]}}},name:"throbber",schema:[y("dom")]}),PS=sl({name:"OuterContainer",factory:function(n,t,e){return{uid:n.uid,dom:n.dom,components:t,apis:{getSocket:function(t){return cS.getPart(t,n,"socket")},setSidebar:function(t,e){cS.getPart(t,n,"sidebar").each(function(t){var n;n=e,J.getCurrent(t).each(function(t){return Ut.set(t,[(e=n,TS.sketch(function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:(n=t,r=F(Zt(o=e),function(t){var e=o[t],e=Do(Eo("sidebar",ES,e));return{name:t,getApi:ow,onSetup:e.onSetup,onShow:e.onShow,onHide:e.onHide}}),F(r,function(t){var e=It(Et);return n.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Cg([dp(t,e),mp(t,e),Pt(Zi(),function(e,t){var n=t.event;tt(r,function(t){return t.name===n.name}).each(function(t){(n.visible?t.onShow:t.onHide)(t.getApi(e))})})])})})),slotBehaviours:Cg([uu(function(t){return TS.hideAllSlots(t)})])};var n,o,r}))]);var e})})},toggleSidebar:function(t,e){cS.getPart(t,n,"sidebar").each(function(t){var n=e;J.getCurrent(t).each(function(e){J.getCurrent(e).each(function(t){kS.hasGrown(e)?TS.isShowing(t,n)?kS.shrink(e):(TS.hideAllSlots(t),TS.showSlot(t,n)):(TS.hideAllSlots(t),TS.showSlot(t,n),kS.grow(e))})})})},whichSidebar:function(t){return cS.getPart(t,n,"sidebar").bind(rw).getOrNull()},getHeader:function(t){return cS.getPart(t,n,"header")},getToolbar:function(t){return cS.getPart(t,n,"toolbar")},setToolbar:function(t,e){cS.getPart(t,n,"toolbar").each(function(t){t.getApis().setGroups(t,e)})},setToolbars:function(t,e){cS.getPart(t,n,"multiple-toolbar").each(function(t){sS.setItems(t,e)})},refreshToolbar:function(t){cS.getPart(t,n,"toolbar").each(function(t){return t.getApis().refresh(t)})},toggleToolbarDrawer:function(t){cS.getPart(t,n,"toolbar").each(function(t){var e=t.getApis().toggle;null!=e?Mt.some(e(t)):Mt.none()})},isToolbarDrawerToggled:function(t){return cS.getPart(t,n,"toolbar").bind(function(e){return Mt.from(e.getApis().isOpen).map(function(t){return t(e)})}).getOr(!1)},getThrobber:function(t){return cS.getPart(t,n,"throbber")},focusToolbar:function(t){cS.getPart(t,n,"toolbar").orThunk(function(){return cS.getPart(t,n,"multiple-toolbar")}).each(function(t){$.focusIn(t)})},setMenubar:function(t,e){cS.getPart(t,n,"menubar").each(function(t){CS.setMenus(t,e)})},focusMenubar:function(t){cS.getPart(t,n,"menubar").each(function(t){CS.focus(t)})}},behaviours:n.behaviours}},configFields:[y("dom"),y("behaviours")],partFields:[um,Aa,lm,lf,am,lu,sm],apis:{getSocket:function(t,e){return t.getSocket(e)},setSidebar:function(t,e,n){t.setSidebar(e,n)},toggleSidebar:function(t,e,n){t.toggleSidebar(e,n)},whichSidebar:function(t,e){return t.whichSidebar(e)},getHeader:function(t,e){return t.getHeader(e)},getToolbar:function(t,e){return t.getToolbar(e)},setToolbar:function(t,e,n){n=F(n,yw);t.setToolbar(e,n)},setToolbars:function(t,e,n){n=F(n,function(t){return F(t,yw)});t.setToolbars(e,n)},refreshToolbar:function(t,e){return t.refreshToolbar(e)},toggleToolbarDrawer:function(t,e){t.toggleToolbarDrawer(e)},isToolbarDrawerToggled:function(t,e){return t.isToolbarDrawerToggled(e)},getThrobber:function(t,e){return t.getThrobber(e)},setMenubar:function(t,e,n){t.setMenubar(e,n)},focusMenubar:function(t,e){t.focusMenubar(e)},focusToolbar:function(t,e){t.focusToolbar(e)}}}),HS={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},zS=g(Tw,!1),NS=g(Tw,!0);function LS(t,e,n,o){return{type:"basic",data:(t=t.getParam(e,n,"string"),F(o===Uw.SemiColon?t.replace(/;$/,"").split(";"):t.split(" "),function(t){var e=t,n=t,t=t.split("=");return 1<t.length&&(e=t[0],n=t[1]),{title:e,format:n}}))}}function WS(n){var t={type:"basic",data:hC};return{tooltip:"Align",text:Mt.none(),icon:Mt.some("align-left"),isSelectedFor:function(t){return function(){return n.formatter.match(t)}},getCurrentValue:Mt.none,getPreviewFor:function(t){return Mt.none},onAction:function(e){return function(){return tt(hC,function(t){return t.format===e.format}).each(function(t){return n.execCommand(t.command)})}},updateText:function(t){var e=tt(hC,function(t){return n.formatter.match(t.format)}).fold(Dt("left"),function(t){return t.title.toLowerCase()});Vt(t,Vx,{icon:"align-"+e})},dataset:t,shouldHide:!1,isInvalid:function(t){return!n.formatter.canApply(t.format)}}}function US(t){return F(t.split(/\s*,\s*/),function(t){return t.replace(/^['"]+|['"]+$/g,"")})}function jS(r){function o(){function e(t){return t?US(t)[0]:""}var t=r.queryCommandValue("FontName"),n=u.data,o=t?t.toLowerCase():"";return{matchOpt:tt(n,function(t){t=t.format;return t.toLowerCase()===o||e(t).toLowerCase()===e(o).toLowerCase()}).orThunk(function(){return St(0===(t=o).indexOf("-apple-system")&&(e=US(t.toLowerCase()),rt(vC,function(t){return-1<e.indexOf(t.toLowerCase())})),{title:i,format:o});var t,e}),font:t}}var i="System Font",u=LS(r,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",Uw.SemiColon);return{tooltip:"Fonts",text:Mt.some(i),icon:Mt.none(),isSelectedFor:function(e){return function(t){return t.exists(function(t){return t.format===e})}},getCurrentValue:function(){return o().matchOpt},getPreviewFor:function(t){return function(){return Mt.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(t){return function(){r.undoManager.transact(function(){r.focus(),r.execCommand("FontName",!1,t.format)})}},updateText:function(t){var e=o(),n=e.matchOpt,e=e.font,n=n.fold(Dt(e),function(t){return t.title});Vt(t,Rx,{text:n})},dataset:u,shouldHide:!1,isInvalid:N}}function GS(e){function o(){var i=Mt.none(),u=n.data,a=e.queryCommandValue("FontSize");if(a)for(var t=3;i.isNone()&&0<=t;t--)!function(t){t=t;var e,n,o=/[0-9.]+px$/.test(e=a)?(n=72*parseInt(e,10)/96,t=Math.pow(10,t||0),Math.round(n*t)/t+"pt"):I(yC,e).getOr(e),r=I(bC,o).getOr("");i=tt(u,function(t){return t.format===a||t.format===o||t.format===r})}(t);return{matchOpt:i,size:a}}var t=Dt(Mt.none),n=LS(e,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",Uw.Space);return{tooltip:"Font sizes",text:Mt.some("12pt"),icon:Mt.none(),isSelectedFor:function(e){return function(t){return t.exists(function(t){return t.format===e})}},getPreviewFor:t,getCurrentValue:function(){return o().matchOpt},onAction:function(t){return function(){e.undoManager.transact(function(){e.focus(),e.execCommand("FontSize",!1,t.format)})}},updateText:function(t){var e=o(),n=e.matchOpt,e=e.size,n=n.fold(Dt(e),function(t){return t.title});Vt(t,Rx,{text:n})},dataset:n,shouldHide:!1,isInvalid:N}}function XS(t,e){var n=e(),e=F(n,function(t){return t.format});return Mt.from(t.formatter.closest(e)).bind(function(e){return tt(n,function(t){return t.format===e})}).orThunk(function(){return St(t.formatter.match("p"),{title:"Paragraph",format:"p"})})}function YS(n){var o=LS(n,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",Uw.SemiColon);return{tooltip:"Blocks",text:Mt.some("Paragraph"),icon:Mt.none(),isSelectedFor:function(t){return function(){return n.formatter.match(t)}},getCurrentValue:Mt.none,getPreviewFor:function(e){return function(){var t=n.formatter.get(e);return Mt.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(e))})}},onAction:Bw(n),updateText:function(t){var e=XS(n,function(){return o.data}).fold(Dt("Paragraph"),function(t){return t.title});Vt(t,Rx,{text:e})},dataset:o,shouldHide:!1,isInvalid:function(t){return!n.formatter.canApply(t.format)}}}function qS(o,t){return{tooltip:"Formats",text:Mt.some("Paragraph"),icon:Mt.none(),isSelectedFor:function(t){return function(){return o.formatter.match(t)}},getCurrentValue:Mt.none,getPreviewFor:function(e){return function(){var t=o.formatter.get(e);return void 0!==t?Mt.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styles:o.dom.parseStyle(o.formatter.getCssText(e))}):Mt.none()}},onAction:Bw(o),updateText:function(t){var n=function(t){var e=t.items;return void 0!==e&&0<e.length?ot(e,n):[{title:t.title,format:t.format}]},e=ot(c0(o),n),e=XS(o,Dt(e)).fold(Dt("Paragraph"),function(t){return t.title});Vt(t,Rx,{text:e})},shouldHide:o.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!o.formatter.canApply(t.format)},dataset:t}}function KS(e){return{isDisabled:function(){return Nt.isDisabled(e)},setDisabled:function(t){return Nt.set(e,t)}}}function JS(e){return{setActive:function(t){p.set(e,t)},isActive:function(){return p.isOn(e)},isDisabled:function(){return Nt.isDisabled(e)},setDisabled:function(t){return Nt.set(e,t)}}}function $S(t,e){return t.map(function(t){return{"aria-label":e.translate(t),title:e.translate(t)}}).getOr({})}function QS(e,n,t,o,r,i){return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]),attributes:$S(t,i)},components:qp([e.map(function(t){return vy(t,i.icons)}),n.map(function(t){return yy(t,"tox-tbtn",i)})]),eventOrder:((t={})[bi()]=["focusing","alloy.base.behaviour","common-button-display-events"],t),buttonBehaviours:Ht([Xp(i.isDisabled),lp(),Lt("common-button-display-events",[Pt(bi(),function(t,e){e.event.prevent(),Rt(t,SC)})])].concat(o.map(function(t){return xC.config({channel:t,initialData:{icon:e,text:n},renderComponents:function(t,e){return qp([t.icon.map(function(t){return vy(t,i.icons)}),t.text.map(function(t){return yy(t,"tox-tbtn",i)})])}})}).toArray()).concat(r.getOr([])))}}function ZS(t,e,n){var o,r=It(Et),i=QS(t.icon,t.text,t.tooltip,Mt.none(),Mt.none(),n);return Em.sketch({dom:i.dom,components:i.components,eventOrder:Ix,buttonBehaviours:Ht([Lt("toolbar-button-events",[(o={onAction:t.onAction,getApi:e.getApi},su(function(e,t){fp(o,e)(function(t){Vt(e,Fx,{buttonApi:t}),o.onAction(t)})})),dp(e,r),mp(e,r)]),Xp(function(){return t.disabled||n.isDisabled()}),lp()].concat(e.toolbarButtonBehaviours))})}function tC(o,r){return function(t,e,n){t=o(t).mapError(function(t){return br(t)}).getOrDie();return r(t,e,n)}}function eC(e,t,n,o){var t=t.outerContainer,r=n.toolbar,i=n.buttons;a(r,P)?(r=r.map(function(t){t={toolbar:t,buttons:i,allowToolbarGroups:n.allowToolbarGroups};return _C(e,t,{backstage:o},Mt.none())}),PS.setToolbars(t,r)):PS.setToolbar(t,_C(e,n,{backstage:o},Mt.none()))}function nC(t){return/^[0-9\.]+(|px)$/i.test(""+t)?Mt.some(parseInt(""+t,10)):Mt.none()}function oC(t){return Q(t)?t+"px":t}function rC(e,t,n){t=t.filter(function(t){return e<t}),n=n.filter(function(t){return t<e});return t.or(n).getOr(e)}function iC(t){var e=pg(t),n=hg(t),o=bg(t);return nC(e).map(function(t){return rC(t,n,o)})}function uC(t,e){t=no(t);return{pos:e?t.y:t.bottom,bounds:t}}function aC(o,r){return Pt(Fx,function(t,e){var n=o.get(t);r.onAction({hide:function(){return Rt(n,Wi())},getValue:function(){return zt.getValue(n)}},e.event.buttonApi)})}function cC(t,e,n){return e.bottom-t.y>=(n=void 0===n?.01:n)&&t.bottom-e.y>=n}function sC(t){n=t.selection.getRng();var e,n=(e=n.getBoundingClientRect()).height<=0&&e.width<=0?(n=ke(At.fromDom(n.startContainer),n.startOffset).element,(kn(n)?ye(n):Mt.some(n)).filter(Cn).map(function(t){return t.dom.getBoundingClientRect()}).getOr(e)):e;return t.inline?(e=rn(),eo(e.left+n.left,e.top+n.top,n.width,n.height)):(e=ln(At.fromDom(t.getBody())),eo(e.x+n.left,e.y+n.top,n.width,n.height))}function lC(t,e,n,o){void 0===o&&(o=0);var r,i=cn(window),u=no(At.fromDom(t.getContentAreaContainer())),a=xg(t)||wg(t)||Zg(t),c=(c=u,l=i,s=o,{x:r=Math.max(c.x+s,l.x),width:Math.min(c.right-s,l.right)-r}),s=c.x,l=c.width;return t.inline&&!a?eo(s,i.y,l,i.height):(r=t,c=u,a=i,t=e.header.isPositionedAtTop(),u=n,i=o,e=At.fromDom(r.getContainer()),n=Fu(e,".tox-editor-header").getOr(e),n=no(n),o=n.y>=c.bottom,t=t&&!o,r=r.inline&&t?{y:Math.max(n.bottom+i,a.y),bottom:a.bottom}:r.inline&&!t?{y:a.y,bottom:Math.min(n.y-i,a.bottom)}:(o="line"===u?no(e):c,t?{y:Math.max(n.bottom+i,a.y),bottom:Math.min(o.bottom-i,a.bottom)}:{y:Math.max(o.y+i,a.y),bottom:Math.min(n.y-i,a.bottom)}),eo(s,u=r.y,l,r.bottom-u))}function fC(t){return"node"===t}function dC(e,t){t=j(G(t,function(t){return t.predicate(e.dom)}),function(t){return"contexttoolbar"===t.type});return{contextToolbars:t.pass,contextForms:t.fail}}function mC(f,e,a,r){function i(){var t=h.get().getOr("node"),e=fC(t)?1:0;return lC(f,p,t,e)}function u(){return!(f.removed||b()&&l.isContextMenuOpen())}function c(){var t,e,n;return!u()||(t=i(),e=xt(h.get(),"node")?(n=f,y.get().filter(Wn).map(ln).getOrThunk(function(){return sC(n)})):sC(f),t.height<=0)||!cC(e,t)}function d(){y.clear(),x.clear(),h.clear(),Om.hide(v)}function t(){var t;Om.isOpen(v)&&(Le(t=v.element,"display"),c()?q(t,"display","none"):(x.set(0),Om.reposition(v)))}function g(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:Ht([$.config({mode:"acyclic"}),Lt("pop-dialog-wrap-events",[uu(function(t){f.shortcuts.add("ctrl+F9","focus statusbar",function(){return $.focusIn(t)})}),au(function(t){f.shortcuts.remove("ctrl+F9")})])])}}function s(t,e){var n,o,h,v,r,e="node"===t?p.anchors.node(e):p.anchors.cursor(),i=(i=f,t=t,n=b(),o={lastElement:y.get,isReposition:function(){return xt(x.get(),0)},getMode:function(){return jl.getMode(a)}},"line"===t?{bubble:fc(12,0,AC),layouts:{onLtr:function(){return[aa]},onRtl:function(){return[ca]}},overrides:FC}:{bubble:fc(0,12,AC,1/12),layouts:(h=i,v=o,r=t,n?{onLtr:function(t){return[qa,Ua,ja,Ga,Xa,Ya].concat(u(t))},onRtl:function(t){return[qa,ja,Ua,Xa,Ga,Ya].concat(u(t))}}:{onLtr:function(t){return[Ya,qa,Ga,Ua,Xa,ja].concat(u(t))},onRtl:function(t){return[Ya,qa,Xa,ja,Ga,Ua].concat(u(t))}}),overrides:FC});function u(t){return fC(r)?[(p=t,function(t,e,n,o,r){u=o,a=p,c=v,s=r,f=sC(i=h),g=c.lastElement().exists(function(t){return me(a,t)}),m=a,i=i.selection.getRng(),d=ke(At.fromDom(i.startContainer),i.startOffset);var i,u,a,c,s,l,f,d,m=i.startContainer===i.endContainer&&i.startOffset===i.endOffset-1&&me(d.element,m)?g?Nd:em:g?(l=u,i=c.getMode(),d=ze(l,"position"),q(l,"position",i),i=cC(f,no(u))&&!c.isReposition()?Wd:Nd,d.each(function(t){return q(l,"position",t)}),i):("fixed"===c.getMode()?s.y+rn().top:s.y)+(je(u)+12)<=f.y?em:nm,g=Bt(Bt({},t),{y:r.y,height:r.height});return Bt(Bt({},m(g,e,n,o,r)),{alwaysFit:!0})})]:[];var p}return sr(e,i)}function m(t,e){var n,o;C.cancel(),u()&&(n=S(t),o=s(t=t[0].position,e),h.set(t),x.set(1),Le(t=v.element,"display"),xt(oe(e,y.get(),me),!0)||(ei(t,HC),jl.reset(a,v)),Om.showWithinBounds(v,g(n),{anchor:o,transition:{classes:[HC],mode:"placement"}},function(){return Mt.some(i())}),e.fold(y.clear,y.set),c())&&q(t,"display","none")}var n,o,l=r.backstage,p=l.shared,b=Hn().deviceType.isTouch,y=rc(),x=rc(),h=rc(),v=_u((n={sink:a,onEscape:function(){return f.focus(),Mt.some(!0)}},o=It([]),Om.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){o.set([]),Om.getContent(t).each(function(t){Le(t.element,"visibility")}),ei(t.element,PC),Le(t.element,"width")},inlineBehaviours:Ht([Lt("context-toolbar-events",[zr(Mi(),function(t,e){"width"===e.event.raw.propertyName&&(ei(t.element,PC),Le(t.element,"width"))}),Pt(VC,function(t,e){var n=t.element,o=(Le(n,"width"),qe(n)),r=(Om.setContent(t,e.event.contents),ti(n,PC),qe(n));q(n,"width",o+"px"),Om.getContent(t).each(function(t){e.event.focus.bind(function(t){return xa(t),Ca(n)}).orThunk(function(){return $.focusIn(t),Sa(Ln(n))})}),Tm.setTimeout(function(){q(t.element,"width",r+"px")},0)}),Pt(IC,function(e,t){Om.getContent(e).each(function(t){o.set(o.get().concat([{bar:t,focus:Sa(Ln(e.element))}]))}),Vt(e,VC,{contents:t.event.forwardContents,focus:Mt.none()})}),Pt(RC,function(e,t){dt(o.get()).each(function(t){o.set(o.get().slice(0,o.get().length-1)),Vt(e,VC,{contents:Tu(t.bar),focus:t.focus})})})]),$.config({mode:"special",onEscape:function(e){return dt(o.get()).fold(function(){return n.onEscape()},function(t){return Rt(e,RC),Mt.some(!0)})}})]),lazySink:function(){return K.value(n.sink)}}))),w=ae(function(){return c=function(t){t=S([t]);Vt(v,IC,{forwardContents:g(t)})},s={},l=[],f=[],d={},m={},t=Zt(a=e),Y(t,function(t){var e,n,o,r,i,u=a[t];"contextform"===u.type?(o=t,i=Do(Eo("ContextForm",tg,r=u)),(s[o]=i).launch.map(function(t){d["form:"+o]=Bt(Bt({},r.launch),{type:"contextformtogglebutton"===t.type?"togglebutton":"button",onAction:function(){c(i)}})}),("editor"===i.scope?f:l).push(i),m[o]=i):"contexttoolbar"===u.type&&(e=t,Eo("ContextToolbar",eg,n=u).each(function(t){("editor"===n.scope?f:l).push(t),m[e]=t}))}),{forms:s,inNodeScope:l,inEditorScope:f,lookupTable:m,formNavigators:d};var a,c,s,l,f,d,m,t}),S=function(t){var e=f.ui.registry.getAll().buttons,n=w(),o=Bt(Bt({},e),n.formNavigators),e=tp(f)===kg.scrolling?kg.scrolling:kg.default,n=nt(F(t,function(t){return"contexttoolbar"===t.type?_C(f,{buttons:o,toolbar:t.items,allowToolbarGroups:!1},r,Mt.some(["form:"])):(e=p.providers,MC(t,e));var e}));return Sw({type:e,uid:O("context-toolbar"),initGroups:n,onEscape:Mt.none,cyclicKeying:!0,providers:p.providers})},C=Im(function(){function n(t){return me(t,s)}function t(e){return V(a,function(t){return t.position===e})}function e(e){return G(a,function(t){return t.position===e})}var o,r,i,u,a,c,s,l;f.hasFocus()&&!f.removed&&(ni(v.element,HC)?C.throttle():(o=w(),r=f,s=At.fromDom(r.getBody()),(n(r=l=At.fromDom(r.selection.getNode()))||ge(s,r)?(r=l,i=o.inNodeScope,u=o.inEditorScope,(0<(i=dC(r,i)).contextForms.length?Mt.some({elem:r,toolbars:[i.contextForms[0]]}):0<(u=dC(r,u)).contextForms.length?Mt.some({elem:r,toolbars:[u.contextForms[0]]}):0<i.contextToolbars.length||0<u.contextToolbars.length?(u=(a=i.contextToolbars.concat(u.contextToolbars)).length<=1?a:(i=t("selection"),u=t("node"),i||u?u&&i?(u=e("node"),c=F(e("selection"),function(t){return Bt(Bt({},t),{position:"node"})}),u.concat(c)):e(i?"selection":"node"):e("line")),Mt.some({elem:r,toolbars:u})):Mt.none()).orThunk(function(){return i=o,(t=n)(e=l)?Mt.none():kr(e,function(t){var e,n,o;return Cn(t)&&(e=(n=dC(t,i.inNodeScope)).contextToolbars,0<(n=0<(n=n.contextForms).length?n:(o=e).length<=1?o:r("selection").orThunk(function(){return r("node")}).orThunk(function(){return r("line")}).map(function(t){return t.position}).fold(function(){return[]},function(e){return G(o,function(t){return t.position===e})})).length)?Mt.some({elem:t,toolbars:n}):Mt.none();function r(e){return tt(o,function(t){return t.position===e})}},t);var t,e,i})):Mt.none()).fold(d,function(t){m(t.toolbars,Mt.some(t.elem))})))},17);f.on("init",function(){f.on("remove",d),f.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",t),f.on("click keyup focus SetContent",C.throttle),f.on(BC,d),f.on("contexttoolbar-show",function(e){I(w().lookupTable,e.toolbarKey).each(function(t){m([t],St(e.target!==f,e.target)),Om.getContent(v).each($.focusIn)})}),f.on("focusout",function(t){Tm.setEditorTimeout(f,function(){Ca(a.element).isNone()&&Ca(v.element).isNone()&&d()},0)}),f.on("SwitchMode",function(){f.mode.isReadOnly()&&d()}),f.on("AfterProgressState",function(t){t.state?d():f.hasFocus()&&C.throttle()}),f.on("NodeChange",function(t){Ca(v.element).fold(C.throttle,Et)})})}(Gc=Uw=Uw||{})[Gc.SemiColon=0]="SemiColon",Gc[Gc.Space=1]="Space";function gC(t,e,n){return ZS(t,{toolbarButtonBehaviours:[].concat(0<n.length?[Lt("toolbarButtonWith",n)]:[]),getApi:KS,onSetup:t.onSetup},e)}function pC(t,e,n){return sr(ZS(t,{toolbarButtonBehaviours:[Ut.config({}),p.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<n.length?[Lt("toolbarToggleButtonWith",n)]:[]),getApi:JS,onSetup:t.onSetup},e))}var hC=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],vC=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],bC={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},yC={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},im=Object.freeze({__proto__:null,events:function(o,r){function i(e,n){o.updateState.each(function(t){t=t(e,n);r.set(t)}),o.renderComponents.each(function(t){t=F(t(n,r.get()),e.getSystem().build);xs(e,t)})}return iu([Pt(Pi(),function(t,e){var n;e.universal||(n=o.channel,$t(e.channels,n)&&i(t,e.data))}),uu(function(e,t){o.initialData.each(function(t){i(e,t)})})])}}),cf=Object.freeze({__proto__:null,getState:function(t,e,n){return n}}),xC=va({fields:[y("channel"),zo("renderComponents"),zo("updateState"),zo("initialData")],name:"reflecting",active:im,apis:cf,state:Object.freeze({__proto__:null,init:function(){var t=It(Mt.none());return{readState:function(){return t.get().getOr("none")},get:t.get,set:t.set,clear:function(){return t.set(Mt.none())}}}})}),Ka=Dt([y("toggleClass"),y("fetch"),Ku("onExecute"),S("getHotspot",Mt.some),S("getAnchorOverrides",Dt({})),Bc(),Ku("onItemExecute"),zo("lazySink"),y("dom"),t("onOpen"),Hs("splitDropdownBehaviours",[Iv,$,jt]),S("matchWidth",!1),S("useMinWidth",!1),S("eventOrder",{}),zo("role")].concat(Wv())),mi=Dt([df({factory:Em,schema:[y("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:Ht([jt.revoke()])}},overrides:function(e){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(e.uid).each(Dr)},buttonBehaviours:Ht([p.config({toggleOnExecute:!1,toggleClass:e.toggleClass})])}}}),df({factory:Em,schema:[y("dom")],name:"button",defaults:function(){return{buttonBehaviours:Ht([jt.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(e){e.getSystem().getByUid(n.uid).each(function(t){n.onExecute(t,e)})}}}}),mf({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[y("text")],name:"aria-descriptor"}),af({schema:[Gu()],name:"menu",defaults:function(o){return{onExecute:function(e,n){e.getSystem().getByUid(o.uid).each(function(t){o.onItemExecute(t,e,n)})}}}}),fm()]),wC=sl({name:"SplitDropdown",configFields:Ka(),partFields:mi(),factory:function(o,t,e,n){function r(t){J.getCurrent(t).each(function(t){wf.highlightFirst(t),$.focusIn(t)})}function i(t){Hv(o,x,t,n,r,_v.HighlightFirst).get(Et)}function u(t){return Dr(Zs(t,o,"button")),Mt.some(!0)}var a=Bt(Bt({},iu([uu(function(n,t){Qs(n,o,"aria-descriptor").each(function(t){var e=O("aria");Ft(t.element,"id",e),Ft(n.element,"aria-describedby",e)})})])),_d(Mt.some(i)));return{uid:o.uid,dom:o.dom,components:t,apis:{repositionMenus:function(t){p.isOn(t)&&Lv(t)}},eventOrder:Bt(Bt({},o.eventOrder),((t={})[Hi()]=["disabling","toggling","alloy.base.behaviour"],t)),events:a,behaviours:Ns(o.splitDropdownBehaviours,[Iv.config({others:{sandbox:function(t){var e=Zs(t,o,"arrow");return Nv(o,t,{onOpen:function(){p.on(e),p.on(t)},onClose:function(){p.off(e),p.off(t)}})}}}),$.config({mode:"special",onSpace:u,onEnter:u,onDown:function(t){return i(t),Mt.some(!0)}}),jt.config({}),p.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:o.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,e){return t.repositionMenus(e)}}}),SC=O("focus-button"),CC=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],kC={button:tC(Lm,function(t,e){return e=e.backstage.shared.providers,gC(t,e,[])}),togglebutton:tC(Wm,function(t,e){return e=e.backstage.shared.providers,pC(t,e,[])}),menubutton:tC(j0,function(t,e){return ky(t,"tox-tbtn",e.backstage,Mt.none())}),splitbutton:tC(function(t){return Eo("SplitButton",SS,t)},function(t,e){return o=t,t=e.backstage.shared,e=O("channel-update-split-dropdown-display"),a=It(Et),c={getApi:n,onSetup:o.onSetup},wC.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:Bt({"aria-pressed":!1},$S(o.tooltip,t.providers))},onExecute:function(t){o.onAction(n(t))},onItemExecute:function(t,e,n){},splitDropdownBehaviours:Ht([Wp(t.providers.isDisabled),lp(),Lt("split-dropdown-events",[Pt(SC,jt.focus),dp(c,a),mp(c,a)]),Ky.config({})]),eventOrder:((c={})[Ki()]=["alloy.base.behaviour","split-dropdown-events"],c),toggleClass:"tox-tbtn--enabled",lazySink:t.getSink,fetch:(r=n,i=o,u=t.providers,function(e){return Bv(function(t){return i.fetch(t)}).map(function(t){return Mt.from(Nh(sr(yh(O("menu-value"),t,function(t){i.onItemAction(r(e),t)},i.columns,i.presets,_g.CLOSE_ON_EXECUTE,i.select.getOr(N),u),{movement:xh(i.columns,i.presets),menuBehaviours:Cg("auto"!==i.columns?[]:[uu(function(n,t){dg(n,4,ng(i.presets)).each(function(t){var e=t.numRows,t=t.numColumns;$.setGridSize(n,e,t)})})])})))})}),parts:{menu:ig(0,o.columns,o.presets)},components:[wC.parts.button(QS(o.icon,o.text,Mt.none(),Mt.some(e),Mt.some([p.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),t.providers)),wC.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Xd("chevron-down",t.providers.icons)},buttonBehaviours:Ht([Wp(t.providers.isDisabled),lp(),Yd()])}),wC.parts["aria-descriptor"]({text:t.providers.translate("To open the popup, press Shift+Enter")})]});function n(n){return{isDisabled:function(){return Nt.isDisabled(n)},setDisabled:function(t){return Nt.set(n,t)},setIconFill:function(t,e){Fu(n.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(t){Ft(t,"fill",e)})},setIconStroke:function(t,e){Fu(n.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(t){Ft(t,"stroke",e)})},setActive:function(e){Ft(n.element,"aria-pressed",e),Fu(n.element,"span").each(function(t){n.getSystem().getByDom(t).each(function(t){return p.set(t,e)})})},isActive:function(){return Fu(n.element,"span").exists(function(t){return n.getSystem().getByDom(t).exists(p.isOn)})}}}var o,r,i,u,a,c}),grouptoolbarbutton:tC(function(t){return Eo("GroupToolbarButton",xS,t)},function(t,e,n){var o,r,i,u,a=n.ui.registry.getAll().buttons;(u={})[jc]=e.backstage.shared.header.isPositionedAtTop()?pc.TopToBottom:pc.BottomToTop;if(tp(n)!==kg.floating)throw new Error("Toolbar groups are only supported when using floating toolbar mode");return i=e.backstage,r=function(t){return _C(n,{buttons:a,toolbar:t,allowToolbarGroups:!1},e,Mt.none())},u=u,i=i.shared,FS.sketch({lazySink:i.getSink,fetch:function(){return Bv(function(t){t(F(r(o.items),yw))})},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:QS((o=t).icon,o.text,o.tooltip,Mt.none(),Mt.none(),i.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:u}}}})}),styleSelectButton:function(t,e){return Fw(t,e=e.backstage,qS(t,Bt({type:"advanced"},e.styleselect)))},fontsizeSelectButton:function(t,e){return Fw(t,e.backstage,GS(t))},fontSelectButton:function(t,e){return Fw(t,e.backstage,jS(t))},formatButton:function(t,e){return Fw(t,e.backstage,YS(t))},alignMenuButton:function(t,e){return Fw(t,e.backstage,WS(t))}},OC={styleselect:kC.styleSelectButton,fontsizeselect:kC.fontsizeSelectButton,fontselect:kC.fontSelectButton,formatselect:kC.formatButton,align:kC.alignMenuButton},_C=function(o,c,s,l){t=c.toolbar,e=c.buttons;var n,t,e=!1===t?[]:void 0===t||!0===t?(n=e,e=F(CC,function(t){var e=G(t.items,function(t){return ne(n,t)||ne(OC,t)});return{name:t.name,items:e}}),G(e,function(t){return 0<t.items.length})):P(t)?F(t.split("|"),function(t){return{items:t.trim().split(" ")}}):a(t,function(t){return ne(t,"name")&&ne(t,"items")})?t:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[]);return G(F(e,function(t){var e=ot(t.items,function(t){return 0===t.trim().length?[]:(r=o,e=c.buttons,i=t,u=c.allowToolbarGroups,a=s,n=l,I(e,i.toLowerCase()).orThunk(function(){return n.bind(function(t){return mt(t,function(t){return I(e,t+i.toLowerCase())})})}).fold(function(){return I(OC,i.toLowerCase()).map(function(t){return t(r,a)}).orThunk(function(){return Mt.none()})},function(t){return"grouptoolbarbutton"!==t.type||u?(n=a,o=r,I(kC,(e=t).type).fold(function(){return console.error("skipping button defined by",e),Mt.none()},function(t){return Mt.some(t(e,n,o))})):(console.warn("Ignoring the '"+i+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),Mt.none());var e,n,o}).toArray());var r,e,i,u,a,n});return{title:Mt.from(o.translate(t.name)),items:e}}),function(t){return 0<t.items.length})},cm=Hn(),TC=cm.os.isiOS()&&cm.os.version.major<=12,EC=Object.freeze({__proto__:null,render:function(d,m,g,p,t){var h=It(0),v=m.outerContainer,t=(zS(d),At.fromDom(t.targetNode)),e=_e(Ln(t)),n=m.mothership;Vl(t,n,Ze),Os(e,m.uiMothership),d.on("PostRender",function(){function t(){var t=c.get();t.left===u.innerWidth&&t.top===u.innerHeight||(c.set(Yn(u.innerWidth,u.innerHeight)),Pp(o))}function e(){var t=o.getDoc().documentElement,e=s.get();e.left===t.offsetWidth&&e.top===t.offsetHeight||(s.set(Yn(t.offsetWidth,t.offsetHeight)),Pp(o))}function n(t){return o.fire("ScrollContent",t)}var o,r,i,u,a,c,s,l,f;eC(d,m,g,p),h.set(d.getWin().innerWidth),PS.setMenubar(v,kw(d,g)),PS.setSidebar(v,g.sidebar),r=m,i=(o=d).dom,u=o.getWin(),a=o.getDoc().documentElement,c=It(Yn(u.innerWidth,u.innerHeight)),s=It(Yn(a.offsetWidth,a.offsetHeight)),i.bind(u,"resize",t),i.bind(u,"scroll",n),l=uc(At.fromDom(o.getBody()),"load",e),f=r.uiMothership.element,o.on("hide",function(){q(f,"display","none")}),o.on("show",function(){Le(f,"display")}),o.on("NodeChange",e),o.on("remove",function(){l.unbind(),i.unbind(u,"resize",t),i.unbind(u,"scroll",n),u=null})});var o,r,t=PS.getSocket(v).getOrDie("Could not find expected socket element"),e=(TC&&(Ve(t.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),o=function(){d.fire("ScrollContent")},r=null,n=ic(t.element,"scroll",function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];l(r)&&(r=setTimeout(function(){r=null,o.apply(null,t)},20))}),d.on("remove",n.unbind)),sp(d,m),d.addCommand("ToggleSidebar",function(t,e){PS.toggleSidebar(v,e),d.fire("ToggleSidebar")}),d.addQueryValueHandler("ToggleSidebar",function(){return PS.whichSidebar(v)}),tp(d)),n=(e!==kg.sliding&&e!==kg.floating||d.on("ResizeWindow ResizeEditor ResizeContent",function(){var t=d.getWin().innerWidth;t!==h.get()&&(PS.refreshToolbar(m.outerContainer),h.set(t))}),{enable:function(){cp(m,!1)},disable:function(){cp(m,!0)},isDisabled:function(){return Nt.isDisabled(v)}});return{iframeContainer:t.element.dom,editorContainer:v.element.dom,api:n}}}),DC=Object.freeze({__proto__:null,render:function(o,r,s,l,t){var i,u,e,a,n,c,f,d,m,g,p,h,v,b,y=r.mothership,x=r.uiMothership,w=r.outerContainer,S=It(null),C=At.fromDom(t.targetNode),k=(i=o,u=C,t=l,a=S,n=(e=r).uiMothership,c=e.outerContainer,f=$g.DOM,d=rp(i),m=ap(i),g=bg(i).or(iC(i)),p=t.shared.header,h=p.isPositionedAtTop,v=(t=tp(i))===kg.sliding||t===kg.floating,b=It(!1),{isVisible:_,isPositionedAtTop:h,show:function(){b.set(!0),q(c.element,"display","flex"),f.addClass(i.getBody(),"mce-edit-focus"),Le(n.element,"display"),B(!1),D()},hide:function(){b.set(!1),e.outerContainer&&(q(c.element,"display","none"),f.removeClass(i.getBody(),"mce-edit-focus")),q(n.element,"display","none")},update:D,updateMode:B,repositionPopups:E}),O=o.getParam("toolbar_persist",!1,"boolean");function _(){return b.get()&&!i.removed}function T(t){return v?t.fold(Dt(0),function(t){return 1<t.components().length?je(t.components()[1].element):0}):0}function E(){n.broadcastOn([ql()],{})}function D(t){var e,n;void 0===t&&(t=!1),_()&&(d||(n=g.getOrThunk(function(){var t=nC(He(Un(),"margin-left")).getOr(0);return qe(Un())-Ye(u).left+t}),q(a.get().element,"max-width",n+"px")),v&&PS.refreshToolbar(c),d||(n=T(PS.getToolbar(c)),e=no(u),n=h()?Math.max(e.y-je(a.get().element)+n,0):e.bottom,Ve(c.element,{position:"absolute",top:Math.round(n)+"px",left:Math.round(e.x)+"px"})),m&&(n=a.get(),t?gS.reset(n):gS.refresh(n)),E())}function B(t){var e,n;void 0===t&&(t=!0),!d&&m&&_()&&(e=p.getDockingMode(),(n=function(t){switch(ep(i)){case Og.auto:var e,n=T(PS.getToolbar(c)),n=je(t.element)-n,o=no(u);return o.y>n?"top":(e=ve(u),e=Math.max(e.dom.scrollHeight,je(e)),o.bottom<e-n||oo().bottom<o.bottom-n?"bottom":"top");case Og.bottom:return"bottom";default:return Og.top,"top"}}(a.get()))!==e)&&(e=n,n=a.get(),gS.setModes(n,[e]),p.setDockingMode(e),e=h()?pc.TopToBottom:pc.BottomToTop,Ft(n.element,jc,e),t)&&D(!0)}function M(){var i,u,a,t,c,e;function n(t){var e=uC(u,a.isPositionedAtTop()),n=e.pos,e=e.bounds,o=c.get(),r=o.pos,o=o.bounds,o=e.height!==o.height||e.width!==o.width;c.set({pos:n,bounds:e}),o&&Pp(i,t),a.isVisible()&&(r!==n?a.update(!0):o&&(a.updateMode(),a.repositionPopups()))}S.get()?k.show():(S.set(PS.getHeader(w).getOrDie()),Os(t=ip(o),y),Os(t,x),eC(o,r,s,l),PS.setMenubar(w,kw(o,s)),k.show(),i=o,t=O,c=It(uC(u=C,(a=k).isPositionedAtTop())),t||(i.on("activate",a.show),i.on("deactivate",a.hide)),i.on("SkinLoaded ResizeWindow",function(){return a.update(!0)}),i.on("NodeChange keydown",function(t){Tm.requestAnimationFrame(function(){return n(t)})}),i.on("ScrollWindow",function(){return a.updateMode()}),(e=oc()).set(uc(At.fromDom(i.getBody()),"load",n)),i.on("remove",function(){e.clear()}),o.nodeChanged())}function A(){return Tm.setEditorTimeout(o,M,0)}return NS(o),o.on("show",M),o.on("hide",k.hide),O||(o.on("focus",A),o.on("blur",k.hide)),o.on("init",function(){(o.hasFocus()||O)&&A()}),sp(o,r),{editorContainer:w.element.dom,api:{show:function(){k.show()},hide:function(){k.hide()},enable:function(){cp(r,!1)},disable:function(){cp(r,!0)},isDisabled:function(){return Nt.isDisabled(w)}}}}}),BC="contexttoolbar-hide",MC=function(t,e){var n,o,r,i,u=t.label.fold(function(){return{}},function(t){return{"aria-label":t}}),u=Wt(hv.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:u,selectOnFocus:!0,inputBehaviours:Ht([$.config({mode:"special",onEnter:function(t){return a.findPrimary(t).map(function(t){return Dr(t),!0})},onLeft:function(t,e){return e.cut(),Mt.none()},onRight:function(t,e){return e.cut(),Mt.none()}})])})),a=(n=u,o=t.commands,r=e,i=F(o,function(t){return Wt(("contextformtogglebutton"===t.type?function(t,e,n){var o=e.original,o=(o.primary,B(o,["primary"])),o=Do(Wm(Bt(Bt({},o),{type:"togglebutton",onAction:Et})));return pC(o,n.backstage.shared.providers,[aC(t,e)])}:function(t,e,n){var o=e.original,o=(o.primary,B(o,["primary"])),o=Do(Lm(Bt(Bt({},o),{type:"button",onAction:Et})));return gC(o,n.backstage.shared.providers,[aC(t,e)])})(n,t,{backstage:{shared:{providers:r}}}))}),{asSpecs:function(){return F(i,function(t){return t.asSpec()})},findPrimary:function(n){return mt(o,function(t,e){return t.primary?Mt.from(i[e]).bind(function(t){return t.getOpt(n)}).filter(h(Nt.isDisabled)):Mt.none()})}});return[{title:Mt.none(),items:[u.asSpec()]},{title:Mt.none(),items:a.asSpecs()}]},AC={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},FC={maxHeightFunction:Oc(),maxWidthFunction:AS()},IC=O("forward-slide"),RC=O("backward-slide"),VC=O("change-slide-event"),PC="tox-pop--resizing",HC="tox-pop--transition",zC={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},NC=(ff=["Infinity",(sf="[0-9]+")+"\\."+LC(sf)+LC(Jc="[eE][+-]?[0-9]+"),"\\."+sf+LC(Jc),sf+LC(Jc)].join("|"),new RegExp("^([+-]?(?:"+ff+"))(.*)$"));function LC(t){return"(?:"+t+")?"}function WC(u,a){function e(){var t=a.getOptions(u),r=a.getCurrent(u).map(a.hash),i=rc();return F(t,function(o){return{type:"togglemenuitem",text:a.display(o),onSetup:function(e){function t(t){t&&(i.on(function(t){return t.setActive(!1)}),i.set(e)),e.setActive(t)}t(xt(r,a.hash(o)));var n=a.watcher(u,o,t);return function(){i.clear(),n()}},onAction:function(){return a.setCurrent(u,o)}}})}u.ui.registry.addMenuButton(a.name,{tooltip:a.text,icon:a.icon,fetch:function(t){return t(e())},onSetup:a.onToolbarSetup}),u.ui.registry.addNestedMenuItem(a.name,{type:"nestedmenuitem",text:a.text,getSubmenuItems:e,onSetup:a.onMenuSetup})}function UC(t,e){return function(){t.execCommand("mceToggleFormat",!1,e)}}function jC(e,n){return Dw(e,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",function(t){t.setDisabled(e.mode.isReadOnly()||!e.undoManager[n]())})}function GC(t,e){var n,o,r,i,u,a,c,s,l,f,d,m,g,p,h,v,b=t,y=(Y([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],function(t){b.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Mw(b,t.cmd),onSetup:Ew(b,t.name)})}),b.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:Mw(b,"JustifyNone")}),f=t),x=y;px.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],function(t,e){x.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:Ew(x,t.name),onAction:UC(x,t.name)})});for(var w=1;w<=6;w++){var S="h"+w;x.ui.registry.addToggleButton(S,{text:S.toUpperCase(),tooltip:"Heading "+w,onSetup:Ew(x,S),onAction:UC(x,S)})}h=y,px.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],function(t){h.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Mw(h,t.action)})}),v=y,px.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],function(t){v.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Mw(v,t.action),onSetup:Ew(v,t.name)})}),l=f,px.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],function(t){l.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:Mw(l,t.action)})}),l.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:UC(l,"code")}),s=Aw(0,f=y=e,WS(p=e=t)),p.ui.registry.addNestedMenuItem("align",{text:f.shared.providers.translate("Align"),getSubmenuItems:function(){return s.items.validateItems(s.getStyleItems())}}),i=Aw(0,p=y,jS(f=e)),f.ui.registry.addNestedMenuItem("fontformats",{text:p.shared.providers.translate("Fonts"),getSubmenuItems:function(){return i.items.validateItems(i.getStyleItems())}}),f=e,g=Bt({type:"advanced"},(p=y).styleselect),u=Aw(0,p,qS(f,g)),f.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return u.items.validateItems(u.getStyleItems())}}),a=Aw(0,y,YS(p=e)),p.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return a.items.validateItems(a.getStyleItems())}}),c=Aw(0,y,GS(g=e)),g.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return c.items.validateItems(c.getStyleItems())}}),(p=f=t).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:jC(p,"hasUndo"),onAction:Mw(p,"undo")}),p.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:jC(p,"hasRedo"),onAction:Mw(p,"redo")}),(y=f).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",disabled:!0,onSetup:jC(y,"hasUndo"),onAction:Mw(y,"undo")}),y.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",disabled:!0,onSetup:jC(y,"hasRedo"),onAction:Mw(y,"redo")}),(m=e=t).addCommand("mceApplyTextcolor",function(t,e){var n,o=t,r=e;(n=m).undoManager.transact(function(){n.focus(),n.formatter.apply(o,{value:r}),n.nodeChanged()})}),m.addCommand("mceRemoveTextcolor",function(t){var e,n=t;(e=m).undoManager.transact(function(){e.focus(),e.formatter.remove(n,{value:null},null,!0),e.nodeChanged()})}),g=It(Eh),p=It(Eh),vh(e,"forecolor","forecolor","Text color",g),vh(e,"backcolor","hilitecolor","Background color",p),bh(e,"forecolor","forecolor","Text color"),bh(e,"backcolor","hilitecolor","Background color"),(f=t).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:Mw(f,"mceToggleVisualAid")}),f.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:Dw(d=f,"VisualAid",function(t){t.setActive(d.hasVisual)}),onAction:Mw(f,"mceToggleVisualAid")}),(y=t).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:Dw(r=y,"NodeChange",function(t){t.setDisabled(!r.queryCommandState("outdent"))}),onAction:Mw(y,"outdent")}),y.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:Mw(y,"indent")}),WC(n=t,Bk),o=n,Mt.from(o.getParam("content_langs",void 0,"array")).map(function(t){return{name:"language",text:"Language",icon:"language",getOptions:Dt(t),hash:function(t){return k(t.customCode)?t.code:t.code+"/"+t.customCode},display:function(t){return t.title},watcher:function(t,e,n){return t.formatter.formatChanged("lang",n,!1,{value:e.code,customValue:e.customCode}).unbind},getCurrent:function(t){return Or(At.fromDom(t.selection.getNode()),function(t){return Mt.some(t).filter(Cn).bind(function(e){return Me(e,"lang").map(function(t){return{code:t,customCode:Me(e,"data-mce-lang").getOrUndefined(),title:""}})})})},setCurrent:function(t,e){return t.execCommand("Lang",!1,e)},onToolbarSetup:function(t){var e=oc();return t.setActive(o.formatter.match("lang",{},void 0,!0)),e.set(o.formatter.formatChanged("lang",t.setActive,!0)),e.clear}}}).each(function(t){return WC(n,t)})}function XC(t,e){return{type:"makeshift",x:t,y:e}}function YC(t){return"longpress"===t.type||0===t.type.indexOf("touch")}function qC(t,e,n){switch(n){case"node":return{type:"node",node:Mt.some(At.fromDom((c=t).selection.getNode())),root:At.fromDom(c.getBody())};case"point":return c=t,"contextmenu"===(o=e).type||"longpress"===o.type?c.inline?YC(r=o)?XC((i=r.touches[0]).pageX,i.pageY):XC(r.pageX,r.pageY):(i=c.getContentAreaContainer(),o=YC(r=o)?XC((o=r.touches[0]).clientX,o.clientY):XC(r.clientX,r.clientY),u=(a=$g.DOM.getPos(i)).x,a=a.y,XC(o.x+u,o.y+a)):_k(c);case"selection":return _k(t)}var o,r,i,u,a,c}function KC(l,f,d,m,g,p){function u(){var e,n,o,t,r=d(),i=m,u=g,a=!(b||h||v&&y),c=qC(e=l,n=f,t=o=p),s=Bt({bubble:fc(0,"point"===t?12:0,Ak),layouts:Mk,overrides:{maxWidthFunction:AS(),maxHeightFunction:Oc()}},c);Sy(r,_g.CLOSE_ON_EXECUTE,i,!0).map(function(t){n.preventDefault(),Om.showMenuWithinBounds(u,{anchor:s},{menu:{markers:rg("normal"),highlightImmediately:a},data:t,type:"horizontal"},function(){return Mt.some(lC(e,i.shared,"node"===o?"node":"selection"))}),e.fire(BC)})}var t,e=Hn(),h=e.os.isiOS(),v=e.os.isOSX(),b=e.os.isAndroid(),y=e.deviceType.isTouch();(v||h)&&"node"!==p?(t=function(){function t(){Tm.setEditorTimeout(o,function(){o.selection.setRng(r)},10),i()}function e(t){t.preventDefault(),t.stopImmediatePropagation()}function n(){return i()}var o,r,i;r=(o=l).selection.getRng(),o.once("touchend",t),o.on("mousedown",e,!0),o.once("longpresscancel",n),i=function(){o.off("touchend",t),o.off("longpresscancel",n),o.off("mousedown",e)},u()},function(t,e){var n,o=t.selection;if(!(o.isCollapsed()||e.touches.length<1))return n=e.touches[0],e=o.getRng(),is(t.getWin(),Qc.domRange(e)).exists(function(t){return t.left<=n.clientX&&t.right>=n.clientX&&t.top<=n.clientY&&t.bottom>=n.clientY})}(l,f)?t():(l.once("selectionchange",t),l.once("touchend",function(){return l.off("selectionchange",t)}))):u()}function JC(t){return"string"==typeof t?t.split(/[ ,]/):t}function $C(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")}function QC(t){return P(t)?"|"===t:"separator"===t.type}function ZC(t,e){var n;return 0===e.length?t:(n=dt(t).filter(function(t){return!QC(t)}).fold(function(){return[]},function(t){return[Fk]}),t.concat(n).concat(e).concat([Fk]))}function tk(t,e){return"longpress"!==e.type&&(2!==e.button||e.target===t.getBody()&&""===e.pointerType)}function ek(t,e){return tk(t,e)?t.selection.getStart(!0):e.target}function nk(a,t,r){function e(t){return Om.hide(c)}function n(u){var t,e,n,o;$C(a)&&u.preventDefault(),u.ctrlKey&&!$C(a)||!1===a.getParam("contextmenu")||(e=u,n=(t=a).getParam("contextmenu_avoid_overlap","","string"),o=tk(t,e)?"selection":"point",e=Ot(n)&&(t=ek(t,e),Lh(At.fromDom(t),n))?"node":o,(i()?KC:function(t,e,n,o,r,i){var n=n(),u=qC(t,e,i);Sy(n,_g.CLOSE_ON_EXECUTE,o,!1).map(function(t){e.preventDefault(),Om.showMenuAt(r,{anchor:u},{menu:{markers:rg("normal")},data:t})})})(a,u,function(){var e,t=ek(a,u),n=a.ui.registry.getAll(),o=(e=(o=a).ui.registry.getAll().contextMenus,Mt.from(o.getParam("contextmenu")).map(JC).getOrThunk(function(){return G(JC("link linkchecker image imagetools table spellchecker configurepermanentpen"),function(t){return ne(e,t)})})),r=n.contextMenus,i=t;return 0<(n=Z(o,function(e,t){return I(r,t.toLowerCase()).map(function(t){var t=t.update(i);return P(t)?ZC(e,t.split(" ")):0<t.length?(t=F(t,Ik),ZC(e,t)):e}).getOrThunk(function(){return e.concat([t])})},[])).length&&QC(n[n.length-1])&&n.pop(),n},r,c,e))}var i=Hn().deviceType.isTouch,c=_u(Om.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return a.focus()},onShow:function(){return r.setContextMenuState(!0)},onHide:function(){return r.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:Ht([Lt("dismissContextMenu",[Pt($i(),function(t,e){m.close(t),a.focus()})])])}));a.on("init",function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(i()?"":" ResizeWindow");a.on(t,e),a.on("longpress contextmenu",n)})}function ok(e){return function(t){return t.translate(-e.left,-e.top)}}function rk(e){return function(t){return t.translate(e.left,e.top)}}function ik(n){return function(t,e){return Z(n,function(t,e){return e(t)},Yn(t,e))}}function uk(t,e,n){return t.fold(ik([rk(n),ok(e)]),ik([ok(e)]),ik([]))}function ak(t,e,n){return t.fold(ik([rk(n)]),ik([]),ik([rk(e)]))}function ck(t,e,n){return t.fold(ik([]),ik([ok(n)]),ik([rk(e),ok(n)]))}function sk(t,e,n){t=t.fold(function(t,e){return{position:Mt.some("absolute"),left:Mt.some(t+"px"),top:Mt.some(e+"px")}},function(t,e){return{position:Mt.some("absolute"),left:Mt.some(t-n.left+"px"),top:Mt.some(e-n.top+"px")}},function(t,e){return{position:Mt.some("fixed"),left:Mt.some(t+"px"),top:Mt.some(e+"px")}});return Bt({right:Mt.none(),bottom:Mt.none()},t)}function lk(t,i,u,a){function e(o,r){return function(t,e){var n=o(i,u,a);return r(t.getOr(n.left),e.getOr(n.top))}}return t.fold(e(ck,Rk),e(ak,Vk),e(uk,Pk))}function fk(t,e){t=Be(t,e);return k(t)?NaN:parseInt(t,10)}function dk(t,a,c,s){return mt(t,function(t){var e,n,o=t.sensor,r=t.range.left,i=t.range.top,u=ak(a,e=c,n=s),o=ak(o,e,n);return Math.abs(u.left-o.left)<=r&&Math.abs(u.top-o.top)<=i?Mt.some({output:lk(t.output,a,c,s),extra:t.extra}):Mt.none()})}function mk(t,e){var n;t.getSystem().addToGui(e),ye((n=e).element).filter(Cn).each(function(e){ze(e,"z-index").each(function(t){Ft(e,Hk,t)}),q(e,"z-index",He(n.element,"z-index"))})}function gk(t){ye(t.element).filter(Cn).each(function(e){Me(e,Hk).fold(function(){return Le(e,"z-index")},function(t){return q(e,"z-index",t)}),Fe(e,Hk)}),t.getSystem().removeFromGui(t)}function pk(t,e,n){return t.getSystem().build(ov.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[e]},events:n}))}function hk(t,e){return{bounds:t.getBounds(),height:Ge(e.element),width:Ke(e.element)}}function vk(x,w,t,e,n){var e=t.update(e,n),S=t.getStartData().getOrThunk(function(){return hk(w,x)});e.each(function(t){var e,n,f,d,m,g,p,o,r,i,u,a,c,s,l,h,v=x,b=S,y=(e=w).getTarget(v.element);e.repositionTarget&&(i=rn(pe(v.element)),n=M0(y),c=ze(a=y,"left"),s=ze(a,"top"),l=ze(a,"position"),h=function(t,e,n){return("fixed"===n?Pk:Rk)(parseInt(t,10),parseInt(e,10))},h=(c.isSome()&&s.isSome()&&l.isSome()?Mt.some(h(c.getOrDie(),s.getOrDie(),l.getOrDie())):Mt.none()).getOrThunk(function(){var t=Ye(a);return Vk(t.left,t.top)}),f=v,c=e.snaps,d=h,m=i,g=n,p=t,s=b,l=c.fold(function(){var n,o,t=uk((n=p.left,o=p.top,d.fold(function(t,e){return Rk(t+n,e+o)},function(t,e){return Vk(t+n,e+o)},function(t,e){return Pk(t+n,e+o)})),m,g);return Pk(t.left,t.top)},function(e){n=e,i=m,l=g,u=o=d,a=r=p,c=fk(o=(t=f).element,(r=n).leftAttr),o=fk(o,r.topAttr),r=(isNaN(c)||isNaN(o)?Mt.none():Mt.some(Yn(c,o))).fold(function(){return u},function(t){return Pk(t.left+a.left,t.top+a.top)}),c=(n.mustSnap?Tk:Ek)(t,n,r,i,l),s=uk(r,i,l),o=n,r=s,Ft(i=t.element,o.leftAttr,r.left+"px"),Ft(i,o.topAttr,r.top+"px");var t,n,o,r,i,u,a,c,s,l=c.fold(function(){return{coord:Pk(s.left,s.top),extra:Mt.none()}},function(t){return{coord:t.output,extra:t.extra}});return l.extra.each(function(t){e.onSensor(f,t)}),l.coord}),i=(h=s).bounds,b=ak(l,o=m,r=g),c=La(b.left,i.x,i.x+i.width-h.width),s=La(b.top,i.y,i.y+i.height-h.height),u=Vk(c,s),Pe(y,sk(l.fold(function(){var t=ck(u,o,r);return Rk(t.left,t.top)},Dt(u),function(){var t=uk(u,o,r);return Pk(t.left,t.top)}),0,n))),e.onDrag(v,y,t)})}function bk(n,t,e,o){t.each(gk),e.snaps.each(function(t){var e;Fe(e=n.element,t.leftAttr),Fe(e,t.topAttr)});t=e.getTarget(n.element);o.reset(),e.onDrop(n,t)}function yk(t){return function(e,n){function o(t){n.setStartData(hk(e,t))}return iu(M([Pt(Yi(),function(t){n.getStartData().each(function(){return o(t)})})],t(e,n,o),!0))}}function xk(i,u,a){return[Pt(bi(),function(e,t){var n,o,r;0===t.event.raw.button&&(t.stop(),t={drop:t=function(){return bk(e,Mt.some(o),i,u)},delayDrop:(n=Wh(t,200)).schedule,forceDrop:t,move:function(t){n.cancel(),vk(e,i,u,zk,t)}},o=pk(e,i.blockerClass,(r=t,iu([Pt(bi(),r.forceDrop),Pt(wi(),r.drop),Pt(yi(),function(t,e){r.move(e.event)}),Pt(xi(),r.delayDrop)]))),a(e),mk(e,o))})]}function wk(r,i,u){function a(t){bk(t,c.get(),r,i),c.clear()}var c=rc();return[Pt(gi(),function(e,t){t.stop();var n,o=pk(e,r.blockerClass,(o=t=function(){return a(e)},n=function(t){vk(e,r,i,Nk,t)},iu([Pt(gi(),o),Pt(hi(),t),Pt(vi(),t),Pt(pi(),function(t,e){n(e.event)})])));c.set(o),u(e),mk(e,o)}),Pt(pi(),function(t,e){e.stop(),vk(t,r,i,Nk,e.event)}),Pt(hi(),function(t,e){e.stop(),a(t)}),Pt(vi(),a)]}function Sk(t,o,r,i,e,n){return t.fold(function(){return Lk.snap({sensor:Vk(r-20,i-20),range:Yn(e,n),output:Vk(Mt.some(r),Mt.some(i)),extra:{td:o}})},function(t){var e=r-20,n=i-20,t=t.element.dom.getBoundingClientRect();return Lk.snap({sensor:Vk(e,n),range:Yn(40,40),output:Vk(Mt.some(r-t.width/2),Mt.some(i-t.height/2)),extra:{td:o}})})}function Ck(t,r,i){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,e){var e=e.td,n=r.get(),o=e;n.exists(function(t){return me(t,o)})||(r.set(e),i(e))},mustSnap:!0}}function kk(t){return Wt(Em.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:Ht([Lk.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),Ky.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))}function Ok(i,n){function e(t){var e=ln(t);return Sk(g.getOpt(n),t,e.x,e.y,e.width,e.height)}function o(t){var e=ln(t);return Sk(p.getOpt(n),t,e.right,e.bottom,e.width,e.height)}function r(t,e,n,o){var r,n=n(e);Lk.snapTo(t,n),n=t,t=e.dom.getBoundingClientRect(),Le(n.element,"display"),e=be(At.fromDom(i.getBody())).dom.innerHeight,r=t[o]<0,t=t[o]>e,(r||t)&&q(n.element,"display","none")}function u(t){return r(h,t,e,"top")}function a(t){return r(v,t,o,"bottom")}var c=It([]),s=It([]),t=It(!1),l=rc(),f=rc(),d=Ck(function(){return F(c.get(),e)},l,function(e){f.get().each(function(t){i.fire("TableSelectorChange",{start:e,finish:t})})}),m=Ck(function(){return F(s.get(),o)},f,function(e){l.get().each(function(t){i.fire("TableSelectorChange",{start:t,finish:e})})}),g=kk(d),p=kk(m),h=_u(g.asSpec()),v=_u(p.asSpec());Hn().deviceType.isTouch()&&(i.on("TableSelectionChange",function(e){t.get()||(ws(n,h),ws(n,v),t.set(!0)),l.set(e.start),f.set(e.finish),e.otherCells.each(function(t){c.set(t.upOrLeftCells),s.set(t.downOrRightCells),u(e.start),a(e.finish)})}),i.on("ResizeEditor ResizeWindow ScrollContent",function(){l.get().each(u),f.get().each(a)}),i.on("TableSelectionClear",function(){t.get()&&(Cs(h),Cs(v),t.set(!1)),l.clear(),f.clear()}))}function _k(t){return{type:"selection",root:At.fromDom(t.selection.getNode())}}function Tk(t,e,a,c,s){var n=e.getSnapPoints(t);return dk(n,a,c,s).orThunk(function(){return Z(n,function(e,n){o=n.sensor,n.range.left,n.range.top,t=ak(a,r=c,i=s),o=ak(o,r,i),r=Math.abs(t.left-o.left),i=Math.abs(t.top-o.top);var t,o,r,i,u=Yn(r,i);return e.deltas.fold(function(){return{deltas:Mt.some(u),snap:Mt.some(n)}},function(t){return(u.left+u.top)/2<=(t.left+t.top)/2?{deltas:Mt.some(u),snap:Mt.some(n)}:e})},{deltas:Mt.none(),snap:Mt.none()}).snap.map(function(t){return{output:lk(t.output,a,c,s),extra:t.extra}})})}function Ek(t,e,n,o,r){return dk(e.getSnapPoints(t),n,o,r)}var Dk,Bk={name:"lineheight",text:"Line height",icon:"line-height",getOptions:function(t){return t.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" ")},hash:function(t){return o=["fixed","relative","empty"],Mt.from(NC.exec(t)).bind(function(t){var e=Number(t[1]),t=t[2],n=t;return V(o,function(t){return V(zC[t],function(t){return n===t})})?Mt.some({value:e,unit:t}):Mt.none()}).map(function(t){return t.value+t.unit}).getOr(t);var o},display:x,watcher:function(t,e,n){return t.formatter.formatChanged("lineheight",n,!1,{value:e}).unbind},getCurrent:function(t){return Mt.from(t.queryCommandValue("LineHeight"))},setCurrent:function(t,e){return t.execCommand("LineHeight",!1,e)}},Mk={onLtr:function(){return[qa,Ua,ja,Ga,Xa,Ya,em,nm,Vd,Id,Rd,Fd]},onRtl:function(){return[qa,ja,Ua,Xa,Ga,Ya,em,nm,Rd,Fd,Vd,Id]}},Ak={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},Fk={type:"separator"},Ik=function(e){function t(t){return{text:t.text,icon:t.icon,disabled:t.disabled,shortcut:t.shortcut}}var n;if(P(e))return e;switch(e.type){case"separator":return Fk;case"submenu":return Bt(Bt({type:"nestedmenuitem"},t(e)),{getSubmenuItems:function(){var t=e.getSubmenuItems();return P(t)?t:F(t,Ik)}});default:return Bt(Bt({type:"menuitem"},t(e)),{onAction:(n=e.onAction,function(){return n()})})}},um=tr([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),Rk=um.offset,Vk=um.absolute,Pk=um.fixed,Aa=Object.freeze({__proto__:null,snapTo:function(t,e,n,o){var r=e.getTarget(t.element);e.repositionTarget&&(e=rn(pe(t.element)),t=M0(r),Pe(r,sk([lk((r=o).output,r.output,e,t),r.extra][0],0,t)))}}),Hk="data-initial-z-index",lm=Go("snaps",[y("getSnapPoints"),t("onSensor"),y("leftAttr"),y("topAttr"),S("lazyViewport",oo),S("mustSnap",!1)]),lf=[S("useFixed",N),y("blockerClass"),S("getTarget",x),S("onDrag",Et),S("repositionTarget",!0),S("onDrop",Et),$o("getBounds",oo),lm],zk=Object.freeze({__proto__:null,getData:function(t){return Mt.from(Yn(t.x,t.y))},getDelta:function(t,e){return Yn(e.left-t.left,e.top-t.top)}}),am=M(M([],lf,!0),[$u("dragger",{handlers:yk(xk)})],!1),Nk=Object.freeze({__proto__:null,getData:function(t){var t=t.raw.touches;return 1===t.length?(t=t[0],Mt.some(Yn(t.clientX,t.clientY))):Mt.none()},getDelta:function(t,e){return Yn(e.left-t.left,e.top-t.top)}}),lu=M(M([],lf,!0),[$u("dragger",{handlers:yk(wk)})],!1),sm=M(M([],lf,!0),[$u("dragger",{handlers:yk(function(t,e,n){return M(M([],xk(t,e,n),!0),wk(t,e,n),!0)})})],!1),Lk=ba({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:am,touch:lu,mouseOrTouch:sm}),name:"dragging",active:{events:function(t,e){return t.dragger.handlers(t,e)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:Mt.from(t.extra)}}},state:Object.freeze({__proto__:null,init:function(){var r=Mt.none(),e=Mt.none(),t=Dt({});return Cu({readState:t,reset:function(){r=Mt.none(),e=Mt.none()},update:function(o,t){return o.getData(t).bind(function(t){return e=o,n=t,t=r.map(function(t){return e.getDelta(t,n)}),r=Mt.some(n),t;var e,n})},getStartData:function(){return e},setStartData:function(t){e=Mt.some(t)}})}}),apis:Aa});function Wk(t,e,n){var o,r,i,u,a=At.fromDom(t.getContainer());gt((o=t,e=e,n=n,r=je(a),i=qe(a),(u={}).height=rC(r+e.top,vg(o),yg(o)),n===Dk.Both&&(u.width=rC(i+e.left,hg(o),bg(o))),u),function(t,e){q(a,e,oC(t))}),t.fire("ResizeEditor")}function Uk(t,e,n,o){return Wk(t,Yn(20*n,20*o),e),Mt.some(!0)}function jk(t,e){var o,r,i,u,n,a,c,s,l;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(l=[],t.getParam("elementpath",!0,"boolean")&&l.push((a=t,s=e,(c={}).delimiter||(c.delimiter="»"),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:Ht([$.config({mode:"flow",selector:"div[role=button]"}),Nt.config({disabled:s.isDisabled}),lp(),rv.config({}),Ut.config({}),Lt("elementPathEvents",[uu(function(e,t){a.shortcuts.add("alt+F11","focus statusbar elementpath",function(){return $.focusIn(e)}),a.on("NodeChange",function(t){var n,t=function(t){for(var e=[],n=t.length;0<n--;){var o=t[n];if(1===o.nodeType&&(1!==(r=o).nodeType||"BR"!==r.nodeName&&!r.getAttribute("data-mce-bogus")&&"bookmark"!==r.getAttribute("data-mce-type"))){var r=a.fire("ResolveName",{name:o.nodeName.toLowerCase(),target:o});if(r.isDefaultPrevented()||e.push({name:r.name,element:o}),r.isPropagationStopped())break}}return e}(t.parents);0<t.length?Ut.set(e,(t=F(t||[],function(e,t){return Em.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":t,"tab-index":-1,"aria-level":t+1},innerHtml:e.name},action:function(t){a.focus(),a.selection.select(e.element),a.nodeChanged()},buttonBehaviours:Ht([Gp(s.isDisabled),lp()])})}),n={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+c.delimiter+" "}},Z(t.slice(1),function(t,e){return t.push(n),t.push(e),t},[t[0]]))):Ut.set(e,[])})})])]),components:[]})),t.hasPlugin("wordcount")&&l.push((i=t,u=e,Em.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:Ht([Gp(u.isDisabled),lp(),rv.config({}),Ut.config({}),zt.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),Lt("wordcount-events",[su(function(t){var e=zt.getValue(t),n="words"===e.mode?"characters":"words";zt.setValue(t,{mode:n,count:e.count}),f(t,e.count,n)}),uu(function(n){i.on("wordCountUpdate",function(t){var e=zt.getValue(n).mode;zt.setValue(n,{mode:e,count:t.wordCount}),f(n,t.wordCount,e)})})])]),eventOrder:((n={})[Hi()]=["disabling","alloy.base.behaviour","wordcount-events"],n)}))),t.getParam("branding",!0,"boolean")&&l.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(n=Dm.translate(["Powered by {0}","Tiny"]))+'">'+n+"</a>"}}),n=0<l.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:l}]:[],l=e,t=!(e=o=t).hasPlugin("autoresize"),t=(r=!1===(e=e.getParam("resize",t))?Dk.None:"both"===e?Dk.Both:Dk.Vertical)===Dk.None?Mt.none():Mt.some(Kd("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:l.translate("Resize")},behaviours:[Lk.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,e,n){return Wk(o,n,r)},blockerClass:"tox-blocker"}),$.config({mode:"special",onLeft:function(){return Uk(o,r,-1,0)},onRight:function(){return Uk(o,r,1,0)},onUp:function(){return Uk(o,r,0,-1)},onDown:function(){return Uk(o,r,0,1)}}),rv.config({}),jt.config({})]},l.icons)),n.concat(t.toArray()))};function f(t,e,n){Ut.set(t,[ci(u.translate(["{0} "+n,e[n]]))])}}function Gk(h){function v(){return e.bind(PS.getHeader)}function b(){return K.value(x)}function V(){return e.bind(function(t){return PS.getThrobber(t)}).getOrDie("Could not find throbber element")}var t=h.inline,P=t?DC:EC,y=ap(h)?yS:dS,e=Mt.none(),n=Hn(),o=n.browser.isIE()?["tox-platform-ie"]:[],n=n.deviceType.isTouch()?["tox-platform-touch"]:[],r=np(h),i=ip(h),u=Dm.isRtl()?{attributes:{dir:"rtl"}}:{},a={attributes:((a={})[jc]=r?pc.BottomToTop:pc.TopToBottom,a)},x=_u((i=me(Un(),i)&&"grid"===He(i,"display"),u={dom:Bt({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(o).concat(n)},u),behaviours:Ht([jl.config({useFixed:function(){return y.isDocked(v)}})])},s={dom:{styles:{width:document.body.clientWidth+"px"}},events:iu([Pt(qi(),function(){q(M.element,"width",document.body.clientWidth+"px")})])},sr(u,i?s:{}))),c=Wt({dom:{tag:"div",classes:["tox-anchorbar"]}}),w=D0(x,h,function(){return e.bind(function(t){return c.getOpt(t)}).getOrDie("Could not find a anchor bar element")}),u=PS.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:w,onEscape:function(){h.focus()}}),S=tp(h),i=PS.parts.toolbar(Bt({dom:{tag:"div",classes:["tox-toolbar"]},getSink:b,providers:w.shared.providers,onEscape:function(){h.focus()},type:S,lazyToolbar:function(){return e.bind(function(t){return PS.getToolbar(t)}).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return v().getOrDie("Could not find header element")}},a)),s=PS.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:w.shared.providers,onEscape:function(){h.focus()},type:S}),l=PS.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),f=PS.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),H=PS.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:w}),z=h.getParam("statusbar",!0,"boolean")&&!t?Mt.some(jk(h,w.shared.providers)):Mt.none(),l={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[l,f]},f=Zg(h),d=wg(h),m=xg(h),a=PS.parts.header({dom:Bt({tag:"div",classes:["tox-editor-header"]},a),components:nt([m?[u]:[],f?[s]:d?[i]:[],rp(h)?[]:[c.asSpec()]]),sticky:ap(h),editor:h,sharedBackstage:w.shared}),m=nt([r?[]:[a],t?[]:[l],r?[a]:[]]),u=nt([[{dom:{tag:"div",classes:["tox-editor-container"]},components:m}],t?[]:z.toArray(),[H]]),f=up(h),s=Bt(Bt({role:"application"},Dm.isRtl()?{dir:"rtl"}:{}),f?{"aria-hidden":"true"}:{}),C=_u(PS.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(t?["tox-tinymce-inline"]:[]).concat(r?["tox-tinymce--toolbar-bottom"]:[]).concat(n).concat(o),styles:Bt({visibility:"hidden"},f?{opacity:"0",border:"0"}:{}),attributes:s},components:u,behaviours:Ht([lp(),Nt.config({disableClass:"tox-tinymce--disabled"}),$.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])})),e=Mt.some(C);h.shortcuts.add("alt+F9","focus menubar",function(){PS.focusMenubar(C)}),h.shortcuts.add("alt+F10","focus toolbar",function(){PS.focusToolbar(C)}),h.addCommand("ToggleToolbarDrawer",function(){PS.toggleToolbarDrawer(C)}),h.addQueryStateHandler("ToggleToolbarDrawer",function(){return PS.isToolbarDrawerToggled(C)});var g,p,k,O,_,T,E,D,B=qh(C),M=qh(x);return g=h,p=B,k=M,d=ya(),O=ic(d,"touchstart",I),_=ic(d,"touchmove",function(t){return A(Gi(),t)}),T=ic(d,"touchend",function(t){return A(Xi(),t)}),E=ic(d,"mousedown",I),D=ic(d,"mouseup",function(t){0===t.raw.button&&F(Kl(),{target:t.target})}),g.on("PostRender",function(){g.on("click",R),g.on("tap",R),g.on("mouseup",N),g.on("mousedown",L),g.on("ScrollWindow",W),g.on("ResizeWindow",U),g.on("ResizeEditor",j),g.on("AfterProgressState",G),g.on("DismissPopups",X)}),g.on("remove",function(){g.off("click",R),g.off("tap",R),g.off("mouseup",N),g.off("mousedown",L),g.off("ScrollWindow",W),g.off("ResizeWindow",U),g.off("ResizeEditor",j),g.off("AfterProgressState",G),g.off("DismissPopups",X),E.unbind(),O.unbind(),_.unbind(),T.unbind(),D.unbind()}),g.on("detach",function(){_s(p),_s(k),p.destroy(),k.destroy()}),{mothership:B,uiMothership:M,backstage:w,renderUI:function(){var o,r,l,f,d,m,n;function e(t){var e;!m.get()||"focusin"===(e=t).type&&(e.composed?ft(e.composedPath()):Mt.from(e.target)).map(At.fromDom).filter(Cn).exists(function(t){return ni(t,"mce-pastebin")})||(t.preventDefault(),uw(f()),l.editorManager.setActive(l))}function i(t){var e,n,o,r,i,u,a,c,s;t!==m.get()&&(m.set(t),e=l,n=f(),o=d.providers,a=n.element,c=i=t,s="data-mce-"+(r="tabindex"),Mt.from(e.iframeElement).map(At.fromDom).each(function(e){c?(Me(e,r).each(function(t){return Ft(e,s,t)}),Ft(e,r,-1)):(Fe(e,r),Me(e,s).each(function(t){Ft(e,r,t),Fe(e,s)}))}),i?(MS.block(n,(u=o,function(t,e){return{dom:{tag:"div",attributes:{"aria-label":u.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:iw('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}})),Le(a,"display"),Fe(a,"aria-hidden"),e.hasFocus()&&uw(n)):(i=J.getCurrent(n).exists(function(t){return wa(t.element)}),MS.unblock(n),q(a,"display","none"),Ft(a,"aria-hidden","true"),i&&e.focus()),l.fire("AfterProgressState",{state:t}))}y.setup(h,w.shared,v),GC(h,w),nk(h,b,w),r=(o=h).ui.registry.getAll().sidebars,Y(Zt(r),function(e){function n(){return xt(Mt.from(o.queryCommandValue("ToggleSidebar")),e)}var t=r[e];o.ui.registry.addToggleButton(e,{icon:t.icon,tooltip:t.tooltip,onAction:function(t){o.execCommand("ToggleSidebar",!1,e),t.setActive(n())},onSetup:function(t){function e(){return t.setActive(n())}return o.on("ToggleSidebar",e),function(){o.off("ToggleSidebar",e)}}})}),l=h,f=V,d=w.shared,m=It(!1),n=rc(),l.inline||l.on("PreInit",function(){l.dom.bind(l.getWin(),"focusin",e),l.on("BeforeExecCommand",function(t){"mcefocus"===t.command.toLowerCase()&&!0!==t.value&&e(t)})}),l.on("ProgressState",function(t){var e;n.on(Tm.clearTimeout),Q(t.time)?(e=Tm.setEditorTimeout(l,function(){return i(t.state)},t.time),n.set(e)):(i(t.state),n.clear())}),pt(h.getParam("toolbar_groups",{},"object"),function(t,e){h.ui.registry.addGroupToolbarButton(e,t)});var u,a,t=h.ui.registry.getAll(),c=t.buttons,s=t.menuItems,g=t.contextToolbars,t=t.sidebars,p=Sg(h),s={menuItems:s,menus:(s=h.getParam("menu"))?pt(s,function(t){return Bt(Bt({},t),{items:t.items})}):{},menubar:h.getParam("menubar"),toolbar:p.getOrThunk(function(){return h.getParam("toolbar",!0)}),allowToolbarGroups:S===kg.floating,buttons:c,sidebar:t},p=(mC(h,g,x,{backstage:w}),Ok(h,x),h.getElement());return t=oC((g=gg(t=c=h),u=vg(t),a=yg(t),nC(g).map(function(t){return rC(t,u,a)}).getOr(gg(c)))),c=oC(iC(g=h).getOr(pg(g))),h.inline||(Ne("div","width",c)&&q(C.element,"width",c),Ne("div","height",t)?q(C.element,"height",t):q(C.element,"height","200px")),P.render(h,{mothership:B,uiMothership:M,outerContainer:C},s,w,{targetNode:p,height:t})},getUi:function(){return{channels:{broadcastAll:M.broadcast,broadcastOn:M.broadcastOn,register:Et}}}};function A(e,n){Y([p,k],function(t){t.broadcastEvent(e,n)})}function F(e,n){Y([p,k],function(t){t.broadcastOn([e],n)})}function I(t){return F(Yl(),{target:t.target})}function R(t){return F(Yl(),{target:At.fromDom(t.target)})}function N(t){0===t.button&&F(Kl(),{target:At.fromDom(t.target)})}function L(){Y(g.editorManager.get(),function(t){g!==t&&t.fire("DismissPopups",{relatedTarget:g})})}function W(t){return A(Yi(),wc(t))}function U(t){F(ql(),{}),A(qi(),wc(t))}function j(){return F(ql(),{})}function G(t){t.state&&F(Yl(),{target:At.fromDom(g.getContainer())})}function X(t){F(Yl(),{target:At.fromDom(t.relatedTarget.getContainer())})}}function Xk(e){return yr("items","items",lo(),So(_o(function(t){return Eo("Checking item of "+e,K1,t).fold(function(t){return K.error(br(t))},function(t){return K.value(t)})})))}function Yk(t){return P(t.type)&&P(t.name)}function qk(t){return{internalDialog:Do(Eo("dialog",$1,t)),dataValidator:(e=ot(G(Z1(t),Yk),function(e){return Mt.from(tO[e.type]).fold(function(){return[]},function(t){return[Fo(e.name,t)]})}),w(e)),initialData:t.initialData};var e}function Kk(t){var n=[],o={};return gt(t,function(t,e){t.fold(function(){n.push(e)},function(t){o[e]=t})}),0<n.length?K.error(n):K.value(o)}function Jk(t,e){q(t,"height",e+"px"),Hn().browser.isIE()?Le(t,"flex-basis"):q(t,"flex-basis",e+"px")}function $k(t,a,e){Au(t,'[role="dialog"]').each(function(u){Fu(u,'[role="tablist"]').each(function(i){e.get().map(function(t){return q(a,"height","0"),q(a,"flex-basis","0"),Math.min(t,(t=a,o=i,n=ve(e=u).dom,n="fixed"===He(Au(e,".tox-dialog-wrap").getOr(e),"position")?Math.max(n.clientHeight,window.innerHeight):Math.max(n.offsetHeight,n.scrollHeight),r=je(t),t=t.dom.offsetLeft>=o.dom.offsetLeft+qe(o)?Math.max(je(o),r):r,o=parseInt(He(e,"margin-top"),10)||0,r=parseInt(He(e,"margin-bottom"),10)||0,n-(je(e)+o+r-t)));var e,n,o,r}).each(function(t){Jk(a,t)})})})}function Qk(t){return Fu(t,'[role="tabpanel"]')}function Zk(t,e,f,n){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:Bt(Bt({},e.map(function(t){return{id:t}}).getOr({})),n?{"aria-live":"polite"}:{})},components:[],behaviours:Ht([dx(0),xC.config({channel:cO,updateState:function(t,e){return Mt.some({isTabPanel:function(){return"tabpanel"===e.body.type}})},renderComponents:function(t){return"tabpanel"!==t.body.type?[(s=t.body,l=f,{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[(e=Wt(ux.sketch(function(e){return{dom:{tag:"div",classes:["tox-form"].concat(s.classes)},components:F(s.items,function(t){return a0(e,t,l)})}}))).asSpec()]}],behaviours:Ht([$.config({mode:"acyclic",useTabstopAt:h(Kb)}),fx(e),vx(e,{postprocess:function(t){return Kk(t).fold(function(t){return console.error(t),{}},x)}})])})]:[(e=t.body,r=f,a=It({}),c=It(null),e=F(e.tabs,function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:r.shared.providers.translate(t.title)},view:function(){return[ux.sketch(function(e){return{dom:{tag:"div",classes:["tox-form"]},components:F(t.items,function(t){return a0(e,t,r)}),formBehaviours:Ht([$.config({mode:"acyclic",useTabstopAt:h(Kb)}),Lt("TabView.form.events",[uu(o),au(n)]),Za.config({channels:Sr([{key:rO,value:{onReceive:n}},{key:iO,value:{onReceive:o}}])})])}})]}}}),i=e,u=rc(),t={extraEvents:[uu(function(t){var o=t.element;Qk(o).each(function(e){var n;q(e,"visibility","hidden"),t.getSystem().getByDom(e).toOptional().each(function(t){var n,o,r;ft(st((o=e,r=t,F(n=i,function(t,e){Ut.set(r,n[e].view());e=o.dom.getBoundingClientRect();return Ut.set(r,[]),e.height})),function(t,e){return e<t?-1:t<e?1:0})).fold(u.clear,u.set)}),$k(o,e,u),Le(e,"visibility"),n=t,ft(i).each(function(t){return oO.showTab(n,t.value)}),Tm.requestAnimationFrame(function(){$k(o,e,u)})})}),Pt(qi(),function(t){var e=t.element;Qk(e).each(function(t){$k(e,t,u)})}),Pt(pv,function(t,e){var r=t.element;Qk(r).each(function(e){var t=Sa(Ln(e)),n=(q(e,"visibility","hidden"),ze(e,"height").map(function(t){return parseInt(t,10)})),o=(Le(e,"height"),Le(e,"flex-basis"),e.dom.getBoundingClientRect().height);n.forall(function(t){return t<o})?(u.set(o),$k(r,e,u)):n.each(function(t){Jk(e,t)}),Le(e,"visibility"),t.each(xa)})})],selectFirst:!1},oO.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,e,n){e=zt.getValue(e);Vt(t,gv,{name:e,oldName:c.get()}),c.set(e)},tabs:e,components:[oO.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[nO.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:Ht([rv.config({})])}),oO.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:t.selectFirst,tabSectionBehaviours:Ht([Lt("tabpanel",t.extraEvents),$.config({mode:"acyclic"}),J.config({find:function(t){return ft(oO.getViewItems(t))}}),zt.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([rO],{}),a.get()},setValue:function(t,e){a.set(e),t.getSystem().broadcastOn([iO],{})}}})])}))];function n(t){var t=Kk(zt.getValue(t)).getOr({}),e=a.get(),e=sr(e,t);a.set(e)}function o(t){var e=a.get();zt.setValue(t,e)}var r,i,u,a,c,s,l,e},initialData:t})])}}function t1(t,e){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,e]}}function e1(t,e){return T1.parts.close(Em.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":e.translate("Close")}},action:t,buttonBehaviours:Ht([rv.config({})])}))}function n1(){return T1.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})}function o1(t,e){return T1.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:iw("<p>"+e.translate(t)+"</p>")}]}]})}function r1(t){return T1.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})}function i1(t,e){return[ov.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),ov.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:e})]}function u1(e){var t="tox-dialog",n=t+"-wrap",o=n+"__backdrop",r=t+"__disable-scroll";return T1.sketch({lazySink:e.lazySink,onEscape:function(t){return e.onEscape(t),Mt.some(!0)},useTabstopAt:function(t){return!Kb(t)},dom:{tag:"div",classes:[t].concat(e.extraClasses),styles:Bt({position:"relative"},e.extraStyles)},components:M([e.header,e.body],e.footer.toArray(),!0),parts:{blocker:{dom:iw('<div class="'+n+'"></div>'),components:[{dom:{tag:"div",classes:fO?[o,o+"--opaque"]:[o]}}]}},dragBlockClass:n,modalBehaviours:Ht(M([jt.config({}),Lt("dialog-events",e.dialogEvents.concat([zr(Ci(),function(t,e){$.focusIn(t)})])),Lt("scroll-lock",[uu(function(){ti(Un(),r)}),au(function(){ei(Un(),r)})])],e.extraBehaviours,!0)),eventOrder:Bt(((t={})[Hi()]=["dialog-events"],t[Ki()]=["scroll-lock","dialog-events","alloy.base.behaviour"],t[Ji()]=["alloy.base.behaviour","dialog-events","scroll-lock"],t),e.eventOrder)})}function a1(t){return Em.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[Kd("close",{tag:"div",classes:["tox-icon"]},t.icons)],action:function(t){Rt(t,sv)}})}function c1(t,e,n){function o(t){return[ci(n.translate(t.title))]}return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:Bt({},e.map(function(t){return{id:t}}).getOr({}))},components:o(t),behaviours:Ht([xC.config({channel:aO,renderComponents:o})])}}function s1(){return{dom:iw('<div class="tox-dialog__draghandle"></div>')}}function l1(t,e){return t={title:e.shared.providers.translate(t),draggable:e.dialog.isDraggableModal()},e=e.shared.providers,o=T1.parts.title(c1(t,Mt.none(),e)),n=T1.parts.draghandle(s1()),e=T1.parts.close(a1(e)),o=[o].concat(t.draggable?[n]:[]).concat([e]),ov.sketch({dom:iw('<div class="tox-dialog__header"></div>'),components:o});var n,o}function f1(t,e,n){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":n.translate(t)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:e,components:[{dom:iw('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}function d1(t,o,e){return{onClose:function(){return e.closeWindow()},onBlock:function(n){T1.setBusy(t(),function(t,e){return f1(n.message,e,o)})},onUnblock:function(){T1.setIdle(t())}}}function m1(t,e,n,o){return _u(u1(Bt(Bt({},t),{lazySink:o.shared.getSink,extraBehaviours:M([xC.config({channel:uO,updateState:function(t,e){return Mt.some(e)},initialData:e}),yx({})],t.extraBehaviours,!0),onEscape:function(t){Rt(t,sv)},dialogEvents:n,eventOrder:((o={})[Pi()]=[xC.name(),Za.name()],o[Ki()]=["scroll-lock",xC.name(),"messages","dialog-events","alloy.base.behaviour"],o[Ji()]=["alloy.base.behaviour","dialog-events","messages",xC.name(),"scroll-lock"],o)})))}function g1(t){return F(t,function(t){return"menu"===t.type?(n=F((e=t).items,function(t){var e=It(!1);return Bt(Bt({},t),{storage:e})}),Bt(Bt({},e),{items:n})):t;var e,n})}function p1(t){return Z(t,function(t,e){return"menu"!==e.type?t:Z(e.items,function(t,e){return t[e.name]=e.storage,t},t)},{})}function h1(t,n){return[Pr(Ci(),qb),t(cv,function(t,e){n.onClose(),e.onClose()}),t(sv,function(t,e,n,o){e.onCancel(t),Rt(o,cv)}),Pt(mv,function(t,e){return n.onUnblock()}),Pt(dv,function(t,e){return n.onBlock(e.event)})]}function v1(t,e){function n(t,e){return ov.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:F(e,function(t){return t.memento.asSpec()})})}e=j(e.map(function(t){return t.footerButtons}).getOr([]),function(t){return"start"===t.align});return[n("start",e.pass),n("end",e.fail)]}function b1(t,n){return{dom:iw('<div class="tox-dialog__footer"></div>'),components:[],behaviours:Ht([xC.config({channel:sO,initialData:t,updateState:function(t,e){var r=F(e.buttons,function(t){var e=Wt(My(t,t.type,n));return{name:t.name,align:t.align,memento:e}});return Mt.some({lookupByName:function(t,e){return n=t,o=e,tt(r,function(t){return t.name===o}).bind(function(t){return t.memento.getOpt(n)});var n,o},footerButtons:r})},renderComponents:v1})])}}function y1(t,e){return T1.parts.footer(b1(t,e))}function x1(e,n){var o;return e.getRoot().getSystem().isConnected()?(o=J.getCurrent(e.getFormWrapper()).getOr(e.getFormWrapper()),ux.getField(o,n).fold(function(){var t=e.getFooter();return xC.getState(t).get().bind(function(t){return t.lookupByName(o,n)})},function(t){return Mt.some(t)})):Mt.none()}function w1(u,o,a){function t(t){var e=u.getRoot();e.getSystem().isConnected()&&t(e)}var c={getData:function(){var t=u.getRoot(),t=t.getSystem().isConnected()?u.getFormWrapper():t,t=zt.getValue(t),e=pt(a,function(t){return t.get()});return Bt(Bt({},t),e)},setData:function(i){t(function(t){var e,n=c.getData(),o=Bt(Bt({},n),i),n=(e=o,n=u.getRoot(),xC.getState(n).get().map(function(t){return Do(Eo("data",t.dataValidator,e))}).getOr(e)),r=u.getFormWrapper();zt.setValue(r,n),gt(a,function(t,e){ne(o,e)&&t.set(o[e])})})},disable:function(t){x1(u,t).each(Nt.disable)},enable:function(t){x1(u,t).each(Nt.enable)},focus:function(t){x1(u,t).each(jt.focus)},block:function(e){if(!P(e))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t(function(t){Vt(t,dv,{message:e})})},unblock:function(){t(function(t){Rt(t,mv)})},showTab:function(n){t(function(t){var e=u.getBody();xC.getState(e).get().exists(function(t){return t.isTabPanel()})&&J.getCurrent(e).each(function(t){oO.showTab(t,n)})})},redial:function(n){t(function(t){var e=o(n);t.getSystem().broadcastOn([uO],e),t.getSystem().broadcastOn([aO],e.internalDialog),t.getSystem().broadcastOn([cO],e.internalDialog),t.getSystem().broadcastOn([sO],e.internalDialog),c.setData(e.initialData)})},close:function(){t(function(t){Rt(t,cv)})}};return c}function S1(t){return H(t)&&-1!==pO.indexOf(t.mceAction)}function C1(u,t,a,e){var n,o=l1(u.title,e),r=(r={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[Xb({dom:{tag:"iframe",attributes:{src:u.url}},behaviours:Ht([rv.config({}),jt.config({})])})]}],behaviours:Ht([$.config({mode:"acyclic",useTabstopAt:h(Kb)})])},T1.parts.body(r)),i=u.buttons.bind(function(t){return 0===t.length?Mt.none():Mt.some(y1({buttons:t},e))}),t=dO(function(){return g},d1(function(){return m},e.shared.providers,t)),c=Bt(Bt({},u.height.fold(function(){return{}},function(t){return{height:t+"px","max-height":t+"px"}})),u.width.fold(function(){return{}},function(t){return{width:t+"px","max-width":t+"px"}})),s=u.width.isNone()&&u.height.isNone()?["tox-dialog--width-lg"]:[],l=new gO(u.url,{base_uri:new gO(window.location.href)}),f=l.protocol+"://"+l.host+(l.port?":"+l.port:""),d=oc(),m=m1({header:o,body:r,footer:i,extraClasses:s,extraBehaviours:[Lt("messages",[uu(function(){var t=ic(At.fromDom(window),"message",function(t){var e;if(l.isSameOrigin(new gO(t.raw.origin)))if(S1(t=t.raw.data)){var n=a,o=g,r=t;switch(r.mceAction){case"insertContent":n.insertContent(r.content);break;case"setContent":n.setContent(r.content);break;case"execCommand":var i=!!z(r.ui)&&r.ui;n.execCommand(r.cmd,i,r.value);break;case"close":o.close();break;case"block":o.block(r.message);break;case"unblock":o.unblock()}}else!S1(e=t)&&H(e)&&ne(e,"mceAction")&&u.onMessage(g,t)});d.set(t)}),au(d.clear)]),Za.config({channels:((o={})[lO]={onReceive:function(t,e){Fu(t.element,"iframe").each(function(t){t.dom.contentWindow.postMessage(e,f)})}},o)})],extraStyles:c},u,t,e),g={block:function(e){if(!P(e))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");p(function(t){Vt(t,dv,{message:e})})},unblock:function(){p(function(t){Rt(t,mv)})},close:function(){p(function(t){Rt(t,cv)})},sendMessage:function(e){p(function(t){t.getSystem().broadcastOn([lO],e)})}};function p(t){n.getSystem().isConnected()&&t(n)}return{dialog:n=m,instanceApi:g}}function k1(t){function o(t,y,x,w){return eO.open(function(t,e,n){function o(){return p.on(function(t){Om.reposition(t),gS.refresh(t)})}var r,i,u,a,c,s,l,f,d,m,g,e=Do(Eo("data",n,e)),p=rc(),h=S.shared.header.isPositionedAtTop(),v=(n={dataValidator:n,initialData:e,internalDialog:t},i={redial:eO.redial,closeWindow:function(){p.on(Om.hide),C.off("ResizeEditor",o),p.clear(),x(v.instanceApi)}},u=S,t=w,a=O("dialog-label"),b=O("dialog-content"),c=Wt((c={title:n.internalDialog.title,draggable:!0},l=a,f=u.shared.providers,ov.sketch({dom:iw('<div class="tox-dialog__header"></div>'),components:[c1(c,Mt.some(l),f),s1(),a1(f)],containerBehaviours:Ht([Lk.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return Iu(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),s=Wt((l={body:n.internalDialog.body},f=u,t=t,Zk(l,Mt.some(b),f,t))),f=p1(l=g1(n.internalDialog.buttons)),d=Wt(mO({buttons:l},u)),t=O1(function(){return g},{onBlock:function(n){MS.block(m,function(t,e){return f1(n.message,e,u.shared.providers)})},onUnblock:function(){MS.unblock(m)},onClose:function(){return i.closeWindow()}},u.shared.getSink),m=_u({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((l={role:"dialog"})["aria-labelledby"]=a,l["aria-describedby"]=b,l)},eventOrder:((a={})[Pi()]=[xC.name(),Za.name()],a[Hi()]=["execute-on-form"],a[Ki()]=["reflecting","execute-on-form"],a),behaviours:Ht([$.config({mode:"cyclic",onEscape:function(t){return Rt(t,cv),Mt.some(!0)},useTabstopAt:function(t){return!Kb(t)&&("button"!==ie(t)||"disabled"!==Be(t,"disabled"))}}),xC.config({channel:uO,updateState:function(t,e){return Mt.some(e)},initialData:n}),jt.config({}),Lt("execute-on-form",t.concat([zr(Ci(),function(t,e){$.focusIn(t)})])),MS.config({getRoot:function(){return Mt.some(m)}}),Ut.config({}),yx({})]),components:[c.asSpec(),s.asSpec(),d.asSpec()]}),g=w1({getRoot:Dt(m),getFooter:function(){return d.get(m)},getBody:function(){return s.get(m)},getFormWrapper:function(){var t=s.get(m);return J.getCurrent(t).getOr(t)}},i.redial,f),{dialog:m,instanceApi:g}),b=_u(Om.sketch(Bt(Bt({lazySink:S.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},h?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:Ht(M([Lt("window-manager-inline-events",[Pt($i(),function(t,e){Rt(v.dialog,sv)})])],(r=C,k&&h?[]:[gS.config({contextual:{lazyContext:function(){return Mt.some(no(At.fromDom(r.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]),!0)),isExtraPart:function(t,e){return Lh(e=e,".tox-alert-dialog")||Lh(e,".tox-confirm-dialog")}})));return p.set(b),Om.showWithin(b,Tu(v.dialog),{anchor:y},Mt.some(Un())),k&&h||(gS.refresh(b),C.on("ResizeEditor",o)),v.instanceApi.setData(e),$.focusIn(v.dialog),v.instanceApi},t)}var a,c,s,l,S=t.backstage,C=t.editor,k=ap(C),n=(c=(a=t).backstage.shared,{open:function(t,e){function n(){T1.hide(u),e()}var o=Wt(My({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:Mt.none()},"cancel",a.backstage)),r=n1(),i=e1(n,c.providers),u=_u(u1({lazySink:function(){return c.getSink()},header:t1(r,i),body:o1(t,c.providers),footer:Mt.some(r1(i1([],[o.asSpec()]))),onEscape:n,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Pt(sv,n)],eventOrder:{}})),r=(T1.show(u),o.get(u));jt.focus(r)}}),r=(l=(s=t).backstage.shared,{open:function(t,e){function n(t){T1.hide(a),e(t)}var o=Wt(My({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:Mt.none()},"submit",s.backstage)),r=My({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:Mt.none()},"cancel",s.backstage),i=n1(),u=e1(function(){return n(!1)},l.providers),a=_u(u1({lazySink:function(){return l.getSink()},header:t1(i,u),body:o1(t,l.providers),footer:Mt.some(r1(i1([],[r,o.asSpec()]))),onEscape:function(){return n(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Pt(sv,function(){return n(!1)}),Pt(fv,function(){return n(!0)})],eventOrder:{}})),i=(T1.show(a),o.get(a));jt.focus(i)}});return{open:function(t,e,n){return void 0!==e&&"toolbar"===e.inline?o(t,S.shared.anchors.inlineDialog(),n,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?o(t,S.shared.anchors.cursor(),n,e.ariaAttrs):(m=n,eO.open(function(t,e,n){r={redial:eO.redial,closeWindow:function(){T1.hide(d.dialog),m(d.instanceApi)}},t=l1((o={dataValidator:n,initialData:e,internalDialog:t}).internalDialog.title,n=S),i=n,i=Zk({body:o.internalDialog.body},Mt.none(),i,!1),i=T1.parts.body(i),u=p1(a=g1(o.internalDialog.buttons)),a=y1({buttons:a},n),c=O1(function(){return f},d1(function(){return l},n.shared.providers,r),n.shared.getSink),s=function(){switch(o.internalDialog.size){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(),l=m1({header:t,body:i,footer:Mt.some(a),extraClasses:s,extraBehaviours:[],extraStyles:{}},o,c,n),f=w1({getRoot:Dt(l),getBody:function(){return T1.getBody(l)},getFooter:function(){return T1.getFooter(l)},getFormWrapper:function(){var t=T1.getBody(l);return J.getCurrent(t).getOr(t)}},r.redial,u);var o,r,i,u,a,c,s,l,f,d={dialog:l,instanceApi:f};return T1.show(d.dialog),d.instanceApi.setData(e),d.instanceApi},t));var m},openUrl:function(t,e){return n=e,eO.openUrl(function(t){var e=C1(t,{closeWindow:function(){T1.hide(e.dialog),n(e.instanceApi)}},C,S);return T1.show(e.dialog),e.instanceApi},t);var n},alert:function(t,e){n.open(t,function(){e()})},close:function(t){t.close()},confirm:function(t,e){r.open(t,function(t){e(t)})}}}(Gc=Dk=Dk||{})[Gc.None=0]="None",Gc[Gc.Both=1]="Both",Gc[Gc.Vertical=2]="Vertical";function O1(i,t,c){function e(t,r){return Pt(t,function(n,o){var t=n,e=function(t,e){r(i(),t,o.event,n)};xC.getState(t).get().each(function(t){e(t.internalDialog)})})}return M(M([],h1(e,t),!0),[e(fv,function(t,e){e.onSubmit(t)}),e(av,function(t,e,n){e.onChange(t,{name:n.name})}),e(lv,function(t,e,n,o){function r(){return $.focusIn(o)}function i(t){return Ae(t,"disabled")||Me(t,"aria-disabled").exists(function(t){return"true"===t})}var u=Ln(o.element),a=Sa(u);e.onAction(t,{name:n.name,value:n.value}),Sa(u).fold(r,function(e){i(e)||a.exists(function(t){return ge(e,t)&&i(t)})?r():c().toOptional().filter(function(t){return!ge(t.element,e)}).each(r)})}),e(gv,function(t,e,n){e.onTabChange(t,{newTabName:n.name,oldTabName:n.oldName})}),au(function(t){var e=i();zt.setValue(t,e.getData())})],!1)}var _1,im=Dt([y("lazySink"),zo("dragBlockClass"),$o("getBounds",oo),S("useTabstopAt",L),S("eventOrder",{}),Hs("modalBehaviours",[$]),qu("onExecute"),Ju("onEscape")]),cf={sketch:x},fm=Dt([mf({name:"draghandle",overrides:function(t,e){return{behaviours:Ht([Lk.config({mode:"mouse",getTarget:function(t){return Au(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(e,null,2)).message),getBounds:t.getDragBounds})])}}}),df({schema:[y("dom")],name:"title"}),df({factory:cf,schema:[y("dom")],name:"close"}),df({factory:cf,schema:[y("dom")],name:"body"}),mf({factory:cf,schema:[y("dom")],name:"footer"}),af({factory:{sketch:function(t,e){return Bt(Bt({},t),{dom:e.dom,components:e.components})}},schema:[S("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),S("components",[])],name:"blocker"})]),T1=sl({name:"ModalDialog",configFields:im(),partFields:fm(),factory:function(i,t,e,o){var r=rc(),n=O("modal-events"),u=Bt(Bt({},i.eventOrder),((u={})[Ki()]=[n].concat(i.eventOrder["alloy.system.attached"]||[]),u));return{uid:i.uid,dom:i.dom,components:t,apis:{show:function(t){r.set(t);var e=i.lazySink(t).getOrDie(),n=o.blocker(),n=e.getSystem().build(Bt(Bt({},n),{components:n.components.concat([Tu(t)]),behaviours:Ht([jt.config({}),Lt("dialog-blocker-events",[zr(Ci(),function(){$.focusIn(t)})])])}));ws(e,n),$.focusIn(t)},hide:function(e){r.clear(),ye(e.element).each(function(t){e.getSystem().getByDom(t).each(function(t){Cs(t)})})},getBody:function(t){return Zs(t,i,"body")},getFooter:function(t){return Zs(t,i,"footer")},setIdle:function(t){MS.unblock(t)},setBusy:function(t,e){MS.block(t,e)}},eventOrder:u,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Ns(i.modalBehaviours,[Ut.config({}),$.config({mode:"cyclic",onEnter:i.onExecute,onEscape:i.onEscape,useTabstopAt:i.useTabstopAt}),MS.config({getRoot:r.get}),Lt(n,[uu(function(t){var e,n=t.element,o=Zs(t,i,"title").element,r=Me(n,"id").fold(function(){var t=O("dialog-label");return Ft(o,"id",t),t},x);Ft(n,"aria-labelledby",r),n=t.element,e=Zs(t,i,"body").element,r=Mt.from(Be(n,"id")).fold(function(){var t=O("dialog-describe");return Ft(e,"id",t),t},x),Ft(n,"aria-describedby",r)})])])}},apis:{show:function(t,e){t.show(e)},hide:function(t,e){t.hide(e)},getBody:function(t,e){return t.getBody(e)},getFooter:function(t,e){return t.getFooter(e)},setBusy:function(t,e,n){t.setBusy(e,n)},setIdle:function(t,e){t.setIdle(e)}}}),Ka=w([e("type"),e("name")].concat(mu)),mi=pr,cm=[yr("name","name",fo(function(){return O("button-name")}),gr),Wo("icon"),Ko("align","end",["start","end"]),Jo("primary",!1),Jo("disabled",!1)],sf=M(M([],cm,!0),[e("text")],!1),Jc=M([Io("type",["submit","cancel","custom"])],sf,!0),ff=Mo("type",{submit:Jc,cancel:Jc,custom:Jc,menu:M([Io("type",["menu"]),Wo("text"),Wo("tooltip"),Wo("icon"),Ho("items",Ka)],cm,!0)}),um=[e("type"),e("text"),Io("level",["info","warn","error","success"]),e("icon"),S("url","")],E1=w(um),lm=[e("type"),e("text"),Jo("disabled",!1),Jo("primary",!1),yr("name","name",fo(function(){return O("button-name")}),gr),Wo("icon"),Jo("borderless",!1)],D1=w(lm),lf=[e("type"),e("name"),e("label"),Jo("disabled",!1)],B1=w(lf),am=pr,lu=[e("type"),e("name")],sm=lu.concat([Wo("label")]),Aa=sm.concat([S("columns","auto")]),M1=w(Aa),Gc=fr([e("value"),e("text"),e("icon")]),A1=w(sm),cf=gr,F1=w(sm),af=gr,I1=lu.concat([qo("tag","textarea"),e("scriptId"),e("scriptUrl"),Xo("settings",void 0,vr)]),R1=lu.concat([qo("tag","textarea"),Ro("init")]),V1=_o(function(t){return Eo("customeditor.old",wo(R1),t).orThunk(function(){return Eo("customeditor.new",wo(I1),t)})}),im=gr,P1=w(sm),fm=So(En),mu=[e("type"),e("html"),Ko("presets","presentation",["presentation","document"])],H1=w(mu),Jc=sm.concat([Jo("sandboxed",!0)]),z1=w(Jc),Ka=gr,cm=sm.concat([Fo("currentState",w([y("blob"),e("url")]))]),N1=w(cm),um=sm.concat([Wo("inputMode"),Wo("placeholder"),Jo("maximized",!1),Jo("disabled",!1)]),L1=w(um),lm=gr,lf=[e("text"),e("value")],Aa=[e("text"),Ho("items",(_1=ae(function(){return W1}),{extract:function(t,e){return _1().extract(t,e)},toString:function(){return _1().toString()}}))],W1=Co([w(lf),w(Aa)]),vr=sm.concat([Ho("items",W1),Jo("disabled",!1)]),U1=w(vr),lu=gr,En=sm.concat([Po("items",[e("text"),e("value")]),Yo("size",1),Jo("disabled",!1)]),j1=w(En),mu=gr,Jc=sm.concat([Jo("constrain",!0),Jo("disabled",!1)]),G1=w(Jc),cm=w([e("width"),e("height")]),um=[e("type"),Ho("header",gr),Ho("cells",So(gr))],X1=w(um),lf=sm.concat([Wo("placeholder"),Jo("maximized",!1),Jo("disabled",!1)]),Y1=w(lf),Aa=gr,vr=sm.concat([Ko("filetype","file",["image","media","file"]),S("disabled",!1)]),q1=w(vr),En=w([e("value"),S("meta",{})]),K1=xo(function(){return Oo("type",{alertbanner:E1,bar:w((t=Xk("bar"),[e("type"),t])),button:D1,checkbox:B1,colorinput:A1,colorpicker:F1,dropzone:P1,grid:w((t=Xk("grid"),[e("type"),Fo("columns",mr),t])),iframe:z1,input:L1,listbox:U1,selectbox:j1,sizeinput:G1,textarea:Y1,urlinput:q1,customeditor:V1,htmlpanel:H1,imagetools:N1,collection:M1,label:w((t=Xk("label"),[e("type"),e("label"),t])),table:X1,panel:J1});var t}),Jc=[e("type"),S("classes",[]),Ho("items",K1)],J1=w(Jc),um=[yr("name","name",fo(function(){return O("tab-name")}),gr),e("title"),Ho("items",K1)],lf=[e("type"),Po("tabs",um)],sm=w(lf),vr=sf,Jc=ff,$1=w([e("title"),Fo("body",Oo("type",{panel:J1,tabpanel:sm})),qo("size","normal"),Ho("buttons",Jc),S("initialData",{}),$o("onAction",Et),$o("onChange",Et),$o("onSubmit",Et),$o("onClose",Et),$o("onCancel",Et),S("onTabChange",Et)]),um=w(M([Io("type",["cancel","custom"])],vr,!0)),Q1=w([e("title"),e("url"),Lo("height"),Lo("width"),jo("buttons",um),$o("onAction",Et),$o("onCancel",Et),$o("onClose",Et),$o("onMessage",Et)]),Z1=function(t){return H(t)?[t].concat(ot(bt(t),Z1)):c(t)?ot(t,Z1):[]},tO={checkbox:am,colorinput:cf,colorpicker:af,dropzone:fm,input:lm,iframe:Ka,sizeinput:cm,selectbox:mu,listbox:lu,size:cm,textarea:Aa,urlinput:En,customeditor:im,collection:Gc,togglemenuitem:mi},eO={open:function(t,e){e=qk(e);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,e){return t(Do(Eo("dialog",Q1,e)))},redial:qk},lf=cl({name:"TabButton",configFields:[S("uid",void 0),y("value"),yr("dom","dom",po(function(){return{attributes:{role:"tab",id:O("aria"),"aria-selected":"false"}}}),dr()),zo("action"),S("domModification",{}),Hs("tabButtonBehaviours",[jt,$,zt]),y("view")],factory:function(t,e){return{uid:t.uid,dom:t.dom,components:t.components,events:_d(t.action),behaviours:Ns(t.tabButtonBehaviours,[jt.config({}),$.config({mode:"execution",useSpace:!0,useEnter:!0}),zt.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),sf=Dt([y("tabs"),y("dom"),S("clickToDismiss",!1),Hs("tabbarBehaviours",[wf,$]),Xu(["tabClass","selectedClass"])]),ff=Dt([Xc({factory:lf,name:"tabs",unit:"tab",overrides:function(o){return{action:function(t){var e=t.getSystem().getByUid(o.uid).getOrDie(),n=wf.isHighlighted(e,t);(n&&o.clickToDismiss?function(t,e){wf.dehighlight(t,e),Vt(t,eu(),{tabbar:t,button:e})}:n?Et:function(t,e){wf.highlight(t,e),Vt(t,tu(),{tabbar:t,button:e})})(e,t)},domModification:{classes:[o.markers.tabClass]}}}})]),nO=sl({name:"Tabbar",configFields:sf(),partFields:ff(),factory:function(t,e,n,o){return{uid:t.uid,dom:t.dom,components:e,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Ns(t.tabbarBehaviours,[wf.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,e){Ft(e.element,"aria-selected","true")},onDehighlight:function(t,e){Ft(e.element,"aria-selected","false")}}),$.config({mode:"flow",getInitial:function(t){return wf.getHighlighted(t).map(function(t){return t.element})},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),sm=cl({name:"Tabview",configFields:[Hs("tabviewBehaviours",[Ut])],factory:function(t,e){return{uid:t.uid,dom:t.dom,behaviours:Ns(t.tabviewBehaviours,[Ut.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),Jc=Dt([S("selectFirst",!0),t("onChangeTab"),t("onDismissTab"),S("tabs",[]),Hs("tabSectionBehaviours",[])]),vr=Dt([df({factory:nO,schema:[y("dom"),Vo("markers",[y("tabClass"),y("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),df({factory:sm,name:"tabview"})]),oO=sl({name:"TabSection",configFields:Jc(),partFields:vr(),factory:function(r,t,e,n){function o(t,e){Qs(t,r,"tabbar").each(function(t){e(t).each(Dr)})}return{uid:r.uid,dom:r.dom,components:t,behaviours:zs(r.tabSectionBehaviours),events:iu(nt([r.selectFirst?[uu(function(t,e){o(t,wf.getFirst)})]:[],[Pt(tu(),function(t,e){var n=e.event.button,o=zt.getValue(n);Qs(n,r,"tabview").each(function(e){tt(r.tabs,function(t){return t.value===o}).each(function(t){t=t.view();Me(n.element,"id").each(function(t){Ft(e.element,"aria-labelledby",t)}),Ut.set(e,t),r.onChangeTab(e,n,t)})})}),Pt(eu(),function(t,e){e=e.event.button;r.onDismissTab(t,e)})]])),apis:{getViewItems:function(t){return Qs(t,r,"tabview").map(function(t){return Ut.contents(t)}).getOr([])},showTab:function(t,n){o(t,function(e){return tt(wf.getCandidates(e),function(t){return zt.getValue(t)===n}).filter(function(t){return!wf.isHighlighted(e,t)})})}}}},apis:{getViewItems:function(t,e){return t.getViewItems(e)},showTab:function(t,e,n){t.showTab(e,n)}}}),rO="send-data-to-section",iO="send-data-to-view",uO=O("update-dialog"),aO=O("update-title"),cO=O("update-body"),sO=O("update-footer"),lO=O("body-send-message"),fO=Kp.deviceType.isTouch(),dO=function(i,t){function e(t,r){return Pt(t,function(n,o){var t=n,e=function(t,e){r(i(),t,o.event,n)};xC.getState(t).get().each(function(t){e(t)})})}return M(M([],h1(e,t),!0),[e(lv,function(t,e,n){e.onAction(t,{name:n.name})})],!1)},mO=b1,gO=tinymce.util.Tools.resolve("tinymce.util.URI"),pO=["insertContent","setContent","execCommand","close","block","unblock"];f.add("silver",function(t){var e=Gk(t),n=e.uiMothership,o=e.backstage,r=e.renderUI,e=e.getUi;return Zh(t,o.shared),{renderUI:r,getWindowManagerImpl:Dt(k1({editor:t,backstage:o})),getNotificationManagerImpl:function(){return c=t,r=n,s=o.shared,{open:function(t,e){function n(){e(),Om.hide(u)}var o=!t.closeButton&&t.timeout&&(0<t.timeout||t.timeout<0),i=_u(Fm.sketch({text:t.text,level:$t(["success","error","warning","warn","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:Mt.from(t.icon),closeButton:!o,onAction:n,iconProvider:s.providers.icons,translationProvider:s.providers.translate})),u=_u(Om.sketch(Bt({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:s.getSink,fireDismissalEventInstead:{}},s.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));function a(){var t=no(At.fromDom(c.getContentAreaContainer())),e=oo(),n=La(e.x,t.x,t.right),o=La(e.y,t.y,t.bottom),r=Math.max(t.right,e.right),t=Math.max(t.bottom,e.bottom);return Mt.some(eo(n,o,r-n,t-o))}return r.add(u),0<t.timeout&&Tm.setTimeout(function(){n()},t.timeout),{close:n,moveTo:function(t,e){Om.showAt(u,Tu(i),{anchor:{type:"makeshift",x:t,y:e}})},moveRel:function(t,e){var n,o=Tu(i),r={maxHeightFunction:Oc()};"banner"!==e&&_(t)?(n=function(){switch(e){case"bc-bc":return nm;case"tc-tc":return em;case"tc-bc":return Ya;default:return qa}}(),t={type:"node",root:Un(),node:Mt.some(At.fromDom(t)),overrides:r,layouts:{onRtl:function(){return[n]},onLtr:function(){return[n]}}},Om.showWithinBounds(u,o,{anchor:t},a)):(t=Bt(Bt({},s.anchors.banner()),{overrides:r}),Om.showWithinBounds(u,o,{anchor:t},a))},text:function(t){Fm.updateText(i,t)},settings:t,getEl:function(){return i.element.dom},progressBar:{value:function(t){Fm.updateProgress(i,t)}}}},close:function(t){t.close()},reposition:function(n){0<n.length&&Y(n,function(t,e){0===e?t.moveRel(null,"banner"):t.moveRel(n[e-1].getEl(),"bc-tc")})},getArgs:function(t){return t.settings}};var c,r,s},ui:e()}})}();
!function(){"use strict";var D=function(){return(D=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}).apply(this,arguments)};function r(n,e){var t={};for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t}function c(n,e,t){if(t||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||((o=o||Array.prototype.slice.call(e,0,r))[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))}function o(t){return function(n){return e=typeof(n=n),(null===n?"null":"object"==e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e)===t;var e}}function f(e){return function(n){return typeof n===e}}function l(e){return function(n){return e===n}}function I(n){return!(null==n)}function bn(){}function d(t,o){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t(o.apply(null,n))}}function M(n){return function(){return n}}function yn(n){return n}function m(n,e){return n===e}var g=o("string"),p=o("object"),V=o("array"),h=l(null),B=f("boolean"),A=l(void 0),N=f("function"),H=f("number");function Rn(o){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=r.concat(n);return o.apply(null,t)}}function Fn(e){return function(n){return!e(n)}}function P(n){return function(){throw new Error(n)}}function z(n){n()}function j(){return L}var _=M(!1),R=M(!0),L={fold:function(n,e){return n()},isSome:_,isNone:R,getOr:yn,getOrThunk:$,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:M(null),getOrUndefined:M(void 0),or:yn,orThunk:$,map:j,each:bn,bind:j,exists:_,forall:R,filter:function(){return L},toArray:function(){return[]},toString:M("none()")};function $(n){return n()}function G(t){var o,r=!1;return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return r||(r=!0,o=t.apply(null,n)),o}}function U(n,e){return-1<Gn.call(n,e)}function W(n,e){for(var t=0,o=n.length;t<o;t++)if(e(n[t],t))return 1}function xn(n,e){for(var t=n.length,o=new Array(t),r=0;r<t;r++){var i=n[r];o[r]=e(i,r)}return o}function wn(n,e){for(var t=0,o=n.length;t<o;t++)e(n[t],t)}function X(n,e){for(var t=[],o=0,r=n.length;o<r;o++){var i=n[o];e(i,o)&&t.push(i)}return t}function q(n,e,t){for(var o,r=n,i=r.length-1;0<=i;i--)o=r[i],t=e(t,o,i);return t}function Y(n,t,o){return wn(n,function(n,e){o=t(o,n,e)}),o}function K(n,e){for(var t=n,o=e,r=_,i=0,u=t.length;i<u;i++){var c=t[i];if(o(c,i))return On.some(c);if(r(c,i))break}return On.none()}function J(n,e){for(var t=0,o=n.length;t<o;t++)if(e(n[t],t))return On.some(t);return On.none()}function Q(n){for(var e=[],t=0,o=n.length;t<o;++t){if(!V(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);Un.apply(e,n[t])}return e}function Z(n,e){return Q(xn(n,e))}function nn(n,e){for(var t=0,o=n.length;t<o;++t)if(!0!==e(n[t],t))return!1;return!0}function en(n){n=$n.call(n,0);return n.reverse(),n}function tn(n,e){return X(n,function(n){return!U(e,n)})}function on(n){return[n]}function rn(n,e){for(var t=0;t<n.length;t++){var o=e(n[t],t);if(o.isSome())return o}return On.none()}function un(n,e){var t=String(e).toLowerCase();return K(n,function(n){return n.search(t)})}function cn(n,e){return-1!==n.indexOf(e)}function an(e){return function(n){return cn(n,e)}}function sn(n){return window.matchMedia(n).matches}function fn(n){return M("alloy."+n)}function ln(n,e){Fe(n,n.element,e,{})}function dn(n,e,t){Fe(n,n.element,e,t)}function mn(n){ln(n,Se())}function gn(n,e,t){Fe(n,e,t,{})}function pn(n,e){n=n.dom;if(1!==n.nodeType)return!1;if(void 0!==n.matches)return n.matches(e);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(e);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(e);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function hn(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount}function vn(n,e){e=void 0===e?document:e.dom;return hn(e)?[]:xn(e.querySelectorAll(n),kn.fromDom)}function In(n,e){e=void 0===e?document:e.dom;return hn(e)?On.none():On.from(e.querySelector(n)).map(kn.fromDom)}function Sn(n,e){return n.dom===e.dom}function Vn(){return Pn(0,0)}function Bn(n){function e(n){return function(){return t===n}}var t=n.current,n=n.version;return{current:t,version:n,isEdge:e("Edge"),isChrome:e("Chrome"),isIE:e("IE"),isOpera:e("Opera"),isFirefox:e(Yn),isSafari:e("Safari")}}function An(n){function e(n){return function(){return t===n}}var t=n.current,n=n.version;return{current:t,version:n,isWindows:e(Jn),isiOS:e("iOS"),isAndroid:e(Qn),isOSX:e("OSX"),isLinux:e("Linux"),isSolaris:e(Zn),isFreeBSD:e(ne),isChromeOS:e(ee)}}function Nn(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}}function Hn(t){function n(){return r}function e(n){return n(t)}var o=M(t),r={fold:function(n,e){return e(t)},isSome:R,isNone:_,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:n,orThunk:n,map:function(n){return Hn(n(t))},each:function(n){n(t)},bind:e,exists:e,forall:e,filter:function(n){return n(t)?r:L},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return r}function Pn(n,e){return{major:n,minor:e}}function zn(){return Bn({current:void 0,version:Wn.unknown()})}function jn(){return An({current:void 0,version:Wn.unknown()})}var Ln,On={some:Hn,none:j,from:function(n){return null==n?L:Hn(n)}},$n=Array.prototype.slice,Gn=Array.prototype.indexOf,Un=Array.prototype.push,Wn={nu:Pn,detect:function(n,e){var t,o,e=String(e).toLowerCase();return 0===n.length?Vn():(o=function(n,e){for(var t=0;t<n.length;t++){var o=n[t];if(o.test(e))return o}}(n,t=e))?Pn(r(1),r(2)):{major:0,minor:0};function r(n){return Number(t.replace(o,"$"+n))}},unknown:Vn},Xn=(Ln=/^\s+|\s+$/g,function(n){return n.replace(Ln,"")}),n=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,qn={browsers:M([{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return cn(n,"edge/")&&cn(n,"chrome")&&cn(n,"safari")&&cn(n,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,n],search:function(n){return cn(n,"chrome")&&!cn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return cn(n,"msie")||cn(n,"trident")}},{name:"Opera",versionRegexes:[n,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:an("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:an("firefox")},{name:"Safari",versionRegexes:[n,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(cn(n,"safari")||cn(n,"mobile/"))&&cn(n,"applewebkit")}}]),oses:M([{name:"Windows",search:an("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return cn(n,"iphone")||cn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:an("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:an("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:an("linux"),versionRegexes:[]},{name:"Solaris",search:an("sunos"),versionRegexes:[]},{name:"FreeBSD",search:an("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:an("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}])},Yn="Firefox",Kn=Bn,Jn=(M("Edge"),M("Chrome"),M("IE"),M("Opera"),M(Yn),M("Safari"),"Windows"),Qn="Android",Zn="Solaris",ne="FreeBSD",ee="ChromeOS",te=An,oe=(M(Jn),M("iOS"),M(Qn),M("Linux"),M("OSX"),M(Zn),M(ne),M(ee),G(function(){return n=navigator.userAgent,s=On.from(navigator.userAgentData),u=sn,a=qn.browsers(),f=qn.oses(),{browser:s=s.bind(function(n){return o=a,rn(n.brands,function(e){var t=e.brand.toLowerCase();return K(o,function(n){return t===(null==(n=n.brand)?void 0:n.toLowerCase())}).map(function(n){return{current:n.name,version:Wn.nu(parseInt(e.version,10),0)}})});var o}).orThunk(function(){return un(a,t=n).map(function(n){var e=Wn.detect(n.versionRegexes,t);return{current:n.name,version:e}});var t}).fold(zn,Kn),os:f=un(f,t=n).map(function(n){var e=Wn.detect(n.versionRegexes,t);return{current:n.name,version:e}}).fold(jn,te),deviceType:(s=s,e=n,u=u,o=(f=f).isiOS()&&!0===/ipad/i.test(e),r=f.isiOS()&&!o,i=(c=f.isiOS()||f.isAndroid())||u("(pointer:coarse)"),u=o||!r&&c&&u("(min-device-width:768px)"),c=r||c&&!u,s=s.isSafari()&&f.isiOS()&&!1===/safari/i.test(e),{isiPad:M(o),isiPhone:M(r),isTablet:M(u),isPhone:M(c),isTouch:M(i),isAndroid:f.isAndroid,isiOS:f.isiOS,isWebView:M(s),isDesktop:M(!c&&!u&&!s)})};var n,t,e,o,r,i,u,c,a,s,f})),n=M,re=n("touchstart"),ie=n("touchmove"),ue=n("touchend"),ce=n("mousedown"),ae=n("mousemove"),se=n("mouseup"),fe=n("mouseover"),le=n("keydown"),de=n("keyup"),me=n("input"),ge=n("change"),pe=n("click"),he=n("transitionend"),ve=n("selectstart"),n={tap:fn("tap")},be=fn("focus"),ye=fn("blur.post"),xe=fn("paste.post"),we=fn("receive"),Se=fn("execute"),Oe=fn("focus.item"),ke=n.tap,Te=fn("longpress"),Ce=fn("system.init"),Ee=fn("system.attached"),De=fn("system.detached"),Me=fn("focusmanager.shifted"),_e=fn("highlight"),Re=fn("dehighlight"),Fe=function(n,e,t,o){o=D({target:e},o);n.getSystem().triggerEvent(t,e,o)},kn={fromHtml:function(n,e){e=(e||document).createElement("div");if(e.innerHTML=n,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Nn(e.childNodes[0])},fromTag:function(n,e){return Nn((e||document).createElement(n))},fromText:function(n,e){return Nn((e||document).createTextNode(n))},fromDom:Nn,fromPoint:function(n,e,t){return On.from(n.dom.elementFromPoint(e,t)).map(Nn)}};function Ie(n){return n.dom.nodeName.toLowerCase()}function Ve(e){return function(n){return n.dom.nodeType===e}}function Be(n){return kn.fromDom(n.dom.ownerDocument)}function Ae(n){return pt(n)?n:Be(n)}function Ne(n){return On.from(n.dom.parentNode).map(kn.fromDom)}function He(n,e){n=n.dom.childNodes;return On.from(n[e]).map(kn.fromDom)}function Pe(e,t){Ne(e).each(function(n){n.dom.insertBefore(t.dom,e.dom)})}function ze(e,t){He(e,0).fold(function(){bt(e,t)},function(n){e.dom.insertBefore(t.dom,n.dom)})}function je(e,n){wn(n,function(n){bt(e,n)})}function Le(n){n.dom.textContent="",wn(vt(n),function(n){yt(n)})}function $e(n){return ht(n)&&I(n.dom.host)}function Ge(n){return kn.fromDom(n.dom.host)}function Ue(){return st(kn.fromDom(document))}function We(n,e){bt(n.element,e.element)}function Xe(e){var n,t=Ne(e.element).bind(function(n){return e.getSystem().getByDom(n).toOptional()});Ot(n=e),yt(n.element),n.getSystem().removeFromWorld(n),t.each(function(n){n.syncComponents()})}function qe(n,e){for(var t=Ct(n),o=0,r=t.length;o<r;o++){var i=t[o];e(n[i],i)}}function Ye(n,t){return Dt(n,function(n,e){return{k:e,v:t(n,e)}})}function Ke(n,t){var o=[];return qe(n,function(n,e){o.push(t(n,e))}),o}function v(n,e){return Mt(n,e)?On.from(n[e]):On.none()}function Je(n,e){return Mt(n,e)&&void 0!==n[e]&&null!==n[e]}function Qe(n,e,t){if(!(g(t)||B(t)||H(t)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")}function Tn(n,e,t){Qe(n.dom,e,t)}function Ze(n,e){var t=n.dom;qe(e,function(n,e){Qe(t,e,n)})}function Cn(n,e){n=n.dom.getAttribute(e);return null===n?void 0:n}function nt(n,e){return On.from(Cn(n,e))}function et(n,e){n=n.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(e)}function tt(n,e){n.dom.removeAttribute(e)}function ot(n,e){n=Cn(n,e);return void 0===n||""===n?[]:n.split(" ")}function rt(n){return void 0!==n.dom.classList}function it(n,e){rt(n)?n.dom.classList.add(e):(e=e,e=ot(n=n,"class").concat([e]),Tn(n,"class",e.join(" ")))}function ut(n,e){var t,o;rt(n)?n.dom.classList.remove(e):(t=e,0<(o=X(ot(e=n,"class"),function(n){return n!==t})).length?Tn(e,"class",o.join(" ")):tt(e,"class")),0===(rt(o=n)?o.dom.classList:ot(o,"class")).length&&tt(o,"class")}function ct(n,e){return rt(n)&&n.dom.classList.contains(e)}function at(n,e,t){ut(n,t),it(n,e)}"undefined"==typeof window&&Function("return this;")();function st(n){if(null==(n=n.dom.body))throw new Error("Body is not available yet");return kn.fromDom(n)}function ft(t){return{isValue:R,isError:_,getOr:M(t),getOrThunk:M(t),getOrDie:M(t),or:function(n){return ft(t)},orThunk:function(n){return ft(t)},fold:function(n,e){return e(t)},map:function(n){return ft(n(t))},mapError:function(n){return ft(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return On.some(t)}}}function lt(t){return{isValue:_,isError:R,getOr:yn,getOrThunk:function(n){return n()},getOrDie:function(){return P(String(t))()},or:yn,orThunk:function(n){return n()},fold:function(n,e){return n(t)},map:function(n){return lt(t)},mapError:function(n){return lt(n(t))},each:bn,bind:function(n){return lt(t)},exists:_,forall:R,toOptional:On.none}}var dt,mt=Ve(1),gt=Ve(3),pt=Ve(9),ht=Ve(11),vt=function(n){return xn(n.dom.childNodes,kn.fromDom)},bt=function(n,e){n.dom.appendChild(e.dom)},yt=function(n){n=n.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},n=N(Element.prototype.attachShadow)&&N(Node.prototype.getRootNode),xt=M(n),wt=n?function(n){return kn.fromDom(n.dom.getRootNode())}:Ae,St=function(n){var e,t,o,r=gt(n)?n.dom.parentNode:n.dom;return null!=r&&null!==r.ownerDocument&&(o=r.ownerDocument,n=kn.fromDom(r),($e(n=wt(n))?On.some(n):On.none()).fold(function(){return o.body.contains(r)},(e=St,t=Ge,function(n){return e(t(n))})))},Ot=function(n){ln(n,De()),wn(n.components(),Ot)},kt=function(n){wn(n.components(),kt),ln(n,Ee())},Tt=function(n,e,t){n.getSystem().addToWorld(e),t(n.element,e.element),St(n.element)&&kt(e),n.syncComponents()},Ct=Object.keys,Et=Object.hasOwnProperty,Dt=function(n,t){var o={};return qe(n,function(n,e){n=t(n,e);o[n.k]=n.v}),o},Mt=function(n,e){return Et.call(n,e)},n=Object.freeze({__proto__:null,toAlpha:function(n,e,t){at(n.element,e.alpha,e.omega)},toOmega:function(n,e,t){at(n.element,e.omega,e.alpha)},isAlpha:function(n,e,t){return ct(n.element,e.alpha)},isOmega:function(n,e,t){return ct(n.element,e.omega)},clear:function(n,e,t){ut(n.element,e.alpha),ut(n.element,e.omega)}}),F={value:ft,error:lt,fromOption:function(n,e){return n.fold(function(){return lt(e)},ft)}};function _t(n,e,t){return n.stype===dt.Error?e(n.serror):t(n.svalue)}function Rt(n){return{stype:dt.Value,svalue:n}}function Ft(n){return{stype:dt.Error,serror:n}}function It(n,e,t,o){return{tag:"field",key:n,newKey:e,presence:t,prop:o}}function Vt(n,e,t){switch(n.tag){case"field":return e(n.key,n.newKey,n.presence,n.prop);case"custom":return t(n.newKey,n.instantiator)}}function Bt(u){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var t={},o=0;o<n.length;o++){var r,i=n[o];for(r in i)Mt(i,r)&&(t[r]=u(t[r],i[r]))}return t}}function At(){return{tag:"required",process:{}}}function Nt(n){return{tag:"defaultedThunk",process:n}}function Ht(n){return Nt(M(n))}function Pt(){return{tag:"option",process:{}}}function zt(n){return{tag:"mergeWithThunk",process:n}}function jt(n){return p(n)&&100<Ct(n).length?" removed due to size":JSON.stringify(n,null,2)}function Lt(n,e){return go([{path:n,getErrorInfo:e}])}function $t(t){return{extract:function(e,n){return uo(t(n),function(n){return Lt(e,M(n))})},toString:M("val")}}function Gt(n,e,t,o){return o(v(n,e).getOrThunk(function(){return t(n)}))}function Ut(n){var a=wo(n),s=q(n,function(t,n){return Vt(n,function(n){var e;return vo(t,((e={})[n]=!0,e))},M(t))},{});return{extract:function(n,e){var t,o,r,i,u,c=X(B(e)?[]:Ct((o=I,r=c={},i=function(n,e){r[e]=n},u=bn,qe(e,function(n,e){(o(n,e)?i:u)(n,e)}),c)),function(n){return!Je(s,n)});return 0===c.length?a.extract(n,e):(t=c,Lt(n,function(){return"There are unsupported fields: ["+t.join(", ")+"] specified"}))},toString:a.toString}}function Wt(e){return $t(function(n){return e(n).fold(go,mo)})}function Xt(e,n){return i=function(n){return e(n).fold(Ft,Rt)},u=n,{extract:function(e,t){var o,r,n=Ct(t),n=(r=$t(i),o=e,n=xn(n,function(n,e){return r.extract(o.concat(["["+e+"]"]),n)}),yo(n));return po(n,function(n){n=xn(n,function(n){return It(n,n,At(),u)});return wo(n).extract(e,t)})},toString:function(){return"setOf("+u.toString()+")"}};var i,u}function qt(n,e,t){return io((e=e.extract([n],o=t),ao(e,function(n){return{input:o,errors:n}})));var o}function Yt(n){return n.fold(function(n){throw new Error(so(n))},yn)}function Kt(n,e,t){return Yt(qt(n,e,t))}function Jt(n,e){return t=n,c=Ye(e,wo),{extract:function(i,u){return v(u,t).fold(function(){return n=t,Lt(i,function(){return'Choice schema did not contain choice key: "'+n+'"'});var n},function(n){return t=i,e=u,v(o=c,r=n).fold(function(){return n=o,e=r,Lt(t,function(){return'The chosen schema: "'+e+'" did not exist in branches: '+jt(n)});var n,e},function(n){return n.extract(t.concat(["branch: "+r]),e)});var t,e,o,r})},toString:function(){return"chooseOn("+t+"). Possible values: "+Ct(c)}};var t,c}function b(n){return Oo(n,n,At(),So())}function Qt(n,e){return Oo(n,n,At(),e)}function Zt(n,e){return Oo(n,n,At(),wo(e))}function i(n){return Oo(n,n,Pt(),So())}function no(n,e){return Oo(n,n,Pt(),e)}function eo(n,e){return no(n,wo(e))}function to(n,e){return no(n,Ut(e))}function y(n,e){return Oo(n,n,Ht(e),So())}function oo(n,e,t){return Oo(n,n,Ht(e),t)}function ro(u){if(!V(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var c=[],t={};return wn(u,function(n,o){var e=Ct(n);if(1!==e.length)throw new Error("one and only one name per case");var r=e[0],i=n[r];if(void 0!==t[r])throw new Error("duplicate key detected:"+r);if("cata"===r)throw new Error("cannot have a case named cata (sorry)");if(!V(i))throw new Error("case arguments must be an array");c.push(r),t[r]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=t.length;if(e!==i.length)throw new Error("Wrong number of arguments to case "+r+". Expected "+i.length+" ("+i+"), got "+e);return{fold:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(n.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+n.length);return n[o].apply(null,t)},match:function(n){var e=Ct(n);if(c.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+e.join(","));if(nn(c,function(n){return U(e,n)}))return n[r].apply(null,t);throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+c.join(", "))},log:function(n){console.log(n,{constructors:c,constructor:r,params:t})}}}}),t}function io(n){return _t(n,F.error,F.value)}dt={Error:0,0:"Error",Value:1,1:"Value"};function uo(n,e){return n.stype===dt.Error?e(n.serror):n}function co(n,e){return n.stype===dt.Value?{stype:dt.Value,svalue:e(n.svalue)}:n}function ao(n,e){return n.stype===dt.Error?{stype:dt.Error,serror:e(n.serror)}:n}function so(n){return"Errors: \n"+xn(10<(e=n.errors).length?e.slice(0,10).concat([{path:[],getErrorInfo:M("... (only showing first ten failures)")}]):e,function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()}).join("\n")+"\n\nInput object: "+jt(n.input);var e}function fo(n,e){return{tag:"custom",newKey:n,instantiator:e}}var lo,mo=Rt,go=Ft,po=function(n,e){return n.stype===dt.Value?e(n.svalue):n},ho=_t,vo=Bt(function(n,e){return p(n)&&p(e)?vo(n,e):e}),bo=Bt(function(n,e){return e}),yo=function(n){e=[],t=[],wn(n,function(n){_t(n,function(n){return t.push(n)},function(n){return e.push(n)})});var e,t,n={values:e,errors:t};return 0<n.errors.length?d(go,Q)(n.errors):mo(n.values)},xo=$t(mo),wo=function(t){return{extract:function(r,i){for(var u={},c=[],n=0,e=t;n<e.length;n++)Vt(e[n],function(n,e,t,o){t=function(e,t,o,r,i){function u(n){return i.extract(t.concat([r]),n)}function n(n){return n.fold(function(){return mo(On.none())},function(n){n=i.extract(t.concat([r]),n);return co(n,On.some)})}var c,a,s,f,l,d;switch(e.tag){case"required":return s=t,d=u,v(f=o,l=r).fold(function(){return n=l,e=f,Lt(s,function(){return'Could not find valid *required* value for "'+n+'" in '+jt(e)});var n,e},d);case"defaultedThunk":return Gt(o,r,e.process,u);case"option":return n(v(o,r));case"defaultedOptionThunk":return a=e.process,n(v(c=o,r).map(function(n){return!0===n?a(c):n}));case"mergeWithThunk":return Gt(o,r,M({}),function(n){return u(vo(e.process(o),n))})}}(t,r,i,n,o);ho(t,function(n){c.push.apply(c,n)},function(n){u[e]=n})},function(n,e){u[n]=e(i)});return 0<c.length?go(c):mo(u)},toString:function(){return"obj{\n"+xn(t,function(n){return Vt(n,function(n,e,t,o){return n+" -> "+o.toString()},function(n,e){return"state("+n+")"})}).join("\n")+"}"}}},So=M(xo),xo=(lo=N,$t(function(n){var e=typeof n;return lo(n)?mo(n):go("Expected type: function but got: "+e)})),Oo=It,ko=[b("alpha"),b("omega")];function To(n,e){return(t={})[n]=e,t;var t}function Co(n){return e={},wn(n,function(n){e[n.key]=n.value}),e;var e}function Eo(n,e,t){return void 0===t&&(t=m),n.exists(function(n){return t(n,e)})}function Do(n){for(var e=[],t=function(n){e.push(n)},o=0;o<n.length;o++)n[o].each(t);return e}function Mo(n){return N(n)?n:_}function _o(n,e){return Sn(n.element,e.event.target)}function Ro(n){if(Je(n,"can")||Je(n,"abort")||Je(n,"run"))return D(D({},Qo),n);throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!")}function Fo(n,e){return{key:n,value:Ro({abort:e})}}function w(n,e){return{key:n,value:Ro({run:e})}}function Io(n,t,o){return{key:n,value:Ro({run:function(n,e){t.apply(void 0,[n,e].concat(o))}})}}function Vo(n){return function(t){return{key:n,value:Ro({run:function(n,e){_o(n,e)&&t(n,e)}})}}}function Bo(n,e,t){var i,o=e.partUids[t];return w(i=n,function(n,r){n.getSystem().getByUid(o).each(function(n){var e=n.element,t=i,o=r;n.getSystem().triggerEvent(t,e,o.event)})})}function Ao(n){return w(n,function(n,e){e.cut()})}function No(n,e){var t=n.toString(),o=t.indexOf(")")+1,r=t.indexOf("("),i=t.substring(r+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:e,parameters:tr(i)}},n}function Ho(n){return{classes:A(n.classes)?[]:n.classes,attributes:A(n.attributes)?{}:n.attributes,styles:A(n.styles)?{}:n.styles}}function Po(t,o,r){return er(function(n,e){r(n,t,o)})}function zo(n){return{key:n,value:void 0}}function jo(n){var n=Kt("Creating behaviour: "+n.name,ir,n),e=n.fields,t=n.name,o=n.active,r=n.apis,i=n.extra,n=n.state,u=Ut(e),e=eo(t,[to("config",e)]);return Yo(u,e,t,o,r,i,n)}function En(n){var e=n;return{get:function(){return e},set:function(n){e=n}}}function Lo(n){n.dom.focus()}function $o(n){return n.dom.blur()}function Go(n){return void 0===n&&(n=kn.fromDom(document)),On.from(n.dom.activeElement).map(kn.fromDom)}function Uo(e){return Go(wt(e)).filter(function(n){return e.dom.contains(n.dom)})}function Wo(n){return n.dom.innerHTML}function Xo(n){var e;return $e(n)?"#shadow-root":(n=kn.fromDom(n.dom.cloneNode(!1)),e=kn.fromTag("div"),n=kn.fromDom(n.dom.cloneNode(!0)),bt(e,n),Wo(e))}ro([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);function qo(n){return w(Ko,n)}function Yo(t,n,s,r,e,o,i){function u(n){return Je(n,s)?n[s]():On.none()}var e=Ye(e,function(n,e){return r=s,t=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var o=[t].concat(n);return t.config({name:M(r)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+r+". Using API: "+u)},function(n){var e=Array.prototype.slice.call(o,1);return i.apply(void 0,[t,n.config,n.state].concat(e))})},o=u=e,n=(e=(i=n).toString()).indexOf(")")+1,c=e.indexOf("("),a=e.substring(c+1,n-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:o,parameters:tr(a.slice(0,1).concat(a.slice(3)))}},t;var r,i,u,t,o,c,a}),o=Ye(o,No),c=D(D(D({},o),e),{revoke:Rn(zo,s),config:function(n){var e=Kt(s+"-config",t,n);return{key:s,value:{config:e,me:c,configAsRaw:G(function(){return Kt(s+"-config",t,n)}),initialConfig:n,state:i}}},schema:M(n),exhibit:function(n,t){return n=u(n),e=v(r,"exhibit"),o=function(n,e){return e(t,n.config,n.state)},(n.isSome()&&e.isSome()?On.some(o(n.getOrDie(),e.getOrDie())):On.none()).getOrThunk(function(){return Ho({})});var e,o},name:M(s),handlers:function(n){return u(n).map(function(n){return v(r,"events").getOr(function(){return{}})(n.config,n.state)}).getOr({})}});return c}var Ko,Jo,Qo={can:R,abort:_,run:bn},S=Co,Zo=Vo(Ee()),nr=Vo(De()),er=Vo(Ce()),tr=(Ko=Se(),function(n){return xn(n,function(n){return e=n.length-"/*".length,n.length>="/*".length&&"/*"===n.substr(e,e+"/*".length)?n.substring(0,n.length-"/*".length):n;var e})}),or={init:function(){return rr({readState:M("No State required")})}},rr=function(n){return n},O=Co,ir=Ut([b("fields"),b("name"),y("active",{}),y("apis",{}),y("state",or),y("extra",{})]),ur=Ut([b("branchKey"),b("branches"),b("name"),y("active",{}),y("apis",{}),y("state",or),y("extra",{})]),cr=M(void 0),ar=jo({fields:ko,name:"swapping",apis:n}),sr=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),ko=tinymce.util.Tools.resolve("tinymce.ThemeManager"),fr=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],lr=["undo","bold","italic","link","image","bullist","styleselect"],dr="formatChanged",mr="orientationChanged",gr="dropupDismissed",n=Object.freeze({__proto__:null,events:function(u){return S([w(we(),function(o,n){var e,r=u.channels,t=Ct(r),i=n;wn((e=i).universal?t:X(t,function(n){return U(e.channels,n)}),function(n){var e=r[n],t=e.schema,n=Kt("channel["+n+"] data\nReceiver: "+Xo(o.element),t,i.data);e.onReceive(o,n)})})])}}),pr="unknown";function hr(e,n,t){var o,r,i,u;switch(v(vr.get(),e).orThunk(function(){return rn(Ct(vr.get()),function(n){return-1<e.indexOf(n)?On.some(vr.get()[n]):On.none()})}).getOr(Jo.NORMAL)){case Jo.NORMAL:return t(yr());case Jo.LOGGING:o=e,r=n,i=[],u=(new Date).getTime();var c={logEventCut:function(n,e,t){i.push({outcome:"cut",target:e,purpose:t})},logEventStopped:function(n,e,t){i.push({outcome:"stopped",target:e,purpose:t})},logNoParent:function(n,e,t){i.push({outcome:"no-parent",target:e,purpose:t})},logEventNoHandlers:function(n,e){i.push({outcome:"no-handlers-left",target:e})},logEventResponse:function(n,e,t){i.push({outcome:"response",purpose:t,target:e})},write:function(){var n=(new Date).getTime();U(["mousemove","mouseover","mouseout",Ce()],o)||console.log(o,{event:o,time:n-u,target:r.dom,sequence:xn(i,function(n){return U(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+Xo(n.target)+")":n.outcome})})}},a=t(c);return c.write(),a;case Jo.STOP:return!0}}Jo={STOP:0,0:"STOP",NORMAL:1,1:"NORMAL",LOGGING:2,2:"LOGGING"};var vr=En({}),br=["alloy/data/Fields","alloy/debugging/Debugging"],yr=M({logEventCut:bn,logEventStopped:bn,logNoParent:bn,logEventNoHandlers:bn,logEventResponse:bn,write:bn}),xr=M([b("menu"),b("selectedMenu")]),wr=M([b("item"),b("selectedItem")]);function Sr(n,e,t){return void 0!==(o=new Error).stack&&K(o.stack.split("\n"),function(e){return 0<e.indexOf("alloy")&&!W(br,function(n){return-1<e.indexOf(n)})}).getOr(pr),Oo(e,e,t,Wt(function(t){return F.value(function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)})}));var o}function Or(n){return Sr(0,n,Ht(bn))}function kr(n){return Sr(0,n,Ht(On.none))}function Tr(n){return Sr(0,n,At())}function Cr(n){return Sr(0,n,At())}function u(n,e){return fo(n,M(e))}function Er(n){return fo(n,yn)}function Dr(n,e,t){e=e.aria;e.update(n,e,t.get())}function Mr(e,n,t){n.toggleClass.each(function(n){(t.get()?it:ut)(e.element,n)})}function _r(n,e,t){Yr(n,e,t,!t.get())}function Rr(n,e,t){t.set(!0),Mr(n,e,t),Dr(n,e,t)}function Fr(n,e,t){t.set(!1),Mr(n,e,t),Dr(n,e,t)}function Ir(n,e,t){Yr(n,e,t,e.selected)}function Vr(t,o){return Zr.config({channels:To(dr,{onReceive:function(n,e){e.command===t&&o(n,e.state)}})})}function Br(n){return Zr.config({channels:To(mr,{onReceive:n})})}function Ar(n,e){return{key:n,value:{onReceive:e}}}function Nr(){function n(n,e){e.stop(),mn(n)}return[w(pe(),n),w(ke(),n),Ao(re()),Ao(ce())]}function Hr(n,e){e.ignore||(Lo(n.element),e.onFocus(n))}function Pr(n){return void 0!==n.style&&N(n.style.getPropertyValue)}function zr(n,e,t){if(!g(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);Pr(n)&&n.style.setProperty(e,t)}function Dn(n,e,t){zr(n.dom,e,t)}function jr(n,e){var t=n.dom;qe(e,function(n,e){zr(t,e,n)})}function Lr(n,e){var t=n.dom,o=window.getComputedStyle(t).getPropertyValue(e);return""!==o||St(n)?o:oi(t,e)}function $r(n,e){n=n.dom,n=oi(n,e);return On.from(n).filter(function(n){return 0<n.length})}function Gr(n,e){var t;Pr(t=n.dom)&&t.style.removeProperty(e),Eo(nt(n,"style").map(Xn),"")&&tt(n,"style")}function Ur(n){n.dom.offsetWidth}function Wr(t,o){function n(n){var e=o(n);return e<=0||null===e?(n=Lr(n,t),parseFloat(n)||0):e}function r(t,n){return Y(n,function(n,e){e=Lr(t,e),e=void 0===e?0:parseInt(e,10);return isNaN(e)?n:n+e},0)}return{set:function(n,e){if(!H(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);n=n.dom;Pr(n)&&(n.style[t]=e+"px")},get:n,getOuter:n,aggregate:r,max:function(n,e,t){n=r(n,t);return n<e?e-n:0}}}function Xr(n){return ri.get(n)}function qr(n,e){return vn(e,n)}function Yr(n,e,t,o){(o?Rr:Fr)(n,e,t)}function Kr(n,e,t){Tn(n.element,"aria-expanded",t)}M(wo(wr().concat(xr())));var Jr=M(wo(wr())),Qr=M(Zt("initSize",[b("numColumns"),b("numRows")])),Zr=jo({fields:[Qt("channels",Xt(F.value,Ut([Tr("onReceive"),y("schema",So())])))],name:"receiving",active:n}),n=Object.freeze({__proto__:null,onLoad:Ir,toggle:_r,isOn:function(n,e,t){return t.get()},on:Rr,off:Fr,set:Yr}),ni=Object.freeze({__proto__:null,exhibit:function(){return Ho({})},events:function(n,e){t=n,o=e,r=_r;var t,o,r,i=qo(function(n){r(n,t,o)}),e=Po(n,e,Ir);return S(Q([n.toggleOnExecute?[i]:[],[e]]))}}),k=jo({fields:[y("selected",!1),i("toggleClass"),y("toggleOnExecute",!0),oo("aria",{mode:"none"},Jt("mode",{pressed:[y("syncWithExpanded",!1),u("update",function(n,e,t){Tn(n.element,"aria-pressed",t),e.syncWithExpanded&&Kr(n,0,t)})],checked:[u("update",function(n,e,t){Tn(n.element,"aria-checked",t)})],expanded:[u("update",Kr)],selected:[u("update",function(n,e,t){Tn(n.element,"aria-selected",t)})],none:[u("update",bn)]}))],name:"toggling",active:ni,apis:n,state:{init:function(){var e=En(!1);return{get:function(){return e.get()},set:function(n){return e.set(n)},clear:function(){return e.set(!1)},readState:function(){return e.get()}}}}}),ei="tinymce-mobile",Mn=function(n){return ei+"-"+n},ni=Object.freeze({__proto__:null,focus:Hr,blur:function(n,e){e.ignore||$o(n.element)},isFocused:function(n){return n=n.element,e=wt(n).dom,n.dom===e.activeElement;var e}}),n=Object.freeze({__proto__:null,exhibit:function(n,e){return Ho(e.ignore?{}:{attributes:{tabindex:"-1"}})},events:function(t){return S([w(be(),function(n,e){Hr(n,t),e.stop()})].concat(t.stopMousedown?[w(ce(),function(n,e){e.event.prevent()})]:[]))}}),ti=jo({fields:[Or("onFocus"),y("stopMousedown",!1),y("ignore",!1)],name:"focusing",active:n,apis:ni}),oi=function(n,e){return Pr(n)?n.style.getPropertyValue(e):""},ri=Wr("height",function(n){var e=n.dom;return St(n)?e.getBoundingClientRect().height:e.offsetHeight});function ii(n,e,t,o,r){return n(t,o)?On.some(t):N(r)&&r(t)?On.none():e(t,o,r)}function ui(n,e,t){for(var o=n.dom,r=N(t)?t:_;o.parentNode;){var o=o.parentNode,i=kn.fromDom(o);if(e(i))return On.some(i);if(r(i))break}return On.none()}function ci(n,e,t){return ui(n,function(n){return pn(n,e)},t)}function ai(n,e){return In(e,n)}function si(n,e,t){return ii(pn,ci,n,e,t)}function fi(n,e,t){var o=en(n.slice(0,e)),n=en(n.slice(e+1));return K(o.concat(n),t)}function li(n,e,t){return K(en(n.slice(0,e)),t)}function di(n,e,t){var o=n.slice(0,e);return K(n.slice(e+1).concat(o),t)}function mi(n,e,t){return K(n.slice(e+1),t)}function s(e){return function(n){n=n.raw;return U(e,n.which)}}function gi(n){return function(e){return nn(n,function(n){return n(e)})}}function pi(n){return!0===n.raw.shiftKey}function hi(n){return!0===n.raw.ctrlKey}function a(n,e){return{matches:n,classification:e}}function vi(n,e,t,o){n+=e;return o<n?t:n<t?o:n}function bi(n,e,t){return Math.min(Math.max(n,e),t)}function yi(t,o,n,r){wn(qr(t.element,"."+o.highlightClass),function(e){W(r,function(n){return n.element===e})||(ut(e,o.highlightClass),t.getSystem().getByDom(e).each(function(n){o.onDehighlight(t,n),ln(n,Re())}))})}function xi(n,e,t,o){yi(n,e,0,[o]),ki(0,e,0,o)||(it(o.element,e.highlightClass),e.onHighlight(n,o),ln(o,_e()))}function wi(e,t,n,o){var r=qr(e.element,"."+t.itemClass);return J(r,function(n){return ct(n,t.highlightClass)}).bind(function(n){n=vi(n,o,0,r.length-1);return e.getSystem().getByDom(r[n]).toOptional()})}function Si(n,e,t){e.exists(function(e){return t.exists(function(n){return Sn(n,e)})})||dn(n,Me(),{prevFocus:e,newFocus:t})}function Oi(){function o(n){return Uo(n.element)}return{get:o,set:function(n,e){var t=o(n);n.getSystem().triggerFocus(e,n.element),Si(n,t,o(n))}}}function ki(n,e,t,o){return ct(o.element,e.highlightClass)}function Ti(e,n,t){return ai(e.element,"."+n.itemClass).bind(function(n){return e.getSystem().getByDom(n).toOptional()})}function Ci(e,n,t){n=qr(e.element,"."+n.itemClass);return(0<n.length?On.some(n[n.length-1]):On.none()).bind(function(n){return e.getSystem().getByDom(n).toOptional()})}function Ei(e,n,t){return Do(xn(qr(e.element,"."+n.itemClass),function(n){return e.getSystem().getByDom(n).toOptional()}))}var Di,Mi=[8],_i=[9],Ri=[13],Fi=[27],Ii=[32],Vi=[37],Bi=[38],Ai=[39],Ni=[40],Hi=Fn(pi),n=Object.freeze({__proto__:null,dehighlightAll:function(n,e,t){return yi(n,e,0,[])},dehighlight:function(n,e,t,o){ki(0,e,0,o)&&(ut(o.element,e.highlightClass),e.onDehighlight(n,o),ln(o,Re()))},highlight:xi,highlightFirst:function(e,t,n){Ti(e,t).each(function(n){xi(e,t,0,n)})},highlightLast:function(e,t,n){Ci(e,t).each(function(n){xi(e,t,0,n)})},highlightAt:function(e,t,n,o){var r=o,i=qr((o=e).element,"."+t.itemClass);On.from(i[r]).fold(function(){return F.error(new Error("No element found with index "+r))},o.getSystem().getByDom).fold(function(n){throw n},function(n){xi(e,t,0,n)})},highlightBy:function(e,t,n,o){K(Ei(e,t),o).each(function(n){xi(e,t,0,n)})},isHighlighted:ki,getHighlighted:function(e,n,t){return ai(e.element,"."+n.highlightClass).bind(function(n){return e.getSystem().getByDom(n).toOptional()})},getFirst:Ti,getLast:Ci,getPrevious:function(n,e,t){return wi(n,e,0,-1)},getNext:function(n,e,t){return wi(n,e,0,1)},getCandidates:Ei}),x=jo({fields:[b("highlightClass"),b("itemClass"),Or("onHighlight"),Or("onDehighlight")],name:"highlighting",apis:n});function Pi(n,e,t,o,c){function a(e,t,n,o,r){var n=n(e,t,o,r),i=t.event;return K(n,function(n){return n.matches(i)}).map(function(n){return n.classification}).bind(function(n){return n(e,t,o,r)})}var r={schema:function(){return n.concat([y("focusManager",Oi()),oo("focusInside","onFocus",Wt(function(n){return U(["onFocus","onEnterOrSpace","onApi"],n)?F.value(n):F.error("Invalid value for focusInside")})),u("handler",r),u("state",e),u("sendFocusIn",c)])},processKey:a,toEvents:function(i,u){var n=i.focusInside!==Di.OnFocusMode?On.none():c(i).map(function(t){return w(be(),function(n,e){t(n,i,u),e.stop()})}),e=[w(le(),function(o,r){a(o,r,t,i,u).fold(function(){var e=o,t=r,n=s(Ii.concat(Ri))(t.event);i.focusInside===Di.OnEnterOrSpaceMode&&n&&_o(e,t)&&c(i).each(function(n){n(e,i,u),t.stop()})},function(n){r.stop()})}),w(de(),function(n,e){a(n,e,o,i,u).each(function(n){e.stop()})})];return S(n.toArray().concat(e))}};return r}function zi(n){function c(n,e){return 0<Xr(n.visibilitySelector.bind(function(n){return si(e,n)}).getOr(e))}function e(e,t,n){var o=t,r=X(qr(e.element,o.selector),function(n){return c(o,n)});On.from(r[o.firstTabstop]).each(function(n){t.focusManager.set(e,n)})}function o(o,n,r,i){var e,u=qr(o.element,r.selector);return(e=r).focusManager.get(o).bind(function(n){return si(n,e.selector)}).bind(function(n){return J(u,Rn(Sn,n)).bind(function(n){return e=o,t=r,i(u,n,function(n){return c(e=t,n=n)&&e.useTabstopAt(n);var e}).fold(function(){return t.cyclic?On.some(!0):On.none()},function(n){return t.focusManager.set(e,n),On.some(!0)});var e,t})})}var n=[i("onEscape"),i("onEnter"),y("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),y("firstTabstop",0),y("useTabstopAt",R),i("visibilitySelector")].concat([n]),t=M([a(gi([pi,s(_i)]),function(n,e,t){return o(n,0,t,t.cyclic?fi:li)}),a(s(_i),function(n,e,t){return o(n,0,t,t.cyclic?di:mi)}),a(s(Fi),function(e,t,n){return n.onEscape.bind(function(n){return n(e,t)})}),a(gi([Hi,s(Ri)]),function(e,t,n){return n.onEnter.bind(function(n){return n(e,t)})})]),r=M([]);return Pi(n,or.init,t,r,function(){return On.some(e)})}function ji(n){return"input"===Ie(n)&&"radio"!==Cn(n,"type")||"textarea"===Ie(n)}function Li(n,e,t){return ji(t)&&s(Ii)(e.event)?On.none():(gn(n,t,Se()),On.some(!0))}function $i(n,e){return On.some(!0)}function Gi(n,e,t){return t.execute(n,e,n.element)}function Ui(n){function e(){t.get().each(n)}var t=En(On.none());return{clear:function(){e(),t.set(On.none())},isSet:function(){return t.get().isSome()},get:function(){return t.get()},set:function(n){e(),t.set(On.some(n))}}}function Wi(){var e=Ui(function(n){return n.destroy()});return D(D({},e),{run:function(n){return e.get().each(n)}})}function Xi(){var e=Ui(bn);return D(D({},e),{on:function(n){return e.get().each(n)}})}function qi(){var t=Xi();return rr({readState:function(){return t.get().map(function(n){return{numRows:String(n.numRows),numColumns:String(n.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set({numRows:n,numColumns:e})},getNumRows:function(){return t.get().map(function(n){return n.numRows})},getNumColumns:function(){return t.get().map(function(n){return n.numColumns})}})}function Yi(e,t){return function(n){return"rtl"===Bu(n)?t:e}}function Ki(i){return function(n,e,t,o){var r=i(n.element);return Au(r,n,e,t,o)}}function Ji(n,e){return Ki(Yi(n,e))}function Qi(n,e){return Ki(Yi(e,n))}function Zi(r){return function(n,e,t,o){return Au(r,n,e,t,o)}}function nu(n){return!((n=n.dom).offsetWidth<=0&&n.offsetHeight<=0)}function eu(n,e,t){var o,n=X(qr(n,t),nu);return J(o=n,function(n){return Sn(n,e)}).map(function(n){return{index:n,candidates:o}})}function tu(n,e){return J(n,function(n){return Sn(e,n)})}function ou(e,n,t,o){return o(Math.floor(n/t),n%t).bind(function(n){n=n.row*t+n.column;return 0<=n&&n<e.length?On.some(e[n]):On.none()})}function ru(o,n,r,i,u){return ou(o,n,i,function(n,e){var t=n===r-1?o.length-n*i:i,e=vi(e,u,0,t-1);return On.some({row:n,column:e})})}function iu(t,n,o,r,i){return ou(t,n,r,function(n,e){n=vi(n,i,0,o-1),e=bi(e,0,(n===o-1?t.length-n*r:r)-1);return On.some({row:n,column:e})})}function uu(e,t,n){ai(e.element,t.selector).each(function(n){t.focusManager.set(e,n)})}function cu(r){return function(n,e,t,o){return eu(n,e,t.selector).bind(function(n){return r(n.candidates,n.index,o.getNumRows().getOr(t.initSize.numRows),o.getNumColumns().getOr(t.initSize.numColumns))})}}function au(n,e,t){return t.captureTab?On.some(!0):On.none()}function su(n,e,t,r){function i(n,e,t){var o;return(e=vi(e,r,0,t.length-1))===n?On.none():"button"===Ie(o=t[e])&&"disabled"===Cn(o,"disabled")?i(n,e,t):On.from(t[e])}return eu(n,t,e).bind(function(n){var e=n.index,n=n.candidates;return i(e,e,n)})}function fu(e,t,o){return(r=o).focusManager.get(e).bind(function(n){return si(n,r.selector)}).bind(function(n){return o.execute(e,t,n)});var r}function lu(e,t,n){t.getInitial(e).orThunk(function(){return ai(e.element,t.selector)}).each(function(n){t.focusManager.set(e,n)})}function du(n,e,t){return su(n,t.selector,e,-1)}function mu(n,e,t){return su(n,t.selector,e,1)}function gu(r){return function(n,e,t,o){return r(n,e,t,o).bind(function(){return t.executeOnMove?fu(n,e,t):On.some(!0)})}}function pu(n,e,t){return t.onEscape(n,e)}function hu(n,e,t){return On.from(n[e]).bind(function(n){return On.from(n[t]).map(function(n){return{rowIndex:e,columnIndex:t,cell:n}})})}function vu(n,e,t,o){return hu(n,e,vi(t,o,0,n[e].length-1))}function bu(n,e,t,o){t=vi(t,o,0,n.length-1);return hu(n,t,bi(e,0,n[t].length-1))}function yu(n,e,t,o){return hu(n,e,bi(t+o,0,n[e].length-1))}function xu(n,e,t,o){t=bi(t+o,0,n.length-1);return hu(n,t,bi(e,0,n[t].length-1))}function wu(e,t,n){t.previousSelector(e).orThunk(function(){var n=t.selectors;return ai(e.element,n.cell)}).each(function(n){t.focusManager.set(e,n)})}function Su(n,o){return function(e,t,i){var u=i.cycles?n:o;return si(t,i.selectors.row).bind(function(n){return tu(qr(n,i.selectors.cell),t).bind(function(o){var r=qr(e,i.selectors.row);return tu(r,n).bind(function(n){e=i;var e,t=xn(r,function(n){return qr(n,e.selectors.cell)});return u(t,n,o).map(function(n){return n.cell})})})})}}function Ou(e,t,o){return o.focusManager.get(e).bind(function(n){return o.execute(e,t,n)})}function ku(e,t,n){ai(e.element,t.selector).each(function(n){t.focusManager.set(e,n)})}function Tu(n,e,t){return su(n,t.selector,e,-1)}function Cu(n,e,t){return su(n,t.selector,e,1)}function Eu(o,n){return e=o,t={},n=xn(n,function(n){return e=n.name(),t="Cannot configure "+n.name()+" for "+o,Oo(e,e,Pt(),$t(function(n){return go("The field: "+e+" is forbidden. "+t)}));var e,t}).concat([fo("dump",yn)]),oo(e,t,wo(n));var e,t}function Du(n,e){return D(D({},O(e)),n.dump)}function Mu(n){return Mt(n,"uiType")}function _u(n){var e=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++Qu+String(e)}function Ru(n){function e(n){return n.name}return n.fold(e,e,e,e)}function Fu(e,t){return function(n){n=Kt("Converting part type",t,n);return e(n)}}(ni=Di=Di||{}).OnFocusMode="onFocus",ni.OnEnterOrSpaceMode="onEnterOrSpace",ni.OnApiMode="onApi";var n=zi(fo("cyclic",_)),ni=zi(fo("cyclic",R)),Iu=Pi([y("execute",Li),y("useSpace",!1),y("useEnter",!0),y("useControlEnter",!1),y("useDown",!1)],or.init,function(n,e,t,o){var n=t.useSpace&&!ji(n.element)?Ii:[],r=t.useEnter?Ri:[],i=t.useDown?Ni:[];return[a(s(n.concat(r).concat(i)),Gi)].concat(t.useControlEnter?[a(gi([hi,s(Ri)]),Gi)]:[])},function(n,e,t,o){return t.useSpace&&!ji(n.element)?[a(s(Ii),$i)]:[]},function(){return On.none()}),Vu=Object.freeze({__proto__:null,flatgrid:qi,init:function(n){return n.state(n)}}),Bu=function(n){return"rtl"===Lr(n,"direction")?"rtl":"ltr"},Au=function(e,t,n,o,r){return o.focusManager.get(t).bind(function(n){return e(t.element,n,o,r)}).map(function(n){return o.focusManager.set(t,n),!0})},Nu=Zi,Hu=Zi,Pu=Zi,zu=cu(function(n,e,t,o){return ru(n,e,t,o,-1)}),e=cu(function(n,e,t,o){return ru(n,e,t,o,1)}),t=cu(function(n,e,t,o){return iu(n,e,t,o,-1)}),ju=cu(function(n,e,t,o){return iu(n,e,t,o,1)}),zu=Pi([b("selector"),y("execute",Li),kr("onEscape"),y("captureTab",!1),Qr()],qi,M([a(s(Vi),Ji(zu,e)),a(s(Ai),Qi(zu,e)),a(s(Bi),Nu(t)),a(s(Ni),Hu(ju)),a(gi([pi,s(_i)]),au),a(gi([Hi,s(_i)]),au),a(s(Fi),function(n,e,t){return t.onEscape(n,e)}),a(s(Ii.concat(Ri)),function(e,t,o,n){return(r=o).focusManager.get(e).bind(function(n){return si(n,r.selector)}).bind(function(n){return o.execute(e,t,n)});var r})]),M([a(s(Ii),$i)]),function(){return On.some(uu)}),e=[b("selector"),y("getInitial",On.none),y("execute",Li),kr("onEscape"),y("executeOnMove",!1),y("allowVertical",!0)],t=M([a(s(Ii),$i)]),ju=Pi(e,or.init,function(n,e,t,o){var r=Vi.concat(t.allowVertical?Bi:[]),t=Ai.concat(t.allowVertical?Ni:[]);return[a(s(r),gu(Ji(du,mu))),a(s(t),gu(Qi(du,mu))),a(s(Ri),fu),a(s(Ii),fu),a(s(Fi),pu)]},t,function(){return On.some(lu)}),e=[Zt("selectors",[b("row"),b("cell")]),y("cycles",!0),y("previousSelector",On.none),y("execute",Li)],t=Su(function(n,e,t){return vu(n,e,t,-1)},function(n,e,t){return yu(n,e,t,-1)}),Lu=Su(function(n,e,t){return vu(n,e,t,1)},function(n,e,t){return yu(n,e,t,1)}),$u=Su(function(n,e,t){return bu(n,t,e,-1)},function(n,e,t){return xu(n,t,e,-1)}),Gu=Su(function(n,e,t){return bu(n,t,e,1)},function(n,e,t){return xu(n,t,e,1)}),t=M([a(s(Vi),Ji(t,Lu)),a(s(Ai),Qi(t,Lu)),a(s(Bi),Nu($u)),a(s(Ni),Hu(Gu)),a(s(Ii.concat(Ri)),function(e,t,o){return Uo(e.element).bind(function(n){return o.execute(e,t,n)})})]),Lu=M([a(s(Ii),$i)]),Nu=Pi(e,or.init,t,Lu,function(){return On.some(wu)}),$u=[b("selector"),y("execute",Li),y("moveOnTab",!1)],Hu=M([a(s(Bi),Pu(Tu)),a(s(Ni),Pu(Cu)),a(gi([pi,s(_i)]),function(n,e,t,o){return t.moveOnTab?Pu(Tu)(n,e,t,o):On.none()}),a(gi([Hi,s(_i)]),function(n,e,t,o){return t.moveOnTab?Pu(Cu)(n,e,t,o):On.none()}),a(s(Ri),Ou),a(s(Ii),Ou)]),Gu=M([a(s(Ii),$i)]),e=Pi($u,or.init,Hu,Gu,function(){return On.some(ku)}),t=Pi([kr("onSpace"),kr("onEnter"),kr("onShiftEnter"),kr("onLeft"),kr("onRight"),kr("onTab"),kr("onShiftTab"),kr("onUp"),kr("onDown"),kr("onEscape"),y("stopSpaceKeyup",!1),i("focusIn")],or.init,function(n,e,t){return[a(s(Ii),t.onSpace),a(gi([Hi,s(Ri)]),t.onEnter),a(gi([pi,s(Ri)]),t.onShiftEnter),a(gi([pi,s(_i)]),t.onShiftTab),a(gi([Hi,s(_i)]),t.onTab),a(s(Bi),t.onUp),a(s(Ni),t.onDown),a(s(Vi),t.onLeft),a(s(Ai),t.onRight),a(s(Ii),t.onSpace),a(s(Fi),t.onEscape)]},function(n,e,t){return t.stopSpaceKeyup?[a(s(Ii),$i)]:[]},function(n){return n.focusIn}),Lu=n.schema(),$u=ni.schema(),Hu=ju.schema(),Gu=zu.schema(),n=Nu.schema(),ni=Iu.schema(),ju=e.schema(),zu=t.schema(),T=(e=Jt((Iu=Kt("Creating behaviour: "+(Nu={branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Lu,cyclic:$u,flow:Hu,flatgrid:Gu,matrix:n,execution:ni,menu:ju,special:zu}),name:"keying",active:{events:function(n,e){return n.handler.toEvents(n,e)}},apis:{focusIn:function(e,t,o){t.sendFocusIn(t).fold(function(){e.getSystem().triggerFocus(e.element,e.element)},function(n){n(e,t,o)})},setGridSize:function(n,e,t,o,r){Je(t,"setGridSize")?t.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:Vu}).name,ur,Nu)).branchKey,Iu.branches),t=Iu.name,Lu=Iu.active,$u=Iu.apis,Hu=Iu.extra,Gu=Iu.state,ni=eo(t,[no("config",n=e)]),Yo(n,ni,t,Lu,$u,Hu,Gu)),ju=Eu,Uu=Du,Wu="placeholder",Xu=ro([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),qu=function(o,r,i,u){return n=o,t=u,(Mu(e=i)&&e.uiType===Wu?(a=e,s=t,(c=n).exists(function(n){return n!==a.owner})?Xu.single(!0,M(a)):v(s,a.name).fold(function(){throw new Error("Unknown placeholder component: "+a.name+"\nKnown: ["+Ct(s)+"]\nNamespace: "+c.getOr("none")+"\nSpec: "+JSON.stringify(a,null,2))},function(n){return n.replace()})):Xu.single(!1,M(e))).fold(function(n,e){var e=Mu(i)?e(r,i.config,i.validated):e(r),t=Z(v(e,"components").getOr([]),function(n){return qu(o,r,n,u)});return[D(D({},e),{components:t})]},function(n,e){var t;return Mu(i)?(t=e(r,i.config,i.validated),i.validated.preprocess.getOr(yn)(t)):e(r)});var n,e,t,c,a,s},Yu=Xu.single,Ku=Xu.multiple,Ju=M(Wu),Qu=0,zu=ro([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Vu=y("factory",{sketch:yn}),ur=y("schema",[]),Nu=b("name"),Iu=Oo("pname","pname",Nt(function(n){return"<alloy."+_u(n.name)+">"}),So()),e=fo("schema",function(){return[i("preprocess")]}),n=y("defaults",M({})),ni=y("overrides",M({})),t=wo([Vu,ur,Nu,Iu,n,ni]),Lu=wo([Vu,ur,Nu,n,ni]),$u=wo([Vu,ur,Nu,Iu,n,ni]),Hu=wo([Vu,e,Nu,b("unit"),Iu,n,ni]),Zu=Fu(zu.required,t);function nc(n,e,t,o){return vo(e.defaults(n,t,o),t,{uid:n.partUids[e.name]},e.overrides(n,t,o))}function ec(n,e,t){return o=e,r={},i={},wn(t,function(n){n.fold(function(o){r[o.pname]=Yu(!0,function(n,e,t){return o.factory.sketch(nc(n,o,e,t))})},function(n){var e=o.parts[n.name];i[n.name]=M(n.factory.sketch(nc(o,n,e[Da()]),e))},function(o){r[o.pname]=Yu(!1,function(n,e,t){return o.factory.sketch(nc(n,o,e,t))})},function(o){r[o.pname]=Ku(!0,function(e,n,t){return xn(e[o.name],function(n){return o.factory.sketch(vo(o.defaults(e,n,t),n,o.overrides(e,n)))})})})}),{internals:M(r),externals:M(i)};var o,r,i}function tc(n,e,t){return o=On.some(n),n=(r=e).components,e=Ye(t,function(n,e){return o=n,r=!1,{name:M(t=e),required:function(){return o.fold(function(n,e){return n},function(n,e){return n})},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+t);return r=!0,o}};var t,o,r}),i=o,u=r,c=e,t=Z(n,function(n){return qu(i,u,n,c)}),qe(e,function(n){if(!1===n.used()&&n.required())throw new Error("Placeholder: "+n.name()+" was not found in components list\nNamespace: "+o.getOr("none")+"\nComponents: "+JSON.stringify(r.components,null,2))}),t;var o,r,i,u,c}function oc(n,e,t){e=e.partUids[t];return n.getSystem().getByUid(e).toOptional()}function rc(n,e,t){return oc(n,e,t).getOrDie("Could not find part: "+t)}function ic(t){return Oo("partUids","partUids",zt(function(n){return e=n.uid,n=xn(t,Ru),Co(xn(n,function(n){return{key:n,value:e+"-"+n}}));var e}),So())}function uc(n){return To(Ma,n)}function cc(o){return n=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return o.apply(void 0,c([n.getApis(),n],e,!1))},t=(e=o.toString()).indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,t-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:tr(i.slice(1))}},n;var n,e,t,r,i}function ac(n){n=mt(n)?n.dom[Ra]:null;return On.from(n)}function sc(n,e,t,o,r){return Kt(n+" [SpecSchema]",Ut((n=r,(0<o.length?[Zt("parts",o)]:[]).concat([b("uid"),y("dom",{}),y("components",[]),Er("originalSpec"),y("debug.sketcher",{})]).concat(n).concat(e))),t)}function fc(n,e,t,o,r){r=Ia(r),e=sc(n,e,r,Z(t,function(n){return n.fold(On.none,On.some,On.none,On.none).map(function(n){return Zt(n.name,n.schema.concat([Er(Da())]))}).toArray()}),[ic(t)]),t=ec(0,e,t);return o(e,tc(n,e,t.internals()),r,t.externals())}function lc(n){var o=Kt("Sketcher for "+n.name,Va,n),n=Ye(o.apis,cc),e=Ye(o.extraApis,No);return D(D({name:o.name,configFields:o.configFields,sketch:function(n){return t=o.name,e=o.configFields,(0,o.factory)(sc(t,e,t=Ia(n),[],[]),t);var e,t}},n),e)}function dc(n){var r,i,e=Kt("Sketcher for "+n.name,Ba,n),n=(r=e.name,n=e.partFields,i={},wn(n,function(n){n.fold(On.some,On.none,On.some,On.some).each(function(t){n=r,e=t.pname;var n,e,o={uiType:Ju(),owner:n,name:e};i[t.name]=function(n){var e=Kt("Part: "+t.name+" in "+r,wo(t.schema),n);return D(D({},o),{config:n,validated:e})}})}),i),t=Ye(e.apis,cc),o=Ye(e.extraApis,No);return D(D({name:e.name,partFields:e.partFields,configFields:e.configFields,sketch:function(n){return fc(e.name,e.configFields,e.partFields,e.factory,n)},parts:n},t),o)}function C(n){o={prefix:ei};var o,n=n.replace(/\$\{([^{}]*)\}/g,function(n,e){var t,e=o[e];return"string"==(t=typeof e)||"number"==t?e.toString():n}),n=kn.fromHtml(n),e=vt(n),t=Y(void 0!==n.dom.attributes?n.dom.attributes:[],function(n,e){return"class"===e.name?n:D(D({},n),((n={})[e.name]=e.value,n))},{}),r=Array.prototype.slice.call(n.dom.classList,0),e=0===e.length?{}:{innerHtml:Wo(n)};return D({tag:Ie(n),classes:r,attributes:t},e)}function mc(n){return{dom:C(n)}}function gc(n){return O([k.config({toggleClass:Mn("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),Vr(n,function(n,e){(e?k.on:k.off)(n)})])}function pc(n,e,t,o){t=gc(t);return Ha(e,o,t,n)}function hc(n,e){e=e.ui.registry.getAll().icons;return On.from(e[n]).fold(function(){return C('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-'+n+' ${prefix}-icon"></span>')},function(n){return C('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item">'+n+"</span>")})}function vc(e){return Ea({name:e+"-edge",overrides:function(n){return n.model.manager.edgeActions[e].fold(function(){return{}},function(o){return{events:S([Io(re(),function(n,e,t){return o(n,t)},[n]),Io(ce(),function(n,e,t){return o(n,t)},[n]),Io(ae(),function(n,e,t){t.mouseIsDown.get()&&o(n,t)},[n])])}})}})}function bc(n,e,t){e.store.manager.onLoad(n,e,t)}function yc(n,e,t){e.store.manager.onUnload(n,e,t)}function xc(){var n=En(null);return rr({set:n.set,get:n.get,isNotSet:function(){return null===n.get()},clear:function(){n.set(null)},readState:function(){return{mode:"memory",value:n.get()}}})}function wc(){var i=En({}),u=En({});return rr({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(n){return v(i.get(),n).orThunk(function(){return v(u.get(),n)})},update:function(n){var e=i.get(),t=u.get(),o={},r={};wn(n,function(e){v(o[e.value]=e,"meta").each(function(n){v(n,"text").each(function(n){r[n]=e})})}),i.set(D(D({},e),o)),u.set(D(D({},t),r))},clear:function(){i.set({}),u.set({})}})}function Sc(n,e,t,o){var r=e.store;t.update([o]),r.setValue(n,o),e.onSetValue(n,o)}function Oc(n,e){Pa.set(n,e)}function kc(n){return Pa.get(n)}function Tc(n){n=n.event.raw;return-1===n.type.indexOf("touch")?void 0!==n.clientX?On.some(n).map(function(n){return za(n.clientX,n.clientY)}):On.none():void 0!==n.touches&&1===n.touches.length?On.some(n.touches[0]).map(function(n){return za(n.clientX,n.clientY)}):On.none()}function Cc(n){return n.model.minX}function Ec(n){return n.model.minY}function Dc(n){return n.model.minX-1}function Mc(n){return n.model.minY-1}function _c(n){return n.model.maxX}function Rc(n){return n.model.maxY}function Fc(n){return n.model.maxX+1}function Ic(n){return n.model.maxY+1}function Vc(n,e,t){return e(n)-t(n)}function Bc(n){return Vc(n,_c,Cc)}function Ac(n){return Vc(n,Rc,Ec)}function Nc(n){return Bc(n)/2}function Hc(n){return Ac(n)/2}function Pc(n){return n.stepSize}function zc(n){return n.snapToGrid}function jc(n){return n.snapStart}function Lc(n){return n.rounded}function $c(n,e){return void 0!==n[e+"-edge"]}function Gc(n){return $c(n,"left")}function Uc(n){return $c(n,"right")}function Wc(n){return $c(n,"top")}function Xc(n){return $c(n,"bottom")}function qc(n){return n.model.value.get()}function Yc(n,e){return{x:n,y:e}}function Kc(n,e){dn(n,ja(),{value:e})}function Jc(n,e,t,o){return n<e?n:t<n?t:n===e?e-1:Math.max(e,n-o)}function Qc(n,e,t,o){return t<n?n:n<e?e:n===t?t+1:Math.min(t,n+o)}function Zc(n,e,t){return Math.max(e,Math.min(t,n))}function na(n){var r,e,i,u,t=n.min,o=n.max,c=n.range,a=n.value,s=n.step,f=n.snap,l=n.snapStart,d=n.rounded,m=n.hasMinEdge,g=n.hasMaxEdge,p=n.minBound,h=n.maxBound,n=n.screenRange,m=m?t-1:t,g=g?o+1:o;return a<p?m:h<a?g:(h=Zc((p=p,(Math.min(h,Math.max(a,p))-p)/n*c+t),m,g),f&&t<=h&&h<=o?(r=h,e=t,i=o,u=s,l.fold(function(){var n=Math.round((r-e)/u)*u;return Zc(e+n,e-1,i+1)},function(n){var e=Math.round((r-n)%u/u),t=Math.floor((r-n)/u),o=Math.floor((i-n)/u),o=Math.min(o,t+e);return Math.max(n,n+o*u)})):d?Math.round(h):h)}function ea(n){var e=n.min,t=n.max,o=n.range,r=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,c=n.maxBound,a=n.maxOffset,s=n.centerMinEdge,n=n.centerMaxEdge;return r<e?i?0:s:t<r?u?c:n:(r-e)/o*a}function ta(n){return n.element.dom.getBoundingClientRect()}function oa(n){return ta(n)[La]}function ra(n){return ta(n).right}function ia(n){return ta(n).top}function ua(n){return ta(n).bottom}function ca(n){return ta(n).width}function aa(n){return ta(n).height}function sa(n,e){n=ta(n),e=ta(e);return(n[La]+n.right)/2-e[La]}function fa(n,e){n=ta(n),e=ta(e);return(n.top+n.bottom)/2-e.top}function la(n,e){dn(n,ja(),{value:e})}function da(n,e,t){return na({min:Cc(e),max:_c(e),range:Bc(e),value:t,step:Pc(e),snap:zc(e),snapStart:jc(e),rounded:Lc(e),hasMinEdge:Gc(e),hasMaxEdge:Uc(e),minBound:oa(n),maxBound:ra(n),screenRange:ca(n)})}function ma(t){return function(n,e){return la(n,{x:e=(0<t?Qc:Jc)(qc(n=e).x,Cc(n),_c(n),Pc(n))}),On.some(e).map(R)}}function ga(n,e,t,o,r,i){i=i,t=t,o=o,r=r,c=ca(u=e),o=o.bind(function(n){return On.some(sa(n,u))}).getOr(0),r=r.bind(function(n){return On.some(sa(n,u))}).getOr(c);var u,c,t=ea({min:Cc(i),max:_c(i),range:Bc(i),value:t,hasMinEdge:Gc(i),hasMaxEdge:Uc(i),minBound:oa(u),minOffset:0,maxBound:ra(u),maxOffset:c,centerMinEdge:o,centerMaxEdge:r});return oa(e)-oa(n)+t}function pa(n,e){dn(n,ja(),{value:e})}function ha(n,e,t){return na({min:Ec(e),max:Rc(e),range:Ac(e),value:t,step:Pc(e),snap:zc(e),snapStart:jc(e),rounded:Lc(e),hasMinEdge:Wc(e),hasMaxEdge:Xc(e),minBound:ia(n),maxBound:ua(n),screenRange:aa(n)})}function va(t){return function(n,e){return pa(n,{y:e=(0<t?Qc:Jc)(qc(n=e).y,Ec(n),Rc(n),Pc(n))}),On.some(e).map(R)}}function ba(n,e,t,o,r,i){i=i,t=t,o=o,r=r,c=aa(u=e),o=o.bind(function(n){return On.some(fa(n,u))}).getOr(0),r=r.bind(function(n){return On.some(fa(n,u))}).getOr(c);var u,c,t=ea({min:Ec(i),max:Rc(i),range:Ac(i),value:t,hasMinEdge:Wc(i),hasMaxEdge:Xc(i),minBound:ia(u),minOffset:0,maxBound:ua(u),maxOffset:c,centerMinEdge:o,centerMaxEdge:r});return ia(e)-ia(n)+t}function ya(n,e){dn(n,ja(),{value:e})}function xa(n,e){return{x:n,y:e}}function wa(r,i){return function(n,e){return e=e,t=0<r?Qc:Jc,ya(n,xa(o=(n=i)?qc(e).x:t(qc(e).x,Cc(e),_c(e),Pc(e)),n?t(qc(e).y,Ec(e),Rc(e),Pc(e)):qc(e).y)),On.some(o).map(R);var t,o}}function Sa(e,t,o,n){return Ha(t,function(){var n=o();e.setContextToolbar([{label:t+" group",items:n}])},{},n)}function Oa(n){var e,t=n.selection.getStart(),t=kn.fromDom(t),o=kn.fromDom(n.getBody()),r=(e=function(n){return Sn(o,n)},(mt(n=t)?On.some(n):Ne(n).filter(mt)).map(function(n){return ii(function(n,e){return e(n)},ui,n,function(n){return $r(n,"font-size").isSome()},e).bind(function(n){return $r(n,"font-size")}).getOrThunk(function(){return Lr(n,"font-size")})}).getOr(""));return K(Ua,function(n){return r===n}).getOr("medium")}function ka(n){var e=void 0!==n.uid&&Je(n,"uid")?n.uid:Fa("memento");return{get:function(n){return n.getSystem().getByUid(e).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(e).toOptional()},asSpec:function(){return D(D({},n),{uid:e})}}}Fu(zu.external,Lu);function Ta(n,e){Object.defineProperty(n.dom,Ra,{value:e,writable:!0})}function Ca(t,o){return{left:t,top:o,translate:function(n,e){return Ca(t+n,o+e)}}}var Ea=Fu(zu.optional,$u),Gu=Fu(zu.group,Hu),Da=M("entirety"),Ma=_u("alloy-premade"),ur=M("alloy-id-"),Vu=M("data-alloy-id"),_a=ur(),Ra=Vu(),Fa=_u,Ia=function(n){return Mt(n,"uid")?n:D(D({},n),{uid:Fa("uid")})},Va=Ut([b("name"),b("factory"),b("configFields"),y("apis",{}),y("extraApis",{})]),Ba=Ut([b("name"),b("factory"),b("configFields"),b("partFields"),y("apis",{}),y("extraApis",{})]),Aa=lc({name:"Button",factory:function(n){function e(e){return v(n.dom,"attributes").bind(function(n){return v(n,e)})}t=n.action;var t=S(Q([t.map(function(t){return qo(function(n,e){t(n),e.stop()})}).toArray(),Nr()])),o=n.dom.tag;return{uid:n.uid,dom:n.dom,components:n.components,events:t,behaviours:Uu(n.buttonBehaviours,[ti.config({}),T.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:"button"!==o?{role:e("role").getOr("button")}:(t=e("type").getOr("button"),o=e("role").map(function(n){return{role:n}}).getOr({}),D({type:t},o))},eventOrder:n.eventOrder}},configFields:[y("uid",void 0),b("dom"),y("components",[]),ju("buttonBehaviours",[ti,T]),i("action"),i("role"),y("eventOrder",{})]}),Na=jo({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return S([Fo(ve(),R)])},exhibit:function(){return Ho({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),Ha=function(n,e,t,o){return Aa.sketch({dom:hc(n,o),action:e,buttonBehaviours:vo(O([Na.config({})]),t)})},e=Ea({schema:[b("dom")],name:"label"}),Nu=vc("top-left"),Iu=vc("top"),n=vc("top-right"),ni=vc("right"),t=vc("bottom-right"),Lu=vc("bottom"),$u=vc("bottom-left"),zu=[e,vc("left"),ni,Iu,Lu,Nu,n,$u,t,Zu({name:"thumb",defaults:M({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:S([Bo(re(),n,"spectrum"),Bo(ie(),n,"spectrum"),Bo(ue(),n,"spectrum"),Bo(ce(),n,"spectrum"),Bo(ae(),n,"spectrum"),Bo(se(),n,"spectrum")])}}}),Zu({schema:[fo("mouseIsDown",function(){return En(!1)})],name:"spectrum",overrides:function(t){function o(e,n){return r.getValueFromEvent(n).map(function(n){return r.setValueFrom(e,t,n)})}var r=t.model.manager;return{behaviours:O([T.config({mode:"special",onLeft:function(n){return r.onLeft(n,t)},onRight:function(n){return r.onRight(n,t)},onUp:function(n){return r.onUp(n,t)},onDown:function(n){return r.onDown(n,t)}}),ti.config({})]),events:S([w(re(),o),w(ie(),o),w(ce(),o),w(ae(),function(n,e){t.mouseIsDown.get()&&o(n,e)})])}}})],Hu=Object.freeze({__proto__:null,onLoad:bc,onUnload:yc,setValue:function(n,e,t,o){e.store.manager.setValue(n,e,t,o)},getValue:function(n,e,t){return e.store.manager.getValue(n,e,t)},getState:function(n,e,t){return t}}),ur=Object.freeze({__proto__:null,events:function(t,o){var n=t.resetOnDom?[Zo(function(n,e){bc(n,t,o)}),nr(function(n,e){yc(n,t,o)})]:[Po(t,o,bc)];return S(n)}}),Vu=Object.freeze({__proto__:null,memory:xc,dataset:wc,manual:function(){return rr({readState:bn})},init:function(n){return n.store.manager.state(n)}}),e=[i("initialValue"),b("getFallbackEntry"),b("getDataKey"),b("setValue"),u("manager",{setValue:Sc,getValue:function(n,e,t){var o=e.store,r=o.getDataKey(n);return t.lookup(r).getOrThunk(function(){return o.getFallbackEntry(r)})},onLoad:function(e,t,o){t.store.initialValue.each(function(n){Sc(e,t,o,n)})},onUnload:function(n,e,t){t.clear()},state:wc})],ni=[b("getValue"),y("setValue",bn),i("initialValue"),u("manager",{setValue:function(n,e,t,o){e.store.setValue(n,o),e.onSetValue(n,o)},getValue:function(n,e,t){return e.store.getValue(n)},onLoad:function(e,t,n){t.store.initialValue.each(function(n){t.store.setValue(e,n)})},onUnload:bn,state:or.init})],E=jo({fields:[oo("store",{mode:"memory"},Jt("mode",{memory:[i("initialValue"),u("manager",{setValue:function(n,e,t,o){t.set(o),e.onSetValue(n,o)},getValue:function(n,e,t){return t.get()},onLoad:function(n,e,t){e.store.initialValue.each(function(n){t.isNotSet()&&t.set(n)})},onUnload:function(n,e,t){t.clear()},state:xc})],manual:ni,dataset:e})),Or("onSetValue"),y("resetOnDom",!1)],name:"representing",active:ur,apis:Hu,extra:{setValueFrom:function(n,e){e=E.getValue(e);E.setValue(n,e)}},state:Vu}),Pa=Wr("width",function(n){return n.dom.offsetWidth}),za=Ca,ja=M("slider.change.value"),La="left",Iu=ma(-1),Lu=ma(1),Nu=On.none,n=On.none,$u={"top-left":On.none(),top:On.none(),"top-right":On.none(),right:On.some(function(n,e){Kc(n,{x:Fc(e)})}),"bottom-right":On.none(),bottom:On.none(),"bottom-left":On.none(),left:On.some(function(n,e){Kc(n,{x:Dc(e)})})},t=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){e=da(n,e,t);return la(n,{x:e}),e},setToMin:function(n,e){la(n,{x:Cc(e)})},setToMax:function(n,e){la(n,{x:_c(e)})},findValueOfOffset:da,getValueFromEvent:function(n){return Tc(n).map(function(n){return n.left})},findPositionOfValue:ga,setPositionFromValue:function(n,e,t,o){var r=qc(t),r=ga(n,o.getSpectrum(n),r.x,o.getLeftEdge(n),o.getRightEdge(n),t),o=kc(e.element)/2;Dn(e.element,"left",r-o+"px")},onLeft:Iu,onRight:Lu,onUp:Nu,onDown:n,edgeActions:$u}),ni=On.none,e=On.none,ur=va(-1),Hu=va(1),Vu={"top-left":On.none(),top:On.some(function(n,e){Kc(n,{y:Mc(e)})}),"top-right":On.none(),right:On.none(),"bottom-right":On.none(),bottom:On.some(function(n,e){Kc(n,{y:Ic(e)})}),"bottom-left":On.none(),left:On.none()},Iu=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){e=ha(n,e,t);return pa(n,{y:e}),e},setToMin:function(n,e){pa(n,{y:Ec(e)})},setToMax:function(n,e){pa(n,{y:Rc(e)})},findValueOfOffset:ha,getValueFromEvent:function(n){return Tc(n).map(function(n){return n.top})},findPositionOfValue:ba,setPositionFromValue:function(n,e,t,o){var r=qc(t),r=ba(n,o.getSpectrum(n),r.y,o.getTopEdge(n),o.getBottomEdge(n),t),o=Xr(e.element)/2;Dn(e.element,"top",r-o+"px")},onLeft:ni,onRight:e,onUp:ur,onDown:Hu,edgeActions:Vu}),Lu=Tc,Nu=wa(-1,!1),n=wa(1,!1),$u=wa(-1,!0),ni=wa(1,!0),e={"top-left":On.some(function(n,e){Kc(n,Yc(Dc(e),Mc(e)))}),top:On.some(function(n,e){Kc(n,Yc(Nc(e),Mc(e)))}),"top-right":On.some(function(n,e){Kc(n,Yc(Fc(e),Mc(e)))}),right:On.some(function(n,e){Kc(n,Yc(Fc(e),Hc(e)))}),"bottom-right":On.some(function(n,e){Kc(n,Yc(Fc(e),Ic(e)))}),bottom:On.some(function(n,e){Kc(n,Yc(Nc(e),Ic(e)))}),"bottom-left":On.some(function(n,e){Kc(n,Yc(Dc(e),Ic(e)))}),left:On.some(function(n,e){Kc(n,Yc(Dc(e),Hc(e)))})},ur=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){e=xa(da(n,e,t.left),ha(n,e,t.top));return ya(n,e),e},setToMin:function(n,e){ya(n,xa(Cc(e),Ec(e)))},setToMax:function(n,e){ya(n,xa(_c(e),Rc(e)))},getValueFromEvent:Lu,setPositionFromValue:function(n,e,t,o){var r=qc(t),i=ga(n,o.getSpectrum(n),r.x,o.getLeftEdge(n),o.getRightEdge(n),t),r=ba(n,o.getSpectrum(n),r.y,o.getTopEdge(n),o.getBottomEdge(n),t),o=kc(e.element)/2,n=Xr(e.element)/2;Dn(e.element,"left",i-o+"px"),Dn(e.element,"top",r-n+"px")},onLeft:Nu,onRight:n,onUp:$u,onDown:ni,edgeActions:e}),Hu=[y("stepSize",1),y("onChange",bn),y("onChoose",bn),y("onInit",bn),y("onDragStart",bn),y("onDragEnd",bn),y("snapToGrid",!1),y("rounded",!0),i("snapStart"),Qt("model",Jt("mode",{x:[y("minX",0),y("maxX",100),fo("value",function(n){return En(n.mode.minX)}),b("getInitialValue"),u("manager",t)],y:[y("minY",0),y("maxY",100),fo("value",function(n){return En(n.mode.minY)}),b("getInitialValue"),u("manager",Iu)],xy:[y("minX",0),y("maxX",100),y("minY",0),y("maxY",100),fo("value",function(n){return En({x:n.mode.minX,y:n.mode.minY})}),b("getInitialValue"),u("manager",ur)]})),Eu("sliderBehaviours",[T,E]),fo("mouseIsDown",function(){return En(!1)})],$a=M("mouse.released"),Ga=dc({name:"Slider",configFields:Hu,partFields:zu,factory:function(r,n,e,t){function i(n){return rc(n,r,"thumb")}function u(n){return rc(n,r,"spectrum")}function o(n){return oc(n,r,"left-edge")}function c(n){return oc(n,r,"right-edge")}function a(n){return oc(n,r,"top-edge")}function s(n){return oc(n,r,"bottom-edge")}function f(n,e){h.setPositionFromValue(n,e,r,{getLeftEdge:o,getRightEdge:c,getTopEdge:a,getBottomEdge:s,getSpectrum:u})}function l(n,e){p.value.set(e),f(n,i(n))}function d(t){var n=r.mouseIsDown.get();r.mouseIsDown.set(!1),n&&oc(t,r,"thumb").each(function(n){var e=p.value.get();r.onChoose(t,n,e)})}function m(n,e){e.stop(),r.mouseIsDown.set(!0),r.onDragStart(n,i(n))}function g(n,e){e.stop(),r.onDragEnd(n,i(n)),d(n)}var p=r.model,h=p.manager;return{uid:r.uid,dom:r.dom,components:n,behaviours:Du(r.sliderBehaviours,[T.config({mode:"special",focusIn:function(n){return oc(n,r,"spectrum").map(T.focusIn).map(R)}}),E.config({store:{mode:"manual",getValue:function(n){return p.value.get()}}}),Zr.config({channels:((n={})[$a()]={onReceive:d},n)})]),events:S([w(ja(),function(n,e){var t;n=n,e=e.event.value,l(n,e),t=i(n),r.onChange(n,t,e),On.some(!0)}),Zo(function(n,e){var t=p.getInitialValue(),t=(p.value.set(t),i(n)),o=(f(n,t),u(n));r.onInit(n,t,o,p.value.get())}),w(re(),m),w(ue(),g),w(ce(),m),w(se(),g)]),apis:{resetToMin:function(n){h.setToMin(n,r)},resetToMax:function(n){h.setToMax(n,r)},setValue:l,refresh:f},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(n,e,t){n.setValue(e,t)},resetToMin:function(n,e){n.resetToMin(e)},resetToMax:function(n,e){n.resetToMax(e)},refresh:function(n,e){n.refresh(e)}}}),Ua=["9px","10px","11px","12px","14px","16px","18px","20px","24px","32px","36px"],Vu=M(Ua),Wa=Ut([b("getInitialValue"),b("onChange"),b("category"),b("sizes")]),Xa=Vu(),qa={},Ya={exports:qa};function Ka(n){return n.dom.textContent}function Ja(n){return 0<n.length}function Qa(n){return null==n?"":n}function Za(n,e){return{key:n,value:{config:{},me:(n=n,e=S(e),jo({fields:[b("enabled")],name:n,active:{events:M(e)}})),configAsRaw:M({}),initialConfig:{},state:or}}}function ns(n){return n.dom.value}function es(n,e){if(void 0===e)throw new Error("Value.set was undefined");n.dom.value=e}function ts(n,e){var t=ka(Qs.sketch({inputAttributes:{placeholder:nf.translate(e)},onSetValue:function(n,e){ln(n,me())},inputBehaviours:O([Ys.config({find:On.some}),Zs.config({}),T.config({mode:"execution"})]),selectOnFocus:!1})),e=ka(Aa.sketch({dom:C('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'),action:function(n){n=t.get(n);E.setValue(n,"")}}));return{name:n,spec:Ks.sketch({dom:C('<div class="${prefix}-input-container"></div>'),components:[t.asSpec(),e.asSpec()],containerBehaviours:O([k.config({toggleClass:Mn("input-container-empty")}),Ys.config({find:function(n){return On.some(t.get(n))}}),Za("input-clearing",[w(me(),function(n){var e=t.get(n);(0<E.getValue(e).length?k.off:k.on)(n)})])])})}}function os(n,e,t){(e.disabled()?tf:of)(n,e)}function rs(n,e){return!0===e.useNative&&U(ef,Ie(n.element))}function is(n,e){return rs(n,e)?et(n.element,"disabled"):"true"===Cn(n.element,"aria-disabled")}function us(n){return"<alloy.field."+n+">"}function cs(e){function t(n){return"The component must be in a context to execute: "+n+(e?"\n"+Xo(e().element)+" is not in context.":"")}function n(n){return function(){throw new Error(t(n))}}function o(n){return function(){console.warn(t(n))}}return{debugInfo:M("fake"),triggerEvent:o("triggerEvent"),triggerFocus:o("triggerFocus"),triggerEscape:o("triggerEscape"),broadcast:o("broadcast"),broadcastOn:o("broadcastOn"),broadcastEvent:o("broadcastEvent"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),isConnected:_}}function as(n,r){var i={};return qe(n,function(n,o){qe(n,function(n,e){var t=v(i,e).getOr([]);i[e]=t.concat([r(o,n)])})}),i}function ss(n){return n.cHandler}function fs(n,e){return{name:n,handler:e}}function ls(e,n){wn(n,function(n){it(e,n)})}function ds(e,n){wn(n,function(n){ut(e,n)})}function ms(n,e,t){var o,r,i,u,c,a={"alloy.base.behaviour":n.events},n=n.eventOrder,a=as(D(D({},a),(o=t,r={},wn(e,function(n){r[n.name()]=n.handlers(o)}),r)),fs);return i=n,t=Ke(a,function(t,e){return(1===t.length?F.value(t[0].handler):(n=t,(o=(o=i)[r=e])?function(r,i,n,u){try{t=function(n,e){var n=n[i],e=e[i],t=u.indexOf(n),o=u.indexOf(e);if(-1===t)throw new Error("The ordering for "+r+" does not have an entry for "+n+".\nOrder specified: "+JSON.stringify(u,null,2));if(-1===o)throw new Error("The ordering for "+r+" does not have an entry for "+e+".\nOrder specified: "+JSON.stringify(u,null,2));return t<o?-1:o<t?1:0},(o=$n.call(n,0)).sort(t);var e=o;return F.value(e)}catch(n){return F.error([n])}var t,o}("Event: "+r,"name",n,o).map(function(n){var t,e,o,r,n=xn(n,function(n){return n.handler});return{can:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Y(e,function(n,e){return n&&e.can.apply(void 0,t)},!0)},abort:(o=e=t=n,r=function(n){return n.abort},function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Y(o,function(n,e){return n||r(e).apply(void 0,t)},!1)}),run:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];wn(t,function(n){n.run.apply(void 0,e)})}}}):F.error(["The event ("+r+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(xn(n,function(n){return n.name}),null,2)]))).map(function(n){r=N(n=n)?{can:R,abort:_,run:n}:n;var r,n=1<t.length?X(i[e],function(e){return W(t,function(n){return n.name===e})}).join(" > "):t[0].name;return To(e,{handler:function(n,e){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];n=[n,e].concat(t);r.abort.apply(void 0,n)?e.stop():r.can.apply(void 0,n)&&r.run.apply(void 0,n)},purpose:n})});var n,o,r}),e={},u=[],c=[],wn(t,function(n){n.fold(function(n){u.push(n)},function(n){c.push(n)})}),(0<(n={errors:u,values:c}).errors.length?F.error(Q(n.errors)):(a=e,0===(t=n.values).length?F.value(a):F.value(vo(a,bo.apply(void 0,t))))).getOrDie()}function gs(t){function n(){return h}var r,e,o,i,u,c,a=En(ff),s=Yt(qt("custom.definition",lf,t)),f=(u=v(f=t,"behaviours").getOr({}),l=Z(Ct(u),function(n){n=u[n];return I(n)?[n.me]:[]}),c=f,l=xn(f=l,function(n){return eo(n.name(),[b("config"),y("state",or)])}),{list:f,data:Ye(qt("component.behaviours",wo(l),c.behaviours).fold(function(n){throw new Error(so(n)+"\nComplete spec:\n"+JSON.stringify(c,null,2))},yn),function(n){return M(n.map(function(n){return{config:n.config,state:n.state.init(n.config)}}))})}),l=f.list,d=f.data,m=(f=l,g=d,o=D(D({},(o=e=s).dom),{uid:o.uid,domChildren:xn(o.components,function(n){return n.element})}),i=e.domModification.fold(function(){return Ho({})},Ho),e=0<f.length?function(e,n,t){var o=D({},{"alloy.base.modification":i});function r(n){return q(n,function(n,e){return D(D({},e.modification),n)},{})}wn(n,function(n){o[n.name()]=n.exhibit(e,t)});n=as(o,function(n,e){return{name:n,modification:e}});return Ho({classes:q(n.classes,function(n,e){return e.modification.concat(n)},[]),attributes:r(n.attributes),styles:r(n.styles)})}(g,f,o):i,f=D(D({},g=o),{attributes:D(D({},g.attributes),e.attributes),styles:D(D({},g.styles),e.styles),classes:g.classes.concat(e.classes)}),Ze(r=kn.fromTag(f.tag),f.attributes),ls(r,f.classes),jr(r,f.styles),f.innerHtml.each(function(n){var e,t,o=Be(e=r).dom;je(t=kn.fromDom(o.createDocumentFragment()),(n=n,(o=(o||document).createElement("div")).innerHTML=n,vt(kn.fromDom(o)))),Le(e),bt(e,t)}),o=f.domChildren,je(r,o),f.value.each(function(n){es(r,n)}),f.uid,Ta(r,f.uid),r),g=ms(s,l,d),p=En(s.components),h={uid:t.uid,getSystem:a.get,config:function(n){var e=d;return(N(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))})()},hasConfigured:function(n){return N(d[n.name()])},spec:t,readState:function(n){return d[n]().map(function(n){return n.state.readState()}).getOr("not enabled")},getApis:function(){return s.apis},connect:function(n){a.set(n)},disconnect:function(){a.set(cs(n))},element:m,syncComponents:function(){var n=Z(vt(m),function(n){return a.get().getByDom(n).fold(function(){return[]},on)});p.set(n)},components:p.get,events:g};return h}function ps(n){return n={element:kn.fromText(n)},e=Kt("external.component",Ut([b("element"),i("uid")]),n),t=En(cs()),o=e.uid.getOrThunk(function(){return Fa("external")}),Ta(e.element,o),uc(r={uid:o,getSystem:t.get,config:On.none,hasConfigured:_,connect:function(n){t.set(n)},disconnect:function(){t.set(cs(function(){return r}))},getApis:function(){return{}},element:e.element,spec:n,readState:M("No state"),syncComponents:bn,components:M([]),events:{}});var e,t,o,r}function hs(n){(Uo(n.element).isNone()||ti.isFocused(n))&&(ti.isFocused(n)||ti.focus(n),dn(n,pf,{item:n}))}function vs(n){dn(n,hf,{item:n})}function bs(n,e,t,o){o=n.getSystem().build(o);Tt(n,o,t)}function ys(n,e,t,o){K(js(n),function(n){return Sn(o.element,n.element)}).each(Xe)}function xs(e,n,t,r,o){var i=js(e);return On.from(i[r]).map(function(n){return ys(e,0,0,n),o.each(function(n){bs(e,0,function(n,e){var t,o=e;He(t=n,r).fold(function(){bt(t,o)},function(n){Pe(n,o)})},n)}),n})}function ws(n,e,t,o){return v(e.routes,o.start).bind(function(n){return v(n,o.destination)})}function Ss(e,t,n){var o,r,i=n;Gs(o=e,r=t).bind(function(n){return $s(0,r,0,n)}).each(function(n){n=n.transition;ut(e.element,n.transitionClass),tt(e.element,t.destinationAttr)})}function Os(n,e,t,o){Ss(n,e,t),et(n.element,e.stateAttr)&&Cn(n.element,e.stateAttr)!==o&&e.onFinish(n,o),Tn(n.element,e.stateAttr,o)}function ks(n){it(n,_f)}function Ts(n){ut(n,_f)}function Cs(n){return v(n,"format").getOr(n.title)}function Es(n){n=n.replace(/\|/g," ").trim();return 0<n.length?n.split(/\s+/):[]}function Ds(r,f){function n(t){return function(){return Ha(e=t,function(){n.execCommand(e)},{},n=f);var n,e}}function e(o){return function(){return n=f,t=gc(e=o),Ha(e,function(){n.execCommand(e)},t,n);var n,e,t}}function t(n,e,t){return function(){return pc(f,n,e,t)}}function o(){return o=function(){f.fire("scrollIntoView")},e=t=f,n=(r=function(n){return Z(n,function(n){return void 0===n.items?!Je(n,"format")||e.formatter.canApply(n.format)?[n]:[]:0<r(n.items).length?[n]:[]})})(n=b),n=Vf(n),c=(i={formats:n,handle:function(n,e){t.undoManager.transact(function(){k.isOn(n)?t.formatter.remove(e):t.formatter.apply(e)}),o()}}).formats,a=function(){return u},n=If("Styles",[].concat(xn(c.items,function(n){return Ff(Cs(n),n.title,n.isSelected(),n.getPreview(),Je(c.expansions,Cs(n)))})),a,!1),s=Ye(c.menus,function(n,e){n=xn(n,function(n){return Ff(Cs(n),n.title,void 0!==n.isSelected&&n.isSelected(),void 0!==n.getPreview?n.getPreview():"",Je(c.expansions,Cs(n)))});return If(e,n,a,!0)}),s=vo(s,To("styles",n)),n={tmenu:Df.tieredData("styles",s,c.expansions)},(u=ka(Df.sketch({dom:{tag:"div",classes:[Mn("styles-menu")]},components:[],fakeFocus:!0,stayInDom:!0,onExecute:function(n,e){var t=E.getValue(e);return i.handle(e,t.value),On.none()},onEscape:function(){return On.none()},onOpenMenu:function(n,e){n=kc(n.element);Oc(e.element,n),Mf.jumpTo(e,"current")},onOpenSubmenu:function(n,e,t){var o=kc(n.element),e=ci(e.element,'[role="menu"]').getOrDie("hacky"),n=n.getSystem().getByDom(e).getOrDie();Oc(t.element,o),Mf.progressTo(n,"before"),Mf.jumpTo(t,"after"),Mf.progressTo(t,"current")},onCollapseMenu:function(n,e,t){e=ci(e.element,'[role="menu"]').getOrDie("hacky"),n=n.getSystem().getByDom(e).getOrDie();Mf.progressTo(n,"after"),Mf.progressTo(t,"current")},navigateOnHover:!1,highlightImmediately:!0,data:n.tmenu,markers:{backgroundMenu:Mn("styles-background-menu"),menu:Mn("styles-menu"),selectedMenu:Mn("styles-selected-menu"),item:Mn("styles-item"),selectedItem:Mn("styles-selected-item")}}))).asSpec();var t,n,o,e,r,i,u,c,a,s}function i(n,e){return{isSupported:function(){var e=f.ui.registry.getAll().buttons;return n.forall(function(n){return Je(e,n)})},sketch:e}}var u,c,a=n("undo"),s=n("redo"),l=e("bold"),d=e("italic"),m=e("underline"),g=n("removeformat"),p=t("unlink","link",function(){f.execCommand("unlink",null,!1)}),h=t("unordered-list","ul",function(){f.execCommand("InsertUnorderedList",null,!1)}),v=t("ordered-list","ol",function(){f.execCommand("InsertOrderedList",null,!1)}),b=(c=function(n){return xn(n,function(n){var e;return Je(n,"items")?(e=c(n.items),vo(vo(n,{isSelected:_,getPreview:M("")}),{items:e})):Je(n,"format")?vo(n,{isSelected:y(n.format),getPreview:x(n.format)}):(n=_u((e=n).title),e=vo(e,{format:n,isSelected:y(n),getPreview:x(n)}),u.formatter.register(n,e),e)})})((u=f).getParam("style_formats",fr,"array"));function y(n){return function(){return u.formatter.match(n)}}function x(n){return function(){return u.formatter.getCssText(n)}}return{undo:i(On.none(),a),redo:i(On.none(),s),bold:i(On.none(),l),italic:i(On.none(),d),underline:i(On.none(),m),removeformat:i(On.none(),g),link:i(On.none(),function(){return t=r,pc(o=f,"link","link",function(){var n,e=cf(t,o);t.setContextToolbar(e),e=o,n=function(){t.focusToolbar()},(qs.os.isAndroid()?function(n,e){var t=e.selection.getRng();n(),e.selection.setRng(t)}:z)(n,e),Xs(o).each(function(n){o.selection.select(n.dom)})});var t,o}),unlink:i(On.none(),p),image:i(On.none(),function(){return i=f,e=ka({dom:{tag:"input",attributes:{accept:"image/*",type:"file",title:""},styles:{visibility:"hidden",position:"absolute"}},events:S([Ao(pe()),w(ge(),function(n,e){e=e.event.raw,e=e.target.files||e.dataTransfer.files;On.from(e[0]).each(function(n){var o=i,r=n,t=r;new Ws(function(n){var e=new FileReader;e.onloadend=function(){n(e.result)},e.readAsDataURL(t)}).then(function(n){return n.split(",")[1]}).then(function(t){o.undoManager.transact(function(){var n=o.editorUpload.blobCache,e=n.create(_u("mceu"),r,t),n=(n.add(e),o.dom.createHTML("img",{src:e.blobUri()}));o.insertContent(n)})})})})])}),Aa.sketch({dom:hc("image",i),components:[e.asSpec()],action:function(n){e.get(n).element.dom.click()}});var i,e}),bullist:i(On.some("bullist"),h),numlist:i(On.some("numlist"),v),fontsizeselect:i(On.none(),function(){return e={onChange:function(n){var t=o;On.from(Ua[n]).each(function(n){var e;Oa(e=t)!==n&&e.execCommand("fontSize",!1,n)})},getInitialValue:function(){return e=Oa(o),J(Ua,function(n){return n===e}).getOr(2);var e}},Sa(r,"font-size",function(){return n=e,[mc('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'),(n={onChange:n.onChange,sizes:Xa,category:"font",getInitialValue:n.getInitialValue},o=Kt("SizeSlider",Wa,n),Ga.sketch({dom:{tag:"div",classes:[Mn("slider-"+o.category+"-size-container"),Mn("slider"),Mn("slider-size-container")]},onChange:function(n,e,t){t=t.x();0<=t&&t<o.sizes.length&&o.onChange(t)},onDragStart:function(n,e){k.on(e)},onDragEnd:function(n,e){k.off(e)},model:{mode:"x",minX:0,maxX:o.sizes.length-1,getInitialValue:function(){return{x:o.getInitialValue()}}},stepSize:1,snapToGrid:!0,sliderBehaviours:O([Br(Ga.refresh)]),components:[Ga.parts.spectrum({dom:C('<div class="${prefix}-slider-size-container"></div>'),components:[mc('<div class="${prefix}-slider-size-line"></div>')]}),Ga.parts.thumb({dom:C('<div class="${prefix}-slider-thumb"></div>'),behaviours:O([k.config({toggleClass:Mn("thumb-active")})])})]})),mc('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')];var n,o},o=f);var o,e}),forecolor:i(On.none(),function(){return n={onChange:function(n,e,t){o.undoManager.transact(function(){o.formatter.apply("forecolor",{value:t}),o.nodeChanged()})},getInitialValue:M(-1)},Sa(r,"color-levels",function(){return[(o=n,Ga.sketch({dom:C('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'),components:[Ga.parts["left-edge"](mc('<div class="${prefix}-hue-slider-black"></div>')),Ga.parts.spectrum({dom:C('<div class="${prefix}-slider-gradient-container"></div>'),components:[mc('<div class="${prefix}-slider-gradient"></div>')],behaviours:O([k.config({toggleClass:Mn("thumb-active")})])}),Ga.parts["right-edge"](mc('<div class="${prefix}-hue-slider-white"></div>')),Ga.parts.thumb({dom:C('<div class="${prefix}-slider-thumb"></div>'),behaviours:O([k.config({toggleClass:Mn("thumb-active")})])})],onChange:function(n,e,t){t=r(t.x());Dn(e.element,"background-color",t),o.onChange(n,e,t)},onDragStart:function(n,e){k.on(e)},onDragEnd:function(n,e){k.off(e)},onInit:function(n,e,t,o){o=r(o.x());Dn(e.element,"background-color",o)},stepSize:10,model:{mode:"x",minX:0,maxX:360,getInitialValue:function(){return{x:o.getInitialValue()}}},sliderBehaviours:O([Br(Ga.refresh)])}))];function r(n){return n<0?"black":360<n?"white":"hsl("+n+", 100%, 50%)"}var o},o=f);var o,n}),styleselect:i(On.none(),function(){return Ha("style-formats",function(n){f.fire("toReading"),r.dropup.appear(o,k.on,n)},O([k.config({toggleClass:Mn("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),Zr.config({channels:Co([Ar(mr,k.off),Ar(gr,k.off)])})]),f)})}}function Ms(n){function e(){return n.stopPropagation()}function t(){return n.preventDefault()}var o=d(t,e);return{target:kn.fromDom(function(n){if(xt()&&I(n.target)){var e=kn.fromDom(n.target);if(mt(e)&&I(e.dom.shadowRoot)&&n.composed&&n.composedPath){e=n.composedPath();if(e)return 0<e.length?On.some(e[0]):On.none()}}return On.from(n.target)}(n).getOr(n.target)),x:n.clientX,y:n.clientY,stop:e,prevent:t,kill:o,raw:n}}function _s(n,e,t,o,r){function i(n){u(n)&&c(Ms(n))}var u,c;u=t,c=o;return n.dom.addEventListener(e,i,r),{unbind:Rn(Us,n,e,i,r)}}function _n(n,e,t){return _s(n,e,Af,t,!1)}function Rs(n,e,t){return _s(n,e,Af,t,!0)}function Fs(n){return{isPortrait:M(n.matchMedia("(orientation: portrait)").matches)}}function Is(o,e){var n=kn.fromDom(o),r=null,t=_n(n,"orientationchange",function(){Nf.clearInterval(r);var n=Fs(o);e.onChange(n),i(function(){e.onReady(n)})}),i=function(n){Nf.clearInterval(r);var e=o.innerHeight,t=0;r=Nf.setInterval(function(){e!==o.innerHeight?(Nf.clearInterval(r),n(On.some(o.innerHeight))):20<t&&(Nf.clearInterval(r),n(On.none())),t++},50)};return{onAdjustment:i,destroy:function(){t.unbind()}}}function Vs(n,e,t){var o,n=n.document.createRange(),r=n;return e.fold(function(n){r.setStartBefore(n.dom)},function(n,e){r.setStart(n.dom,e)},function(n){r.setStartAfter(n.dom)}),o=n,t.fold(function(n){o.setEndBefore(n.dom)},function(n,e){o.setEnd(n.dom,e)},function(n){o.setEndAfter(n.dom)}),n}function Bs(n,e,t,o,r){n=n.document.createRange();return n.setStart(e.dom,t),n.setEnd(o.dom,r),n}function As(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}}function Ns(n,e,t){return e(kn.fromDom(t.startContainer),t.startOffset,kn.fromDom(t.endContainer),t.endOffset)}function Hs(n,e){r=n;var r,t,n=e.match({domRange:function(n){return{ltr:M(n),rtl:On.none}},relative:function(n,e){return{ltr:G(function(){return Vs(r,n,e)}),rtl:G(function(){return On.some(Vs(r,e,n))})}},exact:function(n,e,t,o){return{ltr:G(function(){return Bs(r,n,e,t,o)}),rtl:G(function(){return On.some(Bs(r,t,o,n,e))})}}});return(t=(e=n).ltr()).collapsed?e.rtl().filter(function(n){return!1===n.collapsed}).map(function(n){return Hf.rtl(kn.fromDom(n.endContainer),n.endOffset,kn.fromDom(n.startContainer),n.startOffset)}).getOrThunk(function(){return Ns(0,Hf.ltr,t)}):Ns(0,Hf.ltr,t)}function Ps(o,n){return{uid:o.uid,dom:o.dom,components:n,behaviours:Du(o.formBehaviours,[E.config({store:{mode:"manual",getValue:function(n){e=o,t=n.getSystem();var e,t,n=Ye(e.partUids,function(n,e){return M(t.getByUid(n))});return Ye(n,function(n,o){return n().bind(function(n){var e=Ys.getCurrent(n),t=new Error("Cannot find a current component to extract the value from for form part '"+o+"': "+Xo(n.element));return e.fold(function(){return F.error(t)},F.value)}).map(E.getValue)})},setValue:function(t,n){qe(n,function(e,n){oc(t,o,n).each(function(n){Ys.getCurrent(n).each(function(n){E.setValue(n,e)})})})}}})]),apis:{getField:function(n,e){return oc(n,o,e).bind(Ys.getCurrent)}}}}function zs(n){return"prepared"===n.type?On.some(n.menu):On.none()}!function(){function n(){var n,e,t={exports:{}};function o(){}function i(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(n,this)}function r(t,o){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn(function(){var n,e=1===t._state?o.onFulfilled:o.onRejected;if(null!==e){try{n=e(t._value)}catch(n){return void c(o.promise,n)}u(o.promise,n)}else(1===t._state?u:c)(o.promise,t._value)})):t._deferreds.push(o)}function u(n,e){try{if(e===n)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if(e instanceof i)return n._state=3,n._value=e,a(n);if("function"==typeof t)return f((o=t,r=e,function(){o.apply(r,arguments)}),n)}n._state=1,n._value=e,a(n)}catch(e){c(n,e)}var o,r}function c(n,e){n._state=2,n._value=e,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&i._immediateFn(function(){n._handled||i._unhandledRejectionFn(n._value)});for(var e=0,t=n._deferreds.length;e<t;e++)r(n,n._deferreds[e]);n._deferreds=null}function s(n,e,t){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=t}function f(n,e){var t=!1;try{n(function(n){t||(t=!0,u(e,n))},function(n){t||(t=!0,c(e,n))})}catch(n){t||(t=!0,c(e,n))}}l=t,n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=setTimeout,i.prototype.catch=function(n){return this.then(null,n)},i.prototype.then=function(n,e){var t=new this.constructor(o);return r(this,new s(n,e,t)),t},i.all=function(n){var c=Array.prototype.slice.call(n);return new i(function(r,i){if(0===c.length)return r([]);for(var u=c.length,n=0;n<c.length;n++)!function e(t,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var o=n.then;if("function"==typeof o)return o.call(n,function(n){e(t,n)},i),0}c[t]=n,0==--u&&r(c)}catch(n){i(n)}}(n,c[n])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(n){n(e)})},i.reject=function(t){return new i(function(n,e){e(t)})},i.race=function(r){return new i(function(n,e){for(var t=0,o=r.length;t<o;t++)r[t].then(n,e)})},i._immediateFn="function"==typeof setImmediate?function(n){setImmediate(n)}:function(n){e(n,0)},i._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},i._setImmediateFn=function(n){i._immediateFn=n},i._setUnhandledRejectionFn=function(n){i._unhandledRejectionFn=n},l.exports?l.exports=i:n.Promise||(n.Promise=i);var l=t.exports;return{boltExport:("undefined"!=typeof window?window:Function("return this;")()).Promise||l}}var e=this;"object"==typeof qa&&void 0!==Ya?Ya.exports=n():(e="undefined"!=typeof globalThis?globalThis:e||self).EphoxContactWrapper=n()}();function js(n,e){return n.components()}function Ls(){function a(n){return t(n).bind(zs)}function e(n){return v(s.get(),n)}function t(n){return v(f.get(),n)}var s=En({}),f=En({}),l=En({}),d=Xi(),m=En({});return{setMenuBuilt:function(n,e){var t;f.set(D(D({},f.get()),((t={})[n]={type:"prepared",menu:e},t)))},setContents:function(n,e,t,o){d.set(n),s.set(t),f.set(e),m.set(o);n=t,r={},qe(o,function(n,e){wn(n,function(n){r[n]=e})}),u=Dt(i=n,function(n,e){return{k:n,v:e}}),c=Ye(u,function(n,e){return[e].concat(Tf(r,i,u,e))});var r,i,u,c,e=Ye(r,function(n){return v(c,n).getOr([n])});l.set(e)},expand:function(t){return v(s.get(),t).map(function(n){var e=v(l.get(),t).getOr([]);return[n].concat(e)})},refresh:function(n){return v(l.get(),n)},collapse:function(n){return v(l.get(),n).bind(function(n){return 1<n.length?On.some(n.slice(1)):On.none()})},lookupMenu:t,lookupItem:e,otherMenus:function(n){var e=m.get();return tn(Ct(e),n)},getPrimary:function(){return d.get().bind(a)},getMenus:function(){return f.get()},clear:function(){s.set({}),f.set({}),l.set({}),d.clear()},isClear:function(){return d.get().isNone()},getTriggeringPath:function(n,u){var c=X(e(n).toArray(),function(n){return a(n).isSome()});return v(l.get(),n).bind(function(n){for(var i=en(c.concat(n)),e=Z(i,function(n,e){return t=n,o=u,r=i.slice(0,e+1),a(t).bind(function(e){return function(n){for(var e=s.get(),t=Ct(e),o=0,r=t.length;o<r;o++){var i=e[t[o]];if(i===n)return On.some(i)}return On.none()}(t).bind(function(n){return o(n).map(function(n){return{triggeredMenu:e,triggeringItem:n,triggeringPath:r}})})}).fold(function(){return Eo(d.get(),n)?[]:[On.none()]},function(n){return[On.some(n)]});var t,o,r}),t=[],o=0;o<e.length;o++){var r=e[o];if(!r.isSome())return On.none();t.push(r.getOrDie())}return On.some(t)})}}}function $s(n,e,t,o){return ws(0,e,0,o).bind(function(e){return e.transition.map(function(n){return{transition:n,route:e}})})}function Gs(e,t,n){return nt(e.element,t.destinationAttr).map(function(n){return{start:Cn(e.element,t.stateAttr),destination:n}})}function Us(n,e,t,o){n.dom.removeEventListener(e,t,o)}var Ws=Ya.exports.boltExport,Xs=function(n){return si(kn.fromDom(n.selection.getStart()),"a")},qs=oe(),Lu=Object.freeze({__proto__:null,getCurrent:function(n,e,t){return e.find(n)}}),Ys=jo({fields:[b("find")],name:"composing",apis:Lu}),Ks=lc({name:"Container",factory:function(n){var e=n.dom,t=e.attributes,e=r(e,["attributes"]);return{uid:n.uid,dom:D({tag:"div",attributes:D({role:"presentation"},t)},e),components:n.components,behaviours:n.containerBehaviours.dump,events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},configFields:[y("components",[]),Eu("containerBehaviours",[]),y("events",{}),y("domModification",{}),y("eventOrder",{})]}),Js=lc({name:"DataField",factory:function(t){return{uid:t.uid,dom:t.dom,behaviours:Uu(t.dataBehaviours,[E.config({store:{mode:"memory",initialValue:t.getInitialValue()}}),Ys.config({find:On.some})]),events:S([Zo(function(n,e){E.setValue(n,t.getInitialValue())})])}},configFields:[b("uid"),b("dom"),b("getInitialValue"),ju("dataBehaviours",[E,Ys])]}),Qs=lc({name:"Input",configFields:M([i("data"),y("inputAttributes",{}),y("inputStyles",{}),y("tag","input"),y("inputClasses",[]),Or("onSetValue"),y("styles",{}),y("eventOrder",{}),Eu("inputBehaviours",[E,ti]),y("selectOnFocus",!0)])(),factory:function(n,e){return{uid:n.uid,dom:{tag:(t=n).tag,attributes:D({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses},components:[],behaviours:D(D({},O([ti.config({onFocus:(t=n).selectOnFocus?function(n){var n=n.element,e=ns(n);n.dom.setSelectionRange(0,e.length)}:bn})])),Du(t.inputBehaviours,[E.config({store:D(D({mode:"manual"},t.data.map(function(n){return{initialValue:n}}).getOr({})),{getValue:function(n){return ns(n.element)},setValue:function(n,e){ns(n.element)!==e&&es(n.element,e)}}),onSetValue:t.onSetValue})])),eventOrder:n.eventOrder};var t}}),Nu=Object.freeze({__proto__:null,exhibit:function(n,e){return Ho({attributes:Co([{key:e.tabAttr,value:"true"}])})}}),Zs=jo({fields:[y("tabAttr","data-alloy-tabstop")],name:"tabstopping",active:Nu}),nf=tinymce.util.Tools.resolve("tinymce.util.I18n"),ef=["input","button","textarea","select"],tf=function(e,n,t){n.disableClass.each(function(n){it(e.element,n)}),(rs(e,n)?function(n){Tn(n.element,"disabled","disabled")}:function(n){Tn(n.element,"aria-disabled","true")})(e),n.onDisabled(e)},of=function(e,n,t){n.disableClass.each(function(n){ut(e.element,n)}),(rs(e,n)?function(n){tt(n.element,"disabled")}:function(n){Tn(n.element,"aria-disabled","false")})(e),n.onEnabled(e)},n=Object.freeze({__proto__:null,enable:of,disable:tf,isDisabled:is,onLoad:os,set:function(n,e,t,o){(o?tf:of)(n,e)}}),$u=Object.freeze({__proto__:null,exhibit:function(n,e){return Ho({classes:e.disabled()?e.disableClass.toArray():[]})},events:function(t,n){return S([Fo(Se(),function(n,e){return is(n,t)}),Po(t,n,os)])}}),rf=jo({fields:[oo("disabled",_,xo),y("useNative",!0),i("disableClass"),Or("onDisabled"),Or("onEnabled")],name:"disabling",active:$u,apis:n}),uf=[Eu("formBehaviours",[E])],cf=(cc(function(n,e,t){return n.getField(e,t)}),G(function(o,r){return[{label:"the link group",items:[(e={fields:[ts("url","Type or paste URL"),ts("text","Link text"),ts("title","Link title"),ts("target","Link target"),{name:"link",spec:Js.sketch({dom:{tag:"span",styles:{display:"none"}},getInitialValue:function(){return On.none()}})}],maxFieldIndex:["url","text","title","target"].length-1,getInitialValue:function(){return On.some(Xs(n=r).fold(function(){return{url:"",text:n.selection.getContent({format:"text"}),title:"",target:"",link:On.none()}},function(n){return e=Ka(n=n),t=Cn(n,"href"),o=Cn(n,"title"),r=Cn(n,"target"),{url:Qa(t),text:e!==t?Qa(e):"",title:Qa(o),target:Qa(r),link:On.some(n)};var e,t,o,r}));var n},onExecute:function(n,e){var t,u,n=E.getValue(n);t=r,(u=n).url.toOptional().filter(Ja).fold(function(){var e=t;u.link.bind(yn).each(function(n){e.execCommand("unlink")})},function(r){n=u,(e={}).href=r,n.title.toOptional().filter(Ja).each(function(n){e.title=n}),n.target.toOptional().filter(Ja).each(function(n){e.target=n});var n,e,i=e;u.link.bind(yn).fold(function(){var n=u.text.toOptional().filter(Ja).getOr(r);t.insertContent(t.dom.createHTML("a",i,t.dom.encode(n)))},function(e){t=e,o=r;var t,o,n=u.text.toOptional().filter(Ja).fold(function(){return Cn(n=t,"href")===Ka(n)?On.some(o):On.none();var n},On.some);Ze(e,i),n.each(function(n){e.dom.textContent=n})})}),o.restoreToolbar(),r.focus()}},i="navigateEvent",u=Kt("SerialisedDialog",wo([b("fields"),y("maxFieldIndex",e.fields.length-1),b("onExecute"),b("getInitialValue"),fo("state",function(){return{dialogSwipeState:Xi(),currentScreen:En(0)}})]),e),c=ka((e={field:function(n,e){return t.push(n),n=us(n),e=e,{uiType:Ju(),owner:"form",name:n,config:e,validated:{}}},record:M(t=[])},n=(n=function(t){return{dom:C('<div class="${prefix}-serialised-dialog"></div>'),components:[Ks.sketch({dom:C('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'),components:xn(u.fields,function(n,e){return e<=u.maxFieldIndex?Ks.sketch({dom:C('<div class="${prefix}-serialised-dialog-screen"></div>'),components:[s(-1,"previous",0<e),t.field(n.name,n.spec),s(1,"next",e<u.maxFieldIndex)]}):t.field(n.name,n.spec)})})],formBehaviours:O([Br(function(n,e){var t=e;ai(n.element,"."+Mn("serialised-dialog-chain")).each(function(n){Dn(n,"left",-u.state.currentScreen.get()*t.width+"px")})}),T.config({mode:"special",focusIn:function(n,e){l(n)},onTab:function(n,e){return f(n,1),On.some(!0)},onShiftTab:function(n,e){return f(n,-1),On.some(!0)}}),Za("form-events",[Zo(function(e,n){u.state.currentScreen.set(0),u.state.dialogSwipeState.clear();var t=a.get(e);x.highlightFirst(t),u.getInitialValue(e).each(function(n){E.setValue(e,n)})}),qo(u.onExecute),w(he(),function(n,e){"left"===e.event.raw.propertyName&&l(n)}),w(i,function(n,e){f(n,e.event.direction)})])])}})(e),e=xn(e.record(),function(n){return Zu({name:n,pname:us(n)})}),fc("form",uf,e,Ps,n))),a=ka({dom:C('<div class="${prefix}-dot-container"></div>'),behaviours:O([x.config({highlightClass:Mn("dot-active"),itemClass:Mn("dot-item")})]),components:Z(u.fields,function(n,e){return e<=u.maxFieldIndex?[mc('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')]:[]})}),{dom:C('<div class="${prefix}-serializer-wrapper"></div>'),components:[c.asSpec(),a.asSpec()],behaviours:O([T.config({mode:"special",focusIn:function(n){n=c.get(n);T.focusIn(n)}}),Za("serializer-wrapper-events",[w(re(),function(n,e){e=e.event;u.state.dialogSwipeState.set({xValue:e.raw.touches[0].clientX,points:[]})}),w(ie(),function(n,r){var i=r.event;u.state.dialogSwipeState.on(function(n){var e,t,o;r.event.prevent(),u.state.dialogSwipeState.set((n=n,(e=i.raw.touches[0].clientX)===n.xValue?n:(o={direction:t=0<e-n.xValue?1:-1,xValue:e},{xValue:e,points:(0===n.points.length?[]:n.points[n.points.length-1].direction===t?n.points.slice(0,n.points.length-1):n.points).concat([o])})))})}),w(ue(),function(t,n){u.state.dialogSwipeState.on(function(n){var e;f(c.get(t),-1*(0===n.points.length?0:(e=n.points[0].direction,n=n.points[n.points.length-1].direction,-1===e&&-1===n?-1:1===e&&1===n?1:0)))})})])])})]}];var n,t,e,i,u,c,a;function s(e,n,t){return Aa.sketch({dom:C('<span class="${prefix}-icon-'+n+' ${prefix}-icon"></span>'),action:function(n){dn(n,i,{direction:e})},buttonBehaviours:O([rf.config({disableClass:Mn("toolbar-navigation-disabled"),disabled:function(){return!t}})])})}function f(n,o){var r=qr(n.element,"."+Mn("serialised-dialog-screen"));ai(n.element,"."+Mn("serialised-dialog-chain")).each(function(t){0<=u.state.currentScreen.get()+o&&u.state.currentScreen.get()+o<r.length&&($r(t,"left").each(function(n){var n=parseInt(n,10),e=kc(r[0]);Dn(t,"left",n-o*e+"px")}),u.state.currentScreen.set(u.state.currentScreen.get()+o))})}function l(t){var n=qr(t.element,"input"),n=(On.from(n[u.state.currentScreen.get()]).each(function(n){t.getSystem().getByDom(n).each(function(n){var e=t,n=n.element;e.getSystem().triggerFocus(n,e.element)})}),a.get(t));x.highlightAt(n,u.state.currentScreen.get())}})),ni=S([{key:be(),value:Ro({can:function(n,e){var t,e=e.event,o=e.originator,e=e.target;return!(Sn(t=o,n.element)&&!Sn(t,e)&&(console.warn(be()+" did not get interpreted by the desired target. \nOriginator: "+Xo(o)+"\nTarget: "+Xo(e)+"\nCheck the "+be()+" event handlers"),1))}})}]),af=Object.freeze({__proto__:null,events:ni}),sf=yn,ff=cs(),e="alloy.base.behaviour",lf=wo([Oo("dom","dom",At(),wo([b("tag"),y("styles",{}),y("classes",[]),y("attributes",{}),i("value"),i("innerHtml")])),b("components"),b("uid"),y("events",{}),y("apis",{}),Oo("eventOrder","eventOrder",((t={})[Se()]=["disabling",e,"toggling","typeaheadevents"],t[be()]=[e,"focusing","keying"],t[Ce()]=[e,"disabling","toggling","representing"],t[me()]=[e,"representing","streaming","invalidating"],t[De()]=[e,"representing","item-events","tooltipping"],t[ce()]=["focusing",e,"item-type-events"],t[re()]=["focusing",e,"item-type-events"],t[fe()]=["item-type-events","tooltipping"],t[we()]=["receiving","reflecting","tooltipping"],zt(M(t))),So()),i("domModification")]),df=Fa,mf=function(o){return v(o,Ma).getOrThunk(function(){var n=Mt(o,"uid")?o:D({uid:df("")},o),n=sf(n),e=n.events,n=r(n,["events"]),t=xn(v(n,"components").getOr([]),mf),n=D(D({},n),{events:D(D({},af),e),components:t});return F.value(gs(n)).getOrDie()})},gf=uc,pf="alloy.item-hover",hf="alloy.item-focus",vf=M(pf),bf=M(hf),Iu=[b("data"),b("components"),b("dom"),y("hasSubmenu",!1),i("toggling"),ju("itemBehaviours",[k,ti,T,E]),y("ignoreFocus",!1),y("domModification",{}),u("builder",function(n){return{dom:n.dom,domModification:D(D({},n.domModification),{attributes:D(D(D({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Uu(n.itemBehaviours,[n.toggling.fold(k.revoke,function(n){return k.config(D({aria:{mode:"checked"}},n))}),ti.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){vs(n)}}),T.config({mode:"execution"}),E.config({store:{mode:"memory",initialValue:n.data}}),Za("item-type-events",c(c([],Nr(),!0),[w(fe(),hs),w(Oe(),ti.focus)],!1))]),components:n.components,eventOrder:n.eventOrder}}),y("eventOrder",{})],ur=[b("dom"),b("components"),u("builder",function(n){return{dom:n.dom,components:n.components,events:S([w(Oe(),function(n,e){e.stop()})])}})],yf=M("item-widget"),xf=M([Zu({name:"widget",overrides:function(e){return{behaviours:O([E.config({store:{mode:"manual",getValue:function(n){return e.data},setValue:bn}})])}}})]),wf=Jt("type",{widget:[b("uid"),b("data"),b("components"),b("dom"),y("autofocus",!1),y("ignoreFocus",!1),ju("widgetBehaviours",[E,ti,T]),y("domModification",{}),ic(xf()),u("builder",function(t){function o(n){return oc(n,t,"widget").map(function(n){return T.focusIn(n),n})}function n(n,e){return ji(e.event.target)||t.autofocus&&e.setSource(n.element),On.none()}var e=ec(yf(),t,xf()),e=tc(yf(),t,e.internals());return{dom:t.dom,components:e,domModification:t.domModification,events:S([qo(function(n,e){o(n).each(function(n){e.stop()})}),w(fe(),hs),w(Oe(),function(n,e){t.autofocus?o(n):ti.focus(n)})]),behaviours:Uu(t.widgetBehaviours,[E.config({store:{mode:"memory",initialValue:t.data}}),ti.config({ignore:t.ignoreFocus,onFocus:function(n){vs(n)}}),T.config({mode:"special",focusIn:t.autofocus?function(n){o(n)}:cr(),onLeft:n,onRight:n,onEscape:function(n,e){return ti.isFocused(n)||t.autofocus?(t.autofocus&&e.setSource(n.element),On.none()):(ti.focus(n),On.some(!0))}})])}})],item:Iu,separator:ur}),Hu=M([Gu({factory:{sketch:function(n){n=Kt("menu.spec item",wf,n);return n.builder(n)}},name:"items",unit:"item",defaults:function(n,e){return Mt(e,"uid")?e:D(D({},e),{uid:Fa("item")})},overrides:function(n,e){return{type:e.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),zu=M([b("value"),b("items"),b("dom"),b("components"),y("eventOrder",{}),Eu("menuBehaviours",[x,E,Ys,T]),oo("movement",{mode:"menu",moveOnTab:!0},Jt("mode",{grid:[Qr(),u("config",function(n,e){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:e.initSize.numColumns,numRows:e.initSize.numRows},focusManager:n.focusManager}})],matrix:[u("config",function(n,e){return{mode:"matrix",selectors:{row:e.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}}),b("rowSelector")],menu:[y("moveOnTab",!0),u("config",function(n,e){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:e.moveOnTab,focusManager:n.focusManager}})]})),Qt("markers",Jr()),y("fakeFocus",!1),y("focusManager",Oi()),Or("onHighlight")]),Sf=M("alloy.menu-focus"),Of=dc({name:"Menu",configFields:zu(),partFields:Hu(),factory:function(n,e,t,o){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Du(n.menuBehaviours,[x.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),E.config({store:{mode:"memory",initialValue:n.value}}),Ys.config({find:On.some}),T.config(n.movement.config(n,n.movement))]),events:S([w(bf(),function(e,t){var n=t.event;e.getSystem().getByDom(n.target).each(function(n){x.highlight(e,n),t.stop(),dn(e,Sf(),{menu:e,item:n})})}),w(vf(),function(n,e){e=e.event.item;x.highlight(n,e)})]),components:e,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),kf=jo({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(n,e,t,o){bs(n,0,bt,o)},prepend:function(n,e,t,o){bs(n,0,ze,o)},remove:ys,replaceAt:xs,replaceBy:function(e,n,t,o,r){return J(js(e),o).bind(function(n){return xs(e,0,0,n,r)})},set:function(r,n,e,i){var t=function(){var e,n,t=xn(i,r.getSystem().build),o=(e=r).components();wn((n=e).components(),function(n){yt(n.element)}),Le(n.element),n.syncComponents(),wn(tn(o,t),function(n){Ot(n),e.getSystem().removeFromWorld(n)}),wn(t,function(n){n.getSystem().isConnected()?We(e,n):(e.getSystem().addToWorld(n),We(e,n),St(e.element)&&kt(n)),e.syncComponents()})},u=r.element,o=wt(u),c=Go(o).bind(function(e){function n(n){return Sn(e,n)}var o,r;return n(u)?On.some(u):(o=n,(r=function(n){for(var e=0;e<n.childNodes.length;e++){var t=kn.fromDom(n.childNodes[e]);if(o(t))return On.some(t);t=r(n.childNodes[e]);if(t.isSome())return t}return On.none()})(u.dom))});t(),c.each(function(e){Go(o).filter(function(n){return Sn(n,e)}).fold(function(){Lo(e)},bn)})},contents:js})}),Tf=function(t,o,r,n){return v(r,n).bind(function(n){return v(t,n).bind(function(n){var e=Tf(t,o,r,n);return On.some([n].concat(e))})}).getOr([])},Cf=zs,Ef=M("collapse-item"),Df=lc({name:"TieredMenu",configFields:[Cr("onExecute"),Cr("onEscape"),Tr("onOpenMenu"),Tr("onOpenSubmenu"),Or("onRepositionMenu"),Or("onCollapseMenu"),y("highlightImmediately",!0),Zt("data",[b("primary"),b("menus"),b("expansions")]),y("fakeFocus",!1),Or("onHighlight"),Or("onHover"),Zt("markers",[b("backgroundMenu")].concat(xr()).concat(wr())),b("dom"),y("navigateOnHover",!0),y("stayInDom",!1),Eu("tmenuBehaviours",[T,x,Ys,kf]),y("eventOrder",{})],apis:{collapseMenu:function(n,e){n.collapseMenu(e)},highlightPrimary:function(n,e){n.highlightPrimary(e)},repositionMenus:function(n,e){n.repositionMenus(e)}},factory:function(a,n){function t(n){o=n,r=a.data.primary;var o,r,n=Ye(a.data.menus,function(n,e){function t(){return Of.sketch(D(D({},n),{value:e,markers:a.markers,fakeFocus:a.fakeFocus,onHighlight:a.onHighlight,focusManager:(a.fakeFocus?function(){function o(n){return x.getHighlighted(n).map(function(n){return n.element})}return{get:o,set:function(e,n){var t=o(e),n=(e.getSystem().getByDom(n).fold(bn,function(n){x.highlight(e,n)}),o(e));Si(e,t,n)}}}:Oi)()}))}return e===r?{type:"prepared",menu:o.getSystem().build(t())}:{type:"notbuilt",nbMenu:t}}),e=Ye(a.data.menus,function(n,e){return Z(n.items,function(n){return"separator"===n.type?[]:[n.data.value]})});return d.setContents(a.data.primary,n,a.data.expansions,e),d.getPrimary()}function r(n){return E.getValue(n).value}function i(e,n){x.highlight(e,n),x.getHighlighted(n).orThunk(function(){return x.getFirst(n)}).each(function(n){gn(e,n.element,Oe())})}function u(e,n){return Do(xn(n,function(n){return e.lookupMenu(n).bind(function(n){return"prepared"===n.type?On.some(n.menu):On.none()})}))}function c(e,n,t){wn(u(n,n.otherMenus(t)),function(n){ds(n.element,[a.markers.backgroundMenu]),a.stayInDom||kf.remove(e,n)})}function s(n,t){var e;qe((e=n,o.get().getOrThunk(function(){var t={};return wn(X(qr(e.element,"."+a.markers.item),function(n){return"true"===Cn(n,"aria-haspopup")}),function(n){e.getSystem().getByDom(n).each(function(n){var e=r(n);t[e]=n})}),o.set(t),t})),function(n,e){e=U(t,e);Tn(n.element,"aria-expanded",e)})}function f(e,t,o){return On.from(o[0]).bind(function(n){return t.lookupMenu(n).bind(function(n){return"notbuilt"===n.type?On.none():(n=n.menu,wn(u(t,o.slice(1)),function(n){it(n.element,a.markers.backgroundMenu)}),St(n.element)||kf.append(e,gf(n)),ds(n.element,[a.markers.backgroundMenu]),i(e,n),c(e,t,o),On.some(n))})})}var l,o=Xi(),d=Ls();function m(i,u,c){var n;return void 0===c&&(c=l.HighlightSubmenu),u.hasConfigured(rf)&&rf.isDisabled(u)?On.some(u):(n=r(u),d.expand(n).bind(function(r){return s(i,r),On.from(r[0]).bind(function(o){return d.lookupMenu(o).bind(function(n){e=i,t=o;var e,t,n="notbuilt"!==(n=n).type?n.menu:(e=e.getSystem().build(n.nbMenu()),d.setMenuBuilt(t,e),e);return St(n.element)||kf.append(i,gf(n)),a.onOpenSubmenu(i,u,n,en(r)),c===l.HighlightSubmenu?(x.highlightFirst(n),f(i,d,r)):(x.dehighlightAll(n),On.some(u))})})}))}function g(e,t){var n=r(t);return d.collapse(n).bind(function(n){return s(e,n),f(e,d,n).map(function(n){return a.onCollapseMenu(e,t,n),n})})}function e(t){return function(e,n){return si(n.getSource(),"."+a.markers.item).bind(function(n){return e.getSystem().getByDom(n).toOptional().bind(function(n){return t(e,n).map(R)})})}}function p(n){return x.getHighlighted(n).bind(x.getHighlighted)}l={HighlightSubmenu:0,0:"HighlightSubmenu",HighlightParent:1,1:"HighlightParent"};var h=S([w(Sf(),function(e,t){var n=t.event.item;d.lookupItem(r(n)).each(function(){var n=t.event.menu,n=(x.highlight(e,n),r(t.event.item));d.refresh(n).each(function(n){return c(e,d,n)})})}),qo(function(e,n){n=n.event.target;e.getSystem().getByDom(n).each(function(n){0===r(n).indexOf("collapse-item")&&g(e,n),m(e,n,l.HighlightSubmenu).fold(function(){a.onExecute(e,n)},bn)})}),Zo(function(e,n){t(e).each(function(n){kf.append(e,gf(n)),a.onOpenMenu(e,n),a.highlightImmediately&&i(e,n)})})].concat(a.navigateOnHover?[w(vf(),function(n,e){var e=e.event.item,t=n,o=r(e);d.refresh(o).bind(function(n){return s(t,n),f(t,d,n)}),m(n,e,l.HighlightParent),a.onHover(n,e)})]:[])),v={collapseMenu:function(e){p(e).each(function(n){g(e,n)})},highlightPrimary:function(e){d.getPrimary().each(function(n){i(e,n)})},repositionMenus:function(t){d.getPrimary().bind(function(e){return p(t).bind(function(n){var n=r(n),t=Do(xn(Ke(d.getMenus(),yn),Cf));return d.getTriggeringPath(n,function(n){return e=n,rn(t,function(n){return n.getSystem().isConnected()?K(x.getCandidates(n),function(n){return r(n)===e}):On.none()});var e})}).map(function(n){return{primary:e,triggeringPath:n}})}).fold(function(){On.from(t.components()[0]).filter(function(n){return"menu"===Cn(n.element,"role")}).each(function(n){a.onRepositionMenu(t,n,[])})},function(n){var e=n.primary,n=n.triggeringPath;a.onRepositionMenu(t,e,n)})}};return{uid:a.uid,dom:a.dom,markers:a.markers,behaviours:Du(a.tmenuBehaviours,[T.config({mode:"special",onRight:e(function(n,e){return ji(e.element)?On.none():m(n,e,l.HighlightSubmenu)}),onLeft:e(function(n,e){return ji(e.element)?On.none():g(n,e)}),onEscape:e(function(n,e){return g(n,e).orThunk(function(){return a.onEscape(n,e).map(function(){return n})})}),focusIn:function(e,n){d.getPrimary().each(function(n){gn(e,n.element,Oe())})}}),x.config({highlightClass:a.markers.selectedMenu,itemClass:a.markers.menu}),Ys.config({find:function(n){return x.getHighlighted(n)}}),kf.config({})]),eventOrder:a.eventOrder,apis:v,events:h}},extraApis:{tieredData:function(n,e,t){return{primary:n,menus:e,expansions:t}},singleData:function(n,e){return{primary:n,menus:To(n,e),expansions:{}}},collapseItem:function(n){return{value:_u(Ef()),meta:{text:n}}}}}),Vu=Object.freeze({__proto__:null,findRoute:ws,disableTransition:Ss,getCurrentRoute:Gs,jumpTo:Os,progressTo:function(e,t,o,r){var i,u=t;et((i=e).element,u.destinationAttr)&&(nt(i.element,u.destinationAttr).each(function(n){Tn(i.element,u.stateAttr,n)}),tt(i.element,u.destinationAttr));n=r;var n={start:Cn(e.element,t.stateAttr),destination:n};$s(0,t,0,n).fold(function(){Os(e,t,o,r)},function(n){Ss(e,t,o);n=n.transition;it(e.element,n.transitionClass),Tn(e.element,t.destinationAttr,r)})},getState:function(n,e,t){return nt(n.element,e.stateAttr)}}),Lu=Object.freeze({__proto__:null,events:function(r,i){return S([w(he(),function(t,n){var o=n.event.raw;Gs(t,r).each(function(e){ws(0,r,0,e).each(function(n){n.transition.each(function(n){o.propertyName===n.property&&(Os(t,r,i,e.destination),r.onTransition(t,e))})})})}),Zo(function(n,e){Os(n,r,i,r.initialState)})])}}),Mf=jo({fields:[y("destinationAttr","data-transitioning-destination"),y("stateAttr","data-transitioning-state"),b("initialState"),Or("onTransition"),Or("onFinish"),Qt("routes",Xt(F.value,Xt(F.value,Ut([to("transition",[b("property"),b("transitionClass")])]))))],name:"transitioning",active:Lu,apis:Vu,extra:{createRoutes:function(n){var t={};return qe(n,function(n,e){e=e.split("<->");t[e[0]]=To(e[1],n),t[e[1]]=To(e[0],n)}),t},createBistate:function(n,e,t){return Co([{key:n,value:To(e,t)},{key:e,value:To(n,t)}])},createTristate:function(n,e,t,o){return Co([{key:n,value:Co([{key:e,value:o},{key:t,value:o}])},{key:e,value:Co([{key:n,value:o},{key:t,value:o}])},{key:t,value:Co([{key:n,value:o},{key:e,value:o}])}])}}}),_f=Mn("scrollable"),Rf=_f,Ff=function(n,e,t,o,r){return{data:{value:n,text:e},type:"item",dom:{tag:"div",classes:r?[Mn("styles-item-is-menu")]:[]},toggling:{toggleOnExecute:!1,toggleClass:Mn("format-matches"),selected:t},itemBehaviours:O(r?[]:[Vr(n,function(n,e){(e?k.on:k.off)(n)})]),components:[{dom:{tag:"div",attributes:{style:o},innerHtml:e}}]}},If=function(n,e,t,o){return{value:n,dom:{tag:"div"},components:[Aa.sketch({dom:{tag:"div",classes:[Mn("styles-collapser")]},components:o?[{dom:{tag:"span",classes:[Mn("styles-collapse-icon")]}},ps(n)]:[ps(n)],action:function(n){o&&(n=t().get(n),Df.collapseMenu(n))}}),{dom:{tag:"div",classes:[Mn("styles-menu-items-container")]},components:[Of.parts.items({})],behaviours:O([Za("adhoc-scrollable-menu",[Zo(function(n,e){Dn(n.element,"overflow-y","auto"),Dn(n.element,"-webkit-overflow-scrolling","touch"),ks(n.element)}),nr(function(n){Gr(n.element,"overflow-y"),Gr(n.element,"-webkit-overflow-scrolling"),Ts(n.element)})])])}],items:e,menuBehaviours:O([Mf.config({initialState:"after",routes:Mf.createTristate("before","current","after",{transition:{property:"transform",transitionClass:"transitioning"}})})])}},Vf=function(n){return q(n,function(n,e){var t,o,r,i,u=Je(e=e,"items")?(u=vo((t=["items"],o={},qe(r=e,function(n,e){U(t,e)||(o[e]=n)}),o),{menu:!0}),i=Vf(r.items),{item:u,menus:vo(i.menus,To(r.title,i.items)),expansions:vo(i.expansions,To(r.title,r.title))}):{item:e,menus:{},expansions:{}};return{menus:vo(n.menus,u.menus),items:[u.item].concat(n.items),expansions:vo(n.expansions,u.expansions)}},{menus:{},expansions:{},items:[]})},Bf=function(n){return Z(n,function(n){return(V(n)?Bf:Es)(n)})},Af=R,Nf=tinymce.util.Tools.resolve("tinymce.util.Delay"),Hf=ro([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]);function Pf(n,e){var t=Ie(n);return"input"===t?Ll.after(n):U(["br","img"],t)?0===e?Ll.before(n):Ll.after(n):Ll.on(n,e)}function zf(n){return On.from(n.getSelection())}function jf(n,e,t,o,r){var i=Bs(n,e,t,o,r);zf(n).each(function(n){n.removeAllRanges(),n.addRange(i)})}function Lf(n){var e;return 0<n.rangeCount?(e=n.getRangeAt(0),n=n.getRangeAt(n.rangeCount-1),On.some(Al(kn.fromDom(e.startContainer),e.startOffset,kn.fromDom(n.endContainer),n.endOffset))):On.none()}function $f(n){var e,t,o,r,i,u,c,a,s,f,l;return null!==n.anchorNode&&null!==n.focusNode&&(o=kn.fromDom(n.anchorNode),r=kn.fromDom(n.focusNode),s=u=n.anchorOffset,f=c=r,l=a=n.focusOffset,(e=Be(t=i=o).dom.createRange()).setStart(t.dom,s),e.setEnd(f.dom,l),t=e,s=Sn(i,c)&&u===a,t.collapsed)&&!s?On.some(Al(o,n.anchorOffset,r,n.focusOffset)):Lf(n)}function Gf(n){return zf(n).filter(function(n){return 0<n.rangeCount}).bind($f)}function Uf(n,e){var i,e=(n=Hs(i=n,e).match({ltr:function(n,e,t,o){var r=i.document.createRange();return r.setStart(n.dom,e),r.setEnd(t.dom,o),r},rtl:function(n,e,t,o){var r=i.document.createRange();return r.setStart(t.dom,o),r.setEnd(n.dom,e),r}})).getClientRects();return 0<(e=0<e.length?e[0]:n.getBoundingClientRect()).width||0<e.height?On.some(e).map(As):On.none()}function Wf(n){return On.from(n.dom.contentWindow)}function Xf(n){return Wf(n).bind(Gf)}function qf(n){return n.getFrame()}function Yf(n,e,t,o){return n[t].getOrThunk(function(){return function(n){return _n(e,o,n)}})}function Kf(c){var a=qf(c);return On.some(kn.fromDom(a.dom.contentWindow.document.body)).bind(function(u){return On.some(kn.fromDom(a.dom.contentWindow.document)).bind(function(r){return Wf(a).map(function(i){var n=kn.fromDom(r.dom.documentElement),e=c.getCursorBox.getOrThunk(function(){return function(){return Gf(i).map(function(n){return Gl.exact(n.start,n.soffset,n.finish,n.foffset)}).bind(function(n){return Uf(i,n).orThunk(function(){return Gf(i).filter(function(n){return Sn(n.start,n.finish)&&n.soffset===n.foffset}).bind(function(n){n=n.start.dom.getBoundingClientRect();return 0<n.width||0<n.height?On.some(n):On.none()})})})}}),t=c.setSelection.getOrThunk(function(){return function(n,e,t,o){var r,a;r=i,t=t=t,o=o=o,n=Pf(n=n,e=e),e=Pf(t,o),t=Gl.relative(n,e),Hs(a=r,t).match({ltr:function(n,e,t,o){jf(a,n,e,t,o)},rtl:function(r,i,u,c){zf(a).each(function(n){if(n.setBaseAndExtent)n.setBaseAndExtent(r.dom,i,u.dom,c);else if(n.extend)try{t=u,o=c,(e=n).collapse(r.dom,i),e.extend(t.dom,o)}catch(n){jf(a,u,c,r,i)}else jf(a,u,c,r,i);var e,t,o})}})}}),o=c.clearSelection.getOrThunk(function(){return function(){zf(i).each(function(n){return n.removeAllRanges()})}});return{body:u,doc:r,win:i,html:n,getSelection:Rn(Xf,a),setSelection:t,clearSelection:o,frame:a,onKeyup:Yf(c,r,"onKeyup","keyup"),onNodeChanged:Yf(c,r,"onNodeChanged","SelectionChange"),onDomChanged:c.onDomChanged,onScrollToCursor:c.onScrollToCursor,onScrollToElement:c.onScrollToElement,onToReading:c.onToReading,onToEditing:c.onToEditing,onToolbarScrollStart:c.onToolbarScrollStart,onTouchContent:c.onTouchContent,onTapContent:c.onTapContent,onTouchToolstrip:c.onTouchToolstrip,getCursorBox:e}})})})}function Jf(){var e=In("head").getOrDie(),n=In('meta[name="viewport"]').getOrThunk(function(){var n=kn.fromTag("meta");return Tn(n,"name","viewport"),bt(e,n),n}),t=Cn(n,"content");return{maximize:function(){Tn(n,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){null!=t&&0<t.length?Tn(n,"content",t):Tn(n,"content","user-scalable=yes")}}}function Qf(n,e){function t(t){return function(n){var e=Cn(n,"style"),e=void 0===e?"no-styles":e.trim();e!==t&&(Tn(n,Ul,e),Tn(n,"style",t))}}o=function(n){return pn(n,"*")};var o=X(function(n){for(var e=N(void 0)?void 0:_,t=n.dom,o=[];null!==t.parentNode&&void 0!==t.parentNode;){var r=t.parentNode,i=kn.fromDom(r);if(o.push(i),!0===e(i))break;t=r}return o}(n),o),r=Z(o,function(n){return e=function(n){return pn(n,"*")},X(Ne(t=n).map(vt).map(function(n){return X(n,function(n){return!Sn(t,n)})}).getOr([]),e);var e,t}),e=void 0!==(e=Lr(e,"background-color"))&&""!==e?"background-color:"+e+"!important":"background-color:rgb(255,255,255)!important;";wn(r,t("display:none!important;")),wn(o,t(Wl+Xl+e)),t((!0===ql?"":Wl)+Xl+e)(n)}function Zf(){wn(vn("["+Ul+"]"),function(n){var e=Cn(n,Ul);"no-styles"!==e?Tn(n,"style",e):tt(n,"style"),tt(n,Ul)})}function nl(n){n=n.raw;return void 0===n.touches||1!==n.touches.length?On.none():On.some(n.touches[0])}function el(t){var o,r,i=Xi(),u=En(!1),c=(o=function(n){t.triggerEvent(Te(),n),u.set(!0)},r=null,{cancel:function(){null!==r&&(clearTimeout(r),r=null)},schedule:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];r=setTimeout(function(){o.apply(null,n),r=null},400)}}),a=Co([{key:re(),value:function(e){return nl(e).each(function(n){c.cancel();n={x:n.clientX,y:n.clientY,target:e.target};c.schedule(e),u.set(!1),i.set(n)}),On.none()}},{key:ie(),value:function(n){return c.cancel(),nl(n).each(function(o){i.on(function(n){var e=o,t=Math.abs(e.clientX-n.x),e=Math.abs(e.clientY-n.y);(5<t||5<e)&&i.clear()})}),On.none()}},{key:ue(),value:function(e){return c.cancel(),i.get().filter(function(n){return Sn(n.target,e.target)}).map(function(n){return u.get()?(e.prevent(),!1):t.triggerEvent(ke(),e)})}}]);return{fireIfReady:function(e,n){return v(a,n).bind(function(n){return n(e)})}}}function tl(t){var e=el({triggerEvent:function(n,e){t.onTapContent(e)}});return{fireTouchstart:function(n){e.fireIfReady(n,"touchstart")},onTouchend:function(){return _n(t.body,"touchend",function(n){e.fireIfReady(n,"touchend")})},onTouchmove:function(){return _n(t.body,"touchmove",function(n){e.fireIfReady(n,"touchmove")})}}}function ol(n,e){n=parseInt(Cn(n,e),10);return isNaN(n)?0:n}function rl(n){return D(D({},n),{width:2})}function il(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}}function ul(n){var t,o,n=n.getSelection();return void 0!==n&&0<n.rangeCount?(t=n.getRangeAt(0)).collapsed?Ne(o=kn.fromDom(t.startContainer)).bind(function(n){var e,n=Gl.exact(o,t.startOffset,n,"img"===Ie(e=n)?1:jl.getOption(e).fold(function(){return vt(e).length},function(n){return n.length}));return Uf(t.startContainer.ownerDocument.defaultView,n).map(rl).map(on)}).getOr([]):xn(t.getClientRects(),il):[]}function cl(n,e){Tn(n,Kl,e)}function al(n){return{top:n.top,bottom:n.top+n.height}}function sl(t,o){var r=kn.fromDom(o.document.body),n=_n(kn.fromDom(t),"resize",function(){var n=t,e=ol(r,Kl);((n=n.innerHeight)<e?On.some(e-n):On.none()).each(function(e){var n;(0<(n=ul(o)).length?On.some(n[0]).map(al):On.none()).each(function(n){n=n.top>o.innerHeight||n.bottom>o.innerHeight?Math.min(e,n.bottom-o.innerHeight+50):0;0!==n&&o.scrollTo(o.pageXOffset,o.pageYOffset+n)})}),cl(r,t.innerHeight)});return cl(r,t.innerHeight),{toEditing:function(){var n,e;(n=o).focus(),e=kn.fromDom(n.document.body),(Go().exists(function(n){return U(["input","textarea"],Ie(n))})?function(n){Nf.setTimeout(function(){n()},0)}:z)(function(){Go().each($o),Lo(e)})},destroy:function(){n.unbind()}}}function fl(t,o){function r(){h(i)||(clearTimeout(i),i=null)}var i=null;return{cancel:r,throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];r(),i=setTimeout(function(){i=null,t.apply(null,n)},o)}}}function ll(n){var t,o,e=ka(Ks.sketch({dom:C('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'),containerBehaviours:O([k.config({toggleClass:Mn("mask-tap-icon-selected"),toggleOnExecute:!1})])})),r=(t=n,o=null,{cancel:function(){h(o)||(clearTimeout(o),o=null)},throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];h(o)&&(o=setTimeout(function(){o=null,t.apply(null,n)},200))}});return Ks.sketch({dom:C('<div class="${prefix}-disabled-mask"></div>'),components:[Ks.sketch({dom:C('<div class="${prefix}-content-container"></div>'),components:[Aa.sketch({dom:C('<div class="${prefix}-content-tap-section"></div>'),components:[e.asSpec()],action:function(n){r.throttle()},buttonBehaviours:O([k.config({toggleClass:Mn("mask-tap-icon-selected")})])})]})]})}function dl(n){var e=Kt("Getting AndroidWebapp schema",Jl,n),t=(Dn(e.toolstrip,"width","100%"),mf(ll(function(){e.setReadOnly(e.readOnlyOnInit()),u.enter()},e.translate))),n=(e.alloy.add(t),{show:function(){e.alloy.add(t)},hide:function(){e.alloy.remove(t)}});bt(e.container,t.element);s=e,o=n,r=Jf(),i=Wi(),f=Wi();var s,o,r,i,f,u={enter:function(){var e;o.hide(),it(s.container,Mn("fullscreen-maximized")),it(s.container,Mn("android-maximized")),r.maximize(),it(s.body,Mn("android-scroll-reload")),i.set(sl(s.win,(e=s.editor).getWin.getOrThunk(function(){var n=qf(e);return function(){return zl(n)}})().getOrDie("no"))),Kf(s.editor).each(function(n){function e(n){return!Sn(n.start,n.finish)||n.soffset!==n.foffset}function t(){var n=o.doc.dom.hasFocus()&&o.getSelection().exists(e);i.getByDom(r).each(!0===(n||Go(c).filter(function(n){return"input"===Ie(n)}).exists(function(n){return n.dom.selectionStart!==n.dom.selectionEnd}))?k.on:k.off)}var o,r,i,u,c,a;Qf(s.container,n.body),f.set((o=n,r=s.toolstrip,i=s.alloy,u=tl(o),c=Be(r),a=[_n(o.body,"touchstart",function(n){o.onTouchContent(),u.fireTouchstart(n)}),u.onTouchmove(),u.onTouchend(),_n(r,"touchstart",function(n){o.onTouchToolstrip()}),o.onToReading(function(){$o(o.body)}),o.onToEditing(bn),o.onScrollToCursor(function(n){n.preventDefault(),o.getCursorBox().each(function(n){var e=o.win,n=n.top>e.innerHeight||n.bottom>e.innerHeight?n.bottom-e.innerHeight+50:0;0!=n&&e.scrollTo(e.pageXOffset,e.pageYOffset+n)})})].concat(1==Yl?[]:[_n(kn.fromDom(o.win),"blur",function(){i.getByDom(r).each(k.off)}),_n(c,"select",t),_n(o.doc,"selectionchange",t)]),{destroy:function(){wn(a,function(n){n.unbind()})}}))})},exit:function(){r.restore(),o.show(),ut(s.container,Mn("fullscreen-maximized")),ut(s.container,Mn("android-maximized")),Zf(),ut(s.body,Mn("android-scroll-reload")),f.clear(),i.clear()}};return{setReadOnly:e.setReadOnly,refreshStructure:bn,enter:u.enter,exit:u.exit,destroy:bn}}function ml(n){return"true"===Cn(n,nd)?0<n.dom.scrollLeft||((e=n).dom.scrollLeft=1,t=0!==e.dom.scrollLeft,e.dom.scrollLeft=0,t):0<n.dom.scrollTop||((e=n).dom.scrollTop=1,t=0!==e.dom.scrollTop,e.dom.scrollTop=0,t);var e,t}function gl(){function e(n){var e=!0===n.scrollable?"${prefix}-toolbar-scrollable-group":"";return{dom:C('<div aria-label="'+n.label+'" class="${prefix}-toolbar-group '+e+'"></div>'),tgroupBehaviours:O([Za("adhoc-scrollable-toolbar",!0===n.scrollable?[er(function(n,e){Dn(n.element,"overflow-x","auto"),Tn(n.element,nd,"true"),ks(n.element)})]:[])]),components:[Ks.sketch({components:[Zl.parts.items({})]})],markers:{itemSelector:"."+Mn("toolbar-group-item")},items:n.items}}function t(){Ql.setGroups(o,r.get()),k.off(o)}var o=mf(Ql.sketch({dom:C('<div class="${prefix}-toolbar"></div>'),components:[Ql.parts.groups({})],toolbarBehaviours:O([k.config({toggleClass:Mn("context-toolbar"),toggleOnExecute:!1,aria:{mode:"none"}}),T.config({mode:"cyclic"})]),shell:!0})),n=mf(Ks.sketch({dom:{classes:[Mn("toolstrip")]},components:[gf(o)],containerBehaviours:O([k.config({toggleClass:Mn("android-selection-context-toolbar"),toggleOnExecute:!1})])})),r=En([]);return{wrapper:n,toolbar:o,createGroups:function(n){return xn(n,d(Zl.sketch,e))},setGroups:function(n){r.set(n),t()},setContextToolbar:function(n){k.on(o),Ql.setGroups(o,n)},restoreToolbar:function(){k.isOn(o)&&t()},refresh:function(){},focus:function(){T.focusIn(o)}}}function pl(n){return mf(Aa.sketch({dom:C('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'),action:function(){n.run(function(n){n.setReadOnly(!1)})}}))}function hl(){return mf(Ks.sketch({dom:C('<div class="${prefix}-editor-socket"></div>'),components:[],containerBehaviours:O([kf.config({})])}))}function vl(n,e,t,o){(!0===t?ar.toAlpha:ar.toOmega)(o),(t?function(n,e){kf.append(n,gf(e))}:function(n,e){kf.remove(n,e)})(n,e)}function bl(e,n){return n.getAnimationRoot.fold(function(){return e.element},function(n){return n(e)})}function yl(n){return n.dimension.property}function xl(n,e){return n.dimension.getDimension(e)}function wl(n,e){ds(bl(n,e),[e.shrinkingClass,e.growingClass])}function Sl(n,e){ut(n.element,e.openClass),it(n.element,e.closedClass),Dn(n.element,yl(e),"0px"),Ur(n.element)}function Ol(n,e){ut(n.element,e.closedClass),it(n.element,e.openClass),Gr(n.element,yl(e))}function kl(n,e,t,o){t.setCollapsed(),Dn(n.element,yl(e),xl(e,n.element)),Ur(n.element),wl(n,e),Sl(n,e),e.onStartShrink(n),e.onShrunk(n)}function Tl(n,e,t){var o=xl(e,n.element);("0px"===o?kl:function(n,e,t,o){o=o.getOrThunk(function(){return xl(e,n.element)}),t.setCollapsed(),Dn(n.element,yl(e),o),Ur(n.element),t=bl(n,e);ut(t,e.growingClass),it(t,e.shrinkingClass),Sl(n,e),e.onStartShrink(n)})(n,e,t,On.some(o))}function Cl(n,e,t){var o=bl(n,e),r=ct(o,e.shrinkingClass),i=xl(e,n.element),u=(Ol(n,e),xl(e,n.element));(r?function(){Dn(n.element,yl(e),i),Ur(n.element)}:function(){Sl(n,e)})(),ut(o,e.shrinkingClass),it(o,e.growingClass),Ol(n,e),Dn(n.element,yl(e),u),t.setExpanded(),e.onStartGrow(n)}function El(n,e,t){return!0===ct(bl(n,e),e.growingClass)}function Dl(n,e,t){return!0===ct(bl(n,e),e.shrinkingClass)}function Ml(e,t){var o=mf(Ks.sketch({dom:{tag:"div",classes:[Mn("dropup")]},components:[],containerBehaviours:O([kf.config({}),ed.config({closedClass:Mn("dropup-closed"),openClass:Mn("dropup-open"),shrinkingClass:Mn("dropup-shrinking"),growingClass:Mn("dropup-growing"),dimension:{property:"height"},onShrunk:function(n){e(),t(),kf.set(n,[])},onGrown:function(n){e(),t()}}),Br(function(n,e){r(bn)})])})),r=function(n){window.requestAnimationFrame(function(){n(),ed.shrink(o)})};return{appear:function(n,e,t){!0===ed.hasShrunk(o)&&!1===ed.isTransitioning(o)&&window.requestAnimationFrame(function(){e(t),kf.set(o,[n()]),ed.grow(o)})},disappear:r,component:o,element:o.element}}function _l(){return oe().browser.isFirefox()}function Rl(n,e){return En(v(n,"target").getOr(e))}function Fl(n,o,e,t,r,i){var u,c,n=n(o,t),a=(u=En(!1),c=En(!1),{stop:function(){u.set(!0)},cut:function(){c.set(!0)},isStopped:u.get,isCut:c.get,event:e,setSource:r.set,getSource:r.get});return n.fold(function(){return i.logEventNoHandlers(o,t),td.complete()},function(e){var t=e.descHandler;return ss(t)(a),a.isStopped()?(i.logEventStopped(o,e.element,t.purpose),td.stopped()):a.isCut()?(i.logEventCut(o,e.element,t.purpose),td.complete()):Ne(e.element).fold(function(){return i.logNoParent(o,e.element,t.purpose),td.complete()},function(n){return i.logEventResponse(o,e.element,t.purpose),td.resume(n)})})}function Il(){var i={};return{registerId:function(o,r,n){qe(n,function(n,e){var t=void 0!==i[e]?i[e]:{};t[r]={cHandler:Rn.apply(void 0,[(n=n).handler].concat(o)),purpose:n.purpose},i[e]=t})},unregisterId:function(t){qe(i,function(n,e){Mt(n,t)&&delete n[t]})},filterByType:function(n){return v(i,n).map(function(n){return Ke(n,function(n,e){return{id:e,descHandler:n}})}).getOr([])},find:function(t,n,r){return v(i,n).bind(function(o){return n=t,e=(u=function(n){return e=o,ac(t=n).bind(function(n){return v(e,n)}).map(function(n){return{element:t,descHandler:n}});var e,t})(i=r),c=Mo(n),e.orThunk(function(){if(!c(i))for(var n=u,e=i.dom,t=Mo(c);e.parentNode;){var e=e.parentNode,o=kn.fromDom(e),r=n(o);if(r.isSome())return r;if(t(o))break}return On.none()});var i,u,n,e,c})}}}function Vl(){function i(n){ac(n.element).each(function(n){delete c[n],u.unregisterId(n)})}var u=Il(),c={};return{find:function(n,e,t){return u.find(n,e,t)},filter:function(n){return u.filterByType(n)},register:function(n){var t,e=ac((t=n).element).getOrThunk(function(){return n=t.element,e=_u(_a+"uid-"),Ta(n,e),e;var n,e});if(Je(c,e)){var o=n,r=c[e];if(r!==o)throw new Error('The tagId "'+e+'" is already used by: '+Xo(r.element)+"\nCannot use it for: "+Xo(o.element)+"\nThe conflicting element is"+(St(r.element)?" ":" not ")+"already in the DOM");i(o)}u.registerId([n],e,n.events),c[e]=n},unregister:i,getById:function(n){return v(c,n)}}}function Bl(n,e,t,o,r){var i=Rl(t,o);return od(n,e,t,o,i,r)}Hf.ltr,Hf.rtl;function Al(n,e,t,o){return{start:n,soffset:e,finish:t,foffset:o}}function Nl(t){function o(e){return Ne(t.element).fold(R,function(n){return Sn(e,n)})}function a(n,e){return h.find(o,n,e)}function r(e){wn(h.filter(we()),function(n){ss(n.descHandler)(e)})}var e,n,i,u,c,s,f,l,d,m,g,p,h=Vl(),v=(e=t.element,u=D({stopBackspace:!0},n={triggerEvent:function(e,t){return hr(e,t.target,function(n){return Bl(a,e,t,t.target,n)})}}),c=el(u),s=xn(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(n){return _n(e,n,function(e){c.fireIfReady(e,n).each(function(n){n&&e.kill()}),u.triggerEvent(n,e)&&e.kill()})}),f=Xi(),l=_n(e,"paste",function(e){c.fireIfReady(e,"paste").each(function(n){n&&e.kill()}),u.triggerEvent("paste",e)&&e.kill(),f.set(setTimeout(function(){u.triggerEvent(xe(),e)},0))}),d=_n(e,"keydown",function(n){var e;u.triggerEvent("keydown",n)?n.kill():!u.stopBackspace||(e=n).raw.which!==Mi[0]||U(["input","textarea"],Ie(e.target))||si(e.target,'[contenteditable="true"]',void 0).isSome()||n.prevent()}),n=e,i=function(n){u.triggerEvent("focusin",n)&&n.kill()},m=_l()?Rs(n,"focus",i):_n(n,"focusin",i),g=Xi(),n=e,i=function(n){u.triggerEvent("focusout",n)&&n.kill(),g.set(setTimeout(function(){u.triggerEvent(ye(),n)},0))},p=_l()?Rs(n,"blur",i):_n(n,"focusout",i),{unbind:function(){wn(s,function(n){n.unbind()}),d.unbind(),m.unbind(),p.unbind(),l.unbind(),f.on(clearTimeout),g.on(clearTimeout)}}),b={debugInfo:M("real"),triggerEvent:function(e,t,o){hr(e,t,function(n){return Bl(a,e,o,t,n)})},triggerFocus:function(u,c){ac(u).fold(function(){Lo(u)},function(n){hr(be(),u,function(n){var e,t,o=a,r=be(),i=Rl(e={originator:c,kill:bn,prevent:bn,target:u},t=u);return Fl(o,r,e,t,i,n),!1})})},triggerEscape:function(n,e){b.triggerEvent("keydown",n.element,e.event)},getByUid:function(n){return C(n)},getByDom:function(n){return E(n)},build:mf,addToGui:function(n){w(n)},removeFromGui:function(n){S(n)},addToWorld:function(n){y(n)},removeFromWorld:function(n){x(n)},broadcast:function(n){O(n)},broadcastOn:function(n,e){k(n,e)},broadcastEvent:function(n,e){T(n,e)},isConnected:R},y=function(n){n.connect(b),gt(n.element)||(h.register(n),wn(n.components(),y),b.triggerEvent(Ce(),n.element,{target:n.element}))},x=function(n){gt(n.element)||(wn(n.components(),x),h.unregister(n)),n.disconnect()},w=function(n){Tt(t,n,bt)},S=function(n){Xe(n)},O=function(n){r({universal:!0,data:n})},k=function(n,e){r({universal:!1,channels:n,data:e})},T=function(n,e){var t,n=h.filter(n),o={stop:function(){t.set(!0)},cut:bn,isStopped:(t=En(!1)).get,isCut:_,event:e,setSource:P("Cannot set source of a broadcasted event"),getSource:P("Cannot get source of a broadcasted event")};return wn(n,function(n){ss(n.descHandler)(o)}),o.isStopped()},C=function(n){return h.getById(n).fold(function(){return F.error(new Error('Could not find component with uid: "'+n+'" in system.'))},F.value)},E=function(n){n=ac(n).getOr("not found");return C(n)};return y(t),{root:t,element:t.element,destroy:function(){v.unbind(),yt(t.element)},add:w,remove:S,getByUid:C,getByDom:E,addToWorld:y,removeFromWorld:x,broadcast:O,broadcastOn:k,broadcastEvent:T}}Hl=gt;var Hl,Pl,zl,jl={get:function(n){if(Hl(n))return Pl(n).getOr("");throw new Error("Can only get text value of a text node")},getOption:Pl=function(n){return Hl(n)?On.from(n.dom.nodeValue):On.none()},set:function(n,e){if(!Hl(n))throw new Error("Can only set raw text value of a text node");n.dom.nodeValue=e}},Nu=ro([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Ll={before:Nu.before,on:Nu.on,after:Nu.after,cata:function(n,e,t,o){return n.fold(e,t,o)},getStart:function(n){return n.fold(yn,yn,yn)}},$l=ro([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Gl={domRange:$l.domRange,relative:$l.relative,exact:$l.exact,exactFromRange:function(n){return $l.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){n=n.match({domRange:function(n){return kn.fromDom(n.startContainer)},relative:function(n,e){return Ll.getStart(n)},exact:function(n,e,t,o){return n}});return kn.fromDom(Ae(n).dom.defaultView)},range:Al},Ul=(zl=Wf,"data-ephox-mobile-fullscreen-style"),Wl="position:absolute!important;",Xl="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",ql=oe().os.isAndroid(),Yl=6<=oe().os.version.major,Kl="data-"+Mn("last-outer-height"),xo=M({unbind:bn}),Jl=wo([Zt("editor",[b("getFrame"),i("getBody"),i("getDoc"),i("getWin"),i("getSelection"),i("setSelection"),i("clearSelection"),i("cursorSaver"),i("onKeyup"),i("onNodeChanged"),i("getCursorBox"),b("onDomChanged"),y("onTouchContent",bn),y("onTapContent",bn),y("onTouchToolstrip",bn),y("onScrollToCursor",xo),y("onScrollToElement",xo),y("onToEditing",xo),y("onToReading",xo),y("onToolbarScrollStart",yn)]),b("socket"),b("toolstrip"),b("dropup"),b("toolbar"),b("container"),b("alloy"),fo("win",function(n){return Be(n.socket).dom.defaultView}),fo("body",function(n){return kn.fromDom(n.socket.dom.ownerDocument.body)}),y("translate",yn),y("setReadOnly",bn),y("readOnlyOnInit",R)]),$u=M([b("dom"),y("shell",!0),Eu("toolbarBehaviours",[kf])]),n=M([Ea({name:"groups",overrides:function(){return{behaviours:O([kf.config({})])}}})]),Ql=dc({name:"Toolbar",configFields:$u(),partFields:n(),factory:function(t,n,e,o){n=t.shell?{behaviours:[kf.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:n.components,behaviours:Du(t.toolbarBehaviours,n.behaviours),apis:{setGroups:function(n,e){(t.shell?On.some(n):oc(n,t,"groups")).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(n){kf.set(n,e)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,e,t){n.setGroups(e,t)}}}),ni=M([b("items"),Zt("markers",xn(["itemSelector"],b)),Eu("tgroupBehaviours",[T])]),e=M([Gu({name:"items",unit:"item"})]),Zl=dc({name:"ToolbarGroup",configFields:ni(),partFields:e(),factory:function(n,e,t,o){return{uid:n.uid,dom:n.dom,components:e,behaviours:Du(n.tgroupBehaviours,[T.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),nd="data-"+Mn("horizontal-scroll"),t=Object.freeze({__proto__:null,refresh:function(n,e,t){t.isExpanded()&&(Gr(n.element,yl(e)),t=xl(e,n.element),Dn(n.element,yl(e),t))},grow:function(n,e,t){t.isExpanded()||Cl(n,e,t)},shrink:function(n,e,t){t.isExpanded()&&Tl(n,e,t)},immediateShrink:function(n,e,t){t.isExpanded()&&kl(n,e,t)},hasGrown:function(n,e,t){return t.isExpanded()},hasShrunk:function(n,e,t){return t.isCollapsed()},isGrowing:El,isShrinking:Dl,isTransitioning:function(n,e,t){return El(n,e)||Dl(n,e)},toggleGrow:function(n,e,t){(t.isExpanded()?Tl:Cl)(n,e,t)},disableTransitions:wl}),ju=Object.freeze({__proto__:null,exhibit:function(n,e,t){return Ho(e.expanded?{classes:[e.openClass],styles:{}}:{classes:[e.closedClass],styles:To(e.dimension.property,"0px")})},events:function(t,o){return S([Vo(he())(function(n,e){e.event.raw.propertyName===t.dimension.property&&(wl(n,t),o.isExpanded()&&Gr(n.element,t.dimension.property),(o.isExpanded()?t.onGrown:t.onShrunk)(n))})])}}),ed=jo({fields:[b("closedClass"),b("openClass"),b("shrinkingClass"),b("growingClass"),i("getAnimationRoot"),Or("onShrunk"),Or("onStartShrink"),Or("onGrown"),Or("onStartGrow"),y("expanded",!1),Qt("dimension",Jt("property",{width:[u("property","width"),u("getDimension",function(n){return kc(n)+"px"})],height:[u("property","height"),u("getDimension",function(n){return Xr(n)+"px"})]}))],name:"sliding",active:ju,apis:t,state:Object.freeze({__proto__:null,init:function(n){var e=En(n.expanded);return rr({isExpanded:function(){return!0===e.get()},isCollapsed:function(){return!1===e.get()},setCollapsed:Rn(e.set,!1),setExpanded:Rn(e.set,!0),readState:function(){return"expanded: "+e.get()}})}})}),td=ro([{stopped:[]},{resume:["element"]},{complete:[]}]),od=function(e,t,o,n,r,i){return Fl(e,t,o,n,r,i).fold(R,function(n){return od(e,t,o,n,r,i)},_)},rd=Mn("readonly-mode"),id=Mn("edit-mode");function ud(n){n=mf(Ks.sketch({dom:{classes:[Mn("outer-container")].concat(n.classes)},containerBehaviours:O([ar.config({alpha:rd,omega:id})])}));return Nl(n)}function cd(n,e){var t=kn.fromTag("input");jr(t,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"}),bt(n,t),Lo(t),e(t),yt(t)}function ad(n){var e,t=n.getSelection();0<t.rangeCount&&(e=t.getRangeAt(0),(n=n.document.createRange()).setStart(e.startContainer,e.startOffset),n.setEnd(e.endContainer,e.endOffset),t.removeAllRanges(),t.addRange(n))}function sd(n,e){Go().each(function(n){Sn(n,e)||$o(n)}),n.focus(),Lo(kn.fromDom(n.document.body)),ad(n)}function fd(n,e,t,o){function r(){sd(e,o)}var i=_n(t,"keydown",function(n){U(["input","textarea"],Ie(n.target))||r()});return{toReading:function(){cd(n,$o)},toEditing:r,onToolbarTouch:bn,destroy:function(){i.unbind()}}}function ld(n){setTimeout(function(){throw n},0)}function dd(n,e){var t,o,r=Be(n).dom.defaultView;return Xr(n)+Xr(e)-(e=Fs(n=r).isPortrait(),t=n.screen.width,o=n.screen.height,r=rn([{width:320,height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],function(n){return e=t<=n.width&&o<=n.height,n=n.keyboard,e?On.some(n):On.none();var e}).getOr({portrait:o/5,landscape:t/4}),r=e?r.portrait:r.landscape,(e?n.screen.height:n.screen.width)-n.innerHeight>r?0:r)}function md(n,e,t){var o=dd(e,t);Dn(n,"padding-bottom",Xr(e)+Xr(t)-o+"px")}function gd(n){return ol(n,Md)}function pd(n,e){var t=Cn(n,_d);return Dd.fixed(n,t,e)}function hd(n,e){return Dd.scroller(n,e)}function vd(n){var e=gd(n);return("true"===Cn(n,Rd)?hd:pd)(n,e)}function bd(n,e,t){var o=Be(n).dom.defaultView.innerHeight;return Tn(n,Fd,o+"px"),o-e-t}function yd(n){n=$r(n,"top").getOr("0");return parseInt(n,10)}function xd(n){return parseInt(n.dom.scrollTop,10)}function wd(o,r){return Ed(function(n){var e=Rn(xd,o),t=(Tn(o,Vd,e()),Math.abs(r-e())),t=Math.ceil(t/10);Id.animate(e,r,t,function(n,e){ol(o,Vd)!==o.dom.scrollTop?e(o.dom.scrollTop):(o.dom.scrollTop=n,Tn(o,Vd,n))},function(){o.dom.scrollTop=r,Tn(o,Vd,r),n(r)},10)})}function Sd(n,e){Dn(n,"top",e+gd(n)+"px")}function Od(n){function o(n){e()?t(n):i.push(n)}function e(){return r.isSome()}function t(e){r.each(function(n){setTimeout(function(){e(n)},0)})}var r=On.none(),i=[];return n(function(n){e()||(r=On.some(n),wn(i,t),i=[])}),{get:o,map:function(t){return Od(function(e){o(function(n){e(t(n))})})},isReady:e}}var kd,Td={nu:Od,pure:function(e){return Od(function(n){n(e)})}},Cd=function(t){function n(n){t().then(n,ld)}return{map:function(n){return Cd(function(){return t().then(n)})},bind:function(e){return Cd(function(){return t().then(function(n){return e(n).toPromise()})})},anonBind:function(n){return Cd(function(){return t().then(function(){return n.toPromise()})})},toLazy:function(){return Td.nu(n)},toCached:function(){var n=null;return Cd(function(){return n=null===n?t():n})},toPromise:t,get:n}},Ed=function(n){return Cd(function(){return new Ws(n)})},Dd=ro([{fixed:["element","property","offsetY"]},{scroller:["element","offsetY"]}]),Md="data-"+Mn("position-y-fixed"),_d="data-"+Mn("y-property"),Rd="data-"+Mn("scrolling"),Fd="data-"+Mn("last-window-height"),Id=(kd=null,{animate:function(r,i,u,c,e,n){function a(n){s=!0,e(n)}var s=!1;function f(n){Nf.clearInterval(kd),a(n)}Nf.clearInterval(kd),kd=Nf.setInterval(function(){var t=r(),n=t,e=i,o=u;(Math.abs(n-e)<=o?On.none():n<e?On.some(n+o):On.some(n-o)).fold(function(){Nf.clearInterval(kd),a(i)},function(n){var e;c(n,f),s||((e=r())!==n||Math.abs(e-i)>Math.abs(t-i))&&(Nf.clearInterval(kd),a(i))})},n)}}),Vd="data-"+Mn("last-scroll-top");function Bd(n,u){return n.fold(function(n,e,t){return Dn(n,e,u+(n=t)+"px"),o=n,Cd(function(){return Ws.resolve(o)});var o},function(n,e){return t=u+(e=e),e=$r(n=n,"top").getOr(e),e=t-parseInt(e,10),e=n.dom.scrollTop+e,o=n,r=e,i=t,Ed(function(n){var e=Rn(xd,o);Id.animate(e,r,15,function(n){o.dom.scrollTop=n,Dn(o,"top",yd(o)+15+"px")},function(){o.dom.scrollTop=r,Dn(o,"top",i+"px"),n(r)},10)});var t,o,r,i})}function Ad(n,e){var n=xn(qr(n,"["+Md+"]"),vd),u=xn(n,function(n){return Bd(n,e)});return Ed(function(o){var r=[],i=0;0===u.length?o([]):wn(u,function(n,e){var t;n.get((t=e,function(n){r[t]=n,++i>=u.length&&o(r)}))})})}function Nd(dn,n){var mn=Jf(),gn=Xi(),pn=Xi(),hn=Wi(),vn=Wi();return{enter:function(){n.hide();var ln=kn.fromDom(document);Kf(dn.editor).each(function(n){var e,t,o,r,i,u,c,A,a,s,f,l,d,m,N,g,H,p,P,z,h,v,b,y,x,w,j,S,O,k,T,L,$,G,U,W,C,E,D,X,q,Y,M,K,_,R,J,F,Q,I,Z,nn,V,en,tn;function B(){o.run(function(n){n.refreshSelection()})}function on(n,e){var t=n-i.dom.scrollTop;o.run(function(n){n.scrollIntoView(t,t+e)})}function rn(){o.run(function(n){n.clearSelection()})}function un(){t.getCursorBox().each(function(n){on(n.top,n.height)}),o.run(function(n){n.syncHeight()})}function cn(){var n=z.innerHeight;return ol(s,Fd)<n}function an(){var n,e;h&&(n=Xr(l),e=Xr(d),e=bd(s,n,e),Tn(s,Md,n+"px"),Dn(s,"height",e+"px"),md(f,s,d))}function sn(){V.clear()}function fn(n){var e=kn.fromTag("span");return ls(e,[Mn("layer-editor"),Mn("unfocused-selection")]),jr(e,{left:n.left+"px",top:n.top+"px",width:n.width+"px",height:n.height+"px"}),e}gn.set({socketHeight:$r(dn.socket,"height"),iframeHeight:$r(n.frame,"height"),outerScroll:document.body.scrollTop}),pn.set({exclusives:(e="."+Rf,_n(ln,"touchmove",function(n){si(n.target,e).filter(ml).fold(function(){n.prevent()},bn)}))}),it(dn.container,Mn("fullscreen-maximized")),Qf(dn.container,n.body),mn.maximize(),Dn(dn.socket,"overflow","scroll"),Dn(dn.socket,"-webkit-overflow-scrolling","touch"),Lo(n.body),hn.set((a={cWin:n.win,ceBody:n.body,socket:dn.socket,toolstrip:dn.toolstrip,dropup:dn.dropup.element,contentElement:n.frame,outerBody:dn.body,outerWindow:dn.win,keyboardType:fd},v=a.cWin,b=a.ceBody,y=a.socket,x=a.toolstrip,w=a.contentElement,j=a.keyboardType,S=a.outerWindow,O=a.dropup,a=a.outerBody,f=b,l=x,d=O,z=Be(s=y).dom.defaultView,P=Cn(p=l,"style"),jr(p,{position:"absolute",top:"0px"}),Tn(p,Md,"0px"),Tn(p,_d,"top"),U=function(){Tn(p,"style",P||""),tt(p,Md),tt(p,_d)},b=Xr(l),_=Xr(d),_=bd(s,b=b,_),H=Cn(g=s,"style"),ks(g),jr(g,{position:"absolute",height:_+"px",width:"100%",top:b+"px"}),Tn(g,Md,b+"px"),Tn(g,Rd,"true"),Tn(g,_d,"top"),G=function(){Ts(g),Tn(g,"style",H||""),tt(g,Md),tt(g,Rd),tt(g,_d)},N=Cn(m=d,"style"),jr(m,{position:"absolute",bottom:"0px"}),Tn(m,Md,"0px"),Tn(m,_d,"bottom"),$=function(){Tn(m,"style",N||""),tt(m,Md),tt(m,_d)},h=!0,md(f,s,d),k={setViewportOffset:function(n){Tn(s,Md,n+"px"),an()},isExpanding:cn,isShrinking:Fn(cn),refresh:an,restore:function(){h=!1,U(),G(),$()}},T=j(a,v,Ue(),w),(L=Is(S,{onChange:bn,onReady:k.refresh})).onAdjustment(function(){k.refresh()}),Z=_n(kn.fromDom(S),"resize",function(){k.isExpanding()&&k.refresh()}),W=x,C=y,E=a,D=S,X=k,q=v,Y=function(n){return t=C,o=n,r=Be(e=W).dom.defaultView,Ed(function(n){Sd(e,o),Sd(t,o),r.scrollTo(0,o),n(o)});var e,t,o,r},M=En(Td.pure({})),en=function(e){var n=Td.nu(function(n){return Y(e).get(n)});M.set(n)},tn=function(n){M.get().get(function(){n()})},K=fl(function(){tn(function(){Ad(E,D.pageYOffset).get(function(){var n=ul(q);On.from(n[0]).bind(function(n){var e=n.top-C.dom.scrollTop;return e>D.innerHeight+5||e<-5?On.some({top:e,bottom:e+n.height}):On.none()}).each(function(n){C.dom.scrollTop=C.dom.scrollTop+n.top}),en(0),X.refresh()})})},1e3),_=_n(kn.fromDom(D),"scroll",function(){D.pageYOffset<0||K.throttle()}),Ad(E,D.pageYOffset).get(yn),nn={unbind:_.unbind},J=w,b=(R=v).document,it(F=kn.fromTag("div"),Mn("unfocused-selections")),bt(kn.fromDom(b.documentElement),F),Q=_n(F,"touchstart",function(n){n.prevent(),sd(R,J),I()}),V={update:function(){I();var n=xn(ul(R),fn);je(F,n)},isActive:function(){return 0<vt(F).length},destroy:function(){Q.unbind(),yt(F)},clear:I=function(){Le(F)}},{toEditing:function(){T.toEditing(),sn()},toReading:function(){T.toReading()},onToolbarTouch:function(n){T.onToolbarTouch()},refreshSelection:function(){V.isActive()&&V.update()},clearSelection:sn,highlightSelection:function(){V.update()},scrollIntoView:function(n,e){var t,o=v,r=dd(t=y,O),o=Rn(ad,o);r<n||r<e?wd(t,t.dom.scrollTop-r+e).get(o):n<0&&wd(t,t.dom.scrollTop+n).get(o)},updateToolbarPadding:bn,setViewportOffset:function(n){var r,i;k.setViewportOffset(n),r=y,i=n,Ed(function(n){function e(n){Dn(r,"top",n+"px")}var t=Rn(yd,r),o=Math.abs(i-t()),o=Math.ceil(o/10);Id.animate(t,i,o,e,function(){e(i),n(i)},10)}).get(yn)},syncHeight:function(){Dn(w,"height",w.dom.contentWindow.document.body.scrollHeight+"px")},refreshStructure:k.refresh,destroy:function(){k.restore(),L.destroy(),nn.unbind(),Z.unbind(),T.destroy(),V.destroy(),cd(Ue(),$o)}})),hn.run(function(n){n.syncHeight()}),vn.set((t=n,o=hn,r=dn.toolstrip,i=dn.socket,dn.dropup,u=tl(t),c=fl(un,300),A=[t.onKeyup(function(){rn(),c.throttle()}),t.onNodeChanged(B),t.onDomChanged(c.throttle),t.onDomChanged(B),t.onScrollToCursor(function(n){n.preventDefault(),c.throttle()}),t.onScrollToElement(function(n){n.element,on(o,i)}),t.onToEditing(function(){o.run(function(n){n.toEditing()})}),t.onToReading(function(){o.run(function(n){n.toReading()})}),_n(t.doc,"touchend",function(n){Sn(t.html,n.target)||Sn(t.body,n.target)}),_n(r,"transitionend",function(n){var e;"height"===n.raw.propertyName&&(e=Xr(r),o.run(function(n){n.setViewportOffset(e)}),B(),un())}),Rs(r,"touchstart",function(n){var e;o.run(function(n){n.highlightSelection()}),e=n,o.run(function(n){n.onToolbarTouch(e)}),t.onTouchToolstrip()}),_n(t.body,"touchstart",function(n){rn(),t.onTouchContent(),u.fireTouchstart(n)}),u.onTouchmove(),u.onTouchend(),_n(t.body,"click",function(n){n.kill()}),_n(r,"touchmove",function(){t.onToolbarScrollStart()})],{destroy:function(){wn(A,function(n){n.unbind()})}}))})},refreshStructure:function(){hn.run(function(n){n.refreshStructure()})},exit:function(){mn.restore(),vn.clear(),hn.clear(),n.show(),gn.on(function(n){n.socketHeight.each(function(n){Dn(dn.socket,"height",n)}),n.iframeHeight.each(function(n){Dn(dn.editor.getFrame(),"height",n)}),document.body.scrollTop=n.scrollTop}),gn.clear(),pn.on(function(n){n.exclusives.unbind()}),pn.clear(),ut(dn.container,Mn("fullscreen-maximized")),Zf(),Ts(dn.toolbar),Gr(dn.socket,"overflow"),Gr(dn.socket,"-webkit-overflow-scrolling"),$o(dn.editor.getFrame()),Kf(dn.editor).each(function(n){n.clearSelection()})}}}function Hd(n,e,t){n.system.broadcastOn([dr],{command:e,state:t})}function Pd(e){return function(){function n(){e._skinLoaded=!0,e.fire("SkinLoaded")}e.initialized?n():e.on("init",n)}}var zd=tinymce.util.Tools.resolve("tinymce.EditorManager"),jd="toReading",Ld="toEditing";ko.add("mobile",function(k){return{getNotificationManagerImpl:function(){return{open:M({progressBar:{value:bn},close:bn,text:bn,getEl:M(null),moveTo:bn,moveRel:bn,settings:{}}),close:bn,reposition:bn,getArgs:M({})}},renderUI:function(){var n,e=k.getElement(),t={content:(y=On.from(k.getParam("skin_url")).getOrThunk(function(){return zd.baseURL+"/skins/ui/oxide"}))+"/content.mobile.min.css",ui:y+"/skin.mobile.min.css"};function o(){k.fire("ScrollIntoView")}!1===k.getParam("skin")==0?(n=sr.DOM.styleSheetLoader,k.contentCSS.push(t.content),n.load(t.ui,Pd(k)),k.on("remove",function(){return n.unload(t.ui)})):Pd(k)();var r,i,u,c,a,s,f,l,d,m,g,p,h,v,b=oe().os.isAndroid()?(y=o,r=ud({classes:[Mn("android-container")]}),i=gl(),u=Wi(),c=pl(u),a=hl(),y=Ml(bn,y),r.add(i.wrapper),r.add(a),r.add(y.component),{system:r,element:r.element,init:function(n){u.set(dl(n))},exit:function(){u.run(function(n){n.exit(),kf.remove(a,c)})},setToolbarGroups:function(n){n=i.createGroups(n);i.setGroups(n)},setContextToolbar:function(n){n=i.createGroups(n);i.setContextToolbar(n)},focusToolbar:function(){i.focus()},restoreToolbar:function(){i.restoreToolbar()},updateMode:function(n){vl(a,c,n,r.root)},socket:a,dropup:y}):(y=o,f=ud({classes:[Mn("ios-container")]}),l=gl(),d=Wi(),m=pl(d),g=hl(),y=Ml(function(){d.run(function(n){n.refreshStructure()})},y),f.add(l.wrapper),f.add(g),f.add(y.component),{system:f,element:f.element,init:function(n){var e,t,o;d.set((Dn((e=Kt("Getting IosWebapp schema",Jl,n)).toolstrip,"width","100%"),Dn(e.container,"position","relative"),t=mf(ll(function(){e.setReadOnly(e.readOnlyOnInit()),o.enter()},e.translate)),e.alloy.add(t),o=Nd(e,{show:function(){e.alloy.add(t)},hide:function(){e.alloy.remove(t)}}),{setReadOnly:e.setReadOnly,refreshStructure:o.refreshStructure,enter:o.enter,exit:o.exit,destroy:bn}))},exit:function(){d.run(function(n){kf.remove(g,m),n.exit()})},setToolbarGroups:function(n){n=l.createGroups(n);l.setGroups(n)},setContextToolbar:function(n){n=l.createGroups(n);l.setContextToolbar(n)},focusToolbar:function(){l.focus()},restoreToolbar:function(){l.restoreToolbar()},updateMode:function(n){vl(g,m,n,f.root)},socket:g,dropup:y}),y=kn.fromDom(e);function x(n,e,t,o){!1===o&&k.selection.collapse();e=e,t=t;e={readOnly:(n=n.get()).backToMask.concat(e.get()),main:n.backToMask.concat(t.get())};b.setToolbarGroups(!0===o?e.readOnly:e.main),k.setMode(!0===o?"readonly":"design"),k.fire(!0===o?jd:Ld),b.updateMode(o)}function w(n,e){return k.on(n,e),{unbind:function(){k.off(n)}}}s=b.system,h=y,v=(p=s).element,On.from(h.dom.nextSibling).map(kn.fromDom).fold(function(){Ne(h).each(function(n){bt(n,v)})},function(n){Pe(n,v)}),wn(vt(p.element),function(n){p.getByDom(n).each(kt)});var S=e.ownerDocument.defaultView,O=Is(S,{onChange:function(){var n,e,t;b.system.broadcastOn([mr],{width:(n=S,e=oe().os.isiOS(),t=Fs(n).isPortrait(),e&&!t?n.screen.height:n.screen.width)})},onReady:bn});return k.on("init",function(){b.init({editor:{getFrame:function(){return kn.fromDom(k.contentAreaContainer.querySelector("iframe"))},onDomChanged:function(){return{unbind:bn}},onToReading:function(n){return w(jd,n)},onToEditing:function(n){return w(Ld,n)},onScrollToCursor:function(e){return k.on("ScrollIntoView",function(n){e(n)}),{unbind:function(){k.off("ScrollIntoView"),O.destroy()}}},onTouchToolstrip:function(){e()},onTouchContent:function(){Uo(kn.fromDom(k.editorContainer.querySelector("."+Mn("toolbar")))).bind(function(n){return b.system.getByDom(n).toOptional()}).each(mn),b.restoreToolbar(),e()},onTapContent:function(n){var t=n.target;"img"===Ie(t)?(k.selection.select(t.dom),n.kill()):"a"===Ie(t)&&b.system.getByDom(kn.fromDom(k.editorContainer)).each(function(n){var e;ar.isAlpha(n)&&(n=t.dom,(e=document.createElement("a")).target="_blank",e.href=n.href,e.rel="noreferrer noopener",(n=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),document.body.appendChild(e),e.dispatchEvent(n),document.body.removeChild(e))})}},container:kn.fromDom(k.editorContainer),socket:kn.fromDom(k.contentAreaContainer),toolstrip:kn.fromDom(k.editorContainer.querySelector("."+Mn("toolstrip"))),toolbar:kn.fromDom(k.editorContainer.querySelector("."+Mn("toolbar"))),dropup:b.dropup,alloy:b.system,translate:bn,setReadOnly:function(n){x(f,s,a,n)},readOnlyOnInit:function(){return!1}});var t,o,n,e=function(){b.dropup.disappear(function(){b.system.broadcastOn([gr],{})})},r={label:"The first group",scrollable:!1,items:[Ha("back",function(){k.selection.collapse(),b.exit()},{},k)]},i={label:"Back to read only",scrollable:!1,items:[Ha("readonly-back",function(){x(f,s,a,!0)},{},k)]},u=Ds(b,k),c={label:"The extra group",scrollable:!1,items:[]},a=En([{label:"the action group",scrollable:!0,items:(t=u,u=k.getParam("toolbar",lr,"array"),u=(V(u)?Bf:Es)(u),o={},Z(u,function(n){var e=!Je(o,n)&&Je(t,n)&&t[n].isSupported()?[t[n].sketch()]:[];return o[n]=!0,e}))},c]),s=En([{label:"The read only mode group",scrollable:!0,items:[]},c]),f=En({backToMask:[r],backToReadOnly:[i]}),l=b;wn(Ct((n=k).formatter.get()),function(e){n.formatter.formatChanged(e,function(n){Hd(l,e,n)})}),wn(["ul","ol"],function(t){n.selection.selectorChanged(t,function(n,e){Hd(l,t,n)})})}),k.on("remove",function(){b.exit()}),k.on("detach",function(){var e=b.system;wn(vt(e.element),function(n){e.getByDom(n).each(Ot)}),yt(e.element),b.system.destroy()}),{iframeContainer:b.socket.element.dom,editorContainer:b.element.dom}}}})}();
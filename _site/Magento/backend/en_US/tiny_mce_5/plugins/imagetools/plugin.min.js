!function(){"use strict";function g(e){var t=e;return{get:function(){return t},set:function(e){t=e}}}function h(e){return null!=e}function p(){}function i(e){return function(){return e}}function e(e){return e}function t(){return s}function n(e){return t=typeof(e=e),"array"==(null===e?"null":"object"==t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t);var t}var a,C=tinymce.util.Tools.resolve("tinymce.PluginManager"),v=tinymce.util.Tools.resolve("tinymce.util.Tools"),c=i(!(a="function")),u=i(!0),s={fold:function(e,t){return e()},isSome:c,isNone:u,getOr:e,getOrThunk:o,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:e,orThunk:o,map:t,each:p,bind:t,exists:c,forall:u,filter:function(){return s},toArray:function(){return[]},toString:i("none()")};function o(e){return e()}function l(n){function e(){return r}function t(e){return e(n)}var o=i(n),r={fold:function(e,t){return t(n)},isSome:u,isNone:c,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:e,orThunk:e,map:function(e){return l(e(n))},each:function(e){e(n)},bind:t,exists:t,forall:t,filter:function(e){return e(n)?r:s},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return r}var m={some:l,none:t,from:function(e){return null==e?s:l(e)}},r={},f={exports:r};function d(e,t){return B(document.createElement("canvas"),e,t)}function F(e){var t=d(e.width,e.height);return T(t).drawImage(e,0,0),t}function y(u){return new E(function(e,t){function n(){a.removeEventListener("load",o),a.removeEventListener("error",r)}function o(){n(),e(a)}function r(){n(),t("Unable to load data of type "+u.type+": "+i)}var i=URL.createObjectURL(u),a=new Image;a.addEventListener("load",o),a.addEventListener("error",r),a.src=i,a.complete&&setTimeout(o,0)})}function w(e,o,r){return o=o||"image/png",typeof HTMLCanvasElement.prototype.toBlob===a?new E(function(t,n){e.toBlob(function(e){e?t(e):n()},o,r)}):x(e.toDataURL(o,r))}function b(e,t){for(var n=0,o=e.length;n<o;n++)t(e[n],n)}function _(e,t){for(var n=e,o=t,r=c,i=0,a=n.length;i<a;i++){var u=n[i];if(o(u,i))return m.some(u);if(r(u,i))break}return m.none()}!function(){function e(){var e,t,n={exports:{}};function o(){}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function r(n,o){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,i._immediateFn(function(){var e,t=1===n._state?o.onFulfilled:o.onRejected;if(null!==t){try{e=t(n._value)}catch(e){return void u(o.promise,e)}a(o.promise,e)}else(1===n._state?a:u)(o.promise,n._value)})):n._deferreds.push(o)}function a(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,c(e);if("function"==typeof n)return l((o=n,r=t,function(){o.apply(r,arguments)}),e)}e._state=1,e._value=t,c(e)}catch(t){u(e,t)}var o,r}function u(e,t){e._state=2,e._value=t,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)r(e,e._deferreds[t]);e._deferreds=null}function s(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function l(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,u(t,e))})}catch(e){n||(n=!0,u(t,e))}}f=n,e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=setTimeout,i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(o);return r(this,new s(e,t,n)),n},i.all=function(e){var u=Array.prototype.slice.call(e);return new i(function(r,i){if(0===u.length)return r([]);for(var a=u.length,e=0;e<u.length;e++)!function t(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var o=e.then;if("function"==typeof o)return o.call(e,function(e){t(n,e)},i),0}u[n]=e,0==--a&&r(u)}catch(e){i(e)}}(e,u[e])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(n){return new i(function(e,t){t(n)})},i.race=function(r){return new i(function(e,t){for(var n=0,o=r.length;n<o;n++)r[n].then(e,t)})},i._immediateFn="function"==typeof setImmediate?function(e){setImmediate(e)}:function(e){t(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},f.exports?f.exports=i:e.Promise||(e.Promise=i);var f=n.exports;return{boltExport:("undefined"!=typeof window?window:Function("return this;")()).Promise||f}}var t=this;"object"==typeof r&&void 0!==f?f.exports=e():(t="undefined"!=typeof globalThis?globalThis:t||self).EphoxContactWrapper=e()}();function B(e,t,n){return e.width=t,e.height=n,e}function N(o){return new E(function(e,t){var n=new XMLHttpRequest;n.open("GET",o,!0),n.responseType="blob",n.onload=function(){200===this.status&&e(this.response)},n.onerror=function(){var e;t(0===this.status?((e=new Error("No access to download image")).code=18,e.name="SecurityError",e):new Error("Error "+this.status+" downloading image"))},n.send()})}var E=f.exports.boltExport,T=function(e){return e.getContext("2d")},x=function(d){return new E(function(e,t){!function(){var e=d.split(","),t=/data:([^;]+)/.exec(e[0]);if(!t)return m.none();for(var t=t[1],e=e[1],n=atob(e),o=n.length,r=Math.ceil(o/1024),i=new Array(r),a=0;a<r;++a){for(var u=1024*a,c=Math.min(1024+u,o),s=new Array(c-u),l=u,f=0;l<c;++f,++l)s[f]=n[l].charCodeAt(0);i[a]=new Uint8Array(s)}return m.some(new Blob(i,{type:t}))}().fold(function(){t("uri is not base64: "+d)},e)})},D=function(e){URL.revokeObjectURL(e.src)},H=y,z=Array.prototype.indexOf,I=Object.keys;function R(e,t,n){function o(t,n){return e.then(function(e){return e.toDataURL(t||"image/png",n)})}return{getType:i(t.type),toBlob:function(){return E.resolve(t)},toDataURL:i(n),toBase64:function(){return n.split(",")[1]},toAdjustedBlob:function(t,n){return e.then(function(e){return w(e,t,n)})},toAdjustedDataURL:o,toAdjustedBase64:function(e,t){return o(e,t).then(function(e){return e.split(",")[1]})},toCanvas:function(){return e.then(F)}}}function U(t,e){return w(t,e).then(function(e){return R(E.resolve(t),e,t.toDataURL())})}function A(e,t){void 0===t&&(t=2);t=Math.pow(10,t),e=Math.round(e*t);return Math.ceil(e/t)}function q(c,s,l){return void 0===l&&(l=!1),new E(function(e){for(var t=new XMLHttpRequest,n=(t.onreadystatechange=function(){4===t.readyState&&e({status:t.status,blob:t.response})},t.open("GET",c,!0),t.withCredentials=l,s),o=I(n),r=0,i=o.length;r<i;r++){var a=o[r],u=n[a];t.setRequestHeader(a,u)}t.responseType="blob",t.send()})}function W(e){t=e;var t,e="ImageProxy HTTP error: "+_(Q,function(e){return t===e.code}).fold(i("Unknown ImageProxy error"),function(e){return e.message});return E.reject(e)}function $(t){return _(Y,function(e){return e.type===t}).fold(i("Unknown service error"),function(e){return e.message})}function V(e){return e<200||300<=e}function G(e,t){var n,o={"Content-Type":"application/json;charset=UTF-8","tiny-api-key":t};return q((t=t,n=-1===(e=e).indexOf("?")?"?":"&",/[?&]apiKey=/.test(e)?e:e+n+"apiKey="+encodeURIComponent(t)),o).then(function(e){return V(e.status)?(t=e.status,"application/json"!==(null==(n=e.blob)?void 0:n.type)||400!==t&&403!==t&&404!==t&&500!==t?W(t):(o=n,new E(function(e,t){var n=new FileReader;n.onload=function(){e(n.result)},n.onerror=function(e){t(e)},n.readAsText(o)}).then(function(e){e="ImageProxy Service error: "+function(e){try{return m.some(JSON.parse(e))}catch(e){return m.none()}}(e).bind(function(e){return n=function(e,t){return h(e)?e[t]:void 0},o=e,b(["error","type"],function(e,t){o=n(o,e)}),e=o,m.from(e).map($);var n,o}).getOr("Invalid JSON in service error message");return E.reject(e)}))):E.resolve(e.blob);var o,t,n})}function J(e,t,n){return void 0===n&&(n=!1),t?G(e,t):q(e,{},n).then(function(e){return V(e.status)?W(e.status):E.resolve(e.blob)})}function K(t){return n=t,new E(function(e){var t=new FileReader;t.onloadend=function(){e(t.result)},t.readAsDataURL(n)}).then(function(e){return R(y(t).then(function(e){D(e);var t=d(e.naturalWidth||e.width,e.naturalHeight||e.height);return T(t).drawImage(e,0,0),t}),t,e)});var n}var j=[{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}];if(!n(j))throw new Error("cases must be an array");if(0===j.length)throw new Error("there must be at least one case");var S=[],X={};function M(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}}b(j,function(e,o){var t=I(e);if(1!==t.length)throw new Error("one and only one name per case");var r=t[0],i=e[r];if(void 0!==X[r])throw new Error("duplicate key detected:"+r);if("cata"===r)throw new Error("cannot have a case named cata (sorry)");if(!n(i))throw new Error("case arguments must be an array");S.push(r),X[r]=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=n.length;if(t!==i.length)throw new Error("Wrong number of arguments to case "+r+". Expected "+i.length+" ("+i+"), got "+t);return{fold:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length!==j.length)throw new Error("Wrong number of arguments to fold. Expected "+j.length+", got "+e.length);return e[o].apply(null,n)},match:function(e){var o=I(e);if(S.length!==o.length)throw new Error("Wrong number of arguments to match. Expected: "+S.join(",")+"\nActual: "+o.join(","));if(function(e){for(var t=0,n=e.length;t<n;++t)if(!0!=-1<z.call(o,e[t]))return;return 1}(S))return e[r].apply(null,n);throw new Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+S.join(", "))},log:function(e){console.log(e,{constructors:S,constructor:r,params:n})}}}});var Q=[{code:404,message:"Could not find Image Proxy"},{code:403,message:"Rejected request"},{code:0,message:"Incorrect Image Proxy URL"}],Y=[{type:"not_found",message:"Failed to load image."},{type:"key_missing",message:"The request did not include an api key."},{type:"key_not_found",message:"The provided api key could not be found."},{type:"domain_not_trusted",message:"The api key is not valid for the request origins."}],P={fromHtml:function(e,t){t=(t||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return M(t.childNodes[0])},fromTag:function(e,t){return M((t||document).createElement(e))},fromText:function(e,t){return M((t||document).createTextNode(e))},fromDom:M,fromPoint:function(e,t,n){return m.from(e.dom.elementFromPoint(t,n)).map(M)}};function Z(e){return e.getParam("imagetools_proxy")}function ee(e){function t(e){return/^[0-9\.]+px$/.test(e)}var n=e.style.width,o=e.style.height;return n||o?t(n)&&t(o)?{w:parseInt(n,10),h:parseInt(o,10)}:null:(n=e.width,o=e.height,n&&o?{w:parseInt(n,10),h:parseInt(o,10)}:null)}function te(e){return{w:e.naturalWidth,h:e.naturalHeight}}function ne(e){return e=P.fromDom(e),t=function(e){var t="img",e=e.dom;if(1!==e.nodeType)return!1;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},_(e.dom.childNodes,function(e){return t(P.fromDom(e))}).map(P.fromDom);var t}function oe(e,t){return e.dom.is(t,"figure")}function re(e,t){return e.dom.is(t,"img:not([data-mce-object],[data-mce-placeholder])")}function O(t,e){function n(e){return re(t,e)&&(pe(t,e)||ve(t,e)||h(Z(t)))}return oe(t,e)?ne(e).bind(function(e){return n(e.dom)?m.some(e.dom):m.none()}):n(e)?m.some(e):m.none()}function ie(e,t){e.notificationManager.open({text:t,type:"error"})}function L(e){var t=e.selection.getNode(),n=e.dom.getParent(t,"figure.image");return null!==n&&oe(e,n)?ne(n):re(e,t)?m.some(P.fromDom(t)):m.none()}function ae(e,t,n){t=t.match(/(?:\/|^)(([^\/\?]+)\.(?:[a-z0-9.]+))(?:\?|$)/i);return h(t)?e.dom.encode(t[n]):null}function ue(e,t){var o,r,n=e.editorUpload.blobCache.getByUri(t.src);return n?he.resolve(n.blob()):(o=e,r=t,m.from(o.getParam("imagetools_fetch_image",null,"function")).fold(function(){return ve(e=o,t=r)?J(t.src,null,(n=t,-1!==v.inArray(e.getParam("imagetools_credentials_hosts",[],"string[]"),new k(n.src).host))):pe(e,t)?(0===(n=t.src).indexOf("data:")?x:N)(n):J((n=Z(e))+(-1===n.indexOf("?")?"?":"&")+"url="+encodeURIComponent(t.src),e.getParam("api_key",e.getParam("imagetools_api_key","","string"),"string"),!1);var e,t,n},function(e){return e(r)}))}function ce(e){me.clearTimeout(e.get())}function se(u,c,s,l,f,d,m){return s.toBlob().then(function(e){var t,n,r,o=u.editorUpload.blobCache,i=d.src,a=c.type===e.type;return u.getParam("images_reuse_filename",!1,"boolean")&&(n=h(r=o.getByUri(i))?(i=r.uri(),t=r.name(),r.filename()):(t=ae(u,i,2),ae(u,i,1))),r=o.create({id:"imagetools"+ge++,blob:e,base64:s.toBase64(),uri:i,name:t,filename:a?n:void 0}),o.add(r),u.undoManager.transact(function(){var o=function(){var e,t,n;u.$(d).off("load",o),u.nodeChanged(),l?u.editorUpload.uploadImagesAuto():(ce(f),e=u,t=f,n=me.setEditorTimeout(e,function(){e.editorUpload.uploadImagesAuto()},e.getParam("images_upload_timeout",3e4,"number")),t.set(n))};u.$(d).on("load",o),m&&u.$(d).attr({width:m.w,height:m.h}),u.$(d).attr({src:r.blobUri()}).removeAttr("data-mce-src")}),r})}function le(o,r,e,i){return function(){return L(o).fold(function(){ie(o,"Could not find selected image")},function(n){return o._scanForImages().then(function(){return ue(o,n.dom)}).then(function(t){return K(t).then(e).then(function(e){return se(o,t,e,!1,r,n.dom,i)})}).catch(function(e){ie(o,e)})})}}function fe(t,n,o){return function(){var e=L(t).map(function(e){e=ee(e.dom);return e?{w:e.h,h:e.w}:null}).getOrNull();return le(t,n,function(e){return l=o,(s=e).toCanvas().then(function(e){return e=e,t=s.getType(),n=((n=l)<0?360+n:n)*Math.PI/180,o=e.width,r=e.height,i=Math.sin(n),a=Math.cos(n),u=A(Math.abs(o*a)+Math.abs(r*i)),i=A(Math.abs(o*i)+Math.abs(r*a)),a=d(u,i),(c=T(a)).translate(u/2,i/2),c.rotate(n),c.drawImage(e,-o/2,-r/2),U(a,t);var t,n,o,r,i,a,u,c});var s,l},e)()}}function de(e,t,n){return function(){return le(e,t,function(e){return a=n,(i=e).toCanvas().then(function(e){return e=e,t=i.getType(),n=a,o=d(e.width,e.height),r=T(o),"v"===n?(r.scale(1,-1),r.drawImage(e,0,-o.height)):(r.scale(-1,1),r.drawImage(e,-o.width,0)),U(o,t);var t,n,o,r});var i,a})()}}"undefined"==typeof window&&Function("return this;")();var me=tinymce.util.Tools.resolve("tinymce.util.Delay"),he=tinymce.util.Tools.resolve("tinymce.util.Promise"),k=tinymce.util.Tools.resolve("tinymce.util.URI"),ge=0,pe=function(e,t){t=t.src;return 0===t.indexOf("data:")||0===t.indexOf("blob:")||new k(t).host===e.documentBaseURI.host},ve=function(e,t){return-1!==v.inArray(e.getParam("imagetools_cors_hosts",[],"string[]"),new k(t.src).host)};C.add("imagetools",function(e){var t,n,o,r,i,a,c,s,u=g(0),l=g(null),f=e;function d(e){return function(){return i.execCommand(e)}}function m(){return L(i).exists(function(e){return O(i,e.dom).isSome()})}function h(t){function i(e){return t.setDisabled(!e)}return i(m()),a=a.concat([i]),function(){a=function(e){for(var t=[],n=0,o=e.length;n<o;n++){var r=e[n];r!==i&&t.push(r)}return t}(a)}}v.each({mceImageRotateLeft:fe(f,u,-90),mceImageRotateRight:fe(f,u,90),mceImageFlipVertical:de(f,u,"v"),mceImageFlipHorizontal:de(f,u,"h"),mceEditImage:(c=f,s=u,function(){var n=L(c),i=n.map(function(e){return te(e.dom)});n.each(function(t){O(c,t.dom).each(function(e){ue(c,t.dom).then(function(e){e={blob:e,url:URL.createObjectURL(e)};c.windowManager.open({title:"Edit Image",size:"large",body:{type:"panel",items:[{type:"imagetools",name:"imagetools",label:"Edit Image",currentState:e}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0,disabled:!0}],onSubmit:function(e){var r=e.getData().imagetools.blob;n.each(function(o){i.each(function(e){var i,t=c,n=s,a=o.dom,u=e;H(i=r).then(function(e){var t,n,o,r=te(e);return u.w===r.w&&u.h===r.h||ee(a)&&(t=a,r=r)&&(n=t.style.width,o=t.style.height,(n||o)&&(t.style.width=r.w+"px",t.style.height=r.h+"px",t.removeAttribute("data-mce-style")),n=t.width,o=t.height,n||o)&&(t.setAttribute("width",String(r.w)),t.setAttribute("height",String(r.h))),URL.revokeObjectURL(e.src),i}).then(K).then(function(e){return se(t,i,e,!0,n,a)})})}),e.close()},onCancel:p,onAction:function(e,t){switch(t.name){case"save-state":t.value?e.enable("save"):e.disable("save");break;case"disable":e.disable("save"),e.disable("cancel");break;case"enable":e.enable("cancel")}}})})})})})},function(e,t){f.addCommand(t,e)}),a=[],(i=e).on("NodeChange",function(){var t=m();b(a,function(e){e(t)})}),i.ui.registry.addButton("rotateleft",{tooltip:"Rotate counterclockwise",icon:"rotate-left",onAction:d("mceImageRotateLeft"),onSetup:h}),i.ui.registry.addButton("rotateright",{tooltip:"Rotate clockwise",icon:"rotate-right",onAction:d("mceImageRotateRight"),onSetup:h}),i.ui.registry.addButton("flipv",{tooltip:"Flip vertically",icon:"flip-vertically",onAction:d("mceImageFlipVertical"),onSetup:h}),i.ui.registry.addButton("fliph",{tooltip:"Flip horizontally",icon:"flip-horizontally",onAction:d("mceImageFlipHorizontal"),onSetup:h}),i.ui.registry.addButton("editimage",{tooltip:"Edit image",icon:"edit-image",onAction:d("mceEditImage"),onSetup:h}),i.ui.registry.addButton("imageoptions",{tooltip:"Image options",icon:"image",onAction:d("mceImage")}),i.ui.registry.addContextMenu("imagetools",{update:function(e){return O(i,e).map(function(e){return{text:"Edit image",icon:"edit-image",onAction:d("mceEditImage")}}).toArray()}}),(t=e).ui.registry.addContextToolbar("imagetools",{items:t.getParam("imagetools_toolbar","rotateleft rotateright flipv fliph editimage imageoptions"),predicate:function(e){return O(t,e).isSome()},position:"node",scope:"node"}),o=u,r=l,(n=e).on("NodeChange",function(e){var t=r.get(),e=O(n,e.element);t&&!e.exists(function(e){return t.src===e.src})&&(ce(o),n.editorUpload.uploadImagesAuto(),r.set(null)),e.each(r.set)})})}();
!function(){"use strict";function r(t){return function(e){return n=typeof(e=e),(null===e?"null":"object"==n&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":n)===t;var n}}function o(n){return function(e){return typeof e===n}}function u(n){return function(e){return n===e}}function i(e){return!(null==e)}function ce(){}function le(e){return function(){return e}}function ae(e){return e}function l(e,n){return e===n}var ke=r("string"),g=r("object"),a=r("array"),N=u(null),f=o("boolean"),s=u(void 0),m=o("function"),b=o("number");function E(r){for(var o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var t=o.concat(e);return r.apply(null,t)}}function h(n){return function(e){return!n(e)}}function y(){return C}var fe=le(!1),se=le(!0),C={fold:function(e,n){return e()},isSome:fe,isNone:se,getOr:ae,getOrThunk:S,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:le(null),getOrUndefined:le(void 0),or:ae,orThunk:S,map:y,each:ce,bind:y,exists:fe,forall:se,filter:function(){return C},toArray:function(){return[]},toString:le("none()")};function S(e){return e()}function me(e,n){return-1<H.call(e,n)}function v(e,n){for(var t=0,r=e.length;t<r;t++)if(n(e[t],t))return!0;return!1}function A(e,n){for(var t=[],r=0;r<e;r++)t.push(n(r));return t}function de(e,n){for(var t=e.length,r=new Array(t),o=0;o<t;o++){var u=e[o];r[o]=n(u,o)}return r}function ge(e,n){for(var t=0,r=e.length;t<r;t++)n(e[t],t)}function T(e,n){for(var t=[],r=[],o=0,u=e.length;o<u;o++){var i=e[o];(n(i,o)?t:r).push(i)}return{pass:t,fail:r}}function pe(e,n){for(var t=[],r=0,o=e.length;r<o;r++){var u=e[r];n(u,r)&&t.push(u)}return t}function Ie(e,n,t){for(var r,o=e,u=o.length-1;0<=u;u--)r=o[u],t=n(t,r,u);return t}function Be(e,t,r){return ge(e,function(e,n){r=t(r,e,n)}),r}function M(e,n){for(var t=e,r=n,o=fe,u=0,i=t.length;u<i;u++){var c=t[u];if(r(c,u))return be.some(c);if(o(c,u))break}return be.none()}function x(e,n){for(var t=0,r=e.length;t<r;t++)if(n(e[t],t))return be.some(t);return be.none()}function k(e){for(var n=[],t=0,r=e.length;t<r;++t){if(!a(e[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+e);V.apply(n,e[t])}return n}function w(e,n){return k(de(e,n))}function I(e,n){for(var t=0,r=e.length;t<r;++t)if(!0!==n(e[t],t))return!1;return!0}function z(e,n){for(var t={},r=0,o=e.length;r<o;r++){var u=e[r];t[String(u)]=n(u,r)}return t}function L(e){return[e]}function _(e,n){return 0<=n&&n<e.length?be.some(e[n]):be.none()}function Me(e){return _(e,0)}function W(e){return _(e,e.length-1)}function Ee(e,n){for(var t=0;t<e.length;t++){var r=n(e[t],t);if(r.isSome())return r}return be.none()}function j(t){function e(){return o}function n(e){return e(t)}var r=le(t),o={fold:function(e,n){return n(t)},isSome:se,isNone:fe,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:e,orThunk:e,map:function(e){return j(e(t))},each:function(e){e(t)},bind:n,exists:n,forall:n,filter:function(e){return e(t)?o:C},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o}var be={some:j,none:y,from:function(e){return null==e?C:j(e)}},F=Array.prototype.slice,H=Array.prototype.indexOf,V=Array.prototype.push,R=function(){return(R=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)};function q(e,n,t){if(t||2===arguments.length)for(var r,o=0,u=n.length;o<u;o++)!r&&o in n||((r=r||Array.prototype.slice.call(n,0,o))[o]=n[o]);return e.concat(r||Array.prototype.slice.call(n))}function Pe(t){var r,o=!1;return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return o||(o=!0,r=t.apply(null,e)),r}}function U(e,n){var t=String(n).toLowerCase();return M(e,function(e){return e.search(t)})}function G(e,n,t){return""===n||e.length>=n.length&&e.substr(t,t+n.length)===n}function t(e,n){return-1!==e.indexOf(n)}function Ne(e,n){return G(e,n,e.length-n.length)}function ze(e){return 0<e.length}function $(n){return function(e){return t(e,n)}}function K(e){return window.matchMedia(e).matches}function X(e,n){e=e.dom;if(1!==e.nodeType)return!1;if(void 0!==e.matches)return e.matches(n);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(n);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(n);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")}function Y(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount}function J(e,n){n=void 0===n?document:n.dom;return Y(n)?be.none():be.from(n.querySelector(e)).map(we.fromDom)}function he(e,n){return e.dom===n.dom}function Q(e,n){return ln().browser.isIE()?(r=e.dom,o=n.dom,t=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(r.compareDocumentPosition(o)&t)):(r=e.dom)!==(o=n.dom)&&r.contains(o);var t,r,o}function ve(e,n){for(var t=fn(e),r=0,o=t.length;r<o;r++){var u=t[r];n(e[u],u)}}function Z(e,t){return Ge(e,function(e,n){return{k:n,v:t(e,n)}})}function ee(e,n){var t={},r=n,o=t,u=ce;return ve(e,function(e,n){(r(e,n)?function(e,n){o[n]=e}:u)(e,n)}),t}function ne(e,t){var r=[];return ve(e,function(e,n){r.push(t(e,n))}),r}function te(e){return ne(e,ae)}function re(e){return fn(e).length}function oe(e,n){return mn(e,n)?be.from(e[n]):be.none()}function ue(e,n){return mn(e,n)&&void 0!==e[n]&&null!==e[n]}function ie(e,n,t){return{element:e,rowspan:n,colspan:t}}function Le(e,n,t){return{element:e,cells:n,section:t}}function D(e,n,t){return{element:e,isNew:n,isLocked:t}}function _e(e,n,t,r){return{element:e,cells:n,section:t,isNew:r}}function We(){return Ve(0,0)}function je(e){function n(e){return function(){return t===e}}var t=e.current,e=e.version;return{current:t,version:e,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(Ze),isSafari:n("Safari")}}function Fe(e){function n(e){return function(){return t===e}}var t=e.current,e=e.version;return{current:t,version:e,isWindows:n(nn),isiOS:n("iOS"),isAndroid:n(tn),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(rn),isFreeBSD:n(on),isChromeOS:n(un)}}function He(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}}function Ve(e,n){return{major:e,minor:n}}function qe(){return je({current:void 0,version:Ke.unknown()})}function Ue(){return Fe({current:void 0,version:Ke.unknown()})}function Ge(e,t){var r={};return ve(e,function(e,n){e=t(e,n);r[e.k]=e.v}),r}var $e,Ke={nu:Ve,detect:function(e,n){var t,r,n=String(n).toLowerCase();return 0===e.length?We():(r=function(e,n){for(var t=0;t<e.length;t++){var r=e[t];if(r.test(n))return r}}(e,t=n))?Ve(o(1),o(2)):{major:0,minor:0};function o(e){return Number(t.replace(r,"$"+e))}},unknown:We},Xe=function(e,n){return G(e,n,0)},Ye=($e=/^\s+|\s+$/g,function(e){return e.replace($e,"")}),Je=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Qe={browsers:le([{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return t(e,"edge/")&&t(e,"chrome")&&t(e,"safari")&&t(e,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Je],search:function(e){return t(e,"chrome")&&!t(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return t(e,"msie")||t(e,"trident")}},{name:"Opera",versionRegexes:[Je,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:$("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:$("firefox")},{name:"Safari",versionRegexes:[Je,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(t(e,"safari")||t(e,"mobile/"))&&t(e,"applewebkit")}}]),oses:le([{name:"Windows",search:$("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return t(e,"iphone")||t(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:$("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:$("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:$("linux"),versionRegexes:[]},{name:"Solaris",search:$("sunos"),versionRegexes:[]},{name:"FreeBSD",search:$("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:$("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}])},Ze="Firefox",en=je,nn=(le("Edge"),le("Chrome"),le("IE"),le("Opera"),le(Ze),le("Safari"),"Windows"),tn="Android",rn="Solaris",on="FreeBSD",un="ChromeOS",cn=Fe,ln=(le(nn),le("iOS"),le(tn),le("Linux"),le("OSX"),le(rn),le(on),le(un),Pe(function(){return e=navigator.userAgent,a=be.from(navigator.userAgentData),i=K,l=Qe.browsers(),f=Qe.oses(),{browser:a=a.bind(function(e){return r=l,Ee(e.brands,function(n){var t=n.brand.toLowerCase();return M(r,function(e){return t===(null==(e=e.brand)?void 0:e.toLowerCase())}).map(function(e){return{current:e.name,version:Ke.nu(parseInt(n.version,10),0)}})});var r}).orThunk(function(){return U(l,t=e).map(function(e){var n=Ke.detect(e.versionRegexes,t);return{current:e.name,version:n}});var t}).fold(qe,en),os:f=U(f,t=e).map(function(e){var n=Ke.detect(e.versionRegexes,t);return{current:e.name,version:n}}).fold(Ue,cn),deviceType:(a=a,n=e,i=i,r=(f=f).isiOS()&&!0===/ipad/i.test(n),o=f.isiOS()&&!r,u=(c=f.isiOS()||f.isAndroid())||i("(pointer:coarse)"),i=r||!o&&c&&i("(min-device-width:768px)"),c=o||c&&!i,a=a.isSafari()&&f.isiOS()&&!1===/safari/i.test(n),{isiPad:le(r),isiPhone:le(o),isTablet:le(i),isPhone:le(c),isTouch:le(u),isAndroid:f.isAndroid,isiOS:f.isiOS,isWebView:le(a),isDesktop:le(!c&&!i&&!a)})};var e,t,n,r,o,u,i,c,l,a,f})),we={fromHtml:function(e,n){n=(n||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return He(n.childNodes[0])},fromTag:function(e,n){return He((n||document).createElement(e))},fromText:function(e,n){return He((n||document).createTextNode(e))},fromDom:He,fromPoint:function(e,n,t){return be.from(e.dom.elementFromPoint(n,t)).map(He)}},an=X,fn=Object.keys,sn=Object.hasOwnProperty,mn=function(e,n){return sn.call(e,n)},dn=["tfoot","thead","tbody","colgroup"];function ye(e){return e.dom.nodeName.toLowerCase()}function gn(e){return e.dom.nodeType}function pn(n){return function(e){return gn(e)===n}}function bn(e){return 8===gn(e)||"#comment"===ye(e)}function hn(n){return function(e){return In(e)&&ye(e)===n}}function vn(e){return we.fromDom(e.dom.ownerDocument)}function wn(e){return Mn(e)?e:vn(e)}function yn(e){return be.from(e.dom.parentNode).map(we.fromDom)}function Cn(e,n){for(var t=m(n)?n:fe,r=e.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=we.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o}function Sn(e){return be.from(e.dom.previousSibling).map(we.fromDom)}function Tn(e){return be.from(e.dom.nextSibling).map(we.fromDom)}function d(e){return de(e.dom.childNodes,we.fromDom)}function xn(e,n){e=e.dom.childNodes;return be.from(e[n]).map(we.fromDom)}function Rn(e){return we.fromDom(e.dom.host)}function Dn(e,n,t){return r=function(e){return X(e,n)},pe(Cn(e,t),r);var r}function On(e,n){return t=function(e){return X(e,n)},pe(d(e),t);var t}function An(e,n){return Y(e=void 0===e?document:e.dom)?[]:de(e.querySelectorAll(n),we.fromDom)}"undefined"==typeof window&&Function("return this;")();function kn(e){if(null==(e=e.dom.body))throw new Error("Body is not available yet");return we.fromDom(e)}var In=pn(1),Bn=pn(3),Mn=pn(9),En=pn(11),Je=m(Element.prototype.attachShadow)&&m(Node.prototype.getRootNode),Pn=le(Je),Nn=Je?function(e){return we.fromDom(e.dom.getRootNode())}:wn,zn=function(e){var n,t,r,o,u=Bn(e)?e.dom.parentNode:e.dom;return null!=u&&null!==u.ownerDocument&&(o=u.ownerDocument,e=we.fromDom(u),e=Nn(e),(En(r=e)&&i(r.dom.host)?be.some(e):be.none()).fold(function(){return o.body.contains(u)},(n=zn,t=Rn,function(e){return n(t(e))})))},Ln=function(e,n){var t=[];return ge(d(e),function(e){t=(t=n(e)?t.concat([e]):t).concat(Ln(e,n))}),t};function _n(e,n,t,r,o){return e(t,r)?be.some(t):m(o)&&o(t)?be.none():n(t,r,o)}function Wn(e,n,t){for(var r=e.dom,o=m(t)?t:fe;r.parentNode;){var r=r.parentNode,u=we.fromDom(r);if(n(u))return be.some(u);if(o(u))break}return be.none()}function jn(e,n,t){return Wn(e,function(e){return X(e,n)},t)}function Fn(e,n){return t=function(e){return X(e,n)},M(e.dom.childNodes,function(e){return t(we.fromDom(e))}).map(we.fromDom);var t}function Hn(e,n){return J(n,e)}function P(e,n,t){return _n(X,jn,e,n,t)}function Vn(e,n,t){if(!(ke(t)||f(t)||b(t)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",t,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,t+"")}function Ce(e,n,t){Vn(e.dom,n,t)}function qn(e,n){var t=e.dom;ve(n,function(e,n){Vn(t,n,e)})}function Un(e,n){e=e.dom.getAttribute(n);return null===e?void 0:e}function Gn(e,n){return be.from(Un(e,n))}function $n(e){return Be(e.dom.attributes,function(e,n){return e[n.name]=n.value,e},{})}function Kn(e,n,t){return void 0===t&&(t=l),e.exists(function(e){return t(e,n)})}function Xn(e){for(var n=[],t=function(e){n.push(e)},r=0;r<e.length;r++)e[r].each(t);return n}function Yn(e,n,t){return e.isSome()&&n.isSome()?be.some(t(e.getOrDie(),n.getOrDie())):be.none()}function Jn(e,n){return e?be.some(n):be.none()}function Qn(e){return void 0!==e.style&&m(e.style.getPropertyValue)}function Zn(e,n,t){if(!ke(t))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",t,":: Element ",e),new Error("CSS value must be a string: "+t);Qn(e)&&e.style.setProperty(n,t)}function Se(e,n,t){Zn(e.dom,n,t)}function et(e,n){var t=e.dom;ve(n,function(e,n){Zn(t,n,e)})}function nt(e,n){var t=e.dom,r=window.getComputedStyle(t).getPropertyValue(n);return""!==r||zn(e)?r:$t(t,n)}function tt(e,n){e=e.dom,e=$t(e,n);return be.from(e).filter(function(e){return 0<e.length})}function rt(e,n){var t;Qn(t=e.dom)&&t.style.removeProperty(n),Kn(Gn(e,"style").map(Ye),"")&&xe(e,"style")}function ot(e,n,t){return void 0===t&&(t=0),Gn(e,n).map(function(e){return parseInt(e,10)}).getOr(t)}function ut(e,n){return ot(e,n,1)}function it(e){return hn("col")(e)?1<ot(e,"span",1):1<ut(e,"colspan")}function ct(e){return 1<ut(e,"rowspan")}function lt(e,n){return parseInt(nt(e,n),10)}function at(e,n){return Yt(e,n,se)}function ft(e,n){return t=["td","th"],(r=void 0===(r=n)?fe:n)(n=e)?be.none():me(t,ye(n))?be.some(n):jn(n,t.join(","),function(e){return X(e,"table")||r(e)});var t,r}function st(e){return at(e,"th,td")}function mt(e){return X(e,"colgroup")?On(e,"col"):w(qt(e),function(e){return On(e,"col")})}function Te(e,n){return P(e,"table",n)}function dt(e){return at(e,"tr")}function gt(e,n){return de(e,function(e){return"colgroup"!==ye(e)?Le(e,de(st(e),function(e){return ie(e,ot(e,"rowspan",1),ot(e,"colspan",1))}),n(e)):Le(e,de(mt(e),function(e){return ie(e,1,ot(e,"span",1))}),"colgroup")})}function pt(e){return yn(e).map(function(e){e=ye(e);return me(dn,e)?e:"tbody"}).getOr("tbody")}function bt(e){var n=dt(e);return gt(q(q([],qt(e),!0),n,!0),pt)}function ht(e,n,t){var r=e.cells,o=r.slice(0,n),r=r.slice(n),n=o.concat(t).concat(r);return Jt(e,n)}function vt(e,n,t){return ht(e,n,[t])}function wt(e,n,t){e.cells[n]=t}function yt(e,n){return e.cells[n]}function O(e,n){return yt(e,n).element}function Ct(e){return e.cells.length}function p(e){e=T(e,function(e){return"colgroup"===e.section});return{rows:e.fail,cols:e.pass}}function St(e,n,t){t=de(e.cells,t);return _e(n(e.element),t,e.section,!0)}function Tt(e){return Gn(e,Qt).bind(function(e){return be.from(e.match(/\d+/g))}).map(function(e){return z(e,se)})}function xt(e){var e=ne(Be(p(e).rows,function(t,e){return ge(e.cells,function(e,n){e.isLocked&&(t[n]=!0)}),t},{}),function(e,n){return parseInt(n,10)});return(e=F.call(e,0)).sort(void 0),e}function Rt(e){var l={},n=[],a=Me(e).map(function(e){return e.element}).bind(Te).bind(Tt).getOr({}),t=0,f=0,s=0,e=T(e,function(e){return"colgroup"===e.section}),r=e.pass,e=(ge(e.fail,function(e){var c=[];ge(e.cells,function(e){for(var n=0;void 0!==l[s+","+n];)n++;for(var t=ue(a,n.toString()),r={element:e.element,rowspan:e.rowspan,colspan:e.colspan,row:s,column:n,isLocked:t},o=0;o<e.colspan;o++)for(var u=0;u<e.rowspan;u++){var i=n+o;l[s+u+","+i]=r,f=Math.max(f,i+1)}c.push(r)}),t++,n.push(Le(e.element,c,e.section)),s++}),W(r).map(function(e){r={},o=0,ge(e.cells,function(n){var t=n.colspan;A(t,function(e){e=o+e;r[e]={element:n.element,colspan:t,column:e}}),o+=t});var r,o,n=r;return{colgroups:[{element:e.element,columns:te(n)}],columns:n}}).getOrThunk(function(){return{colgroups:[],columns:{}}})),r=e.columns,e=e.colgroups;return{grid:{rows:t,columns:f},access:l,all:n,columns:r,colgroups:e}}function Dt(e,n){var t=n.column,r=n.column+n.colspan-1,o=n.row,n=n.row+n.rowspan-1;return t<=e.finishCol&&r>=e.startCol&&o<=e.finishRow&&n>=e.startRow}function Ot(e,n){return n.column>=e.startCol&&n.column+n.colspan-1<=e.finishCol&&n.row>=e.startRow&&n.row+n.rowspan-1<=e.finishRow}function At(e,n,t){var n=Re.findItem(e,n,he),r=Re.findItem(e,t,he);return n.bind(function(t){return r.map(function(e){return n=t,e=e,{startRow:Math.min(n.row,e.row),startCol:Math.min(n.column,e.column),finishRow:Math.max(n.row+n.rowspan-1,e.row+e.rowspan-1),finishCol:Math.max(n.column+n.colspan-1,e.column+e.colspan-1)};var n})})}function kt(n,e,t){return At(n,e,t).map(function(e){return de(Re.filterItems(n,E(Dt,e)),function(e){return e.element})})}function It(e,n){return Re.findItem(e,n,function(e,n){return Q(n,e)}).map(function(e){return e.element})}function Bt(e,n,t,r,o){var u=Zt(e),t=he(e,t)?be.some(n):It(u,n),i=he(e,o)?be.some(r):It(u,r);return t.bind(function(n){return i.bind(function(e){return kt(u,n,e)})})}function Mt(n,t){yn(n).each(function(e){e.dom.insertBefore(t.dom,n.dom)})}function Et(e,n){Tn(e).fold(function(){yn(e).each(function(e){De(e,n)})},function(e){Mt(e,n)})}function Pt(n,t){xn(n,0).fold(function(){De(n,t)},function(e){n.dom.insertBefore(t.dom,e.dom)})}function Nt(e,n){Mt(e,n),De(n,e)}function zt(t,r){ge(r,function(e,n){Et(0===n?t:r[n-1],e)})}function Lt(n,e){ge(e,function(e){De(n,e)})}function _t(e){e.dom.textContent="",ge(d(e),function(e){Oe(e)})}function Wt(e){var n,t=d(e);0<t.length&&(n=e,ge(t,function(e){Mt(n,e)})),Oe(e)}function jt(e){return er.get(e)}function Ft(e){return er.getOption(e)}function Ht(e,n){return er.set(e,n)}function Vt(e,n){return pe(w(e.all,function(e){return e.cells}),n)}function qt(e){return Te(e).fold(le([]),function(e){return On(e,"colgroup")})}var Ut,Gt,xe=function(e,n){e.dom.removeAttribute(n)},$t=function(e,n){return Qn(e)?e.style.getPropertyValue(n):""},Kt=le(10),Xt=le(10),Yt=function(e,n,t){return w(d(e),function(e){return X(e,n)?t(e)?[e]:[]:Yt(e,n,t)})},Jt=function(e,n){return _e(e.element,n,e.section,e.isNew)},Qt="data-snooker-locked-cols",Re={fromTable:function(e){return Rt(bt(e))},generate:Rt,getAt:function(e,n,t){return be.from(e.access[n+","+t])},findItem:function(e,n,t){e=Vt(e,function(e){return t(n,e.element)});return 0<e.length?be.some(e[0]):be.none()},filterItems:Vt,justCells:function(e){return w(e.all,function(e){return e.cells})},justColumns:function(e){return te(e.columns)},hasColumns:function(e){return 0<fn(e.columns).length},getColumnAt:function(e,n){return be.from(e.columns[n])}},Zt=Re.fromTable,De=function(e,n){e.dom.appendChild(n.dom)},Oe=function(e){e=e.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},er=(Ut=Bn,{get:function(e){if(Ut(e))return Gt(e).getOr("");throw new Error("Can only get text value of a text node")},getOption:Gt=function(e){return Ut(e)?be.from(e.dom.nodeValue):be.none()},set:function(e,n){if(!Ut(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=n}}),nr=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function tr(){return{up:le({selector:jn,closest:P,predicate:Wn,all:Cn}),down:le({selector:An,predicate:Ln}),styles:le({get:nt,getRaw:tt,set:Se,remove:rt}),attrs:le({get:Un,set:Ce,remove:xe,copyTo:function(e,n){qn(n,$n(e))}}),insert:le({before:Mt,after:Et,afterAll:zt,append:De,appendAll:Lt,prepend:Pt,wrap:Nt}),remove:le({unwrap:Wt,remove:Oe}),create:le({nu:we.fromTag,clone:function(e){return we.fromDom(e.dom.cloneNode(!1))},text:we.fromText}),query:le({comparePosition:function(e,n){return e.dom.compareDocumentPosition(n.dom)},prevSibling:Sn,nextSibling:Tn}),property:le({children:d,name:ye,parent:yn,document:function(e){return wn(e).dom},isText:Bn,isComment:bn,isElement:In,isSpecial:function(e){return me(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],ye(e))},getLanguage:function(e){return In(e)?Gn(e,"lang"):be.none()},getText:jt,setText:Ht,isBoundary:function(e){return!!In(e)&&("body"===ye(e)||me(nr,ye(e)))},isEmptyTag:function(e){return!!In(e)&&me(["br","img","hr","input"],ye(e))},isNonEditable:function(e){return In(e)&&"false"===Un(e,"contenteditable")}}),eq:he,is:an}}function rr(t,e){return jr($r,function(e,n){return t(n)},e)}function or(e){return jn(e,"table")}function ur(u,i,c){function l(n){return function(e){return void 0!==c&&c(e)||he(e,n)}}return he(u,i)?be.some({boxes:be.some([u]),start:u,finish:i}):or(u).bind(function(o){return or(i).bind(function(r){var e,n,t;return he(o,r)?be.some({boxes:(n=u,t=i,kt(Zt(o),n,t)),start:u,finish:i}):Q(o,r)?(n=0<(e=Dn(i,"td,th",l(o))).length?e[e.length-1]:i,be.some({boxes:Bt(o,u,o,i,r),start:u,finish:n})):Q(r,o)?(t=0<(e=Dn(u,"td,th",l(r))).length?e[e.length-1]:u,be.some({boxes:Bt(r,u,o,i,r),start:u,finish:t})):Gr($r,u,i,void 0).shared.bind(function(e){return P(e,"table",c).bind(function(e){var n=Dn(i,"td,th",l(e)),n=0<n.length?n[n.length-1]:i,t=Dn(u,"td,th",l(e)),t=0<t.length?t[t.length-1]:u;return be.some({boxes:Bt(e,u,o,i,r),start:t,finish:n})})})})})}function ir(e,n){e=An(e,n);return 0<e.length?be.some(e):be.none()}function cr(e,n,r){return Hn(e,n).bind(function(t){return Hn(e,r).bind(function(n){return rr(or,[t,n]).map(function(e){return{first:t,last:n,table:e}})})})}function lr(r,e,n){return cr(r,e,n).bind(function(o){function e(e){return he(r,e)}var n="thead,tfoot,tbody,table",t=jn(o.first,n,e),u=jn(o.last,n,e);return t.bind(function(r){return u.bind(function(e){return he(r,e)?(e=o.table,n=o.first,t=o.last,e=Zt(e),At(c=e,n,t).bind(function(e){for(var n=c,t=e,r=!0,o=E(Ot,t),u=t.startRow;u<=t.finishRow;u++)for(var i=t.startCol;i<=t.finishCol;i++)r=r&&Re.getAt(n,u,i).exists(o);return r?be.some(t):be.none()})):be.none();var c,n,t})})})}function ar(e,n,t,r){return e.fold(n,t,r)}function fr(e,n){return we.fromDom(e.dom.cloneNode(n))}function sr(e){return fr(e,!1)}function mr(e){return fr(e,!0)}function dr(e,n){n=we.fromTag(n);return qn(n,$n(e)),n}function gr(t,r){function e(e){var n=r(e);return n<=0||null===n?(e=nt(e,t),parseFloat(e)||0):n}function o(t,e){return Be(e,function(e,n){n=nt(t,n),n=void 0===n?0:parseInt(n,10);return isNaN(n)?e:e+n},0)}return{set:function(e,n){if(!b(n)&&!n.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+n);e=e.dom;Qn(e)&&(e.style[t]=n+"px")},get:e,getOuter:e,aggregate:o,max:function(e,n,t){e=o(e,t);return e<n?n-e:0}}}function pr(){var e=ln().browser;return e.isIE()||e.isEdge()}function br(e,n,t){return e=nt(e,n),n=t,t=parseFloat(e),(isNaN(t)?be.none():be.some(t)).getOr(n)}function hr(e){return nt(e,"box-sizing")}function vr(e,n,t,r){return n-br(e,"padding-"+t,0)-br(e,"padding-"+r,0)-br(e,"border-"+t+"-width",0)-br(e,"border-"+r+"-width",0)}function wr(e,n){var t=e.dom,t=t.getBoundingClientRect().width||t.offsetWidth;return"border-box"===n?t:vr(e,t,"left","right")}function yr(e){return Qr.get(e)}function Cr(e){return Qr.getOuter(e)}function Sr(t,r){void 0===r&&(r=se);var e=t.grid,n=A(e.columns,ae),o=A(e.rows,ae);return de(n,function(n){return Hr(function(){return w(o,function(e){return Re.getAt(t,e,n).filter(function(e){return e.column===n}).toArray()})},function(e){return 1===e.colspan&&r(e.element)},function(){return Re.getAt(t,0,n)})})}function Tr(t){var e=t.grid,n=A(e.rows,ae),r=A(e.columns,ae);return de(n,function(n){return Hr(function(){return w(r,function(e){return Re.getAt(t,n,e).filter(function(e){return e.row===n}).fold(le([]),function(e){return[e]})})},function(e){return 1===e.rowspan},function(){return Re.getAt(t,n,0)})})}function xr(n,t){return function(e){return"rtl"==("rtl"===nt(e,"direction")?"rtl":"ltr")?t:n}}function Rr(e){return eo.get(e)}function Dr(e){return eo.getOuter(e)}function Or(e,n){return void 0!==e?e:void 0!==n?n:0}function Ar(e){var n,t,r=e.dom.ownerDocument,o=r.body,u=r.defaultView,r=r.documentElement;return o===e.dom?no(o.offsetLeft,o.offsetTop):(n=Or(null==u?void 0:u.pageYOffset,r.scrollTop),u=Or(null==u?void 0:u.pageXOffset,r.scrollLeft),t=Or(r.clientTop,o.clientTop),r=Or(r.clientLeft,o.clientLeft),to(e).translate(u-r,n-t))}function kr(e,n){return{row:e,y:n}}function Ir(e,n){return{col:e,x:n}}function Br(e){return Ar(e).left+Cr(e)}function Mr(e){return Ar(e).left}function Er(e,n){return Ir(e,Mr(n))}function Pr(e,n){return Ir(e,Br(n))}function Nr(e){return Ar(e).top}function zr(e,n){return kr(e,Nr(n))}function Lr(e,n){return kr(e,Nr(n)+Dr(n))}function _r(t,n,r){var e,o;return 0===r.length?[]:(e=de(r.slice(1),function(e,n){return e.map(function(e){return t(n,e)})}),o=r[r.length-1].map(function(e){return n(r.length-1,e)}),e.concat([o]))}function Wr(i){if(!a(i))throw new Error("cases must be an array");if(0===i.length)throw new Error("there must be at least one case");var c=[],t={};return ge(i,function(e,r){var n=fn(e);if(1!==n.length)throw new Error("one and only one name per case");var o=n[0],u=e[o];if(void 0!==t[o])throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!a(u))throw new Error("case arguments must be an array");c.push(o),t[o]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.length;if(n!==u.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+u.length+" ("+u+"), got "+n);return{fold:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(e.length!==i.length)throw new Error("Wrong number of arguments to fold. Expected "+i.length+", got "+e.length);return e[r].apply(null,t)},match:function(e){var n=fn(e);if(c.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+n.join(","));if(I(c,function(e){return me(n,e)}))return e[o].apply(null,t);throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+c.join(", "))},log:function(e){console.log(e,{constructors:c,constructor:o,params:t})}}}}),t}function jr(e,n,t){return 0<t.length?(r=e,o=n,e=t[0],Ie(t.slice(1),function(e,n){n=o(r,n);return Ur(r,e,n)},o(r,e))):be.none();var r,o}function Fr(e){return pr()?wr(e,hr(e)):br(e,"width",e.dom.offsetWidth)}function Hr(e,n,t){var r=e();return M(r,n).orThunk(function(){return be.from(r[0]).orThunk(t)}).map(function(e){return e.element})}function Vr(e){return pr()?(t=hr(n=e),r=(r=n.dom).getBoundingClientRect().height||r.offsetHeight,"border-box"===t?r:vr(n,r,"top","bottom")):br(e,"height",e.dom.offsetHeight);var n,t,r}function qr(t,r){return{left:t,top:r,translate:function(e,n){return qr(t+e,r+n)}}}var Ur=function(n,e,t){return e.bind(function(e){return t.filter(E(n.eq,e))})},Gr=function(n,e,t,r){function o(n){return x(n,r).fold(function(){return n},function(e){return n.slice(0,e+1)})}void 0===r&&(r=fe);var e=[e].concat(n.up().all(e)),t=[t].concat(n.up().all(t)),e=o(e),u=o(t),t=M(e,function(e){return v(u,E(n.eq,e))});return{firstpath:e,secondpath:u,shared:t}},$r=tr(),Kr=ir,Je=Wr([{none:[]},{multiple:["elements"]},{single:["element"]}]),Xr=Je.none,Yr=Je.multiple,Jr=Je.single,Je=tinymce.util.Tools.resolve("tinymce.PluginManager"),Qr=gr("width",function(e){return e.dom.offsetWidth}),Zr=function(e){return wr(e,"content-box")},eo=gr("height",function(e){var n=e.dom;return zn(e)?n.getBoundingClientRect().height:n.offsetHeight}),no=qr,to=function(e){var n=e.dom,t=n.ownerDocument.body;return t===n?no(t.offsetLeft,t.offsetTop):zn(e)?(t=n.getBoundingClientRect(),no(t.left,t.top)):no(0,0)},ro={delta:ae,positions:function(e){return _r(zr,Lr,e)},edge:Nr},oo=xr({delta:ae,edge:Mr,positions:function(e){return _r(Er,Pr,e)}},{delta:function(e){return-e},edge:Br,positions:function(e){return _r(Pr,Er,e)}}),uo={delta:function(e,n){return oo(n).delta(e,n)},positions:function(e,n){return oo(n).positions(e,n)},edge:function(e){return oo(e).edge(e)}},io={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},co=(na=["Infinity",(na="[0-9]+")+"\\."+lo(na)+lo(n="[eE][+-]?[0-9]+"),"\\."+na+lo(n),na+lo(n)].join("|"),new RegExp("^([+-]?(?:"+na+"))(.*)$"));function lo(e){return"(?:"+e+")?"}function ao(e,n,t){var r=be.from(e.dom.parentElement).map(we.fromDom).getOrThunk(function(){return kn(vn(e))});return n(e)/t(r)*100}function fo(e,n){Se(e,"width",n+"px")}function so(e,n){Se(e,"width",n+"%")}function mo(e,n){Se(e,"height",n+"px")}function go(e,n){return tt(e,n).orThunk(function(){return Gn(e,n).map(function(e){return e+"px"})})}function po(e){return go(e,"width")}function bo(e){return ao(e,yr,Zr)}function ho(e){return(zl(e)?yr:Fr)(e)}function vo(e){return n=e=e,((l=Vr(n)+"px")?(l=l,t=n,r=Rr,i=mo,c=parseFloat(l),Ne(l,"%")&&"table"!==ye(t)?(o=c,u=r,l=i,i=Te(r=t).map(function(e){e=u(e);return Math.floor(o/100*e)}).getOr(o),l(r,i),i):c):Rr(n))/ut(e,"rowspan");var n,t,r,o,u,i,c,l}function wo(e,n,t){Se(e,"width",n+t)}function yo(e){return ao(e,yr,Zr)+"%"}function Co(e){return po(e).getOrThunk(function(){return ho(e)+"px"})}function So(e){return go(e,"height").getOrThunk(function(){return vo(e)+"px"})}function To(e,o,u,n,t,i){return e.filter(n).fold(function(){return i((n=u,(t=o)<0||t>=n.length-1?be.none():(e=n[t].fold(function(){var e;return Ee((e=n.slice(0,t),(e=F.call(e,0)).reverse(),e),function(e,n){return e.map(function(e){return{value:e,delta:n+1}})})},function(e){return be.some({value:e,delta:0})}),r=n[t+1].fold(function(){return Ee(n.slice(t+1),function(e,n){return e.map(function(e){return{value:e,delta:n+1}})})},function(e){return be.some({value:e,delta:1})}),e.bind(function(t){return r.map(function(e){var n=e.delta+t.delta;return Math.abs(e.value-t.value)/n})}))));var n,t,e,r},function(e){return t(e)})}function xo(e,n,o,u){var i=Sr(e),e=Re.hasColumns(e)?de(Re.justColumns(e),function(e){return be.from(e.element)}):i,c=[be.some(uo.edge(n))].concat(de(uo.positions(i,n),function(e){return e.map(function(e){return e.x})})),l=h(it);return de(e,function(e,r){return To(e,r,c,l,function(e){return n=e,t=(t=ln().browser).isChrome()||t.isFirefox(),!_l(n)||t?o(e):To(null!=(n=i[r])?n:be.none(),r,c,l,function(e){return u(be.some(yr(e)))},u);var n,t},u)})}function Ro(e){return e.map(function(e){return e+"px"}).getOr("")}function Do(e,n,t){return xo(e,n,ho,function(e){return e.getOrThunk(t.minCellWidth)})}function Oo(e,n,t,r,o){var e=Tr(e),u=[be.some(t.edge(n))].concat(de(t.positions(e,n),function(e){return e.map(function(e){return e.y})}));return de(e,function(e,n){return To(e,n,u,h(ct),r,o)})}function Ao(e,n){return function(){return zn(e)?n(e):parseFloat(tt(e,"width").getOr("0"))}}function ko(r){var t=Ao(r,function(e){return parseFloat(yo(e))}),n=Ao(r,yr);return{width:t,pixelWidth:n,getWidths:function(e,n){return t=n,xo(e,r,bo,function(e){return e.fold(function(){return t.minCellWidth()},function(e){return e/t.pixelWidth()*100})});var t},getCellDelta:function(e){return e/n()*100},singleColumnWidth:function(e,n){return[100-e]},minCellWidth:function(){return Kt()/n()*100},setElementWidth:so,adjustTableWidth:function(e){var n=t();so(r,n+e/100*n)},isRelative:!0,label:"percent"}}function Io(t){var n=Ao(t,yr);return{width:n,pixelWidth:n,getWidths:function(e,n){return Do(e,t,n)},getCellDelta:ae,singleColumnWidth:function(e,n){return[Math.max(Kt(),e+n)-e]},minCellWidth:Kt,setElementWidth:fo,adjustTableWidth:function(e){e=n()+e;fo(t,e)},isRelative:!1,label:"pixel"}}function Bo(e){return"img"===ye(e)?1:Ft(e).fold(function(){return d(e).length},function(e){return e.length})}function Mo(e){return Ft(e).filter(function(e){return 0!==e.trim().length||-1<e.indexOf("Â ")}).isSome()||me(Hl,ye(e))}function Eo(e){return r=Mo,(o=function(e){for(var n=0;n<e.childNodes.length;n++){var t=we.fromDom(e.childNodes[n]);if(r(t))return be.some(t);t=o(e.childNodes[n]);if(t.isSome())return t}return be.none()})(e.dom);var r,o}function Po(e){return Vl(e,Mo)}function No(n){return function(){var e=we.fromTag("td",n.dom);return De(e,we.fromTag("br",n.dom)),e}}function zo(e){return function(){return we.fromTag("col",e.dom)}}function Lo(e){return function(){return we.fromTag("colgroup",e.dom)}}function _o(e){return function(){return we.fromTag("tr",e.dom)}}function Wo(e,n,t){Lt(n=dr(e=e,n),d(mr(e)));var r=n;return ve(t,function(e,n){null===e?xe(r,n):Ce(r,n,e)}),r}function jo(e){return e}function Fo(l,a,f){function s(e,n){var t=e.element.dom,r=n.dom;Qn(t)&&Qn(r)&&(r.style.cssText=t.style.cssText),rt(n,"height"),1!==e.colspan&&rt(n,"width")}return{col:function(e){var n=we.fromTag(ye(e.element),a.dom);return s(e,n),l(e.element,n),n},colgroup:Lo(a),row:_o(a),cell:function(e){var n,t,r,o,u,i=we.fromTag(ye(e.element),a.dom),c=f.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),c=0<c.length?(n=e.element,t=i,r=c,Eo(n).map(function(e){return Ie(Dn(e,r.join(","),function(e){return he(e,n)}),function(e,n){n=sr(n);return xe(n,"contenteditable"),De(e,n),n},t)}).getOr(t)):i;return De(c,we.fromTag("br")),s(e,i),o=e.element,u=i,ve(ql,function(n,t){Gn(o,t).filter(function(e){return me(n,e)}).each(function(e){return Ce(u,t,e)})}),l(e.element,i),i},replace:Wo,colGap:zo(a),gap:No(a)}}function Ho(e){return{col:zo(e),colgroup:Lo(e),row:_o(e),cell:No(e),replace:jo,colGap:zo(e),gap:No(e)}}function Vo(e){return de(e,we.fromDom)}function qo(e){return we.fromDom(e.getBody())}function Uo(e){return e.getBoundingClientRect().width}function Go(e){return e.getBoundingClientRect().height}function $o(n){return function(e){return he(e,qo(n))}}function Ko(e){return/^\d+(\.\d+)?$/.test(e)?e+"px":e}function Xo(e){function n(e){return xe(e,"data-mce-style")}xe(e,"data-mce-style"),ge(st(e),n),ge(mt(e),n),ge(dt(e),n)}function Yo(e){return we.fromDom(e.selection.getStart())}function Jo(e){return ar(e.get(),le([]),ae,L)}function Qo(e,n,t){return{element:t,mergable:(o=n,u=Ul,ar(e.get(),be.none,function(n){return n.length<=1?be.none():lr(o,u.firstSelectedSelector,u.lastSelectedSelector).map(function(e){return{bounds:e,cells:n}})},be.none)),unmergable:0<(t=Jo(e)).length&&I(t,function(e){return r(e,"rowspan")||r(e,"colspan")})?be.some(t):be.none(),selection:Jo(e)};function r(e,n){return Gn(e,n).exists(function(e){return 1<parseInt(e,10)})}var o,u}function Zo(r){return function(e,n){var t=ye(e);return P("col"===t||"colgroup"===t?Te(t=e).bind(function(e){return Kr(e,Ul.firstSelectedSelector)}).fold(le(t),function(e){return e[0]}):e,r,n)}}function eu(u,e,i){u.on("BeforeGetContent",function(t){!0===t.selection&&ar(e.get(),ce,function(e){t.preventDefault(),Te(e[0]).map(function(e){e=function(e,n){function t(e){return X(e.element,n)}for(var o,u,i,c,l,a,f,r,s,m,d,g,p=mr(e),b=bt(p),h=Wl(e),v=Re.generate(b),w=(o=t,w=v.grid.columns,u=v.grid.rows,i=w,l=c=0,a=[],f=[],ve(v.access,function(e){var n,t,r;a.push(e),o(e)&&(f.push(e),t=(n=e.row)+e.rowspan-1,e=(r=e.column)+e.colspan-1,n<u?u=n:c<t&&(c=t),r<i?i=r:l<e&&(l=e))}),{minRow:u,minCol:i,maxRow:c,maxCol:l,allCells:a,selectedCells:f}),y="th:not("+n+"),td:not("+n+")",C=(ge(Yt(p,"th,td",function(e){return X(e,y)}),Oe),b),S=v,T=w,x=t,R=S.grid.columns,D=S.grid.rows,O=0;O<D;O++)for(var A=!1,k=0;k<R;k++)O<T.minRow||T.maxRow<O||k<T.minCol||T.maxCol<k||(Re.getAt(S,O,k).filter(x).isNone()?(m=A,d=C[O].element,g=we.fromTag("td"),De(g,we.fromTag("br")),(m?De:Pt)(d,g)):A=!0);return b=p,r=w,v=v,s=e,e=Re.fromTable(e),h=h,w=0===(w=w).minCol&&e.grid.columns===w.maxCol+1?0:(s=Be(e=Do(e,s,h),function(e,n){return e+n},0),e=Be(e.slice(w.minCol,w.maxCol+1),function(e,n){return e+n},0)/s*h.pixelWidth()-h.pixelWidth(),h.getCellDelta(e)),ve(v.columns,function(e){(e.column<r.minCol||e.column>r.maxCol)&&Oe(e.element)}),ge(pe(at(b,"tr"),function(e){return 0===e.dom.childElementCount}),Oe),r.minCol!==r.maxCol&&r.minRow!==r.maxRow||ge(at(b,"th,td"),function(e){xe(e,"rowspan"),xe(e,"colspan")}),xe(b,Qt),xe(b,"data-snooker-col-series"),Wl(b).adjustTableWidth(w),p}(e,"[data-mce-selected]");return Xo(e),[e]}).each(function(e){var n;t.content=("text"===t.format?de(e,function(e){return e.dom.innerText}):(n=u,de(e,function(e){return n.selection.serializer.serialize(e.dom,{})}))).join("")})},ce)}),u.on("BeforeSetContent",function(o){!0===o.selection&&!0===o.paste&&Me(Kl(e)).each(function(r){Te(r).each(function(e){var n=pe((n=o.content,(t=document.createElement("div")).innerHTML=n,d(we.fromDom(t))),function(e){return"meta"!==ye(e)}),t=hn("table");1===n.length&&t(n[0])&&(o.preventDefault(),t=Ho(we.fromDom(u.getDoc())),n={element:r,clipboard:n[0],generators:t},i.pasteCells(e,n).each(function(){u.focus()}))})})})}function nu(e,n,t){for(var r=0,o=e;o<n;o++)r+=void 0!==t[o]?t[o]:0;return r}function tu(e,n,t){var r,o;ge((n=n,Re.hasColumns(e=e)?(o=n,de(Re.justColumns(e),function(e,n){return{element:e.element,width:o[n],colspan:e.colspan}})):(r=n,de(Re.justCells(e),function(e){var n=nu(e.column,e.column+e.colspan,r);return{element:e.element,width:n,colspan:e.colspan}}))),function(e){t.setElementWidth(e.element,e.width)})}function ru(e,n,t,r,o){var u,i,c,l,e=Re.fromTable(e),n=o.getCellDelta(n),a=o.getWidths(e,o),f=t===e.grid.columns-1,n=r.clampTableDelta(a,t,n,o.minCellWidth(),f),s=(t=t,u=n,i=o,c=r,l=(s=a).slice(0),t=t,s=0===(s=s).length?Xl.none():1===s.length?Xl.only(0):0===t?Xl.left(0,1):t===s.length-1?Xl.right(t-1,t):0<t&&t<s.length-1?Xl.middle(t-1,t,t+1):Xl.none(),t=le(de(l,le(0))),s.fold(t,function(e){return i.singleColumnWidth(l[e],u)},function(e,n){return c.calcLeftEdgeDeltas(l,e,n,u,i.minCellWidth(),i.isRelative)},function(e,n,t){return c.calcMiddleDeltas(l,e,n,t,u,i.minCellWidth(),i.isRelative)},function(e,n){return c.calcRightEdgeDeltas(l,e,n,u,i.minCellWidth(),i.isRelative)}));tu(e,de(s,function(e,n){return e+a[n]}),o),r.resizeTable(o.adjustTableWidth,n,f)}function ou(e){return de(e,le(0))}function uu(e,n,t,r,o){return o(e.slice(0,n)).concat(r).concat(o(e.slice(t)))}function iu(o){return function(e,n,t,r){return o(t)?(r=Math.max(r,e[n]-Math.abs(t)),r=Math.abs(r-e[n]),0<=t?r:-r):t}}function cu(){function i(e,t,n,r){var o=(100+n)/100,u=Math.max(r,(e[t]+n)/o);return de(e,function(e,n){return(n===t?u:e/o)-e})}function c(e,n,t,r,o,u){return u?i(e,n,r,o):(u=t,n=Yl(t=e,e=n,r,o),uu(t,e,u+1,[n,0],ou))}return{resizeTable:function(e,n){return e(n)},clampTableDelta:Yl,calcLeftEdgeDeltas:c,calcMiddleDeltas:function(e,n,t,r,o,u,i){return c(e,t,r,o,u,i)},calcRightEdgeDeltas:function(e,n,t,r,o,u){return u?i(e,t,r,o):(u=Yl(e,t,r,o),ou(e.slice(0,t)).concat([u]))},calcRedestributedWidths:function(e,n,t,r){var o;return r?(o=(n+t)/n,r=de(e,function(e){return e/o}),{delta:100*o-100,newSizes:r}):{delta:t,newSizes:e}}}}function lu(){function i(e,n,t,r,o){r=Jl(e,0<=r?t:n,r,o);return uu(e,n,t+1,[r,-r],ou)}return{resizeTable:function(e,n,t){t&&e(n)},clampTableDelta:function(e,n,t,r,o){return o?0<=t?t:(o=Be(e,function(e,n){return e+n-r},0),Math.max(-o,t)):Yl(e,n,t,r)},calcLeftEdgeDeltas:i,calcMiddleDeltas:function(e,n,t,r,o,u){return i(e,t,r,o,u)},calcRightEdgeDeltas:function(e,n,t,r,o,u){return u?ou(e):de(e,le(r/e.length))},calcRedestributedWidths:function(e,n,t,r){return{delta:0,newSizes:e}}}}function au(e,n,t){var e=t.substring(0,t.length-e.length),r=parseFloat(e);return e===r.toString()?n(r):Ql.invalid(t)}function fu(e,n,t){var r,o,u,i,t=Zl.from(t),c=I(e,function(e){return"0px"===e})?(r=e.length,c=t.fold(function(){return le("")},function(e){return le(e/r+"px")},function(){return le(100/r+"%")}),A(r,c)):(o=e,u=n,t.fold(function(){return o},function(e){return t=(n=e)/u,de(o,function(e){return Zl.from(e).fold(function(){return e},function(e){return e*t+"px"},function(e){return e/100*n+"px"})});var n,t},function(e){return n=u,de(o,function(e){return Zl.from(e).fold(function(){return e},function(e){return e/n*100+"%"},function(e){return e+"%"})});var n}));return 0===(e=c).length?e:(t=(n=Ie(e,function(e,n){var t=Zl.from(n).fold(function(){return{value:n,remainder:0}},function(e){return e=e,{value:(n=Math.floor(e))+"px",remainder:e-n};var n},function(e){return{value:e+"%",remainder:0}});return{output:[t.value].concat(e.output),remainder:e.remainder+t.remainder}},{output:[],remainder:0})).output).slice(0,t.length-1).concat([(e=t[t.length-1],i=Math.round(n.remainder),Zl.from(e).fold(le(e),function(e){return e+i+"px"},function(e){return e+i+"%"}))])}function su(e,n){return 0===e.length?n:Ie(e,function(e,n){return Zl.from(n).fold(le(0),ae,ae)+e},0)}function mu(e){return ea(e).fold(le("px"),le("px"),le("%"))}function du(c,e,n){var l=Re.fromTable(c),u=l.all,a=Re.justCells(l),f=Re.justColumns(l);e.each(function(e){var t,r,o,u,n=mu(e),i=yr(c),i=fu(xo(l,c,Co,Ro),i,e);Re.hasColumns(l)?(o=i,u=n,ge(f,function(e,n){n=su([o[n]],Kt());Se(e.element,"width",n+u)})):(t=i,r=n,ge(a,function(e){var n=su(t.slice(e.column,e.colspan+e.column),Kt());Se(e.element,"width",n+r)})),Se(c,"width",e)}),n.each(function(e){var n=mu(e),t=Rr(c),r=fu(Oo(l,c,ro,So,Ro),t,e),t=u,o=n;ge(a,function(e){var n=su(r.slice(e.row,e.rowspan+e.row),Xt());Se(e.element,"height",n+o)}),ge(t,function(e,n){Se(e.element,"height",r[n])}),Se(c,"height",e)})}function gu(e){return Re.fromTable(e).grid}function pu(n){var o=[];return{bind:function(e){if(void 0===e)throw new Error("Event bind error: undefined handler");o.push(e)},unbind:function(n){o=pe(o,function(e){return e!==n})},trigger:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r={};ge(n,function(e,n){r[e]=t[n]}),ge(o,function(e){e(r)})}}}function bu(e){return{registry:Z(e,function(e){return{bind:e.bind,unbind:e.unbind}}),trigger:Z(e,function(e){return e.trigger})}}function hu(e){return e.slice(0).sort()}function vu(n,e){e=pe(e,function(e){return!me(n,e)});if(0<e.length)throw new Error("Unsupported keys for object: "+hu(e).join(", "))}function wu(e){var r=vu,o=e,u={validate:m,label:"function"};if(0===o.length)throw new Error("You must specify at least one required field.");var t,n="required",e=o;if(a(e))return ge(e,function(e){if(!ke(e))throw new Error("The value "+e+" in the "+n+" fields was not a string.")}),M(t=hu(o),function(e,n){return n<t.length-1&&e===t[n+1]}).each(function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}),function(n){var t=fn(n);{var e;if(!I(o,function(e){return me(t,e)}))throw e=t,new Error("All required keys ("+hu(o).join(", ")+") were not specified. Specified keys were: "+hu(e).join(", ")+".")}r(o,t);e=pe(o,function(e){return!u.validate(n[e],e)});if(0<e.length)throw new Error("All values need to be of type: "+u.label+". Keys ("+hu(e).join(", ")+") were not.");return n};throw new Error("The "+n+" fields must be an array. Was: "+e+".")}function yu(e){function n(){return e.stopPropagation()}function t(){return e.preventDefault()}var r,o,u=we.fromDom(function(e){if(Pn()&&i(e.target)){var n=we.fromDom(e.target);if(In(n)&&i(n.dom.shadowRoot)&&e.composed&&e.composedPath){n=e.composedPath();if(n)return Me(n)}}return be.from(e.target)}(e).getOr(e.target));r=t,o=n;return{target:u,x:e.clientX,y:e.clientY,stop:n,prevent:t,kill:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return r(o.apply(null,e))},raw:e}}function Cu(e,n,t){return r=oa,o=t,(t=e).dom.addEventListener(e=n,n=function(e){r(e)&&o(yu(e))},!1),{unbind:E(Tl,t,e,n,!1)};var r,o}function Su(e){return void 0!==e.dom.classList}function Tu(e,n){Su(e)?e.dom.classList.add(n):(n=n,Ce(e=e,"class",(void 0===(e=Un(e,"class"))||""===e?[]:e.split(" ")).concat([n]).join(" ")))}function xu(e,n){return Su(e)&&e.dom.classList.contains(n)}function Ru(e){var n=e.replace(/\./g,"-");return{resolve:function(e){return n+"-"+e}}}function Du(e){return P(e,"[contenteditable]")}function Ou(e,n){return void 0===n&&(n=!1),!ln().browser.isIE()&&zn(e)?e.dom.isContentEditable:Du(e).fold(le(n),function(e){return"true"===xl(e)})}function Au(e){ge(An(e.parent(),"."+la),Oe)}function ku(n,e,t){var r=n.origin();ge(e,function(e){e.each(function(e){e=t(r,e);Tu(e,la),De(n.parent(),e)})})}function Iu(e,n){var t,r,o,u,i,c,l,a,f,s,m,d,g,p,b,h;Au(e),e.isResizable(n)&&(t=o=Re.fromTable(n),e=e,n=n,r=Tr(o),o=Sr(o),i=Ar(n),c=e.isResizable,l=0<(r=0<r.length?ro.positions(r,n):[]).length?(u=c,w(t.all,function(e,n){return u(e.element)?[n]:[]})):[],a=e,r=pe(r,function(e,n){return v(l,function(e){return n===e})}),f=i,s=Cr(n),ku(a,r,function(e,n){t=n.row,o=f.left-e.left,n=n.y-e.top,e=s,et(r=we.fromTag("div"),{position:"absolute",left:o+"px",top:n-3.5+"px",height:"7px",width:e+"px"}),qn(r,{"data-row":t,role:"presentation"});var t,r,o=r;return Tu(o,aa),o}),p=0<(a=0<o.length?uo.positions(o,n):[]).length?(d=c,g=[],A((m=t).grid.columns,function(e){Re.getColumnAt(m,e).map(function(e){return e.element}).forall(d)&&g.push(e)}),pe(g,function(n){return I(Re.filterItems(m,function(e){return e.column===n}),function(e){return d(e.element)})})):[],r=e,o=pe(a,function(e,n){return v(p,function(e){return n===e})}),b=i,h=Dr(n),ku(r,o,function(e,n){t=n.col,n=n.x-e.left,e=b.top-e.top,r=h,et(o=we.fromTag("div"),{position:"absolute",left:n-3.5+"px",top:e+"px",height:r+"px",width:"7px"}),qn(o,{"data-column":t,role:"presentation"});var t,r,o,n=o;return Tu(n,fa),n}))}function Bu(e,n){ge(An(e.parent(),"."+la),n)}function Mu(e){Bu(e,function(e){Se(e,"display","none")})}function Eu(e){Bu(e,function(e){Se(e,"display","block")})}function Pu(o){function e(e,n){return be.from(Un(e,n))}r=bu({drag:pu(["xDelta","yDelta","target"])}),u=be.none(),(n={mutate:function(e,n){t.trigger.drag(e,n)},events:(t=bu({drag:pu(["xDelta","yDelta"])})).registry}).events.drag.bind(function(n){u.each(function(e){r.trigger.drag(n.xDelta,n.yDelta,e)})});var t,r,u,n,i,c,l,a,f,s,m,d,g,p,b,h,v,w,y,C={assign:function(e){u=be.some(e)},get:function(){return u},mutate:n.mutate,events:r.registry},S=(l=void 0!==(n={}).mode?n.mode:ca,i=C,c=l,l=n,b=!1,h=bu({start:pu([]),stop:pu([])}),d={onEvent:ce,reset:ce,events:bu({move:pu(["info"])}).registry},s=be.none(),g={onEvent:function(e,r){r.extract(e).each(function(e){var n=r,t=e,e=s.map(function(e){return n.compare(e,t)});s=be.some(t),e.each(function(e){m.trigger.move(e)})})},reset:function(){s=be.none()},events:(m=bu({move:pu(["info"])})).registry},p=d,a=x,f=null,w={cancel:R,throttle:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];R(),f=setTimeout(function(){f=null,a.apply(null,e)},200)}},(v={on:function(){p.reset(),p=g},off:function(){p.reset(),p=d},isOn:function(){return p===g},onEvent:function(e,n){p.onEvent(e,n)},events:g.events}).events.move.bind(function(e){c.mutate(i,e.info)}),{element:(y=c.sink(ra({forceDrop:x,drop:D(x),move:D(function(e){w.cancel(),v.onEvent(e,c)}),delayDrop:D(w.throttle)}),l)).element,go:function(e){y.start(e),v.on(),h.trigger.start()},on:function(){b=!0},off:function(){b=!1},destroy:function(){y.destroy()},events:h.registry}),T=be.none();function x(){y.stop(),v.isOn()&&(v.off(),h.trigger.stop())}function R(){N(f)||(clearTimeout(f),f=null)}function D(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];b&&t.apply(null,e)}}function O(e,n){return lt(e,n)-ot(e,"data-initial-"+n,0)}function A(e,n){M.trigger.startAdjust(),C.assign(e),Ce(e,"data-initial-"+n,lt(e,n)),Tu(e,sa),Se(e,"opacity","0.2"),S.go(o.parent())}function k(e){return he(e,o.view())}C.events.drag.bind(function(t){e(t.target,"data-row").each(function(e){var n=lt(t.target,"top");Se(t.target,"top",n+t.yDelta+"px")}),e(t.target,"data-column").each(function(e){var n=lt(t.target,"left");Se(t.target,"left",n+t.xDelta+"px")})}),S.events.stop.bind(function(){C.get().each(function(r){T.each(function(t){e(r,"data-row").each(function(e){var n=O(r,"top");xe(r,"data-initial-top"),M.trigger.adjustHeight(t,n,parseInt(e,10))}),e(r,"data-column").each(function(e){var n=O(r,"left");xe(r,"data-initial-left"),M.trigger.adjustWidth(t,n,parseInt(e,10))}),Iu(o,t)})})});var I=Cu(o.parent(),"mousedown",function(e){xu(e.target,aa)&&A(e.target,"top"),xu(e.target,fa)&&A(e.target,"left")}),B=Cu(o.view(),"mouseover",function(e){P(e.target,"table",k).filter(Ou).fold(function(){zn(e.target)&&Au(o)},function(e){T=be.some(e),Iu(o,e)})}),M=bu({adjustHeight:pu(["table","delta","row"]),adjustWidth:pu(["table","delta","column"]),startAdjust:pu([])});return{destroy:function(){I.unbind(),B.unbind(),S.destroy(),Au(o)},refresh:function(e){Iu(o,e)},on:S.on,off:S.off,hideBars:E(Mu,o),showBars:E(Eu,o),events:M.registry}}function Nu(e,n){e.fire("newrow",{node:n})}function zu(e,n){e.fire("newcell",{node:n})}function Lu(e,n,t){e.fire("TableModified",R(R({},t),{table:n}))}function _u(e){return e.getParam("table_sizing_mode","auto")}function Wu(e){return e.getParam("table_responsive_width")}function ju(e){return e.getParam("table_border_widths",pa,"array")}function Fu(e){return e.getParam("table_border_styles",ba,"array")}function Hu(e){return e.getParam("table_default_attributes",ha,"object")}function Vu(e){return e.getParam("table_default_styles",wa(e=e)?(n=null!=(n=(n=e.dom).getParent(e.selection.getStart(),n.isBlock))?n:e.getBody(),n=Zr(we.fromDom(n)),R(R({},ga),{width:n+"px"})):Rl(e)?ee(ga,function(e,n){return"width"!==n}):ga,"object");var n}function qu(e){return e.getParam("table_cell_advtab",!0,"boolean")}function Uu(e){return e.getParam("table_row_advtab",!0,"boolean")}function Gu(e){return e.getParam("table_advtab",!0,"boolean")}function $u(e){return e.getParam("table_style_by_css",!1,"boolean")}function Ku(e){return e.getParam("table_cell_class_list",[],"array")}function Xu(e){return e.getParam("table_class_list",[],"array")}function Yu(e){return"relative"===_u(e)||!0===Wu(e)}function Ju(e){var n="section",e=e.getParam("table_header_type",n,"string");return me(["section","cells","sectionCells","auto"],e)?e:n}function Qu(e){var n=e.getParam("table_column_resizing",va,"string");return M(["preservetable","resizetable"],function(e){return e===n}).getOr(va)}function Zu(e){return"preservetable"===Qu(e)}function ei(e){return"resizetable"===Qu(e)}function ni(e){e=e.getParam("table_clone_elements");return ke(e)?be.some(e.split(/[ ,]/)):Array.isArray(e)?be.some(e):be.none()}function ti(e){return e.getParam("table_background_color_map",[],"array")}function ri(e){return e.getParam("table_border_color_map",[],"array")}function oi(e,n){return(Yu(e)?Fl:wa(e)?jl:Wl)(n)}function ui(e){xe(e,"width")}function ii(e){return"false"!==Un(e,"data-mce-resize")}function ci(e,n){return{element:e,offset:n}}function li(e,n){return(e.property().isText(n)?e.property().getText(n):e.property().children(n)).length}function ai(t,r){1===ut(t,"colspan")&&po(t).bind(function(e){return r=["fixed","relative","empty"],be.from(co.exec(e)).bind(function(e){var n=Number(e[1]),e=e[2],t=e;return v(r,function(e){return v(io[e],function(e){return t===e})})?be.some({value:n,unit:e}):be.none()});var r}).each(function(e){var n=e.value/2;wo(t,n,e.unit),wo(r,n,e.unit)})}function fi(e){return I(e,function(e){return xa(e.element)})}function si(e){var n="thead"===e.section,t=Kn(Ra(e.cells),"th");return n||t?{type:"header",subType:n&&t?"sectionCells":n?"section":"cells"}:"tfoot"===e.section?{type:"footer"}:{type:"body"}}function mi(e,n,t){return D(t(e.element,n),!0,e.isLocked)}function di(e,n){return e.section!==n?_e(e.element,e.cells,n,e.isNew):e}function gi(){return{transformRow:di,transformCell:function(e,n,t){var r,t=t(e.element,n);return D("td"!==ye(t)?(r=dr(n=t,"td"),Mt(n,r),Lt(r,d(n)),Oe(n),r):t,e.isNew,e.isLocked)}}}function pi(){return{transformRow:di,transformCell:mi}}function bi(){return{transformRow:function(e,n){return di(e,"thead"===n?"tbody":n)},transformCell:mi}}function hi(e,n,t,r){t===r?xe(e,n):Ce(e,n,t)}function vi(e,n,t){W(On(e,n)).fold(function(){return Pt(e,t)},function(e){return Et(e,t)})}function wi(i,e){function n(e,n){var t,r,o,u;0<e.length?(e=e,Lt((_t(u=Fn(r=i,o=t=n).getOrThunk(function(){var e=we.fromTag(o,vn(r).dom);return"thead"===o?vi(r,"caption,colgroup",e):"colgroup"===o?vi(r,"caption",e):De(r,e),e})),u),("colgroup"===t?function(e){return w(e,function(e){return de(e.cells,function(e){return hi(e.element,"span",e.colspan,1),e.element})})}:function(e){return de(e,function(e){e.isNew&&c.push(e.element);var n=e.element;return _t(n),ge(e.cells,function(e){e.isNew&&l.push(e.element),hi(e.element,"colspan",e.colspan,1),hi(e.element,"rowspan",e.rowspan,1),De(n,e.element)}),n})})(e))):Fn(i,n).each(Oe)}var c=[],l=[],t=[],r=[],o=[],u=[];return ge(e,function(e){switch(e.section){case"thead":t.push(e);break;case"tbody":r.push(e);break;case"tfoot":o.push(e);break;case"colgroup":u.push(e)}}),n(u,"colgroup"),n(t,"thead"),n(r,"tbody"),n(o,"tfoot"),{newRows:c,newCells:l}}function yi(e,n){var t;return 0===e.length?0:(t=e[0],x(e,function(e){return!n(t.element,e.element)}).getOr(e.length))}function Ci(p,b){var h=de(p,function(e){return de(e.cells,fe)});return de(p,function(e,g){var n=w(e.cells,function(e,n){if(!1!==h[g][n])return[];r=b,i="colgroup"===(u=(c=p)[t=g]).section;for(var t,r,o,u,i,c={colspan:yi(u.cells.slice(u=n),r),rowspan:i?1:yi((i=c.slice(t),o=u,de(i,function(e){return yt(e,o)})),r)},l=g,a=n,f=c.rowspan,s=c.colspan,m=l;m<l+f;m++)for(var d=a;d<a+s;d++)h[m][d]=!0;return[{element:e.element,rowspan:c.rowspan,colspan:c.colspan,isNew:e.isNew}]});return{element:e.element,cells:n,section:e.section,isNew:e.isNew}})}function Si(o,u,i){var c=[];ge(o.colgroups,function(e){for(var n=[],t=0;t<o.grid.columns;t++){var r=Re.getColumnAt(o,t).map(function(e){return D(e.element,i,!1)}).getOrThunk(function(){return D(u.colGap(),!0,!1)});n.push(r)}c.push(_e(e.element,n,"colgroup",i))});for(var e=0;e<o.grid.rows;e++){for(var n=[],t=0;t<o.grid.columns;t++){var r=Re.getAt(o,e,t).map(function(e){return D(e.element,i,e.isLocked)}).getOrThunk(function(){return D(u.gap(),!0,!1)});n.push(r)}var l=o.all[e],l=_e(l.element,n,l.section,i);c.push(l)}return c}function Ti(e){return Ci(e,he)}function xi(e,n){return Ee(e.all,function(e){return M(e.cells,function(e){return he(n,e.element)})})}function Ri(n,e,t){e=Xn(de(e.selection,function(e){return ft(e).bind(function(e){return xi(n,e)}).filter(t)}));return Jn(0<e.length,e)}function e(a,n,f,s,m){return function(o,u,e,r,i){var c=Re.fromTable(u),l=be.from(null==i?void 0:i.section).getOrThunk(wl);return n(c,e).map(function(e){var n=Si(c,r,!1),n=a(n,e,he,m(r),l),t=xt(n.grid);return{info:e,grid:Ti(n.grid),cursor:n.cursor,lockedColumns:t}}).bind(function(e){var n=wi(u,e.grid),t=be.from(null==i?void 0:i.sizing).getOrThunk(function(){return Wl(u)}),r=be.from(null==i?void 0:i.resize).getOrThunk(lu);return f(u,e.grid,e.info,{sizing:t,resize:r,section:l}),s(u),Iu(o,u),xe(u,Qt),0<e.lockedColumns.length&&Ce(u,Qt,e.lockedColumns.join(",")),be.some({cursor:e.cursor,newRows:n.newRows,newCells:n.newCells})})}}function Di(e,n){return Ri(e,n,se).map(function(e){return{cells:e,generators:n.generators,clipboard:n.clipboard}})}function Oi(e,n){return Ri(e,n,se)}function Ai(e,n){return Ri(e,n,function(e){return!e.isLocked})}function ki(n,e){return I(e,function(e){return xi(n,e).exists(function(e){return!e.isLocked})})}function Ii(n,e){return e.mergable.filter(function(e){return ki(n,e.cells)})}function Bi(n,e){return e.unmergable.filter(function(e){return ki(n,e)})}function Mi(e,n,t,r){for(var o=p(e).rows,u=!0,i=0;i<o.length;i++)for(var c=0;c<Ct(o[0]);c++){var l=o[i],a=yt(l,c),f=t(a.element,n);!0===f&&!1===u?wt(l,c,D(r(),!0,a.isLocked)):!0===f&&(u=!1)}return e}function Ei(e,n){return{rowDelta:0,colDelta:Ct(e[0])-Ct(n[0])}}function Pi(e,n){return{rowDelta:e.length-n.length,colDelta:0}}function Ni(e,n,t,r){var o="colgroup"===n.section?t.col:t.cell;return A(e,function(e){return D(o(),!0,r(e))})}function zi(e,n,t,r){var o=e[e.length-1];return e.concat(A(n,function(){var e="colgroup"===o.section?t.colgroup:t.row,e=St(o,e,ae),n=Ni(e.cells.length,e,t,function(e){return mn(r,e.toString())});return Jt(e,n)}))}function Li(e,t,r,o){return de(e,function(e){var n=Ni(t,e,r,fe);return ht(e,o,n)})}function _i(e,n,t){var r=n.colDelta<0?Li:ae,o=n.rowDelta<0?zi:ae,u=xt(e),i=Ct(e[0]),u=v(u,function(e){return e===i-1}),r=r(e,Math.abs(n.colDelta),t,u?i-1:i),e=xt(r);return o(r,Math.abs(n.rowDelta),t,z(e,se))}function Wi(n,t,e){return pe(e,function(e){return e>=n.column&&e<=Ct(t[0])+n.column})}function ji(e,w,n,y,C){var t,r,o,u=xt(w),S=(t=e,r=u,e=Ct(w[0]),{row:p(w).cols.length+t.row,column:M(A(e-t.column,function(e){return e+t.column}),function(n){return I(r,function(e){return e!==n})}).getOr(e-1)}),T=p(n).rows,x=Wi(S,T,u);return e=T,((n=S).row>=(u=w).length||n.column>Ct(u[0])?Ia("invalid start address out of table bounds, row: "+n.row+", column: "+n.column):(n=(u=u.slice(n.row))[0].cells.slice(n.column),o=Ct(e[0]),e=e.length,ka({rowDelta:u.length-e,colDelta:n.length-o}))).map(function(e){for(var n,t,e=R(R({},e),{colDelta:e.colDelta-x.length}),e=_i(w,e,y),r=xt(e),r=Wi(S,T,r),o=e,u=T,i=y,c=C,l=S.row,a=S.column,f=l+u.length,s=a+Ct(u[0])+r.length,m=z(r,se),d=l;d<f;d++)for(var g,p,b,h=0,v=a;v<s;v++)m[v]?h++:(t=v,p=void 0,p=E(c,yt((b=o)[n=d],t).element),g=b[n],1<b.length&&1<Ct(g)&&(0<t&&p(O(g,t-1))||t<g.cells.length-1&&p(O(g,t+1))||0<n&&p(O(b[n-1],t))||n<b.length-1&&p(O(b[n+1],t)))&&Mi(o,O(o[d],v),c,i.cell),p=(g=yt(u[d-l],v-a-h)).element,b=i.replace(p),wt(o[d],v,D(b,!0,g.isLocked)));return o})}function Fi(t,e,n,r,o){var u=t,i=o,c=r.cell,l=(0<u&&u<e[0].cells.length&&ge(e,function(e){var n=e.cells[u-1],t=e.cells[u];i(t.element,n.element)&&wt(e,u,D(c(),!0,t.isLocked))}),_i(n,Pi(n,e),r));return de(_i(e,Pi(e,l),r),function(e,n){return ht(e,t,l[n].cells)})}function Hi(e,n,t,r,o){var i,c,l,u,a;m=n,i=e,c=o,l=r.cell,a=p(m).rows,0<i&&i<a.length&&(m=a[i-1].cells,u=c,ge(Be(m,function(e,n){return v(e,function(e){return u(e.element,n.element)})?e:e.concat([n])},[]),function(e){for(var o=be.none(),u=i;u<a.length;u++)for(var n=0;n<Ct(a[0]);n++)!function(n){var t=a[u],r=yt(t,n);c(r.element,e.element)&&(o=o.isNone()?be.some(l()):o).each(function(e){wt(t,n,D(e,!0,r.isLocked))})}(n)}));var f,s,o=xt(n),m=Ei(n,t),m=_i(n,R(R({},m),{colDelta:m.colDelta-o.length}),r),o=p(m),d=o.cols,o=o.rows,m=xt(m),n=Ei(t,n),n=R(R({},n),{colDelta:n.colDelta+m.length}),m=_i((f=r,s=m,de(t,function(t){return Be(s,function(e,n){return vt(e,n,Ni(1,t,f,se)[0])},t)})),n,r);return d.concat(o.slice(0,e)).concat(m).concat(o.slice(e,o.length))}function Vi(e,t,n,r,o){var u,i,e=p(e),c=e.rows,e=e.cols,l=c.slice(0,t),a=c.slice(t),n=(n=c[n],u=r,i=o,St(n,function(e){return i(e,u)},function(e,n){return 0<t&&t<c.length&&r(O(c[t-1],n),O(c[t],n))?yt(c[t],n):D(o(e.element,r),!0,e.isLocked)}));return e.concat(l).concat([n]).concat(a)}function qi(e,t,r,o,u){return de(e,function(e){var n=0<t&&t<Ct(e)&&o(O(e,t-1),O(e,t)),n="colgroup"!==e.section&&n?yt(e,t):D(u(yt(e,r).element,o),!0,!1);return vt(e,t,n)})}function Ui(e,n,t,r){return void 0!==O((o=e)[u=n],t)&&0<u&&r(O(o[u-1],t),O(o[u],t))||(o=e[n],0<t&&r(O(o,t-1),O(o,t)));var o,u}function Gi(e,n,t,r){function o(e){return("row"===e?ct:it)(n)?e+"group":e}return e?xa(n)?o(t):null:r&&xa(n)?o("row"===t?"col":"row"):null}function $i(e,n,t){return D(t(e.element,n),!0,e.isLocked)}function Ki(e,u,i,c,l,a,f){return de(e,function(e,o){return n=de((e=e).cells,function(e,n){var r,t,t=e;return v(u,function(e){return i(t.element,e.element)})?(r=f(e,o,n)?l(e,i,c):e,a(r,o,n).each(function(e){var t=r.element;ve({scope:be.from(e)},function(e,n){e.fold(function(){xe(t,n)},function(e){Vn(t.dom,n,e)})})}),r):e}),_e(e.element,n,e.section,e.isNew);var n})}function Xi(t,r,o){return w(t,function(e,n){return Ui(t,n,r,o)?[]:[yt(e,r)]})}function Yi(e,n,t,r,o){var u,i,c,l=p(e).rows,n=w(n,function(e){return Xi(l,e,r)}),a=de(e,function(e){return fi(e.cells)}),f=(f=n,I(u=a,ae)&&fi(f)?se:function(e,n,t){return!("th"===ye(e.element)&&u[n])});i=t,c=a;return Ki(e,n,r,o,$i,function(e,n){return be.some(Gi(i,e.element,"row",c[n]))},f)}function Ji(e,n,t,r){var o=p(e).rows;return Ki(e,de(n,function(e){return yt(o[e.row],e.column)}),t,r,$i,be.none,se)}function Qi(e){return Be(e,function(e,n){return v(e,function(e){return e.column===n.column})?e:e.concat([n])},[]).sort(function(e,n){return e.column-n.column})}function Zi(e){return"tr"===ye(e)||Ma(e)}function ec(e){return{element:e,colspan:ot(e,"colspan",1),rowspan:ot(e,"rowspan",1)}}function nc(e){return Gn(e,"scope").map(function(e){return e.substr(0,3)})}function tc(e){return e=e,e=Pa.property().name(e),me(Ea,e)}function rc(e){return e=e,me(["ol","ul"],Pa.property().name(e))}function oc(e){function u(e){return"br"===ye(e)}var n=0===(n=w(e,function(e){var o,n=d(e);return I(n,function(e){return u(e)||Bn(e)&&0===jt(e).trim().length})?[]:n.concat(Po(o=e).bind(function(t){var r=Tn(t).map(function(e){return!!tc(e)||(n=e,!!me(["br","img","hr","input"],Pa.property().name(n))&&"img"!==ye(e));var n}).getOr(!1);return yn(t).map(function(e){return!0===r||"li"===ye(n=e)||Wn(n,rc).isSome()||u(t)||tc(e)&&!he(o,e)?[]:[we.fromTag("br")];var n})}).getOr([]))})).length?[we.fromTag("br")]:n;_t(e[0]),Lt(e[0],n)}function uc(e){return Ou(e,!0)}function ic(e){0===st(e).length&&Oe(e)}function cc(e,n){return{grid:e,cursor:n}}function c(e,n,t){var r=p(e).rows;return cc(e,be.from(null==(n=null==(e=r[n])?void 0:e.cells[t])?void 0:n.element).filter(uc).orThunk(function(){return Ee(r,function(e){return Ee(e.cells,function(e){e=e.element;return Jn(uc(e),e)})})}))}function lc(e){return Be(e,function(e,n){return v(e,function(e){return e.row===n.row})?e:e.concat([n])},[]).sort(function(e,n){return e.row-n.row})}function ac(u,i){return function(e,n,t,r,o){return c(function(e,n,t,r,u,o,i){var e=p(e),c=e.cols,l=e.rows,e=l[n[0]],a=w(n,function(e){return o=u,w((t=l)[r=e].cells,function(e,n){return Ui(t,r,n,o)?[]:[e]});var t,r,o}),f=de(e.cells,function(e,n){return fi(Xi(l,n,u))}),s=q([],l,!0);ge(n,function(e){s[e]=i.transformRow(l[e],t)});var m,d,g,n=c.concat(s),e=(c=e,I(m=f,ae)&&fi(c.cells)?se:function(e,n,t){return!("th"===ye(e.element)&&m[t])});d=r,g=f;return Ki(n,a,u,o,i.transformCell,function(e,n,t){return be.some(Gi(d,e.element,"col",g[t]))},e)}(e,de(lc(n),function(e){return e.row}),u,i,t,r.replaceOrInit,o),n[0].row,n[0].column)}}function fc(e,n,t){r=t.section;var r,t=gt(e,function(){return r});return Si(Re.generate(t),n,!0)}function sc(e,n,t,r){r=r.sizing,n=Re.generate(n);tu(n,r.getWidths(n,r),r)}function mc(e,n,t,r){var o=r.sizing,r=r.resize,n=Re.generate(n),u=o.getWidths(n,o),i=o.pixelWidth(),r=r.calcRedestributedWidths(u,i,t.pixelDelta,o.isRelative),u=r.newSizes,i=r.delta;tu(n,u,o),o.adjustTableWidth(i)}function dc(e,n){return v(n,function(e){return 0===e.column&&e.isLocked})}function gc(n,e){return v(e,function(e){return e.column+e.colspan>=n.grid.columns&&e.isLocked})}function pc(e,n){var t=Sr(e);return Be(Qi(n),function(e,n){return e+t[n.column].map(Cr).getOr(0)},0)}function bc(t){return function(n,e){return Oi(n,e).filter(function(e){return!(t?dc:gc)(n,e)}).map(function(e){return{details:e,pixelDelta:pc(n,e)}})}}function hc(t){return function(n,e){return Di(n,e).filter(function(e){return!(t?dc:gc)(n,e.cells)})}}function vc(e,n){var o=Re.fromTable(e);return Oi(o,n).bind(function(e){var n=e[e.length-1],t=e[0].column,r=n.column+n.colspan,e=k(de(o.all,function(e){return pe(e.cells,function(e){return e.column>=t&&e.column<r})}));return Ra(e)}).getOr("")}function wc(e,n){return Oi(Re.fromTable(e),n).bind(Ra).getOr("")}function yc(e,l,a,f){return A(e,function(e){for(var n=l,t=a,r=f,o=e,u=we.fromTag("tr"),i=0;i<n;i++){var c=o<t||i<r?we.fromTag("th"):we.fromTag("td");i<r&&Ce(c,"scope","row"),o<t&&Ce(c,"scope","col"),De(c,we.fromTag("br")),De(u,c)}return u})}function Cc(e,n){e.selection.select(n.dom,!0),e.selection.collapse(!0)}function Sc(f,s,m,d,g){var r=Vu(f),p={styles:r,attributes:Hu(f),colGroups:f.getParam("table_use_colgroups",!1,"boolean")};return f.undoManager.ignore(function(){l=m,a=s,e=g,n=d,u=Ju(f),void 0===(c=p)&&(c=uf),r=we.fromTag("table"),o="cells"!==u,et(r,c.styles),qn(r,c.attributes),c.colGroups&&De(r,(c=a,t=we.fromTag("colgroup"),A(c,function(){return De(t,we.fromTag("col"))}),t)),c=Math.min(l,e),o&&0<e&&(i=we.fromTag("thead"),De(r,i),Lt(i,yc(e,a,"sectionCells"===u?c:0,n))),i=we.fromTag("tbody"),De(r,i),Lt(i,yc(o?l-c:l,a,o?0:e,n));var e,n,t,r,o,u=r;Ce(u,"data-mce-id","__mce");i=u,c=we.fromTag("div"),l=we.fromDom(i.dom.cloneNode(!0)),De(c,l);var i,c,l,a=c.dom.innerHTML;f.insertContent(a),f.addVisual()}),Hn(qo(f),'table[data-mce-id="__mce"]').map(function(e){var n,t;return wa(f)?Ol(e):Rl(f)?Al(e):(Yu(f)||(t=r.width,ke(t)&&-1!==t.indexOf("%")))&&Dl(e),Xo(e),xe(e,"data-mce-id"),n=f,ge(An(e,"tr"),function(e){Nu(n,e.dom),ge(An(e,"th,td"),function(e){zu(n,e.dom)})}),t=f,Hn(e,"td,th").each(E(Cc,t)),e.dom}).getOr(null)}function Tc(e,n,t,r,o){function u(e){return b(e)&&0<e}var i;return void 0===r&&(r={}),u(n)&&u(t)?(i=r.headerRows||0,Sc(e,t,n,r.headerColumns||0,i)):(console.error(o),null)}function xc(e){return function(){return e().fold(function(){return[]},function(e){return de(e,function(e){return e.dom})})}}function Rc(n){return function(e){e=0<e.length?be.some(Vo(e)):be.none();n(e)}}function Dc(e,n,t){var r=ot(e,n,1);1===t||r<=1?xe(e,n):Ce(e,n,Math.min(t,r))}function Oc(e,n,t){for(var r=void 0,o=e.select("td,th",n),u=0;u<o.length;u++){var i=e.getStyle(o[u],t);if((r=void 0===r?i:r)!==i)return""}return r}function Ac(e,n,t){t&&e.formatter.apply("align"+t,{},n)}function kc(n,t){cf.each("left center right".split(" "),function(e){n.formatter.remove("align"+e,{},t)})}function Ic(e){e=e.toString(16);return(1===e.length?"0"+e:e).toUpperCase()}function Bc(e){return{value:Ic(e.red)+Ic(e.green)+Ic(e.blue)}}function Mc(e,n,t,r){return{red:e,green:n,blue:t,alpha:r}}function Ec(e,n,t,r){return Mc(parseInt(e,10),parseInt(n,10),parseInt(t,10),parseFloat(r))}function Pc(e){var n=e;return{get:function(){return n},set:function(e){n=e}}}function Nc(e){function n(){t.get().each(e)}var t=Pc(be.none());return{clear:function(){n(),t.set(be.none())},isSet:function(){return t.get().isSome()},get:function(){return t.get()},set:function(e){n(),t.set(be.some(e))}}}function zc(){var n=Nc(ce);return R(R({},n),{on:function(e){return n.get().each(e)}})}function Lc(e){return ue(e,"menu")}function _c(t,r){return function(e){var n;t.execCommand("mceTableApplyCellStyle",!1,((n={})[r]=e,n))}}function Wc(n,t,r,o,u){return function(e){return e(Ml(n,t,r,o,u))}}function jc(t,e,r){e=de(e,function(e){return{text:e.title,value:"#"+(e=t=e.value,(af.test(n=e)||ff.test(n)?be.some({value:(Xe(n=e,"#")?n.substring("#".length):n).toUpperCase()}):be.none()).orThunk(function(){return("transparent"===(e=t)?be.some(Mc(0,0,0,0)):null!==(n=sf.exec(e))?be.some(Ec(n[1],n[2],n[3],"1")):null!==(n=mf.exec(e))?be.some(Ec(n[1],n[2],n[3],n[4])):be.none()).map(Bc);var e,n}).getOrThunk(function(){var e=document.createElement("canvas"),n=(e.height=1,e.width=1,e.getContext("2d")),e=(n.clearRect(0,0,e.width,e.height),n.fillStyle="#FFFFFF",n.fillStyle=t,n.fillRect(0,0,1,1),n.getImageData(0,0,1,1).data);return Bc(Mc(e[0],e[1],e[2],e[3]))}).value),type:"choiceitem"};var n,t});return[{type:"fancymenuitem",fancytype:"colorswatch",initData:{colors:0<e.length?e:void 0,allowCustomColors:!1},onAction:function(e){var n,e="remove"===e.value?"":e.value;t.execCommand("mceTableApplyCellStyle",!1,((n={})[r]=e,n))}}]}function Fc(n){return function(){var e=n.queryCommandValue("mceTableRowType");n.execCommand("mceTableRowType",!1,{type:"header"===e?"body":"header"})}}function Hc(n){return function(){var e=n.queryCommandValue("mceTableColType");n.execCommand("mceTableColType",!1,{type:"th"===e?"td":"th"})}}function Vc(e){return gf.concat((0<(e=df(Ku(e))).length?be.some({name:"class",type:"listbox",label:"Class",items:e}):be.none()).toArray())}function qc(e,n){e=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""}].concat(df(Fu(e)))},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===n?[{name:"borderwidth",type:"input",label:"Border width"}].concat(e):e}}function Uc(u){return function(t,r){var o=t.dom;return{setAttrib:function(e,n){u&&!n||o.setAttrib(r,e,n)},setStyle:function(e,n){u&&!n||o.setStyle(r,e,n)},setFormat:function(e,n){u&&!n||(""===n?t.formatter.remove(e,{value:null},r,!0):t.formatter.apply(e,{value:n},r))}}}}function Gc(n){return function(e){return Xe(e,"rgb")?n.toHex(e):e}}function $c(e,n){n=we.fromDom(n);return{borderwidth:tt(n,"border-width").getOr(""),borderstyle:tt(n,"border-style").getOr(""),bordercolor:tt(n,"border-color").map(Gc(e)).getOr(""),backgroundcolor:tt(n,"background-color").map(Gc(e)).getOr("")}}function Kc(e){var o=e[0];return ge(e.slice(1),function(e){ge(fn(o),function(r){ve(e,function(e,n){var t=o[r];""!==t&&r===n&&t!==e&&(o[r]="")})})}),o}function Xc(e,n,t,r){return M(e,function(e){return!s(t.formatter.matchNode(r,n+e))}).getOr("")}function Yc(e,t){var n=Re.fromTable(e);return de(pe(Re.justCells(n),function(n){return v(t,function(e){return he(n.element,e)})}),function(e){return{element:e.element.dom,column:Re.getColumnAt(n,e.column).map(function(e){return e.element.dom})}})}function Jc(e,n,r,t){var c=t.getData();t.close(),e.undoManager.transact(function(){var o,u=e,i=n,t=r,f=ee(o=c,function(e,n){return t[n]!==e});0<re(f)&&1<=i.length&&Te(i[0]).each(function(e){var c,l,a,n=Yc(e,i),t=0<re(ee(f,function(e,n){return"scope"!==n&&"celltype"!==n})),r=mn(f,"celltype");(t||mn(f,"scope"))&&(c=u,l=o,a=1===n.length,ge(n,function(e){var n,t,r,o=e.element,u=a?pf.normal(c,o):pf.ifTruthy(c,o),e=e.column.map(function(e){return a?pf.normal(c,e):pf.ifTruthy(c,e)}).getOr(u),i=l;(n=u).setAttrib("scope",i.scope),n.setAttrib("class",i.class),n.setStyle("height",Ko(i.height)),e.setStyle("width",Ko(i.width)),qu(c)&&((n=u).setFormat("tablecellbackgroundcolor",(e=l).backgroundcolor),n.setFormat("tablecellbordercolor",e.bordercolor),n.setFormat("tablecellborderstyle",e.borderstyle),n.setFormat("tablecellborderwidth",Ko(e.borderwidth))),a&&(kc(c,o),t=c,r=o,cf.each("top middle bottom".split(" "),function(e){t.formatter.remove("valign"+e,{},r)})),l.halign&&Ac(c,o,l.halign),l.valign&&(i=l.valign)&&c.formatter.apply("valign"+i,{},o)})),r&&u.execCommand("mceTableCellType",!1,{type:o.celltype,no_events:!0}),Lu(u,e.dom,{structure:r,style:t})}),e.focus()})}function Qc(e,n){var t,i,r,o,u,n=Kl(n);0!==n.length&&(i=e,t=Kc(Te((r=n)[0]).map(function(e){return de(Yc(e,r),function(e){return r=e.element,o=qu(t=i),e=e.column,u=t.dom,e=e.getOr(r),R({width:n(e,"width"),height:n(r,"height"),scope:u.getAttrib(r,"scope"),celltype:r.nodeName.toLowerCase(),class:u.getAttrib(r,"class",""),halign:bf(t,r),valign:hf(t,r)},o?$c(u,r):{});function n(e,n){return u.getStyle(e,n)||u.getAttrib(e,n)}var t,r,o,u})}).getOrDie()),o={type:"tabpanel",tabs:[{title:"General",name:"general",items:Vc(e)},qc(e,"cell")]},u={type:"panel",items:[{type:"grid",columns:2,items:Vc(e)}]},e.windowManager.open({title:"Cell Properties",size:"normal",body:qu(e)?o:u,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:t,onSubmit:E(Jc,e,n,t)}))}function Zc(e){return vf.concat((0<(e=df(e.getParam("table_row_class_list",[],"array"))).length?be.some({name:"class",type:"listbox",label:"Class",items:e}):be.none()).toArray())}function el(s,m,d,e){var g=e.getData();e.close(),s.undoManager.transact(function(){var e,n,t,o,u,i,c,r=s,l=m,a=d,f=ee(e=g,function(e,n){return a[n]!==e});0<re(f)&&(n=mn(f,"type"),(t=!n||1<re(f))&&(o=r,u=e,i=a,c=1===l.length,ge(l,function(e){var n,t=c?pf.normal(o,e):pf.ifTruthy(o,e),r=u;(n=t).setAttrib("class",r.class),n.setStyle("height",Ko(r.height)),Uu(o)&&((n=t).setStyle("background-color",(r=u).backgroundcolor),n.setStyle("border-color",r.bordercolor),n.setStyle("border-style",r.borderstyle)),u.align!==i.align&&(kc(o,e),Ac(o,e,u.align))})),n&&r.execCommand("mceTableRowType",!1,{type:e.type,no_events:!0}),Te(we.fromDom(l[0])).each(function(e){return Lu(r,e.dom,{structure:n,style:t})})),s.focus()})}function nl(u){o=Yo(u),t=Ul.selected,e=(o=$l(o)).bind(function(e){return Te(e)}).map(dt);var t,e,n,r,o=Yn(o,e,function(n,e){return pe(e,function(e){return v(Vo(e.dom.cells),function(e){return"1"===Un(e,t)||he(e,n)})})}).getOr([]);0!==o.length&&(e=Kc(de(o,function(e){return e=e.dom,t=Uu(n=u),o=n.dom,R({height:o.getStyle(e,"height")||o.getAttrib(e,"height"),class:o.getAttrib(e,"class",""),type:Te(we.fromDom(r=e)).map(function(e){var n={selection:Vo(r.cells)};return of(e,n)}).getOr(""),align:bf(n,e)},t?$c(o,e):{});var n,t,r,o})),n={type:"tabpanel",tabs:[{title:"General",name:"general",items:Zc(u)},qc(u,"row")]},r={type:"panel",items:[{type:"grid",columns:2,items:Zc(u)}]},u.windowManager.open({title:"Row Properties",size:"normal",body:Uu(u)?n:r,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:e,onSubmit:E(el,u,de(o,function(e){return e.dom}),e)}))}function tl(f,s,t,e){var m=f.dom,d=e.getData(),g=ee(d,function(e,n){return t[n]!==e});e.close(),""===d.class&&delete d.class,f.undoManager.transact(function(){var e,n;if(s||(c=parseInt(d.cols,10)||1,l=parseInt(d.rows,10)||1,s=Sc(f,c,l,0,0)),0<re(g)){var t=f,r=s,o=d,u,i=t.dom,c={},l={};if(c.class=o.class,l.height=Ko(o.height),i.getAttrib(r,"width")&&!$u(t)?c.width=(u=o.width)?u.replace(/px$/,""):"":l.width=Ko(o.width),$u(t)?(l["border-width"]=Ko(o.border),l["border-spacing"]=Ko(o.cellspacing)):(c.border=o.border,c.cellpadding=o.cellpadding,c.cellspacing=o.cellspacing),$u(t)&&r.children)for(var a=0;a<r.children.length;a++)wf(i,r.children[a],{"border-width":Ko(o.border),padding:Ko(o.cellpadding)}),Gu(t)&&wf(i,r.children[a],{"border-color":o.bordercolor});Gu(t)&&(l["background-color"]=o.backgroundcolor,l["border-color"]=o.bordercolor,l["border-style"]=o.borderstyle),c.style=i.serializeStyle(R(R({},Vu(t)),l)),i.setAttribs(r,R(R({},Hu(t)),c)),((u=m.select("caption",s)[0])&&!d.caption||!u&&d.caption)&&f.execCommand("mceTableToggleCaption"),""===d.align?kc(f,s):Ac(f,s,d.align)}f.focus(),f.addVisual(),0<re(g)&&(n=!(e=mn(g,"caption"))||1<re(g),Lu(f,s,{structure:e,style:n}))})}function rl(e,n){var t,r=e.dom,o=(a=Gu(l=e),o=Vu(l),f=Hu(l),a=a?(a=l.dom,{borderstyle:oe(o,"border-style").getOr(""),bordercolor:Gc(a)(oe(o,"border-color").getOr("")),backgroundcolor:Gc(a)(oe(o,"background-color").getOr(""))}):{},R(R(R(R(R(R({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),o),f),a),(a=o["border-width"],$u(l)&&a?{border:a}:oe(f,"border").fold(function(){return{}},function(e){return{border:e}}))),(l=oe(o,"border-spacing").or(oe(f,"cellspacing")).fold(function(){return{}},function(e){return{cellspacing:e}}),a=oe(o,"border-padding").or(oe(f,"cellpadding")).fold(function(){return{}},function(e){return{cellpadding:e}}),R(R({},l),a)))),u=(!1===n?(t=r.getParent(e.selection.getStart(),"table",e.getBody()))?(f=t,a=Gu(l=e),r=l.dom,i=$u(l)?r.getStyle(f,"border-spacing")||r.getAttrib(f,"cellspacing"):r.getAttrib(f,"cellspacing")||r.getStyle(f,"border-spacing"),c=$u(l)?Oc(r,f,"padding")||r.getAttrib(f,"cellpadding"):r.getAttrib(f,"cellpadding")||Oc(r,f,"padding"),o=R({width:r.getStyle(f,"width")||r.getAttrib(f,"width"),height:r.getStyle(f,"height")||r.getAttrib(f,"height"),cellspacing:i,cellpadding:c,border:(i=r,u=tt(we.fromDom(c=f),"border-width"),$u(l)&&u.isSome()?u.getOr(""):i.getAttrib(c,"border")||Oc(l.dom,c,"border-width")||Oc(l.dom,c,"border")),caption:!!r.select("caption",f)[0],class:r.getAttrib(f,"class",""),align:bf(l,f)},a?$c(r,f):{})):Gu(e)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""):(o.cols="1",o.rows="1",Gu(e)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor="")),df(Xu(e)));0<u.length&&o.class&&(o.class=o.class.replace(/\s*mce\-item\-table\s*/g,""));var i,c,l,a,r={type:"grid",columns:2,items:(i=u,c=n?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],l=e.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],a=0<i.length?[{type:"listbox",name:"class",label:"Class",items:i}]:[],c.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(l).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(a))},f=Gu(e)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[r]},qc(e,"table")]}:{type:"panel",items:[r]};e.windowManager.open({title:"Table Properties",size:"normal",body:f,onSubmit:E(tl,e,t,o),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o})}function ol(e){return Gl(Yo(e),$o(e))}function ul(i,n,e,c,t){function u(e){return Te(e,d)}function l(t){return $l(Yo(e=i),$o(e)).bind(function(n){return u(n).map(function(e){return t(e,n)})});var e}function a(e){i.focus()}function r(t,r){return void 0===r&&(r=!1),l(function(e,n){n=Qo(c,e,n);t(e,n,r).each(a)})}function o(){return l(function(e,n){var t,n=Qo(c,e,n),r=Fo(ce,we.fromDom(i.getDoc()),be.none());return Oi(t=Re.fromTable(e),n).bind(function(e){e=Ti(w(p(Si(t,r,!1)).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),function(e){var n=pe(e.cells,function(e){return!e.isLocked});return 0<n.length?[R(R({},e),{cells:n})]:[]}));return Jn(0<e.length,e)}).map(function(e){return de(e,function(e){var t=sr(e.element);return ge(e.cells,function(e){var n=mr(e.element);hi(n,"colspan",e.colspan,1),hi(n,"rowspan",e.rowspan,1),De(t,n)}),t})})})}function f(){return l(function(e,n){var l,n=Qo(c,e,n);return Ai(l=Re.fromTable(e),n).map(function(e){var t,r,n,o,u=e[e.length-1],e=e[0].column,u=u.column+u.colspan,i=(i=l,n=e,o=u,Re.hasColumns(i)?(i=de(pe(Re.justColumns(i),function(e){return e.column>=n&&e.column<o}),function(e){e=mr(e.element);return Dc(e,"span",o-n),e}),Lt(c=we.fromTag("colgroup"),i),[c]):[]),c=(t=e,r=u,de(l.all,function(e){var e=de(pe(e.cells,function(e){return e.column>=t&&e.column<r}),function(e){e=mr(e.element);return Dc(e,"colspan",r-t),e}),n=we.fromTag("tr");return Lt(n,e),n}));return q(q([],i,!0),c,!0)})})}function s(u,e){return e().each(function(e){var o=de(e,mr);l(function(e,n){var t=Ho(we.fromDom(i.getDoc())),r=(r=o,t=t,{selection:Jo(c),clipboard:r,generators:t});u(e,r).each(a)})})}function m(t){return function(e,n){return oe(n,"type").each(function(e){r(t(e),n.no_events)})}}var d=$o(i);ve({mceTableSplitCells:function(){return r(n.unmergeCells)},mceTableMergeCells:function(){return r(n.mergeCells)},mceTableInsertRowBefore:function(){return r(n.insertRowsBefore)},mceTableInsertRowAfter:function(){return r(n.insertRowsAfter)},mceTableInsertColBefore:function(){return r(n.insertColumnsBefore)},mceTableInsertColAfter:function(){return r(n.insertColumnsAfter)},mceTableDeleteCol:function(){return r(n.deleteColumn)},mceTableDeleteRow:function(){return r(n.deleteRow)},mceTableCutCol:function(){return f().each(function(e){t.setColumns(e),r(n.deleteColumn)})},mceTableCutRow:function(){return o().each(function(e){t.setRows(e),r(n.deleteRow)})},mceTableCopyCol:function(){return f().each(function(e){return t.setColumns(e)})},mceTableCopyRow:function(){return o().each(function(e){return t.setRows(e)})},mceTablePasteColBefore:function(){return s(n.pasteColsBefore,t.getColumns)},mceTablePasteColAfter:function(){return s(n.pasteColsAfter,t.getColumns)},mceTablePasteRowBefore:function(){return s(n.pasteRowsBefore,t.getRows)},mceTablePasteRowAfter:function(){return s(n.pasteRowsAfter,t.getRows)},mceTableDelete:function(){return ol(i).each(function(e){Te(e,d).filter(h(d)).each(function(e){var n=we.fromText("");Et(e,n),Oe(e),i.dom.isEmpty(i.getBody())?(i.setContent(""),i.selection.setCursorLocation()):((e=i.dom.createRng()).setStart(n.dom,0),e.setEnd(n.dom,0),i.selection.setRng(e),i.nodeChanged())})})},mceTableCellToggleClass:function(e,r){l(function(e){var n=Kl(c),t=I(n,function(e){return i.formatter.match("tablecellclass",{value:r},e.dom)})?i.formatter.remove:i.formatter.apply;ge(n,function(e){t("tablecellclass",{value:r},e.dom)}),Lu(i,e.dom,ma)})},mceTableToggleClass:function(e,n){l(function(e){i.formatter.toggle("tableclass",{value:n},e.dom),Lu(i,e.dom,ma)})},mceTableToggleCaption:function(){ol(i).each(function(n){Te(n,d).each(function(r){Fn(r,"caption").fold(function(){var e,n,t=we.fromTag("caption");De(t,we.fromText("Caption")),n=t,xn(e=r,0).fold(function(){De(e,n)},function(e){Mt(e,n)}),i.selection.setCursorLocation(t.dom,0)},function(e){hn("caption")(n)&&J("td",r).each(function(e){return i.selection.setCursorLocation(e.dom,0)}),Oe(e)}),Lu(i,r.dom,Ae)})})},mceTableSizingMode:function(e,n){return t=n,ol(i).each(function(e){Rl(i)||wa(i)||Yu(i)||Te(e,d).each(function(e){"relative"!==t||bl(e)?"fixed"!==t||hl(e)?"responsive"!==t||vl(e)||Al(e):Ol(e):Dl(e),Xo(e),Lu(i,e.dom,Ae)})});var t},mceTableCellType:m(function(e){return"th"===e?n.makeCellsHeader:n.unmakeCellsHeader}),mceTableColType:m(function(e){return"th"===e?n.makeColumnsHeader:n.unmakeColumnsHeader}),mceTableRowType:m(function(e){switch(e){case"header":return n.makeRowsHeader;case"footer":return n.makeRowsFooter;default:return n.makeRowsBody}})},function(e,n){i.addCommand(n,e)}),ve({mceTableProps:E(rl,i,!1),mceTableRowProps:E(nl,i),mceTableCellProps:E(Qc,i,c)},function(e,n){i.addCommand(n,function(){return e()})}),i.addCommand("mceInsertTable",function(e,n){g(n)&&0<fn(n).length?Tc(i,n.rows,n.columns,n.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):rl(i,!0)}),i.addCommand("mceTableApplyCellStyle",function(e,n){function r(e){return"tablecell"+e.toLowerCase().replace("-","")}var o;!g(n)||0===(o=Kl(c)).length||function(e){for(var n in e)if(sn.call(e,n))return;return 1}(n=ee(n,function(e,n){return i.formatter.has(r(n))&&ke(e)}))||(ve(n,function(n,t){ge(o,function(e){pf.normal(i,e.dom).setFormat(r(t),n)})}),u(o[0]).each(function(e){return Lu(i,e.dom,ma)}))})}function il(t,e){return Te(t,e).bind(function(e){var n=st(e);return x(n,function(e){return he(t,e)}).map(function(e){return{index:e,all:n}})})}function cl(e,n){e=e.document.createRange();return e.selectNode(n.dom),e}function ll(e,n){e=e.document.createRange();return e.selectNodeContents(n.dom),e}function al(e,n,t){var r,e=e.document.createRange(),o=e;return n.fold(function(e){o.setStartBefore(e.dom)},function(e,n){o.setStart(e.dom,n)},function(e){o.setStartAfter(e.dom)}),r=e,t.fold(function(e){r.setEndBefore(e.dom)},function(e,n){r.setEnd(e.dom,n)},function(e){r.setEndAfter(e.dom)}),e}function fl(e,n,t,r,o){e=e.document.createRange();return e.setStart(n.dom,t),e.setEnd(r.dom,o),e}function sl(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}}function ml(e,n,t){return n(we.fromDom(t.startContainer),t.startOffset,we.fromDom(t.endContainer),t.endOffset)}function dl(e,n){o=e;var o,t,e=n.match({domRange:function(e){return{ltr:le(e),rtl:be.none}},relative:function(e,n){return{ltr:Pe(function(){return al(o,e,n)}),rtl:Pe(function(){return be.some(al(o,n,e))})}},exact:function(e,n,t,r){return{ltr:Pe(function(){return fl(o,e,n,t,r)}),rtl:Pe(function(){return be.some(fl(o,t,r,e,n))})}}});return(t=(n=e).ltr()).collapsed?n.rtl().filter(function(e){return!1===e.collapsed}).map(function(e){return Of.rtl(we.fromDom(e.endContainer),e.endOffset,we.fromDom(e.startContainer),e.startOffset)}).getOrThunk(function(){return ml(0,Of.ltr,t)}):ml(0,Of.ltr,t)}function gl(u,e){return dl(u,e).match({ltr:function(e,n,t,r){var o=u.document.createRange();return o.setStart(e.dom,n),o.setEnd(t.dom,r),o},rtl:function(e,n,t,r){var o=u.document.createRange();return o.setStart(t.dom,r),o.setEnd(e.dom,n),o}})}function pl(e,n){return{parent:le(be.from(e.dom.documentElement).map(we.fromDom).getOr(e)),view:le(e),origin:le(no(0,0)),isResizable:n}}function bl(e){return po(e).exists(function(e){return Pl.test(e)})}function hl(e){return po(e).exists(function(e){return Nl.test(e)})}function vl(e){return po(e).isNone()}function wl(){return{transformRow:ae,transformCell:mi}}function yl(t,r){function o(e){var n;return Zi(e)?Ma((n={element:e}).element)?t.colgroup(n):t.row(n):(n=r(e),n=Ba(n.element)?t.col(n):t.cell(n),u=be.some({item:e,replacement:n}),n)}void 0===r&&(r=ec);var u=be.none();return{getOrInit:function(n,t){return u.fold(function(){return o(n)},function(e){return t(n,e.item)?e.replacement:o(n)})}}}function Cl(r){return function(t){function u(e){var n=t.replace(e,r,"td"===r?{scope:null}:{});return i.push({item:e,sub:n}),n}var i=[];return{replaceOrInit:function(n,t){return Zi(n)||Ba(n)?n:(r=n,o=t,M(i,function(e){return o(e.item,r)}).fold(function(){return u(n)},function(e){return t(n,e.item)?e.sub:u(n)}));var r,o}}}}function Sl(r){return{unmerge:function(t){var e=nc(t);return e.each(function(e){return Ce(t,"scope",e)}),function(){var n=r.cell({element:t,colspan:1,rowspan:1});return rt(n,"width"),rt(t,"width"),e.each(function(e){return Ce(n,"scope",e)}),n}},merge:function(n){return rt(n[0],"width"),(0===(e=Xn(de(n,nc))).length||(t=e[0],r=["row","col"],v(e,function(e){return e!==t&&me(r,e)}))?be.none():be.from(t)).fold(function(){return xe(n[0],"scope")},function(e){return Ce(n[0],"scope",e+"group")}),le(n[0]);var t,r,e}}}function Tl(e,n,t,r){e.dom.removeEventListener(n,t,r)}function xl(e){return e.dom.contentEditable}function Rl(e){return"responsive"===_u(e)}function Dl(e){var n=yo(e);du(e,be.some(n),be.none()),ui(e)}function Ol(e){var n=yr(e)+"px";du(e,be.some(n),be.none()),ui(e)}function Al(e){rt(e,"width");var n=mt(e);ge(0<n.length?n:st(e),function(e){rt(e,"width"),ui(e)}),ui(e)}function kl(e,n){var t,n=Ca(e,n,e.query().prevSibling).getOr(n);return!e.property().isText(n)&&0<(t=e.property().children(n)).length?kl(e,t[t.length-1]):ci(n,li(e,n))}function Il(t){return{isValue:se,isError:fe,getOr:le(t),getOrThunk:le(t),getOrDie:le(t),or:function(e){return Il(t)},orThunk:function(e){return Il(t)},fold:function(e,n){return n(t)},map:function(e){return Il(e(t))},mapError:function(e){return Il(t)},each:function(e){e(t)},bind:function(e){return e(t)},exists:function(e){return e(t)},forall:function(e){return e(t)},toOptional:function(){return be.some(t)}}}function Bl(t){return{isValue:fe,isError:se,getOr:ae,getOrThunk:function(e){return e()},getOrDie:function(){throw e=String(t),new Error(e);var e},or:ae,orThunk:function(e){return e()},fold:function(e,n){return e(t)},map:function(e){return Bl(t)},mapError:function(e){return Bl(e(t))},each:ce,bind:function(e){return Bl(t)},exists:fe,forall:se,toOptional:be.none}}function Ml(t,r,e,o,a){return de(e,function(e){var u,i,c,l,n=e.text||e.title;return Lc(e)?{type:"nestedmenuitem",text:n,getSubmenuItems:function(){return Ml(t,r,e.menu,o,a)}}:{text:n,type:"togglemenuitem",onAction:function(){return a(e.value)},onSetup:(u=t,i=r,c=o,l=e.value,function(t){function e(){function e(e){return u.formatter.match(c,{value:l},e.dom,o)}var n=Kl(i);o?(t.setActive(!v(n,e)),r.set(u.formatter.formatChanged(c,function(e){return t.setActive(!e)},!0))):(t.setActive(I(n,e)),r.set(u.formatter.formatChanged(c,t.setActive,!1,{value:l})))}var r=Nc(function(e){return e.unbind()}),o=!ze(l);return u.initialized?e():u.on("init",e),r.clear})}})}function El(e){return w(e,function(e){return Lc(e)?[R(R({},e),{menu:El(e.menu)})]:ze(e.value)?[e]:[]})}var Pl=/(\d+(\.\d+)?)%/,Nl=/(\d+(\.\d+)?)px|em/,zl=hn("col"),Ll=le(Pl),_l=hn("col"),Wl=function(r){return po(r).fold(function(){return{width:e=Ao(t=r,yr),pixelWidth:e,getWidths:function(e,n){return Do(e,t,n)},getCellDelta:e=le(0),singleColumnWidth:le([0]),minCellWidth:e,setElementWidth:ce,adjustTableWidth:ce,isRelative:!0,label:"none"};var t,e},function(e){return n=r,e=e,(null!==Ll().exec(e)?ko:Io)(n);var n})},jl=Io,Fl=ko,Hl=["img","br"],Vl=function(e,o){function u(e){for(var n=d(e),t=n.length-1;0<=t;t--){var r=n[t];if(o(r))return be.some(r);r=u(r);if(r.isSome())return r}return be.none()}return u(e)},ql={scope:["row","col"]},Ul={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},Gl=Zo("th,td,caption"),$l=Zo("th,td"),Kl=Jo,n=Wr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Xl=R({},n),Yl=iu(function(e){return e<0}),Jl=iu(se),Ql=Wr([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),Zl=R(R({},Ql),{from:function(e){return Ne(e,"%")?au("%",Ql.percent,e):Ne(e,"px")?au("px",Ql.pixels,e):Ql.invalid(e)}}),ea=Zl.from,na=wu(["compare","extract","mutate","sink"]),ta=wu(["element","start","stop","destroy"]),ra=wu(["forceDrop","drop","move","delayDrop"]),oa=se,ua=yu,ia=Ru("ephox-dragster").resolve,ca=na({compare:function(e,n){return no(n.left-e.left,n.top-e.top)},extract:function(e){return be.some(no(e.x,e.y))},sink:function(e,n){n=n,n=R({layerClass:ia("blocker")},n),Ce(t=we.fromTag("div"),"role","presentation"),et(t,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Tu(t,ia("blocker")),Tu(t,n.layerClass);var t,r={element:le(t),destroy:function(){Oe(t)}},o=Cu(r.element(),"mousedown",e.forceDrop),u=Cu(r.element(),"mouseup",e.drop),i=Cu(r.element(),"mousemove",e.move),c=Cu(r.element(),"mouseout",e.delayDrop);return ta({element:r.element,start:function(e){De(e,r.element())},stop:function(){Oe(r.element())},destroy:function(){r.destroy(),u.unbind(),i.unbind(),c.unbind(),o.unbind()}})},mutate:function(e,n){e.mutate(n.left,n.top)}}),n=Ru("ephox-snooker").resolve,la=n("resizer-bar"),aa=n("resizer-rows"),fa=n("resizer-cols"),sa=n("resizer-bar-dragging"),ma={structure:!1,style:!0},Ae={structure:!0,style:!1},da={structure:!0,style:!0},ga={"border-collapse":"collapse",width:"100%"},pa=A(5,function(e){e=e+1+"px";return{title:e,value:e}}),ba=de(["Solid","Dotted","Dashed","Double","Groove","Ridge","Inset","Outset","None","Hidden"],function(e){return{title:e,value:e.toLowerCase()}}),ha={border:"1"},va="preservetable",wa=function(e){return"fixed"===_u(e)||!1===Wu(e)},ya="bar-",Ca=function(n,e,t){return n.property().isText(e)&&0===n.property().getText(e).trim().length||n.property().isComment(e)?t(e).bind(function(e){return Ca(n,e,t).orThunk(function(){return be.some(e)})}):be.none()},Sa=kl,Ta=tr(),xa=hn("th"),Ra=function(e){var n=pe(e,function(e){return xa(e.element)});return 0===n.length?be.some("td"):n.length===e.length?be.some("th"):be.none()},Da=gi,Oa=pi,Aa=bi,ka=Il,Ia=Bl,Ba=hn("col"),Ma=hn("colgroup"),Ea=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Pa=tr(),na=ac("thead",!0),n=ac("tbody",!1),Na=ac("tfoot",!1),za=Cl("th"),La=Cl("td"),_a=e(function(e,n,t,r){var o=n[0].row;return c(Ie(lc(n),function(e,n){return{grid:Vi(e.grid,o,n.row+e.delta,t,r.getOrInit),delta:e.delta+1}},{grid:e,delta:0}).grid,o,n[0].column)},Oi,ce,ce,yl),Wa=e(function(e,n,t,r){var o=lc(n),u=o[o.length-1],i=u.row+u.rowspan;return c(Ie(o,function(e,n){return Vi(e,i,n.row,t,r.getOrInit)},e),i,n[0].column)},Oi,ce,ce,yl),ja=e(function(e,n,t,r){var n=n.details,o=Qi(n),u=o[0].column;return c(Ie(o,function(e,n){return{grid:qi(e.grid,u,n.column+e.delta,t,r.getOrInit),delta:e.delta+1}},{grid:e,delta:0}).grid,n[0].row,u)},bc(!0),mc,ce,yl),Fa=e(function(e,n,t,r){var n=n.details,o=n[n.length-1],u=o.column+o.colspan;return c(Ie(Qi(n),function(e,n){return qi(e,u,n.column,t,r.getOrInit)},e),n[0].row,u)},bc(!1),mc,ce,yl),Ha=e(function(e,n,t,r){var o,n=Qi(n.details),e=(e=e,o=de(n,function(e){return e.column}),w(e,function(e){var n=e.cells,n=Ie(o,function(e,n){return 0<=n&&n<e.length?e.slice(0,n).concat(e.slice(n+1)):e},n);return 0<n.length?[_e(e.element,n,e.section,e.isNew)]:[]})),u=0<e.length?e[0].cells.length-1:0;return c(e,n[0].row,Math.min(n[0].column,u))},function(n,e){return Ai(n,e).map(function(e){return{details:e,pixelDelta:-pc(n,e)}})},mc,ic,yl),Va=e(function(e,n,t,r){var o,u=lc(n),e=(i=u[0].row,u=u[u.length-1].row,o=(e=p(e)).rows,e.cols.concat(o.slice(0,i)).concat(o.slice(u+1))),i=0<e.length?e.length-1:0;return c(e,Math.min(n[0].row,i),n[0].column)},Oi,ce,ic,yl),qa=e(function(e,n,t,r){return c(Yi(e,de(Qi(n),function(e){return e.column}),!0,t,r.replaceOrInit),n[0].row,n[0].column)},Ai,ce,ce,za),Ua=e(function(e,n,t,r){return c(Yi(e,de(Qi(n),function(e){return e.column}),!1,t,r.replaceOrInit),n[0].row,n[0].column)},Ai,ce,ce,La),Ga=e(na,Ai,ce,ce,za),$a=e(n,Ai,ce,ce,La),Ka=e(Na,Ai,ce,ce,La),Xa=e(function(e,n,t,r){return c(Ji(e,n,t,r.replaceOrInit),n[0].row,n[0].column)},Ai,ce,ce,za),Ya=e(function(e,n,t,r){return c(Ji(e,n,t,r.replaceOrInit),n[0].row,n[0].column)},Ai,ce,ce,La),Ja=e(function(e,n,t,r){var o=n.cells;return oc(o),cc(function(e,n,t){var r=p(e).rows;if(0!==r.length)for(var o=n.startRow;o<=n.finishRow;o++)for(var u=n.startCol;u<=n.finishCol;u++){var i=r[o],c=yt(i,u).isLocked;wt(i,u,D(t(),!1,c))}return e}(e,n.bounds,r.merge(o)),be.from(o[0]))},Ii,sc,ce,Sl),Qa=e(function(e,n,t,r){return cc(Ie(n,function(e,n){return Mi(e,n,t,r.unmerge(n))},e),be.from(n[0]))},Bi,sc,ce,Sl),Za=e(function(e,n,t,r){u=n.clipboard,o=n.generators;var o,u=Si(Re.fromTable(u),o,!0);return ji({row:n.row,column:n.column},e,u,n.generators,t).fold(function(){return cc(e,be.some(n.element))},function(e){return c(e,n.row,n.column)})},function(n,t){return ft(t.element).bind(function(e){return xi(n,e).map(function(e){return R(R({},e),{generators:t.generators,clipboard:t.clipboard})})})},sc,ce,yl),ef=e(function(e,n,t,r){var o=p(e).rows,u=n.cells[0].column,o=o[n.cells[0].row];return c(Fi(u,e,fc(n.clipboard,n.generators,o),n.generators,t),n.cells[0].row,n.cells[0].column)},hc(!0),ce,ce,yl),nf=e(function(e,n,t,r){var o=p(e).rows,u=n.cells[n.cells.length-1].column+n.cells[n.cells.length-1].colspan,o=o[n.cells[0].row];return c(Fi(u,e,fc(n.clipboard,n.generators,o),n.generators,t),n.cells[0].row,n.cells[0].column)},hc(!1),ce,ce,yl),tf=e(function(e,n,t,r){var o=p(e).rows,u=n.cells[0].row,o=o[u];return c(Hi(u,e,fc(n.clipboard,n.generators,o),n.generators,t),n.cells[0].row,n.cells[0].column)},Di,ce,ce,yl),rf=e(function(e,n,t,r){var o=p(e).rows,u=n.cells[n.cells.length-1].row+n.cells[n.cells.length-1].rowspan,o=o[n.cells[0].row];return c(Hi(u,e,fc(n.clipboard,n.generators,o),n.generators,t),n.cells[0].row,n.cells[0].column)},Di,ce,ce,yl),of=function(e,n){var r=Re.fromTable(e);return Oi(r,n).bind(function(e){var n,t=e[e.length-1],e=e[0].row,t=t.row+t.rowspan;return e=de(r.all.slice(e,t),function(e){return si(e).type}),t=me(e,"header"),n=me(e,"footer"),t||n?(e=me(e,"body"),!t||e||n?t||e||!n?be.none():be.some("footer"):be.some("header")):be.some("body")}).getOr("")},uf={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},cf=tinymce.util.Tools.resolve("tinymce.util.Tools"),lf=[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}],af=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,ff=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,sf=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,mf=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,df=function(e){return de(e,function(e){var n=e.text||e.title;return Lc(e)?{text:n,items:df(e.menu)}:{text:n,value:e.value}})},gf=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:lf}],pf={normal:Uc(!1),ifTruthy:Uc(!0)},bf=E(Xc,["left","center","right"],"align"),hf=E(Xc,["top","middle","bottom"],"valign"),vf=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],wf=function(e,n,t,r){if("TD"===n.tagName||"TH"===n.tagName)ke(t)?e.setStyle(n,t,r):e.setStyle(n,t);else if(n.children)for(var o=0;o<n.children.length;o++)wf(e,n.children[o],t,r)},na={remove_similar:!0,inherit:!1},n=R({selector:"td,th"},na),yf={tablecellbackgroundcolor:R({styles:{backgroundColor:"%value"}},n),tablecellverticalalign:R({styles:{"vertical-align":"%value"}},n),tablecellbordercolor:R({styles:{borderColor:"%value"}},n),tablecellclass:R({classes:["%value"]},n),tableclass:R({selector:"table",classes:["%value"]},na),tablecellborderstyle:R({styles:{borderStyle:"%value"}},n),tablecellborderwidth:R({styles:{borderWidth:"%value"}},n)},Cf=Wr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Sf=R(R({},Cf),{none:function(e){return Cf.none(e=void 0===e?void 0:e)}}),Tf=function(e,n,t,r,o){void 0===o&&(o=se);var u=1===r;return!u&&t<=0?Sf.first(e[0]):u&&t>=e.length-1?Sf.last(e[e.length-1]):o(t=e[u=t+r])?Sf.middle(n,t):Tf(e,n,u,r,o)},xf=function(e,n,t,r){return{start:e,soffset:n,finish:t,foffset:r}},Na=Wr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),B={before:Na.before,on:Na.on,after:Na.after,cata:function(e,n,t,r){return e.fold(n,t,r)},getStart:function(e){return e.fold(ae,ae,ae)}},Rf=Wr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Df={domRange:Rf.domRange,relative:Rf.relative,exact:Rf.exact,exactFromRange:function(e){return Rf.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){e=e.match({domRange:function(e){return we.fromDom(e.startContainer)},relative:function(e,n){return B.getStart(e)},exact:function(e,n,t,r){return e}});return we.fromDom(wn(e).dom.defaultView)},range:xf},Of=Wr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]);function Af(e,n,t){return n>=e.left&&n<=e.right&&t>=e.top&&t<=e.bottom}function kf(e,n){return n-e.left<e.right-n}function If(e,n,t){e=e.dom.createRange();return e.selectNode(n.dom),e.collapse(t),e}function Bf(n,e,t){var r=n.dom.createRange(),o=(r.selectNode(e.dom),kf(r.getBoundingClientRect(),t));return(!0===o?Eo:Po)(e).map(function(e){return If(n,e,o)})}function Mf(e,n,t){t=kf(n.dom.getBoundingClientRect(),t);return be.some(If(e,n,t))}function Ef(e,n){var t=ye(e);return"input"===t?B.after(e):me(["br","img"],t)?0===n?B.before(e):B.after(e):B.on(e,n)}function Pf(e,n){e=e.fold(B.before,Ef,B.after),n=n.fold(B.before,Ef,B.after);return Df.relative(e,n)}function Nf(e,n,t,r){e=Ef(e,n),n=Ef(t,r);return Df.relative(e,n)}function zf(e){return be.from(e.getSelection())}function Lf(e,n){zf(e).each(function(e){e.removeAllRanges(),e.addRange(n)})}function _f(e,n,t,r,o){Lf(e,fl(e,n,t,r,o))}function Wf(l,e){dl(l,e).match({ltr:function(e,n,t,r){_f(l,e,n,t,r)},rtl:function(o,u,i,c){zf(l).each(function(e){if(e.setBaseAndExtent)e.setBaseAndExtent(o.dom,u,i.dom,c);else if(e.extend)try{t=i,r=c,(n=e).collapse(o.dom,u),n.extend(t.dom,r)}catch(e){_f(l,i,c,o,u)}else _f(l,i,c,o,u);var n,t,r})}})}function jf(e,n,t,r,o){Wf(e,Nf(n,t,r,o))}function Ff(e,n,t){Wf(e,Pf(n,t))}function Hf(e){var n;return 0<e.rangeCount?(n=e.getRangeAt(0),e=e.getRangeAt(e.rangeCount-1),be.some(xf(we.fromDom(n.startContainer),n.startOffset,we.fromDom(e.endContainer),e.endOffset))):be.none()}function Vf(e){var n,t,r,o,u,i,c,l,a,f,s;return null!==e.anchorNode&&null!==e.focusNode&&(r=we.fromDom(e.anchorNode),o=we.fromDom(e.focusNode),a=i=e.anchorOffset,f=c=o,s=l=e.focusOffset,(n=vn(t=u=r).dom.createRange()).setStart(t.dom,a),n.setEnd(f.dom,s),t=n,a=he(u,c)&&i===l,t.collapsed)&&!a?be.some(xf(r,e.anchorOffset,o,e.focusOffset)):Hf(e)}function qf(e,n,t){Lf(e,((t=void 0===t||t)?ll:cl)(e,n))}function Uf(e){return zf(e).filter(function(e){return 0<e.rangeCount}).bind(Vf).map(function(e){return Df.exact(e.start,e.soffset,e.finish,e.foffset)})}function Gf(e,n,t){return As(e,n,(o=Ou,il(r=t,void 0).fold(function(){return Sf.none(r)},function(e){return Tf(e.all,r,e.index,1,o)})));var r,o}function $f(e,n){e=gl(e,n);return xf(we.fromDom(e.startContainer),e.startOffset,we.fromDom(e.endContainer),e.endOffset)}function Kf(e,n){return{item:e,mode:n}}function Xf(e,n,t,r){return void 0===r&&(r=Ss),e.property().parent(n).map(function(e){return Kf(e,r)})}function Yf(n){return function(e){return 0===n.property().children(e).length}}function Jf(e,n){return Ls(Ws,e,Yf(Ws),n)}function Qf(e,n){return _s(Ws,e,Yf(Ws),n)}function Zf(e){return P(e,"tr")}function es(e){return"br"===ye(e)}function ns(e,n,t,r){var o,u,i,c,l,a,f;return(es(n)?(o=e,(i=r).traverse(u=n).orThunk(function(){return Hs(u,i.gather,o)}).map(i.relative)):(c=e,l=r,xn(a=n,f=t).filter(es).orThunk(function(){return xn(a,f-1).filter(es)}).bind(function(e){return l.traverse(e).fold(function(){return Hs(e,l.gather,c).map(l.relative)},function(e){return yn(r=e).bind(function(n){var t=d(n);return x(t,E(he,r)).map(function(e){return{parent:n,children:t,element:r,index:e}})}).map(function(e){return B.on(e.parent,e.index)});var r})}))).map(function(e){return{start:e,finish:e}})}function ts(e,n){return{left:e.left,top:e.top+n,right:e.right,bottom:e.bottom+n}}function rs(e,n){return{left:e.left,top:e.top-n,right:e.right,bottom:e.bottom-n}}function os(e,n,t){return{left:e.left+n,top:e.top+t,right:e.right+n,bottom:e.bottom+t}}function us(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}function is(e,n){return be.some(e.getRect(n))}function cs(e,n,t){return In(n)?is(e,n).map(us):Bn(n)?(e=e,n=n,(0<=(t=t)&&t<Bo(n)?e.getRangedRect(n,t,n,t+1):0<t?e.getRangedRect(n,t-1,n,t):be.none()).map(us)):be.none()}function ls(e,n){return In(n)?is(e,n).map(us):Bn(n)?e.getRangedRect(n,0,n,Bo(n)).map(us):be.none()}function as(n,e,t){return _n(function(e,n){return n(e)},Wn,e,tc,void 0).fold(fe,function(e){return ls(n,e).exists(function(e){return(n=t).left<(e=e).left||Math.abs(e.right-n.left)<1||n.left>e.right;var n})})}function fs(n,t,e){var r,o=n.move(e,5),u=qs(t,n,e,o,100).getOr(o),e=u,o=t;return((r=n).point(e)>o.getInnerHeight()?be.some(r.point(e)-o.getInnerHeight()):r.point(e)<0?be.some(-r.point(e)):be.none()).fold(function(){return t.situsFromPoint(u.left,n.point(u))},function(e){return t.scrollBy(0,e),t.situsFromPoint(u.left,n.point(u)-e)})}function ss(a,f,s,e,m){return P(e,"td,th",f).bind(function(l){return P(l,"table",f).bind(function(e){return n=e,Wn(m,function(e){return yn(e).exists(function(e){return he(e,n)})},void 0).isSome()?(t=u=a,r=i=f,o=c=s,t.getSelection().bind(function(n){return ns(r,n.finish,n.foffset,o).fold(function(){return be.some(ci(n.finish,n.foffset))},function(e){e=t.fromSitus(e),e=Fs.verify(t,n.finish,n.foffset,e.finish,e.foffset,o.failure,r);return Fs.cata(e,function(e){return be.none()},function(){return be.none()},function(e){return be.some(ci(e,0))},function(e){return be.some(ci(e,Bo(e)))})})}).bind(function(e){return Gs(u,i,e.element,e.offset,c,20).map(u.fromSitus)}).bind(function(n){return P(n.finish,"td,th",f).map(function(e){return{start:l,finish:e,range:n}})})):be.none();var t,r,o,n,u,i,c})})}function ms(e,n,t,r,o,u){return ln().browser.isIE()?be.none():u(r,n).orThunk(function(){return ss(e,n,t,r,o).map(function(e){e=e.range;return Is(be.some(Ms(e.start,e.soffset,e.finish,e.foffset)),!0)})})}function ds(e,r){return P(e,"tr",r).bind(function(t){return P(t,"table",r).bind(function(e){var n=An(e,"tr");return he(t,n[0])?Ls(Ws,e,function(e){return Po(e).isSome()},r).map(function(e){var n=Bo(e);return Is(be.some(Ms(e,n,e,n)),!0)}):be.none()})})}function gs(e,r){return P(e,"tr",r).bind(function(t){return P(t,"table",r).bind(function(e){var n=An(e,"tr");return he(t,n[n.length-1])?_s(Ws,e,function(e){return Eo(e).isSome()},r).map(function(e){return Is(be.some(Ms(e,0,e,0)),!0)}):be.none()})})}function ps(e,n,t,r,o,u,i){return ss(e,t,r,o,u).bind(function(e){return Es(n,t,e.start,e.finish,i)})}function bs(e,n){return P(e,"td,th",n)}function hs(n){return function(e){return e===n}}function vs(e){return 37<=e&&e<=40}function ws(u){return{elementFromPoint:function(e,n){return we.fromPoint(we.fromDom(u.document),e,n)},getRect:function(e){return e.dom.getBoundingClientRect()},getRangedRect:function(e,n,t,r){e=Df.exact(e,n,t,r),t=(n=gl(u,e)).getClientRects();return 0<(r=0<t.length?t[0]:n.getBoundingClientRect()).width||0<r.height?be.some(r).map(sl):be.none()},getSelection:function(){return Uf(u).map(function(e){return $f(u,e)})},fromSitus:function(e){e=Df.relative(e.start,e.finish);return $f(u,e)},situsFromPoint:function(e,n){return e=e,n=n,t=we.fromDom(u.document),Ds(t,e,n).map(function(e){return xf(we.fromDom(e.startContainer),e.startOffset,we.fromDom(e.endContainer),e.endOffset)}).map(function(e){return Bs(e.start,e.soffset,e.finish,e.foffset)});var t},clearSelection:function(){zf(u).each(function(e){return e.removeAllRanges()})},collapseSelection:function(o){void 0===o&&(o=!1),Uf(u).each(function(e){return e.fold(function(e){return e.collapse(o)},function(e,n){e=o?e:n;Ff(u,e,e)},function(e,n,t,r){e=o?e:t,t=o?n:r;jf(u,e,t,e,t)})})},setSelection:function(e){jf(u,e.start,e.soffset,e.finish,e.foffset)},setRelativeSelection:function(e,n){Ff(u,e,n)},selectNode:function(e){qf(u,e,!1)},selectContents:function(e){qf(u,e)},getInnerHeight:function(){return u.innerHeight},getScrollY:function(){var e=we.fromDom(u.document),e=void 0!==e?e.dom:document,n=e.body.scrollLeft||e.documentElement.scrollLeft,e=e.body.scrollTop||e.documentElement.scrollTop;return no(n,e).top},scrollBy:function(e,n){var t=we.fromDom(u.document);(t=(void 0!==t?t.dom:document).defaultView)&&t.scrollBy(e,n)}}}function ys(e,n){return{rows:e,cols:n}}function Cs(e){return!1===xu(we.fromDom(e.target),"ephox-snooker-resizer-bar")}function Ss(e,n,t,r){return void 0===r&&(r=Ps),t.sibling(e,n).map(function(e){return Kf(e,r)})}Of.ltr,Of.rtl;function Ts(e,n,t,r){return Bn(n)?(c=n,a=t,f=r,(u=(i=e).dom.createRange()).selectNode(c.dom),Ee(u.getClientRects(),function(e){return Af(e,a,f)?be.some(e):be.none()}).map(function(e){return t=i,n=a,o=f,e=e,u=jt(r=c).length,n=function(e,n,t,r){if(0!==r){if(e===t)return r-1;for(var o=t,u=1;u<r;u++){var i=l(u).getBoundingClientRect(),c=Math.abs(e-i.left);if(n<=i.bottom){if(n<i.top||o<c)return u-1;o=c}}}return 0}(n,o,e.right,u),l(n);function l(e){var n=t.dom.createRange();return n.setStart(r.dom,e),n.collapse(!0),n}var t,r,n,o,u})):(u=n,l=t,s=r,m=(o=e).dom.createRange(),Ee(d(u),function(e){return m.selectNode(e.dom),Af(m.getBoundingClientRect(),l,s)?Ts(o,e,l,s):be.none()}));var i,c,a,f,o,u,l,s,m}function xs(n,t,r,o,e){return M(e=void 0===e?Ns:e,function(e){return e.current===r}).bind(function(e){return e.current(n,t,o,e.next).orThunk(function(){return e.fallback.bind(function(e){return xs(n,t,e,o)})})})}function Rs(e,n,t){var r=ln().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?n.otherRetry(e,t):r.isIE()?n.ieRetry(e,t):be.none()}var Ds=document.caretPositionFromPoint?function(t,e,n){var r,o;return be.from(null==(o=(r=t.dom).caretPositionFromPoint)?void 0:o.call(r,e,n)).bind(function(e){var n;return null===e.offsetNode?be.none():((n=t.dom.createRange()).setStart(e.offsetNode,e.offset),n.collapse(),be.some(n))})}:document.caretRangeFromPoint?function(e,n,t){var r;return be.from(null==(r=(e=e.dom).caretRangeFromPoint)?void 0:r.call(e,n,t))}:function(c,l,a){return we.fromPoint(c,l,a).bind(function(r){function e(){return e=c,t=l,(0===d(n=r).length?Mf:Bf)(e,n,t);var e,n,t}return 0===d(r).length?e():(t=r,o=l,u=a,(i=(n=c).dom.createRange()).selectNode(t.dom),i=i.getBoundingClientRect(),n=n,t=t,o=Math.max(i.left,Math.min(i.right,o)),i=Math.max(i.top,Math.min(i.bottom,u)),(u=n.dom.createRange()).selectNode(t.dom),u=u.getBoundingClientRect(),o=Math.max(u.left,Math.min(u.right,o)),u=Math.max(u.top,Math.min(u.bottom,i)),Ts(n,t,o,u).orThunk(e));var n,t,o,u,i})},Os=tinymce.util.Tools.resolve("tinymce.util.VK"),As=function(n,t,e){return e.fold(be.none,be.none,function(e,n){return Eo(n).map(function(e){return e=Df.exact(e,0,e,0),o=Df.getWin(e=e).dom,e=e.match({domRange:function(e){var n=we.fromDom(e.startContainer),t=we.fromDom(e.endContainer);return Nf(n,e.startOffset,t,e.endOffset)},relative:Pf,exact:Nf}),dl(o,e).match({ltr:n,rtl:n});function n(e,n,t,r){return fl(o,e,n,t,r)}var o})},function(e){return n.execCommand("mceTableInsertRowAfter"),Gf(n,t,e)})},ks=["table","li","dl"],Is=function(e,n){return{selection:e,kill:n}},Bs=function(e,n,t,r){return{start:B.on(e,n),finish:B.on(t,r)}},Ms=Bs,Es=function(t,e,r,n,o){return he(r,n)?be.none():ur(r,n,e).bind(function(e){var n=e.boxes.getOr([]);return 1<n.length?(o(t,n,e.start,e.finish),be.some(Is(be.some(Ms(r,0,r,Bo(r))),!0))):be.none()})},Ps=function(e,n,t,r){void 0===r&&(r=Ps);e=e.property().children(n);return t.first(e).map(function(e){return Kf(e,r)})},Ns=[{current:Xf,next:Ss,fallback:be.none()},{current:Ss,next:Ps,fallback:be.some(Xf)},{current:Ps,next:Ps,fallback:be.some(Ss)}],zs=function(n,e,t,r,o,u){return xs(n,e,r,o).bind(function(e){return u(e.item)?be.none():t(e.item)?be.some(e.item):zs(n,e.item,t,e.mode,o,u)})},Ls=function(e,n,t,r){return zs(e,n,t,Ss,{sibling:function(e,n){return e.query().prevSibling(n)},first:function(e){return 0<e.length?be.some(e[e.length-1]):be.none()}},r)},_s=function(e,n,t,r){return zs(e,n,t,Ss,{sibling:function(e,n){return e.query().nextSibling(n)},first:function(e){return 0<e.length?be.some(e[0]):be.none()}},r)},Ws=tr(),js=Wr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Fs=R(R({},js),{verify:function(u,e,n,t,i,c,r){return P(t,"td,th",r).bind(function(o){return P(e,"td,th",r).map(function(r){return he(o,r)?he(t,o)&&Bo(o)===i?c(r):js.none("in same cell"):rr(Zf,[o,r]).fold(function(){return e=o,n=(t=u).getRect(r),(t=t.getRect(e)).right>n.left&&t.left<n.right?js.success():c(r);var e,n,t},function(e){return c(r)})})}).getOr(js.none("default"))},cata:function(e,n,t,r,o){return e.fold(n,t,r,o)}}),Hs=function(e,n,t){return n(e,t).bind(function(e){return Bn(e)&&0===jt(e).trim().length?Hs(e,n,t):be.some(e)})},Vs=Wr([{none:[]},{retry:["caret"]}]),za={point:function(e){return e.bottom},adjuster:function(e,n,t,r,o){var u=ts(o,5);return Math.abs(t.bottom-r.bottom)<1||t.top>o.bottom?Vs.retry(u):t.top===o.bottom?Vs.retry(ts(o,1)):as(e,n,o)?Vs.retry(os(u,5,0)):Vs.none()},move:ts,gather:Qf},qs=function(t,r,o,u,i){return 0===i?be.some(u):(e=t,n=u.left,c=r.point(u),e.elementFromPoint(n,c).filter(function(e){return"table"===ye(e)}).isSome()?(e=i-1,qs(t,r,o,r.move(u,5),e)):t.situsFromPoint(u.left,r.point(u)).bind(function(e){return e.start.fold(be.none,function(n){return ls(t,n).bind(function(e){return r.adjuster(t,n,e,o,u).fold(be.none,function(e){return qs(t,r,o,e,i-1)})}).orThunk(function(){return be.some(u)})},be.none)}));var e,n,c},Us={tryUp:E(fs,{point:function(e){return e.top},adjuster:function(e,n,t,r,o){var u=rs(o,5);return Math.abs(t.top-r.top)<1||t.bottom<o.top?Vs.retry(u):t.bottom===o.top?Vs.retry(rs(o,1)):as(e,n,o)?Vs.retry(os(u,5,0)):Vs.none()},move:rs,gather:Jf}),tryDown:E(fs,za),ieTryUp:function(e,n){return e.situsFromPoint(n.left,n.top-5)},ieTryDown:function(e,n){return e.situsFromPoint(n.left,n.bottom+5)},getJumpSize:le(5)},Gs=function(t,r,o,u,i,c){return 0===c?be.none():Ks(t,r,o,u,i).bind(function(e){var n=t.fromSitus(e),n=Fs.verify(t,o,u,n.finish,n.foffset,i.failure,r);return Fs.cata(n,function(){return be.none()},function(){return be.some(e)},function(e){return he(o,e)&&0===u?$s(t,o,u,rs,i):Gs(t,r,e,0,i,c-1)},function(e){return he(o,e)&&u===Bo(e)?$s(t,o,u,ts,i):Gs(t,r,e,Bo(e),i,c-1)})})},$s=function(n,e,t,r,o){return cs(n,e,t).bind(function(e){return Rs(n,o,r(e,Us.getJumpSize()))})},Ks=function(n,e,t,r,o){return cs(n,t,r).bind(function(e){return Rs(n,o,e)})},Xs={traverse:Tn,gather:Qf,relative:B.before,otherRetry:Us.tryDown,ieRetry:Us.ieTryDown,failure:Fs.failedDown},Ys={traverse:Sn,gather:Jf,relative:B.before,otherRetry:Us.tryUp,ieRetry:Us.ieTryUp,failure:Fs.failedUp},Js=hs(38),Qs=hs(40),Zs={isBackward:hs(37),isForward:hs(39)},em={isBackward:hs(39),isForward:hs(37)},nm=tinymce.util.Tools.resolve("tinymce.Env");function tm(A,k,e){u=function(i,c,l){e.targets().each(function(r){Te(c).each(function(e){var n,o,u,t=ni(A),t=Fo(ce,we.fromDom(A.getDoc()),t),t=(n=r,o=t,Oi(u=Re.fromTable(e),n).map(function(e){var n,t,r=Si(u,o,!1);return{upOrLeftCells:w(Ti(r.slice(0,(n=e)[n.length-1].row+1)),function(e){return de(e.cells.slice(0,n[n.length-1].column+1),function(e){return e.element})}),downOrRightCells:w(Ti(r.slice((t=e)[0].row+t[0].rowspan-1,r.length)),function(e){return de(e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length),function(e){return e.element})})}}));A.fire("TableSelectionChange",{cells:i,start:c,finish:l,otherCells:t})})})},n=function(){A.fire("TableSelectionClear")};var o,u,n,I={clearBeforeUpdate:r,clear:c,selectRange:function(e,n,t,r){c(e),ge(n,i),Ce(t,o.firstSelected,"1"),Ce(r,o.lastSelected,"1"),u(n,t,r)},selectedSelector:(o=Ul).selectedSelector,firstSelectedSelector:o.firstSelectedSelector,lastSelectedSelector:o.lastSelectedSelector};function t(e){xe(e,o.selected),xe(e,o.firstSelected),xe(e,o.lastSelected)}function i(e){Ce(e,o.selected,"1")}function c(e){r(e),n()}function r(e){ge(An(e,o.selectedSelector+","+o.firstSelectedSelector+","+o.lastSelectedSelector),t)}return A.on("init",function(e){function o(e,t){u.clearBeforeUpdate(r),ur(e,t,n).each(function(e){var n=e.boxes.getOr([]);u.selectRange(r,n,e.start,e.finish),i.selectContents(t),i.collapseSelection()})}var r,n,u,i,s,m,d,a,c,l,t,f,g,p,b=A.getWin(),h=qo(A),v=$o(A),w=(O=ws(b),{clearstate:(c=O,l=h,t=v,f=I,g=zc(),(O={clearstate:p=g.clear,mousedown:function(e){f.clear(l),bs(e.target,t).each(g.set)},mouseover:function(e){S(e)},mouseup:function(e){S(e),p()}}).clearstate),mousedown:O.mousedown,mouseover:O.mouseover,mouseup:O.mouseup}),y=(a=ws(b),{keydown:function(e,n,t,r,o,u){var e=e.raw,i=e.which,c=!0===e.shiftKey;return ir(s,d.selectedSelector).fold(function(){return vs(i)&&!c&&d.clearBeforeUpdate(s),Qs(i)&&c?E(ps,a,s,m,Xs,r,n,d.selectRange):Js(i)&&c?E(ps,a,s,m,Ys,r,n,d.selectRange):Qs(i)?E(ms,a,m,Xs,r,n,gs):Js(i)?E(ms,a,m,Ys,r,n,ds):be.none},function(l){function e(e){return function(){return Ee(e,function(e){return u=e.rows,e=e.cols,i=s,t=u,r=e,o=(c=d).firstSelectedSelector,u=c.lastSelectedSelector,n=u,M(l,function(e){return X(e,n)}).bind(function(e){return u=t,i=r,Te(n=e).bind(function(e){var t=Zt(e),r=u,o=i;return Re.findItem(t,n,he).bind(function(e){var n=0<r?e.row+e.rowspan-1:e.row,e=0<o?e.column+e.colspan-1:e.column;return Re.getAt(t,n+r,e+o).map(function(e){return e.element})})}).bind(function(e){return t=o,jn(n=e,"table").bind(function(e){return Hn(e,t).bind(function(e){return ur(e,n).bind(function(n){return n.boxes.map(function(e){return{boxes:e,start:n.start,finish:n.finish}})})})});var n,t});var n,u,i}).map(function(e){return c.clearBeforeUpdate(i),c.selectRange(i,e.boxes,e.start,e.finish),e.boxes});var t,r,o,n,u,i,c}).fold(function(){return cr(s,d.firstSelectedSelector,d.lastSelectedSelector).map(function(e){var n=Qs(i)||u.isForward(i)?B.after:B.before;return a.setRelativeSelection(B.on(e.first,0),n(e.table)),d.clear(s),Is(be.none(),!0)})},function(e){return be.some(Is(be.none(),!0))})}}return Qs(i)&&c?e([ys(1,0)]):Js(i)&&c?e([ys(-1,0)]):u.isBackward(i)&&c?e([ys(0,-1),ys(-1,0)]):u.isForward(i)&&c?e([ys(0,1),ys(1,0)]):vs(i)&&!c?C:be.none})()},keyup:function(i,c,l,a,f){return ir(s,d.selectedSelector).fold(function(){var t,r,e,o,n=i.raw,u=n.which;return!0!==n.shiftKey||!vs(u)||(t=s,r=m,o=d.selectRange,he(n=c,e=a)&&l===f)?be.none():P(n,"td,th",r).bind(function(n){return P(e,"td,th",r).bind(function(e){return Es(t,r,n,e,o)})})},be.none)}});r=s=h,n=m=v,u=d=I,i=ws(b);function C(){return d.clear(s),be.none()}function S(i){g.on(function(e){f.clearBeforeUpdate(l),bs(i.target,t).each(function(u){ur(e,u,t).each(function(e){var n,t,r,o=e.boxes.getOr([]);1===o.length?(n=o[0],t="false"===xl(n),r=Kn(Du(i.target),n,he),t&&r&&(f.selectRange(l,o,n,n),c.selectContents(n))):1<o.length&&(f.selectRange(l,o,e.start,e.finish),c.selectContents(u))})})})}function T(e,n){!0===e.raw.shiftKey&&(n.kill&&e.kill(),n.selection.each(function(e){e=Df.relative(e.start,e.finish),e=gl(b,e);A.selection.setRng(e)}))}function x(e){return 0===e.button}A.on("TableSelectorChange",function(e){return o(e.start,e.finish)});R=Pc(we.fromDom(h)),D=Pc(0);var R,D,O={touchEnd:function(e){var n,t,r=we.fromDom(e.target);"td"!==ye(r)&&"th"!==ye(r)||(n=R.get(),t=D.get(),he(n,r)&&e.timeStamp-t<300&&(e.preventDefault(),o(r,r))),R.set(r),D.set(e.timeStamp)}};A.on("dragstart",function(e){w.clearstate()}),A.on("mousedown",function(e){x(e)&&Cs(e)&&w.mousedown(ua(e))}),A.on("mouseover",function(e){var n;(void 0===(n=e).buttons||nm.browser.isEdge()&&0===n.buttons||0!=(1&n.buttons))&&Cs(e)&&w.mouseover(ua(e))}),A.on("mouseup",function(e){x(e)&&Cs(e)&&w.mouseup(ua(e))}),A.on("touchend",O.touchEnd),A.on("keyup",function(e){var n,t,r=ua(e);r.raw.shiftKey&&vs(r.raw.which)&&(e=A.selection.getRng(),n=we.fromDom(e.startContainer),t=we.fromDom(e.endContainer),y.keyup(r,n,e.startOffset,t,e.endOffset).each(function(e){T(r,e)}))}),A.on("keydown",function(e){var n=ua(e),e=(k().each(function(e){return e.hideBars()}),A.selection.getRng()),t=we.fromDom(e.startContainer),r=we.fromDom(e.endContainer),o=xr(Zs,em)(we.fromDom(A.selection.getStart()));y.keydown(n,t,e.startOffset,r,e.endOffset,o).each(function(e){T(n,e)}),k().each(function(e){return e.showBars()})}),A.on("NodeChange",function(){var e=A.selection;rr(Te,[we.fromDom(e.getStart()),we.fromDom(e.getEnd())]).fold(function(){return I.clear(h)},ce)})}),{clear:I.clear}}Je.add("table",function(i){z=function(){return qo(i)},L=function(){return $l(Yo(i),$o(i))},_=Ul.selectedSelector;var z,L,_,n,t,r,o,u,e,W,j,s,m,F,l,c,a,d,g,p,f,H,b,h,v,w,y,C,S,V,q,U,T={get:function(){return Kr(z(),_).fold(function(){return L().fold(Xr,Jr)},function(e){return Yr(e)})}},x=(f=i,H=T,b=Pc(be.none()),h=Pc([]),v=be.none(),w=hn("caption"),x=oe("mceTableRowType","header"),O=oe("mceTableColType","th"),f.on("NodeChange ExecCommand TableSelectorChange",ee),{onSetupTable:function(e){return k(e,function(e){return!1})},onSetupCellOrRow:function(e){return k(e,function(e){return w(e.element)})},onSetupColumn:function(n){return function(e){return k(e,function(e){return w(e.element)||re(n)})}},onSetupPasteable:function(n){return function(e){return k(e,function(e){return w(e.element)||n().isNone()})}},onSetupPasteableColumn:function(n,t){return function(e){return k(e,function(e){return w(e.element)||n().isNone()||re(t)})}},onSetupMergeable:function(e){return k(e,function(e){return J("mergeable")})},onSetupUnmergeable:function(e){return k(e,function(e){return J("unmergeable")})},resetTargets:ee,onSetupTableWithCaption:function(e){return te(e,fe,function(e){return Te(e.element,$o(f)).exists(function(e){return Fn(e,"caption").isSome()})})},onSetupTableRowHeaders:x,onSetupTableColumnHeaders:O,targets:b.get}),R=(l=i,d=be.none(),g=be.none(),p=be.none(),l.on("init",function(){e=ii;var e,n,t,o,u,a,i,r,f,c=(r=l).inline?(n=qo(r),et(c=we.fromTag("div"),{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),De(kn(we.fromDom(document)),c),t=e,{parent:le(c),view:le(n),origin:le(no(0,0)),isResizable:t}):pl(we.fromDom(r.getDoc()),e);p=be.some(c),n=l.getParam("object_resizing",!0),(ke(n)?"table"===n:n)&&l.getParam("table_resize_bars",!0,"boolean")&&(t=Y(),o=t,u=X,a=ro,i=uo,r=Pu(c),f=bu({beforeResize:pu(["table","type"]),afterResize:pu(["table","type"]),startDrag:pu([])}),r.events.adjustHeight.bind(function(e){var n=e.table;f.trigger.beforeResize(n,"row");var t,r=n,o=a.delta(e.delta,n),u=e.row,e=a,i=Re.fromTable(r),e=de(Oo(i,r,e,vo,function(e){return e.getOrThunk(Xt)}),function(e,n){return u===n?Math.max(o+e,Xt()):e}),c=e,l=de(Re.justCells(i),function(e){var n=nu(e.row,e.row+e.rowspan,c);return{element:e.element,height:n,rowspan:e.rowspan}});ge((t=e,de(i.all,function(e,n){return{element:e.element,height:t[n]}})),function(e){mo(e.element,e.height)}),ge(l,function(e){mo(e.element,e.height)}),mo(r,Ie(e,function(e,n){return e+n},0)),f.trigger.afterResize(n,"row")}),r.events.startAdjust.bind(function(e){f.trigger.startDrag()}),r.events.adjustWidth.bind(function(e){var n=e.table,t=(f.trigger.beforeResize(n,"col"),i.delta(e.delta,n)),r=u(n);ru(n,t,e.column,o,r),f.trigger.afterResize(n,"col")}),(e={on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:f.registry}).on(),e.events.startDrag.bind(function(e){d=be.some(l.selection.getRng())}),e.events.beforeResize.bind(function(e){var n,t=e.table.dom,r=l,o=Uo(n=t),t=Go(t),e=ya+e.type;r.fire("ObjectResizeStart",{target:n,width:o,height:t,origin:e})}),e.events.afterResize.bind(function(e){var n,t,r=e.table,o=r.dom;Xo(r),d.each(function(e){l.selection.setRng(e),l.focus()}),r=l,t=Uo(n=o),o=Go(o),e=ya+e.type,r.fire("ObjectResized",{target:n,width:t,height:o,origin:e}),l.undoManager.add()}),g=be.some(e))}),l.on("ObjectResizeStart",function(e){var n,t=e.target;K(t)&&(n=we.fromDom(t),ge(l.dom.select(".mce-clonedresizable"),function(e){l.dom.addClass(e,"mce-"+Qu(l)+"-columns")}),!hl(n)&&wa(l)?Ol(n):!bl(n)&&Yu(l)&&Dl(n),vl(n)&&Xe(e.origin,ya)&&Dl(n),c=e.width,a=Rl(l)?"":(t=(n=l).dom.getStyle(e=t,"width")||n.dom.getAttrib(e,"width"),be.from(t).filter(ze).getOr("")))}),l.on("ObjectResized",function(e){var n,t,r,o,u=e.target;K(u)&&(u=we.fromDom(u),o=e.origin,Xe(o,"corner-")&&(n=u,e=e.width,o=Ne(o,"e"),""===a&&Dl(n),e!==c&&""!==a?(Se(n,"width",a),r=Y(),t=X(n),o=Zu(l)||o?gu(n).columns-1:0,ru(n,e-c,o,r,t)):/^(\d+(\.\d+)?)%$/.test(a)&&Se(n,"width",e*parseFloat(a.replace("%",""))/c+"%"),/^(\d+(\.\d+)?)px$/.test(a))&&(r=Re.fromTable(o=n),Re.hasColumns(r)||ge(st(o),function(e){Se(e,"width",nt(e,"width")),xe(e,"width")})),Xo(u),Lu(l,u.dom,ma))}),l.on("SwitchMode",function(){g.each(function(e){l.mode.isReadOnly()?e.hideBars():e.showBars()})}),{lazyResize:function(){return g},lazyWire:function(){return p.getOr(pl(we.fromDom(l.getBody()),ii))},destroy:function(){g.each(function(e){e.destroy()}),p.each(function(e){l.inline&&Oe(e.parent())})}}),G=tm(i,R.lazyResize,x),D=(s=i,m=G,O=R.lazyWire,F=ni(s),D=ei(s)?ce:ai,{deleteRow:A(Va,function(e){return!1===$(s)||1<gu(e).rows},ce,O,Ae),deleteColumn:A(Ha,function(e){return!1===$(s)||1<gu(e).columns},ce,O,Ae),insertRowsBefore:A(_a,se,ce,O,Ae),insertRowsAfter:A(Wa,se,ce,O,Ae),insertColumnsBefore:A(ja,se,D,O,Ae),insertColumnsAfter:A(Fa,se,D,O,Ae),mergeCells:A(Ja,se,ce,O,Ae),unmergeCells:A(Qa,se,ce,O,Ae),pasteColsBefore:A(ef,se,ce,O,Ae),pasteColsAfter:A(nf,se,ce,O,Ae),pasteRowsBefore:A(tf,se,ce,O,Ae),pasteRowsAfter:A(rf,se,ce,O,Ae),pasteCells:A(Za,se,ce,O,da),makeCellsHeader:A(Xa,se,ce,O,Ae),unmakeCellsHeader:A(Ya,se,ce,O,Ae),makeColumnsHeader:A(qa,se,ce,O,Ae),unmakeColumnsHeader:A(Ua,se,ce,O,Ae),makeRowsHeader:A(Ga,se,ce,O,Ae),makeRowsBody:A($a,se,ce,O,Ae),makeRowsFooter:A(Ka,se,ce,O,Ae),getTableRowType:of,getTableCellType:wc,getTableColType:vc}),O=(n=zc(),t=zc(),{getRows:n.get,setRows:function(e){e.fold(n.clear,n.set),t.clear()},clearRows:n.clear,getColumns:t.get,setColumns:function(e){e.fold(t.clear,t.set),n.clear()},clearColumns:t.clear});function $(e){return"table"===ye(qo(e))}function A(i,c,l,a,f){return function(n,e,r){void 0===r&&(r=!1),Xo(n);var t=a(),o=we.fromDom(s.getDoc()),o=Fo(l,o,F),u={sizing:oi(s,n),resize:(ei(s)?cu:lu)(),section:function(e){switch(Ju(s)){case"section":return Da();case"sectionCells":return Oa();case"cells":return Aa();default:switch(Ee(Re.fromTable(e).all,function(e){e=si(e);return"header"===e.type?be.from(e.subType):be.none()}).getOr("section")){case"section":return gi();case"sectionCells":return pi();case"cells":return bi()}return}}(n)};return c(n)?i(t,n,e,o,u).bind(function(e){ge(e.newRows,function(e){Nu(s,e.dom)}),ge(e.newCells,function(e){zu(s,e.dom)});t=n;var t,e=e.cursor.fold(function(){return Me(st(t)).filter(zn).map(function(e){m.clear(t);var n=s.dom.createRng();return n.selectNode(e.dom),s.selection.setRng(n),Ce(e,"data-mce-selected","1"),n})},function(e){var e=Sa(Ta,e),n=s.dom.createRng();return n.setStart(e.element.dom,e.offset),n.setEnd(e.element.dom,e.offset),s.selection.setRng(n),m.clear(t),be.some(n)});return zn(n)&&(Xo(n),r||Lu(s,n.dom,f)),e.map(function(e){return{rng:e,effect:f}})}):be.none()}}function K(e){return"TABLE"===e.nodeName}function X(e){return oi(l,e)}function Y(){return(Zu(l)?lu:cu)()}function J(n){return v.forall(function(e){return!e[n]})}function Q(){return Gl(Yo(f),$o(f)).bind(function(t){return Yn(Te(t),Gl(we.fromDom(f.selection.getEnd()),$o(f)).bind(Te),function(e,n){return he(e,n)?w(t)?be.some({element:n=t,mergable:be.none(),unmergable:be.none(),selection:[n]}):be.some(Qo(H,e,t)):be.none()}).bind(ae)})}function Z(n){return Te(n.element).map(function(e){var t=Re.fromTable(e),e=Be(Oi(t,n).getOr([]),function(e,n){return n.isLocked&&(e.onAny=!0,0===n.column?e.onFirst=!0:n.column+n.colspan>=t.grid.columns&&(e.onLast=!0)),e},{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:Ii(t,n).isSome(),unmergeable:Bi(t,n).isSome(),locked:e}})}function ee(){b.set(Pe(Q)()),v=b.get().bind(Z),ge(h.get(),function(e){e()})}function ne(n){return n(),h.set(h.get().concat([n])),function(){h.set(pe(h.get(),function(e){return e!==n}))}}function k(n,t){return ne(function(){return b.get().fold(function(){n.setDisabled(!0)},function(e){n.setDisabled(t(e))})})}function te(n,t,r){return ne(function(){return b.get().fold(function(){n.setDisabled(!0),n.setActive(!1)},function(e){n.setDisabled(t(e)),n.setActive(r(e))})})}function re(n){return v.exists(function(e){return e.locked[n]})}function oe(n,t){return function(e){return te(e,function(e){return w(e.element)},function(){return f.queryCommandValue(n)===t})}}ul(i,D,0,T,O),e=D,W=T,j=$o(u=i),ve({mceTableRowType:function(){return ie(e.getTableRowType)},mceTableCellType:function(){return ie(e.getTableCellType)},mceTableColType:function(){return ie(e.getTableColType)}},function(e,n){u.addQueryValueHandler(n,e)}),eu(i,T,D),y=i,C=T,D=O,B={text:"Table properties",onSetup:(S=x).onSetupTable,onAction:N("mceTableProps")},M={text:"Delete table",icon:"table-delete-table",onSetup:S.onSetupTable,onAction:N("mceTableDelete")},y.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:N("mceTableInsertRowBefore"),onSetup:S.onSetupCellOrRow}),y.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:N("mceTableInsertRowAfter"),onSetup:S.onSetupCellOrRow}),y.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:N("mceTableDeleteRow"),onSetup:S.onSetupCellOrRow}),y.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:N("mceTableRowProps"),onSetup:S.onSetupCellOrRow}),y.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:N("mceTableCutRow"),onSetup:S.onSetupCellOrRow}),y.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:N("mceTableCopyRow"),onSetup:S.onSetupCellOrRow}),y.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:N("mceTablePasteRowBefore"),onSetup:S.onSetupPasteable(D.getRows)}),y.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:N("mceTablePasteRowAfter"),onSetup:S.onSetupPasteable(D.getRows)}),E={type:"nestedmenuitem",text:"Row",getSubmenuItems:le("tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter")},y.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:N("mceTableInsertColBefore"),onSetup:S.onSetupColumn("onFirst")}),y.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:N("mceTableInsertColAfter"),onSetup:S.onSetupColumn("onLast")}),y.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:N("mceTableDeleteCol"),onSetup:S.onSetupColumn("onAny")}),y.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:N("mceTableCutCol"),onSetup:S.onSetupColumn("onAny")}),y.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:N("mceTableCopyCol"),onSetup:S.onSetupColumn("onAny")}),y.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:N("mceTablePasteColBefore"),onSetup:S.onSetupPasteableColumn(D.getColumns,"onFirst")}),y.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:N("mceTablePasteColAfter"),onSetup:S.onSetupPasteableColumn(D.getColumns,"onLast")}),D={type:"nestedmenuitem",text:"Column",getSubmenuItems:le("tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter")},y.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:N("mceTableCellProps"),onSetup:S.onSetupCellOrRow}),y.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:N("mceTableMergeCells"),onSetup:S.onSetupMergeable}),y.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:N("mceTableSplitCells"),onSetup:S.onSetupUnmergeable}),!(V={type:"nestedmenuitem",text:"Cell",getSubmenuItems:le("tablecellprops tablemergecells tablesplitcells")})===y.getParam("table_grid",!0,"boolean")?y.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:N("mceInsertTable")}):y.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:ue}]}}),y.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:N("mceInsertTable")}),y.ui.registry.addMenuItem("tableprops",B),y.ui.registry.addMenuItem("deletetable",M),y.ui.registry.addNestedMenuItem("row",E),y.ui.registry.addNestedMenuItem("column",D),y.ui.registry.addNestedMenuItem("cell",V),y.ui.registry.addContextMenu("table",{update:function(){return S.resetTargets(),S.targets().fold(le(""),function(e){return"caption"===ye(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"})}}),0!==(q=El(Xu(y))).length&&y.ui.registry.addNestedMenuItem("tableclass",{icon:"table-classes",text:"Table styles",getSubmenuItems:function(){return Ml(y,C,q,"tableclass",function(e){return y.execCommand("mceTableToggleClass",!1,e)})},onSetup:S.onSetupTable}),0!==(U=El(Ku(y))).length&&y.ui.registry.addNestedMenuItem("tablecellclass",{icon:"table-cell-classes",text:"Cell styles",getSubmenuItems:function(){return Ml(y,C,U,"tablecellclass",function(e){return y.execCommand("mceTableCellToggleClass",!1,e)})},onSetup:S.onSetupCellOrRow}),y.ui.registry.addNestedMenuItem("tablecellvalign",{icon:"vertical-align",text:"Vertical align",getSubmenuItems:function(){return Ml(y,C,lf,"tablecellverticalalign",_c(y,"vertical-align"))},onSetup:S.onSetupCellOrRow}),y.ui.registry.addNestedMenuItem("tablecellborderwidth",{icon:"border-width",text:"Border width",getSubmenuItems:function(){return Ml(y,C,ju(y),"tablecellborderwidth",_c(y,"border-width"))},onSetup:S.onSetupCellOrRow}),y.ui.registry.addNestedMenuItem("tablecellborderstyle",{icon:"border-style",text:"Border style",getSubmenuItems:function(){return Ml(y,C,Fu(y),"tablecellborderstyle",_c(y,"border-style"))},onSetup:S.onSetupCellOrRow}),y.ui.registry.addToggleMenuItem("tablecaption",{icon:"table-caption",text:"Table caption",onAction:N("mceTableToggleCaption"),onSetup:S.onSetupTableWithCaption}),y.ui.registry.addNestedMenuItem("tablecellbackgroundcolor",{icon:"cell-background-color",text:"Background color",getSubmenuItems:function(){return jc(y,ti(y),"background-color")},onSetup:S.onSetupCellOrRow}),y.ui.registry.addNestedMenuItem("tablecellbordercolor",{icon:"cell-border-color",text:"Border color",getSubmenuItems:function(){return jc(y,ri(y),"border-color")},onSetup:S.onSetupCellOrRow}),y.ui.registry.addToggleMenuItem("tablerowheader",{text:"Row header",icon:"table-top-header",onAction:Fc(y),onSetup:S.onSetupTableRowHeaders}),y.ui.registry.addToggleMenuItem("tablecolheader",{text:"Column header",icon:"table-left-header",onAction:Hc(y),onSetup:S.onSetupTableColumnHeaders});var I=i,B=T,M=x,E=O;function P(e){return function(){return I.execCommand(e)}}return I.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(e){return e("inserttable | cell row column | advtablesort | tableprops deletetable")}}),I.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:P("mceTableProps"),icon:"table",onSetup:M.onSetupTable}),I.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:P("mceTableDelete"),icon:"table-delete-table",onSetup:M.onSetupTable}),I.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:P("mceTableCellProps"),icon:"table-cell-properties",onSetup:M.onSetupCellOrRow}),I.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:P("mceTableMergeCells"),icon:"table-merge-cells",onSetup:M.onSetupMergeable}),I.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:P("mceTableSplitCells"),icon:"table-split-cells",onSetup:M.onSetupUnmergeable}),I.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:P("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:M.onSetupCellOrRow}),I.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:P("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:M.onSetupCellOrRow}),I.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:P("mceTableDeleteRow"),icon:"table-delete-row",onSetup:M.onSetupCellOrRow}),I.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:P("mceTableRowProps"),icon:"table-row-properties",onSetup:M.onSetupCellOrRow}),I.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:P("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:M.onSetupColumn("onFirst")}),I.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:P("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:M.onSetupColumn("onLast")}),I.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:P("mceTableDeleteCol"),icon:"table-delete-column",onSetup:M.onSetupColumn("onAny")}),I.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:P("mceTableCutRow"),onSetup:M.onSetupCellOrRow}),I.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:P("mceTableCopyRow"),onSetup:M.onSetupCellOrRow}),I.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:P("mceTablePasteRowBefore"),onSetup:M.onSetupPasteable(E.getRows)}),I.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:P("mceTablePasteRowAfter"),onSetup:M.onSetupPasteable(E.getRows)}),I.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:P("mceTableCutCol"),onSetup:M.onSetupColumn("onAny")}),I.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:P("mceTableCopyCol"),onSetup:M.onSetupColumn("onAny")}),I.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:P("mceTablePasteColBefore"),onSetup:M.onSetupPasteableColumn(E.getColumns,"onFirst")}),I.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:P("mceTablePasteColAfter"),onSetup:M.onSetupPasteableColumn(E.getColumns,"onLast")}),I.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:P("mceInsertTable"),icon:"table"}),0!==(E=El(Xu(I))).length&&I.ui.registry.addMenuButton("tableclass",{icon:"table-classes",tooltip:"Table styles",fetch:Wc(I,B,E,"tableclass",function(e){return I.execCommand("mceTableToggleClass",!1,e)}),onSetup:M.onSetupTable}),0!==(E=El(Ku(I))).length&&I.ui.registry.addMenuButton("tablecellclass",{icon:"table-cell-classes",tooltip:"Cell styles",fetch:Wc(I,B,E,"tablecellclass",function(e){return I.execCommand("mceTableCellToggleClass",!1,e)}),onSetup:M.onSetupCellOrRow}),I.ui.registry.addMenuButton("tablecellvalign",{icon:"vertical-align",tooltip:"Vertical align",fetch:Wc(I,B,lf,"tablecellverticalalign",_c(I,"vertical-align")),onSetup:M.onSetupCellOrRow}),I.ui.registry.addMenuButton("tablecellborderwidth",{icon:"border-width",tooltip:"Border width",fetch:Wc(I,B,ju(I),"tablecellborderwidth",_c(I,"border-width")),onSetup:M.onSetupCellOrRow}),I.ui.registry.addMenuButton("tablecellborderstyle",{icon:"border-style",tooltip:"Border style",fetch:Wc(I,B,Fu(I),"tablecellborderstyle",_c(I,"border-style")),onSetup:M.onSetupCellOrRow}),I.ui.registry.addToggleButton("tablecaption",{tooltip:"Table caption",onAction:P("mceTableToggleCaption"),icon:"table-caption",onSetup:M.onSetupTableWithCaption}),I.ui.registry.addMenuButton("tablecellbackgroundcolor",{icon:"cell-background-color",tooltip:"Background color",fetch:function(e){return e(jc(I,ti(I),"background-color"))},onSetup:M.onSetupCellOrRow}),I.ui.registry.addMenuButton("tablecellbordercolor",{icon:"cell-border-color",tooltip:"Border color",fetch:function(e){return e(jc(I,ri(I),"border-color"))},onSetup:M.onSetupCellOrRow}),I.ui.registry.addToggleButton("tablerowheader",{tooltip:"Row header",icon:"table-top-header",onAction:Fc(I),onSetup:M.onSetupTableRowHeaders}),I.ui.registry.addToggleButton("tablecolheader",{tooltip:"Column header",icon:"table-left-header",onAction:Hc(I),onSetup:M.onSetupTableColumnHeaders}),0<(D=(o=i).getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")).length&&o.ui.registry.addContextToolbar("table",{predicate:function(e){return o.dom.is(e,"table")&&o.getBody().contains(e)},items:D,scope:"node",position:"node"}),i.on("PreInit",function(){i.serializer.addTempAttr(Ul.firstSelected),i.serializer.addTempAttr(Ul.lastSelected),i.formatter.register(yf)}),i.getParam("table_tab_navigation",!0,"boolean")&&i.on("keydown",function(e){var n,t,r,o=i,u=G;(n=e).keyCode===Os.TAB&&(t=qo(o),r=function(e){var n=ye(e);return he(e,t)||me(ks,n)},e=o.selection.getRng(),ft(we.fromDom(n.shiftKey?e.startContainer:e.endContainer),r).each(function(e){n.preventDefault(),Te(e,r).each(u.clear),o.selection.collapse(n.shiftKey),(n.shiftKey?function(e,n,t){return As(e,n,(o=Ou,il(r=t,void 0).fold(function(){return Sf.none()},function(e){return Tf(e.all,r,e.index,-1,o)})));var r,o}:Gf)(o,r,e).each(function(e){o.selection.setRng(e)})}))}),i.on("remove",function(){R.destroy()}),{insertTable:(r=i,function(e,n,t){n=Tc(r,n,e,t=void 0===t?{}:t,"Invalid values for insertTable - rows and columns values are required to insert a table.");return r.undoManager.add(),n}),setClipboardRows:Rc(O.setRows),getClipboardRows:xc(O.getRows),setClipboardCols:Rc(O.setColumns),getClipboardCols:xc(O.getColumns),resizeHandler:R,selectionTargets:x};function N(e){return function(){return y.execCommand(e)}}function ue(e){y.execCommand("mceInsertTable",!1,{rows:e.numRows,columns:e.numColumns})}function ie(r){return $l(Yo(u)).bind(function(t){return Te(t,j).map(function(e){var n=Qo(W,e,t);return r(e,n)})}).getOr("")}})}();